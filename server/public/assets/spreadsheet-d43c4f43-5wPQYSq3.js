import{R as kr,an as M0,u as IY,r as NY,a as ay,V as PY,au as MY,av as AL,aw as IT}from"./index-CrSqH__w.js";import{s as l4}from"./css-5483d03f-CnY6i4xu.js";function kY(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var sy=function(t){return t&&t.Math==Math&&t},Vt=sy(typeof globalThis=="object"&&globalThis)||sy(typeof window=="object"&&window)||sy(typeof self=="object"&&self)||sy(typeof M0=="object"&&M0)||function(){return this}()||Function("return this")(),Ho={},nt=function(t){try{return!!t()}catch{return!0}},xY=nt,Nr=!xY(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),$Y=nt,hg=!$Y(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),LY=hg,ly=Function.prototype.call,Lr=LY?ly.bind(ly):function(){return ly.apply(ly,arguments)},dg={},IL={}.propertyIsEnumerable,NL=Object.getOwnPropertyDescriptor,DY=NL&&!IL.call({1:2},1);dg.f=DY?function(e){var r=NL(this,e);return!!r&&r.enumerable}:IL;var pg=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},PL=hg,ML=Function.prototype,KR=ML.call,FY=PL&&ML.bind.bind(KR,KR),kL=PL?FY:function(t){return function(){return KR.apply(t,arguments)}},xL=kL,HY=xL({}.toString),UY=xL("".slice),za=function(t){return UY(HY(t),8,-1)},BY=za,VY=kL,rt=function(t){if(BY(t)==="Function")return VY(t)},jY=rt,WY=nt,GY=za,Qw=Object,zY=jY("".split),mg=WY(function(){return!Qw("z").propertyIsEnumerable(0)})?function(t){return GY(t)=="String"?zY(t,""):Qw(t)}:Qw,ro=function(t){return t==null},YY=ro,KY=TypeError,Yn=function(t){if(YY(t))throw KY("Can't call method on "+t);return t},XY=mg,qY=Yn,hi=function(t){return XY(qY(t))},XR=typeof document=="object"&&document.all,QY=typeof XR>"u"&&XR!==void 0,$L={all:XR,IS_HTMLDDA:QY},LL=$L,ZY=LL.all,ir=LL.IS_HTMLDDA?function(t){return typeof t=="function"||t===ZY}:function(t){return typeof t=="function"},u4=ir,DL=$L,JY=DL.all,Sr=DL.IS_HTMLDDA?function(t){return typeof t=="object"?t!==null:u4(t)||t===JY}:function(t){return typeof t=="object"?t!==null:u4(t)},Zw=Vt,eK=ir,tK=function(t){return eK(t)?t:void 0},Uo=function(t,e){return arguments.length<2?tK(Zw[t]):Zw[t]&&Zw[t][e]},rK=rt,Ys=rK({}.isPrototypeOf),nK=Uo,Iu=nK("navigator","userAgent")||"",FL=Vt,Jw=Iu,c4=FL.process,f4=FL.Deno,h4=c4&&c4.versions||f4&&f4.version,d4=h4&&h4.v8,ji,k0;d4&&(ji=d4.split("."),k0=ji[0]>0&&ji[0]<4?1:+(ji[0]+ji[1]));!k0&&Jw&&(ji=Jw.match(/Edge\/(\d+)/),(!ji||ji[1]>=74)&&(ji=Jw.match(/Chrome\/(\d+)/),ji&&(k0=+ji[1])));var vg=k0,p4=vg,iK=nt,dd=!!Object.getOwnPropertySymbols&&!iK(function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&p4&&p4<41}),oK=dd,HL=oK&&!Symbol.sham&&typeof Symbol.iterator=="symbol",aK=Uo,sK=ir,lK=Ys,uK=HL,cK=Object,gg=uK?function(t){return typeof t=="symbol"}:function(t){var e=aK("Symbol");return sK(e)&&lK(e.prototype,cK(t))},fK=String,pd=function(t){try{return fK(t)}catch{return"Object"}},hK=ir,dK=pd,pK=TypeError,md=function(t){if(hK(t))return t;throw pK(dK(t)+" is not a function")},mK=md,vK=ro,Nu=function(t,e){var r=t[e];return vK(r)?void 0:mK(r)},eS=Lr,tS=ir,rS=Sr,gK=TypeError,UL=function(t,e){var r,n;if(e==="string"&&tS(r=t.toString)&&!rS(n=eS(r,t))||tS(r=t.valueOf)&&!rS(n=eS(r,t))||e!=="string"&&tS(r=t.toString)&&!rS(n=eS(r,t)))return n;throw gK("Can't convert object to primitive value")},BL={exports:{}},m4=Vt,yK=Object.defineProperty,NT=function(t,e){try{yK(m4,t,{value:e,configurable:!0,writable:!0})}catch{m4[t]=e}return e},bK=Vt,wK=NT,v4="__core-js_shared__",SK=bK[v4]||wK(v4,{}),PT=SK,g4=PT;(BL.exports=function(t,e){return g4[t]||(g4[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.26.0",mode:"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.26.0/LICENSE",source:"https://github.com/zloirock/core-js"});var vd=BL.exports,RK=Yn,EK=Object,Kn=function(t){return EK(RK(t))},CK=rt,OK=Kn,TK=CK({}.hasOwnProperty),fr=Object.hasOwn||function(e,r){return TK(OK(e),r)},_K=rt,AK=0,IK=Math.random(),NK=_K(1 .toString),R2=function(t){return"Symbol("+(t===void 0?"":t)+")_"+NK(++AK+IK,36)},PK=Vt,MK=vd,y4=fr,kK=R2,b4=dd,VL=HL,ju=MK("wks"),nu=PK.Symbol,w4=nu&&nu.for,xK=VL?nu:nu&&nu.withoutSetter||kK,qt=function(t){if(!y4(ju,t)||!(b4||typeof ju[t]=="string")){var e="Symbol."+t;b4&&y4(nu,t)?ju[t]=nu[t]:VL&&w4?ju[t]=w4(e):ju[t]=xK(e)}return ju[t]},$K=Lr,S4=Sr,R4=gg,LK=Nu,DK=UL,FK=qt,HK=TypeError,UK=FK("toPrimitive"),jL=function(t,e){if(!S4(t)||R4(t))return t;var r=LK(t,UK),n;if(r){if(e===void 0&&(e="default"),n=$K(r,t,e),!S4(n)||R4(n))return n;throw HK("Can't convert object to primitive value")}return e===void 0&&(e="number"),DK(t,e)},BK=jL,VK=gg,E2=function(t){var e=BK(t,"string");return VK(e)?e:e+""},jK=Vt,E4=Sr,qR=jK.document,WK=E4(qR)&&E4(qR.createElement),C2=function(t){return WK?qR.createElement(t):{}},GK=Nr,zK=nt,YK=C2,WL=!GK&&!zK(function(){return Object.defineProperty(YK("div"),"a",{get:function(){return 7}}).a!=7}),KK=Nr,XK=Lr,qK=dg,QK=pg,ZK=hi,JK=E2,eX=fr,tX=WL,C4=Object.getOwnPropertyDescriptor;Ho.f=KK?C4:function(e,r){if(e=ZK(e),r=JK(r),tX)try{return C4(e,r)}catch{}if(eX(e,r))return QK(!XK(qK.f,e,r),e[r])};var Jr={},rX=Nr,nX=nt,GL=rX&&nX(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),iX=Sr,oX=String,aX=TypeError,Rr=function(t){if(iX(t))return t;throw aX(oX(t)+" is not an object")},sX=Nr,lX=WL,uX=GL,uy=Rr,O4=E2,cX=TypeError,nS=Object.defineProperty,fX=Object.getOwnPropertyDescriptor,iS="enumerable",oS="configurable",aS="writable";Jr.f=sX?uX?function(e,r,n){if(uy(e),r=O4(r),uy(n),typeof e=="function"&&r==="prototype"&&"value"in n&&aS in n&&!n[aS]){var i=fX(e,r);i&&i[aS]&&(e[r]=n.value,n={configurable:oS in n?n[oS]:i[oS],enumerable:iS in n?n[iS]:i[iS],writable:!1})}return nS(e,r,n)}:nS:function(e,r,n){if(uy(e),r=O4(r),uy(n),lX)try{return nS(e,r,n)}catch{}if("get"in n||"set"in n)throw cX("Accessors not supported");return"value"in n&&(e[r]=n.value),e};var hX=Nr,dX=Jr,pX=pg,Pu=hX?function(t,e,r){return dX.f(t,e,pX(1,r))}:function(t,e,r){return t[e]=r,t},zL={exports:{}},QR=Nr,mX=fr,YL=Function.prototype,vX=QR&&Object.getOwnPropertyDescriptor,MT=mX(YL,"name"),gX=MT&&(function(){}).name==="something",yX=MT&&(!QR||QR&&vX(YL,"name").configurable),yg={EXISTS:MT,PROPER:gX,CONFIGURABLE:yX},bX=rt,wX=ir,ZR=PT,SX=bX(Function.toString);wX(ZR.inspectSource)||(ZR.inspectSource=function(t){return SX(t)});var KL=ZR.inspectSource,RX=Vt,EX=ir,T4=RX.WeakMap,XL=EX(T4)&&/native code/.test(String(T4)),CX=vd,OX=R2,_4=CX("keys"),O2=function(t){return _4[t]||(_4[t]=OX(t))},bg={},TX=XL,qL=Vt,_X=Sr,AX=Pu,sS=fr,lS=PT,IX=O2,NX=bg,A4="Object already initialized",JR=qL.TypeError,PX=qL.WeakMap,x0,Kp,$0,MX=function(t){return $0(t)?Kp(t):x0(t,{})},kX=function(t){return function(e){var r;if(!_X(e)||(r=Kp(e)).type!==t)throw JR("Incompatible receiver, "+t+" required");return r}};if(TX||lS.state){var ao=lS.state||(lS.state=new PX);ao.get=ao.get,ao.has=ao.has,ao.set=ao.set,x0=function(t,e){if(ao.has(t))throw JR(A4);return e.facade=t,ao.set(t,e),e},Kp=function(t){return ao.get(t)||{}},$0=function(t){return ao.has(t)}}else{var Wu=IX("state");NX[Wu]=!0,x0=function(t,e){if(sS(t,Wu))throw JR(A4);return e.facade=t,AX(t,Wu,e),e},Kp=function(t){return sS(t,Wu)?t[Wu]:{}},$0=function(t){return sS(t,Wu)}}var Ya={set:x0,get:Kp,has:$0,enforce:MX,getterFor:kX},xX=nt,$X=ir,cy=fr,eE=Nr,LX=yg.CONFIGURABLE,DX=KL,QL=Ya,FX=QL.enforce,HX=QL.get,x1=Object.defineProperty,UX=eE&&!xX(function(){return x1(function(){},"length",{value:8}).length!==8}),BX=String(String).split("String"),VX=zL.exports=function(t,e,r){String(e).slice(0,7)==="Symbol("&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!cy(t,"name")||LX&&t.name!==e)&&(eE?x1(t,"name",{value:e,configurable:!0}):t.name=e),UX&&r&&cy(r,"arity")&&t.length!==r.arity&&x1(t,"length",{value:r.arity});try{r&&cy(r,"constructor")&&r.constructor?eE&&x1(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var n=FX(t);return cy(n,"source")||(n.source=BX.join(typeof e=="string"?e:"")),t};Function.prototype.toString=VX(function(){return $X(this)&&HX(this).source||DX(this)},"toString");var jX=zL.exports,WX=ir,GX=Jr,zX=jX,YX=NT,di=function(t,e,r,n){n||(n={});var i=n.enumerable,o=n.name!==void 0?n.name:e;if(WX(r)&&zX(r,o,n),n.global)i?t[e]=r:YX(e,r);else{try{n.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=r:GX.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},Mu={},KX=Math.ceil,XX=Math.floor,qX=Math.trunc||function(e){var r=+e;return(r>0?XX:KX)(r)},QX=qX,Ks=function(t){var e=+t;return e!==e||e===0?0:QX(e)},ZX=Ks,JX=Math.max,eq=Math.min,wg=function(t,e){var r=ZX(t);return r<0?JX(r+e,0):eq(r,e)},tq=Ks,rq=Math.min,ku=function(t){return t>0?rq(tq(t),9007199254740991):0},nq=ku,Mi=function(t){return nq(t.length)},iq=hi,oq=wg,aq=Mi,I4=function(t){return function(e,r,n){var i=iq(e),o=aq(i),a=oq(n,o),s;if(t&&r!=r){for(;o>a;)if(s=i[a++],s!=s)return!0}else for(;o>a;a++)if((t||a in i)&&i[a]===r)return t||a||0;return!t&&-1}},kT={includes:I4(!0),indexOf:I4(!1)},sq=rt,uS=fr,lq=hi,uq=kT.indexOf,cq=bg,N4=sq([].push),ZL=function(t,e){var r=lq(t),n=0,i=[],o;for(o in r)!uS(cq,o)&&uS(r,o)&&N4(i,o);for(;e.length>n;)uS(r,o=e[n++])&&(~uq(i,o)||N4(i,o));return i},xT=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],fq=ZL,hq=xT,dq=hq.concat("length","prototype");Mu.f=Object.getOwnPropertyNames||function(e){return fq(e,dq)};var Sg={};Sg.f=Object.getOwnPropertySymbols;var pq=Uo,mq=rt,vq=Mu,gq=Sg,yq=Rr,bq=mq([].concat),JL=pq("Reflect","ownKeys")||function(e){var r=vq.f(yq(e)),n=gq.f;return n?bq(r,n(e)):r},P4=fr,wq=JL,Sq=Ho,Rq=Jr,eD=function(t,e,r){for(var n=wq(e),i=Rq.f,o=Sq.f,a=0;a<n.length;a++){var s=n[a];!P4(t,s)&&!(r&&P4(r,s))&&i(t,s,o(e,s))}},Eq=nt,Cq=ir,Oq=/#|\.prototype\./,Rg=function(t,e){var r=_q[Tq(t)];return r==Iq?!0:r==Aq?!1:Cq(e)?Eq(e):!!e},Tq=Rg.normalize=function(t){return String(t).replace(Oq,".").toLowerCase()},_q=Rg.data={},Aq=Rg.NATIVE="N",Iq=Rg.POLYFILL="P",T2=Rg,cS=Vt,Nq=Ho.f,Pq=Pu,Mq=di,kq=NT,xq=eD,$q=T2,Ye=function(t,e){var r=t.target,n=t.global,i=t.stat,o,a,s,l,u,c;if(n?a=cS:i?a=cS[r]||kq(r,{}):a=(cS[r]||{}).prototype,a)for(s in e){if(u=e[s],t.dontCallGetSet?(c=Nq(a,s),l=c&&c.value):l=a[s],o=$q(n?s:r+(i?".":"#")+s,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;xq(u,l)}(t.sham||l&&l.sham)&&Pq(u,"sham",!0),Mq(a,s,u,t)}},Lq=qt,Dq=Lq("toStringTag"),tD={};tD[Dq]="z";var $T=String(tD)==="[object z]",Fq=$T,Hq=ir,$1=za,Uq=qt,Bq=Uq("toStringTag"),Vq=Object,jq=$1(function(){return arguments}())=="Arguments",Wq=function(t,e){try{return t[e]}catch{}},_2=Fq?$1:function(t){var e,r,n;return t===void 0?"Undefined":t===null?"Null":typeof(r=Wq(e=Vq(t),Bq))=="string"?r:jq?$1(e):(n=$1(e))=="Object"&&Hq(e.callee)?"Arguments":n},Gq=_2,zq=String,Dr=function(t){if(Gq(t)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return zq(t)},LT={},Yq=ZL,Kq=xT,Eg=Object.keys||function(e){return Yq(e,Kq)},Xq=Nr,qq=GL,Qq=Jr,Zq=Rr,Jq=hi,eQ=Eg;LT.f=Xq&&!qq?Object.defineProperties:function(e,r){Zq(e);for(var n=Jq(r),i=eQ(r),o=i.length,a=0,s;o>a;)Qq.f(e,s=i[a++],n[s]);return e};var tQ=Uo,rD=tQ("document","documentElement"),rQ=Rr,nQ=LT,M4=xT,iQ=bg,oQ=rD,aQ=C2,sQ=O2,k4=">",x4="<",tE="prototype",rE="script",nD=sQ("IE_PROTO"),fS=function(){},iD=function(t){return x4+rE+k4+t+x4+"/"+rE+k4},$4=function(t){t.write(iD("")),t.close();var e=t.parentWindow.Object;return t=null,e},lQ=function(){var t=aQ("iframe"),e="java"+rE+":",r;return t.style.display="none",oQ.appendChild(t),t.src=String(e),r=t.contentWindow.document,r.open(),r.write(iD("document.F=Object")),r.close(),r.F},fy,L1=function(){try{fy=new ActiveXObject("htmlfile")}catch{}L1=typeof document<"u"?document.domain&&fy?$4(fy):lQ():$4(fy);for(var t=M4.length;t--;)delete L1[tE][M4[t]];return L1()};iQ[nD]=!0;var gd=Object.create||function(e,r){var n;return e!==null?(fS[tE]=rQ(e),n=new fS,fS[tE]=null,n[nD]=e):n=L1(),r===void 0?n:nQ.f(n,r)},DT={},uQ=E2,cQ=Jr,fQ=pg,yd=function(t,e,r){var n=uQ(e);n in t?cQ.f(t,n,fQ(0,r)):t[n]=r},L4=wg,hQ=Mi,dQ=yd,pQ=Array,mQ=Math.max,FT=function(t,e,r){for(var n=hQ(t),i=L4(e,n),o=L4(r===void 0?n:r,n),a=pQ(mQ(o-i,0)),s=0;i<o;i++,s++)dQ(a,s,t[i]);return a.length=s,a},vQ=za,gQ=hi,oD=Mu.f,yQ=FT,aD=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],bQ=function(t){try{return oD(t)}catch{return yQ(aD)}};DT.f=function(e){return aD&&vQ(e)=="Window"?bQ(e):oD(gQ(e))};var HT={},wQ=qt;HT.f=wQ;var SQ=Vt,RQ=SQ,D4=RQ,EQ=fr,CQ=HT,OQ=Jr.f,UT=function(t){var e=D4.Symbol||(D4.Symbol={});EQ(e,t)||OQ(e,t,{value:CQ.f(t)})},TQ=Lr,_Q=Uo,AQ=qt,IQ=di,sD=function(){var t=_Q("Symbol"),e=t&&t.prototype,r=e&&e.valueOf,n=AQ("toPrimitive");e&&!e[n]&&IQ(e,n,function(i){return TQ(r,this)},{arity:1})},NQ=Jr.f,PQ=fr,MQ=qt,F4=MQ("toStringTag"),A2=function(t,e,r){t&&!r&&(t=t.prototype),t&&!PQ(t,F4)&&NQ(t,F4,{configurable:!0,value:e})},H4=rt,kQ=md,xQ=hg,$Q=H4(H4.bind),Cg=function(t,e){return kQ(t),e===void 0?t:xQ?$Q(t,e):function(){return t.apply(e,arguments)}},LQ=za,bd=Array.isArray||function(e){return LQ(e)=="Array"},DQ=rt,FQ=nt,lD=ir,HQ=_2,UQ=Uo,BQ=KL,uD=function(){},VQ=[],cD=UQ("Reflect","construct"),BT=/^\s*(?:class|function)\b/,jQ=DQ(BT.exec),WQ=!BT.exec(uD),kd=function(e){if(!lD(e))return!1;try{return cD(uD,VQ,e),!0}catch{return!1}},fD=function(e){if(!lD(e))return!1;switch(HQ(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return WQ||!!jQ(BT,BQ(e))}catch{return!0}};fD.sham=!0;var I2=!cD||FQ(function(){var t;return kd(kd.call)||!kd(Object)||!kd(function(){t=!0})||t})?fD:kd,U4=bd,GQ=I2,zQ=Sr,YQ=qt,KQ=YQ("species"),B4=Array,XQ=function(t){var e;return U4(t)&&(e=t.constructor,GQ(e)&&(e===B4||U4(e.prototype))?e=void 0:zQ(e)&&(e=e[KQ],e===null&&(e=void 0))),e===void 0?B4:e},qQ=XQ,VT=function(t,e){return new(qQ(t))(e===0?0:e)},QQ=Cg,ZQ=rt,JQ=mg,eZ=Kn,tZ=Mi,rZ=VT,V4=ZQ([].push),Ja=function(t){var e=t==1,r=t==2,n=t==3,i=t==4,o=t==6,a=t==7,s=t==5||o;return function(l,u,c,f){for(var h=eZ(l),d=JQ(h),p=QQ(u,c),m=tZ(d),y=0,S=f||rZ,R=e?S(l,m):r||a?S(l,0):void 0,E,O;m>y;y++)if((s||y in d)&&(E=d[y],O=p(E,y,h),t))if(e)R[y]=O;else if(O)switch(t){case 3:return!0;case 5:return E;case 6:return y;case 2:V4(R,E)}else switch(t){case 4:return!1;case 7:V4(R,E)}return o?-1:n||i?i:R}},xu={forEach:Ja(0),map:Ja(1),filter:Ja(2),some:Ja(3),every:Ja(4),find:Ja(5),findIndex:Ja(6),filterReject:Ja(7)},N2=Ye,jT=Vt,WT=Lr,nZ=rt,lf=Nr,uf=dd,iZ=nt,Kr=fr,oZ=Ys,nE=Rr,P2=hi,GT=E2,aZ=Dr,iE=pg,Xp=gd,hD=Eg,sZ=Mu,dD=DT,lZ=Sg,pD=Ho,mD=Jr,uZ=LT,vD=dg,hS=di,zT=vd,cZ=O2,gD=bg,j4=R2,fZ=qt,hZ=HT,dZ=UT,pZ=sD,mZ=A2,yD=Ya,M2=xu.forEach,$n=cZ("hidden"),k2="Symbol",qp="prototype",vZ=yD.set,W4=yD.getterFor(k2),Ci=Object[qp],iu=jT.Symbol,hp=iu&&iu[qp],gZ=jT.TypeError,dS=jT.QObject,bD=pD.f,vs=mD.f,wD=dD.f,yZ=vD.f,SD=nZ([].push),Ua=zT("symbols"),Og=zT("op-symbols"),bZ=zT("wks"),oE=!dS||!dS[qp]||!dS[qp].findChild,aE=lf&&iZ(function(){return Xp(vs({},"a",{get:function(){return vs(this,"a",{value:7}).a}})).a!=7})?function(t,e,r){var n=bD(Ci,e);n&&delete Ci[e],vs(t,e,r),n&&t!==Ci&&vs(Ci,e,n)}:vs,pS=function(t,e){var r=Ua[t]=Xp(hp);return vZ(r,{type:k2,tag:t,description:e}),lf||(r.description=e),r},x2=function(e,r,n){e===Ci&&x2(Og,r,n),nE(e);var i=GT(r);return nE(n),Kr(Ua,i)?(n.enumerable?(Kr(e,$n)&&e[$n][i]&&(e[$n][i]=!1),n=Xp(n,{enumerable:iE(0,!1)})):(Kr(e,$n)||vs(e,$n,iE(1,{})),e[$n][i]=!0),aE(e,i,n)):vs(e,i,n)},YT=function(e,r){nE(e);var n=P2(r),i=hD(n).concat(CD(n));return M2(i,function(o){(!lf||WT(sE,n,o))&&x2(e,o,n[o])}),e},wZ=function(e,r){return r===void 0?Xp(e):YT(Xp(e),r)},sE=function(e){var r=GT(e),n=WT(yZ,this,r);return this===Ci&&Kr(Ua,r)&&!Kr(Og,r)?!1:n||!Kr(this,r)||!Kr(Ua,r)||Kr(this,$n)&&this[$n][r]?n:!0},RD=function(e,r){var n=P2(e),i=GT(r);if(!(n===Ci&&Kr(Ua,i)&&!Kr(Og,i))){var o=bD(n,i);return o&&Kr(Ua,i)&&!(Kr(n,$n)&&n[$n][i])&&(o.enumerable=!0),o}},ED=function(e){var r=wD(P2(e)),n=[];return M2(r,function(i){!Kr(Ua,i)&&!Kr(gD,i)&&SD(n,i)}),n},CD=function(t){var e=t===Ci,r=wD(e?Og:P2(t)),n=[];return M2(r,function(i){Kr(Ua,i)&&(!e||Kr(Ci,i))&&SD(n,Ua[i])}),n};uf||(iu=function(){if(oZ(hp,this))throw gZ("Symbol is not a constructor");var e=!arguments.length||arguments[0]===void 0?void 0:aZ(arguments[0]),r=j4(e),n=function(i){this===Ci&&WT(n,Og,i),Kr(this,$n)&&Kr(this[$n],r)&&(this[$n][r]=!1),aE(this,r,iE(1,i))};return lf&&oE&&aE(Ci,r,{configurable:!0,set:n}),pS(r,e)},hp=iu[qp],hS(hp,"toString",function(){return W4(this).tag}),hS(iu,"withoutSetter",function(t){return pS(j4(t),t)}),vD.f=sE,mD.f=x2,uZ.f=YT,pD.f=RD,sZ.f=dD.f=ED,lZ.f=CD,hZ.f=function(t){return pS(fZ(t),t)},lf&&(vs(hp,"description",{configurable:!0,get:function(){return W4(this).description}}),hS(Ci,"propertyIsEnumerable",sE,{unsafe:!0})));N2({global:!0,constructor:!0,wrap:!0,forced:!uf,sham:!uf},{Symbol:iu});M2(hD(bZ),function(t){dZ(t)});N2({target:k2,stat:!0,forced:!uf},{useSetter:function(){oE=!0},useSimple:function(){oE=!1}});N2({target:"Object",stat:!0,forced:!uf,sham:!lf},{create:wZ,defineProperty:x2,defineProperties:YT,getOwnPropertyDescriptor:RD});N2({target:"Object",stat:!0,forced:!uf},{getOwnPropertyNames:ED});pZ();mZ(iu,k2);gD[$n]=!0;var SZ=dd,OD=SZ&&!!Symbol.for&&!!Symbol.keyFor,RZ=Ye,EZ=Uo,CZ=fr,OZ=Dr,TD=vd,TZ=OD,mS=TD("string-to-symbol-registry"),_Z=TD("symbol-to-string-registry");RZ({target:"Symbol",stat:!0,forced:!TZ},{for:function(t){var e=OZ(t);if(CZ(mS,e))return mS[e];var r=EZ("Symbol")(e);return mS[e]=r,_Z[r]=e,r}});var AZ=Ye,IZ=fr,NZ=gg,PZ=pd,MZ=vd,kZ=OD,G4=MZ("symbol-to-string-registry");AZ({target:"Symbol",stat:!0,forced:!kZ},{keyFor:function(e){if(!NZ(e))throw TypeError(PZ(e)+" is not a symbol");if(IZ(G4,e))return G4[e]}});var xZ=hg,_D=Function.prototype,z4=_D.apply,Y4=_D.call,$u=typeof Reflect=="object"&&Reflect.apply||(xZ?Y4.bind(z4):function(){return Y4.apply(z4,arguments)}),$Z=rt,Tg=$Z([].slice),LZ=Ye,AD=Uo,ID=$u,DZ=Lr,_g=rt,ND=nt,FZ=bd,HZ=ir,UZ=Sr,K4=gg,PD=Tg,BZ=dd,_s=AD("JSON","stringify"),hy=_g(/./.exec),X4=_g("".charAt),VZ=_g("".charCodeAt),jZ=_g("".replace),WZ=_g(1 .toString),GZ=/[\uD800-\uDFFF]/g,q4=/^[\uD800-\uDBFF]$/,Q4=/^[\uDC00-\uDFFF]$/,Z4=!BZ||ND(function(){var t=AD("Symbol")();return _s([t])!="[null]"||_s({a:t})!="{}"||_s(Object(t))!="{}"}),J4=ND(function(){return _s("\uDF06\uD834")!=='"\\udf06\\ud834"'||_s("\uDEAD")!=='"\\udead"'}),zZ=function(t,e){var r=PD(arguments),n=e;if(!(!UZ(e)&&t===void 0||K4(t)))return FZ(e)||(e=function(i,o){if(HZ(n)&&(o=DZ(n,this,i,o)),!K4(o))return o}),r[1]=e,ID(_s,null,r)},YZ=function(t,e,r){var n=X4(r,e-1),i=X4(r,e+1);return hy(q4,t)&&!hy(Q4,i)||hy(Q4,t)&&!hy(q4,n)?"\\u"+WZ(VZ(t,0),16):t};_s&&LZ({target:"JSON",stat:!0,arity:3,forced:Z4||J4},{stringify:function(e,r,n){var i=PD(arguments),o=ID(Z4?zZ:_s,null,i);return J4&&typeof o=="string"?jZ(o,GZ,YZ):o}});var KZ=Ye,XZ=dd,qZ=nt,MD=Sg,QZ=Kn,ZZ=!XZ||qZ(function(){MD.f(1)});KZ({target:"Object",stat:!0,forced:ZZ},{getOwnPropertySymbols:function(e){var r=MD.f;return r?r(QZ(e)):[]}});var JZ=Ye,eJ=Nr,tJ=Vt,dy=rt,rJ=fr,nJ=ir,iJ=Ys,oJ=Dr,aJ=Jr.f,sJ=eD,ia=tJ.Symbol,rl=ia&&ia.prototype;if(eJ&&nJ(ia)&&(!("description"in rl)||ia().description!==void 0)){var eN={},py=function(){var e=arguments.length<1||arguments[0]===void 0?void 0:oJ(arguments[0]),r=iJ(rl,this)?new ia(e):e===void 0?ia():ia(e);return e===""&&(eN[r]=!0),r};sJ(py,ia),py.prototype=rl,rl.constructor=py;var lJ=String(ia("test"))=="Symbol(test)",uJ=dy(rl.valueOf),cJ=dy(rl.toString),fJ=/^Symbol\((.*)\)[^)]+$/,hJ=dy("".replace),dJ=dy("".slice);aJ(rl,"description",{configurable:!0,get:function(){var e=uJ(this);if(rJ(eN,e))return"";var r=cJ(e),n=lJ?dJ(r,7,-1):hJ(r,fJ,"$1");return n===""?void 0:n}}),JZ({global:!0,constructor:!0,forced:!0},{Symbol:py})}var pJ=UT;pJ("iterator");var mJ=Nr,vJ=yg.EXISTS,kD=rt,gJ=Jr.f,xD=Function.prototype,yJ=kD(xD.toString),$D=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,bJ=kD($D.exec),wJ="name";mJ&&!vJ&&gJ(xD,wJ,{configurable:!0,get:function(){try{return bJ($D,yJ(this))[1]}catch{return""}}});var SJ=nt,LD=!SJ(function(){return Object.isExtensible(Object.preventExtensions({}))}),DD={exports:{}},RJ=nt,EJ=RJ(function(){if(typeof ArrayBuffer=="function"){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}),CJ=nt,OJ=Sr,TJ=za,tN=EJ,D1=Object.isExtensible,_J=CJ(function(){D1(1)}),FD=_J||tN?function(e){return!OJ(e)||tN&&TJ(e)=="ArrayBuffer"?!1:D1?D1(e):!0}:D1,AJ=Ye,IJ=rt,NJ=bg,PJ=Sr,KT=fr,MJ=Jr.f,rN=Mu,kJ=DT,XT=FD,xJ=R2,$J=LD,HD=!1,Ba=xJ("meta"),LJ=0,qT=function(t){MJ(t,Ba,{value:{objectID:"O"+LJ++,weakData:{}}})},DJ=function(t,e){if(!PJ(t))return typeof t=="symbol"?t:(typeof t=="string"?"S":"P")+t;if(!KT(t,Ba)){if(!XT(t))return"F";if(!e)return"E";qT(t)}return t[Ba].objectID},FJ=function(t,e){if(!KT(t,Ba)){if(!XT(t))return!0;if(!e)return!1;qT(t)}return t[Ba].weakData},HJ=function(t){return $J&&HD&&XT(t)&&!KT(t,Ba)&&qT(t),t},UJ=function(){BJ.enable=function(){},HD=!0;var t=rN.f,e=IJ([].splice),r={};r[Ba]=1,t(r).length&&(rN.f=function(n){for(var i=t(n),o=0,a=i.length;o<a;o++)if(i[o]===Ba){e(i,o,1);break}return i},AJ({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:kJ.f}))},BJ=DD.exports={enable:UJ,fastKey:DJ,getWeakData:FJ,onFreeze:HJ};NJ[Ba]=!0;var Ag=DD.exports,VJ=Ye,jJ=LD,WJ=nt,GJ=Sr,zJ=Ag.onFreeze,lE=Object.freeze,YJ=WJ(function(){lE(1)});VJ({target:"Object",stat:!0,forced:YJ,sham:!jJ},{freeze:function(e){return lE&&GJ(e)?lE(zJ(e)):e}});var KJ=qt,XJ=gd,qJ=Jr.f,uE=KJ("unscopables"),cE=Array.prototype;cE[uE]==null&&qJ(cE,uE,{configurable:!0,value:XJ(null)});var Ig=function(t){cE[uE][t]=!0},Ng={},QJ=nt,UD=!QJ(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),ZJ=fr,JJ=ir,eee=Kn,tee=O2,ree=UD,nN=tee("IE_PROTO"),fE=Object,nee=fE.prototype,$2=ree?fE.getPrototypeOf:function(t){var e=eee(t);if(ZJ(e,nN))return e[nN];var r=e.constructor;return JJ(r)&&e instanceof r?r.prototype:e instanceof fE?nee:null},iee=nt,oee=ir,aee=Sr,iN=$2,see=di,lee=qt,hE=lee("iterator"),BD=!1,fu,vS,gS;[].keys&&(gS=[].keys(),"next"in gS?(vS=iN(iN(gS)),vS!==Object.prototype&&(fu=vS)):BD=!0);var uee=!aee(fu)||iee(function(){var t={};return fu[hE].call(t)!==t});uee&&(fu={});oee(fu[hE])||see(fu,hE,function(){return this});var VD={IteratorPrototype:fu,BUGGY_SAFARI_ITERATORS:BD},cee=VD.IteratorPrototype,fee=gd,hee=pg,dee=A2,pee=Ng,mee=function(){return this},vee=function(t,e,r,n){var i=e+" Iterator";return t.prototype=fee(cee,{next:hee(+!n,r)}),dee(t,i,!1),pee[i]=mee,t},gee=ir,yee=String,bee=TypeError,wee=function(t){if(typeof t=="object"||gee(t))return t;throw bee("Can't set "+yee(t)+" as a prototype")},See=rt,Ree=Rr,Eee=wee,QT=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},r;try{r=See(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),r(e,[]),t=e instanceof Array}catch{}return function(i,o){return Ree(i),Eee(o),t?r(i,o):i.__proto__=o,i}}():void 0),Cee=Ye,Oee=Lr,jD=yg,Tee=ir,_ee=vee,oN=$2,aN=QT,Aee=A2,Iee=Pu,yS=di,Nee=qt,Pee=Ng,WD=VD,Mee=jD.PROPER,kee=jD.CONFIGURABLE,sN=WD.IteratorPrototype,my=WD.BUGGY_SAFARI_ITERATORS,xd=Nee("iterator"),lN="keys",$d="values",uN="entries",xee=function(){return this},ZT=function(t,e,r,n,i,o,a){_ee(r,e,n);var s=function(S){if(S===i&&h)return h;if(!my&&S in c)return c[S];switch(S){case lN:return function(){return new r(this,S)};case $d:return function(){return new r(this,S)};case uN:return function(){return new r(this,S)}}return function(){return new r(this)}},l=e+" Iterator",u=!1,c=t.prototype,f=c[xd]||c["@@iterator"]||i&&c[i],h=!my&&f||s(i),d=e=="Array"&&c.entries||f,p,m,y;if(d&&(p=oN(d.call(new t)),p!==Object.prototype&&p.next&&(oN(p)!==sN&&(aN?aN(p,sN):Tee(p[xd])||yS(p,xd,xee)),Aee(p,l,!0))),Mee&&i==$d&&f&&f.name!==$d&&(kee?Iee(c,"name",$d):(u=!0,h=function(){return Oee(f,this)})),i)if(m={values:s($d),keys:o?h:s(lN),entries:s(uN)},a)for(y in m)(my||u||!(y in c))&&yS(c,y,m[y]);else Cee({target:e,proto:!0,forced:my||u},m);return c[xd]!==h&&yS(c,xd,h,{name:i}),Pee[e]=h,m},JT=function(t,e){return{value:t,done:e}},$ee=hi,e_=Ig,cN=Ng,GD=Ya,Lee=Jr.f,Dee=ZT,vy=JT,Fee=Nr,zD="Array Iterator",Hee=GD.set,Uee=GD.getterFor(zD),Bee=Dee(Array,"Array",function(t,e){Hee(this,{type:zD,target:$ee(t),index:0,kind:e})},function(){var t=Uee(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,vy(void 0,!0)):r=="keys"?vy(n,!1):r=="values"?vy(e[n],!1):vy([n,e[n]],!1)},"values"),fN=cN.Arguments=cN.Array;e_("keys");e_("values");e_("entries");if(Fee&&fN.name!=="values")try{Lee(fN,"name",{value:"values"})}catch{}var Vee=$T,jee=_2,Wee=Vee?{}.toString:function(){return"[object "+jee(this)+"]"},Gee=$T,zee=di,Yee=Wee;Gee||zee(Object.prototype,"toString",Yee,{unsafe:!0});var Kee=qt,Xee=Ng,qee=Kee("iterator"),Qee=Array.prototype,YD=function(t){return t!==void 0&&(Xee.Array===t||Qee[qee]===t)},Zee=_2,hN=Nu,Jee=ro,ete=Ng,tte=qt,rte=tte("iterator"),t_=function(t){if(!Jee(t))return hN(t,rte)||hN(t,"@@iterator")||ete[Zee(t)]},nte=Lr,ite=md,ote=Rr,ate=pd,ste=t_,lte=TypeError,KD=function(t,e){var r=arguments.length<2?ste(t):e;if(ite(r))return ote(nte(r,t));throw lte(ate(t)+" is not iterable")},ute=Lr,dN=Rr,cte=Nu,XD=function(t,e,r){var n,i;dN(t);try{if(n=cte(t,"return"),!n){if(e==="throw")throw r;return r}n=ute(n,t)}catch(o){i=!0,n=o}if(e==="throw")throw r;if(i)throw n;return dN(n),r},fte=Cg,hte=Lr,dte=Rr,pte=pd,mte=YD,vte=Mi,pN=Ys,gte=KD,yte=t_,mN=XD,bte=TypeError,F1=function(t,e){this.stopped=t,this.result=e},vN=F1.prototype,r_=function(t,e,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),o=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),s=!!(r&&r.INTERRUPTED),l=fte(e,n),u,c,f,h,d,p,m,y=function(R){return u&&mN(u,"normal",R),new F1(!0,R)},S=function(R){return i?(dte(R),s?l(R[0],R[1],y):l(R[0],R[1])):s?l(R,y):l(R)};if(o)u=t.iterator;else if(a)u=t;else{if(c=yte(t),!c)throw bte(pte(t)+" is not iterable");if(mte(c)){for(f=0,h=vte(t);h>f;f++)if(d=S(t[f]),d&&pN(vN,d))return d;return new F1(!1)}u=gte(t,c)}for(p=o?t.next:u.next;!(m=hte(p,u)).done;){try{d=S(m.value)}catch(R){mN(u,"throw",R)}if(typeof d=="object"&&d&&pN(vN,d))return d}return new F1(!1)},wte=Ys,Ste=TypeError,n_=function(t,e){if(wte(e,t))return t;throw Ste("Incorrect invocation")},Rte=qt,qD=Rte("iterator"),QD=!1;try{var Ete=0,gN={next:function(){return{done:!!Ete++}},return:function(){QD=!0}};gN[qD]=function(){return this},Array.from(gN,function(){throw 2})}catch{}var ZD=function(t,e){if(!e&&!QD)return!1;var r=!1;try{var n={};n[qD]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch{}return r},Cte=ir,Ote=Sr,yN=QT,i_=function(t,e,r){var n,i;return yN&&Cte(n=e.constructor)&&n!==r&&Ote(i=n.prototype)&&i!==r.prototype&&yN(t,i),t},Tte=Ye,_te=Vt,Ate=rt,bN=T2,Ite=di,Nte=Ag,Pte=r_,Mte=n_,kte=ir,xte=ro,bS=Sr,wS=nt,$te=ZD,Lte=A2,Dte=i_,L2=function(t,e,r){var n=t.indexOf("Map")!==-1,i=t.indexOf("Weak")!==-1,o=n?"set":"add",a=_te[t],s=a&&a.prototype,l=a,u={},c=function(S){var R=Ate(s[S]);Ite(s,S,S=="add"?function(O){return R(this,O===0?0:O),this}:S=="delete"?function(E){return i&&!bS(E)?!1:R(this,E===0?0:E)}:S=="get"?function(O){return i&&!bS(O)?void 0:R(this,O===0?0:O)}:S=="has"?function(O){return i&&!bS(O)?!1:R(this,O===0?0:O)}:function(O,A){return R(this,O===0?0:O,A),this})},f=bN(t,!kte(a)||!(i||s.forEach&&!wS(function(){new a().entries().next()})));if(f)l=r.getConstructor(e,t,n,o),Nte.enable();else if(bN(t,!0)){var h=new l,d=h[o](i?{}:-0,1)!=h,p=wS(function(){h.has(1)}),m=$te(function(S){new a(S)}),y=!i&&wS(function(){for(var S=new a,R=5;R--;)S[o](R,R);return!S.has(-0)});m||(l=e(function(S,R){Mte(S,s);var E=Dte(new a,S,l);return xte(R)||Pte(R,E[o],{that:E,AS_ENTRIES:n}),E}),l.prototype=s,s.constructor=l),(p||y)&&(c("delete"),c("has"),n&&c("get")),(y||d)&&c(o),i&&s.clear&&delete s.clear}return u[t]=l,Tte({global:!0,constructor:!0,forced:l!=a},u),Lte(l,t),i||r.setStrong(l,t,n),l},Fte=di,o_=function(t,e,r){for(var n in e)Fte(t,n,e[n],r);return t},Hte=Uo,Ute=Jr,Bte=qt,Vte=Nr,wN=Bte("species"),JD=function(t){var e=Hte(t),r=Ute.f;Vte&&e&&!e[wN]&&r(e,wN,{configurable:!0,get:function(){return this}})},jte=Jr.f,Wte=gd,SN=o_,Gte=Cg,zte=n_,Yte=ro,Kte=r_,Xte=ZT,gy=JT,qte=JD,Ld=Nr,RN=Ag.fastKey,eF=Ya,EN=eF.set,SS=eF.getterFor,tF={getConstructor:function(t,e,r,n){var i=t(function(u,c){zte(u,o),EN(u,{type:e,index:Wte(null),first:void 0,last:void 0,size:0}),Ld||(u.size=0),Yte(c)||Kte(c,u[n],{that:u,AS_ENTRIES:r})}),o=i.prototype,a=SS(e),s=function(u,c,f){var h=a(u),d=l(u,c),p,m;return d?d.value=f:(h.last=d={index:m=RN(c,!0),key:c,value:f,previous:p=h.last,next:void 0,removed:!1},h.first||(h.first=d),p&&(p.next=d),Ld?h.size++:u.size++,m!=="F"&&(h.index[m]=d)),u},l=function(u,c){var f=a(u),h=RN(c),d;if(h!=="F")return f.index[h];for(d=f.first;d;d=d.next)if(d.key==c)return d};return SN(o,{clear:function(){for(var c=this,f=a(c),h=f.index,d=f.first;d;)d.removed=!0,d.previous&&(d.previous=d.previous.next=void 0),delete h[d.index],d=d.next;f.first=f.last=void 0,Ld?f.size=0:c.size=0},delete:function(u){var c=this,f=a(c),h=l(c,u);if(h){var d=h.next,p=h.previous;delete f.index[h.index],h.removed=!0,p&&(p.next=d),d&&(d.previous=p),f.first==h&&(f.first=d),f.last==h&&(f.last=p),Ld?f.size--:c.size--}return!!h},forEach:function(c){for(var f=a(this),h=Gte(c,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:f.first;)for(h(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(c){return!!l(this,c)}}),SN(o,r?{get:function(c){var f=l(this,c);return f&&f.value},set:function(c,f){return s(this,c===0?0:c,f)}}:{add:function(c){return s(this,c=c===0?0:c,c)}}),Ld&&jte(o,"size",{get:function(){return a(this).size}}),i},setStrong:function(t,e,r){var n=e+" Iterator",i=SS(e),o=SS(n);Xte(t,e,function(a,s){EN(this,{type:n,target:a,state:i(a),kind:s,last:void 0})},function(){for(var a=o(this),s=a.kind,l=a.last;l&&l.removed;)l=l.previous;return!a.target||!(a.last=l=l?l.next:a.state.first)?(a.target=void 0,gy(void 0,!0)):s=="keys"?gy(l.key,!1):s=="values"?gy(l.value,!1):gy([l.key,l.value],!1)},r?"entries":"values",!r,!0),qte(e)}},Qte=L2,Zte=tF;Qte("Set",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Zte);var a_=rt,Jte=Ks,ere=Dr,tre=Yn,rre=a_("".charAt),CN=a_("".charCodeAt),nre=a_("".slice),ON=function(t){return function(e,r){var n=ere(tre(e)),i=Jte(r),o=n.length,a,s;return i<0||i>=o?t?"":void 0:(a=CN(n,i),a<55296||a>56319||i+1===o||(s=CN(n,i+1))<56320||s>57343?t?rre(n,i):a:t?nre(n,i,i+2):(a-55296<<10)+(s-56320)+65536)}},s_={codeAt:ON(!1),charAt:ON(!0)},ire=s_.charAt,ore=Dr,rF=Ya,are=ZT,TN=JT,nF="String Iterator",sre=rF.set,lre=rF.getterFor(nF);are(String,"String",function(t){sre(this,{type:nF,string:ore(t),index:0})},function(){var e=lre(this),r=e.string,n=e.index,i;return n>=r.length?TN(void 0,!0):(i=ire(r,n),e.index+=i.length,TN(i,!1))});var iF={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},ure=C2,RS=ure("span").classList,_N=RS&&RS.constructor&&RS.constructor.prototype,oF=_N===Object.prototype?void 0:_N,AN=Vt,aF=iF,cre=oF,dp=Bee,ES=Pu,sF=qt,CS=sF("iterator"),IN=sF("toStringTag"),OS=dp.values,lF=function(t,e){if(t){if(t[CS]!==OS)try{ES(t,CS,OS)}catch{t[CS]=OS}if(t[IN]||ES(t,IN,e),aF[e]){for(var r in dp)if(t[r]!==dp[r])try{ES(t,r,dp[r])}catch{t[r]=dp[r]}}}};for(var TS in aF)lF(AN[TS]&&AN[TS].prototype,TS);lF(cre,"DOMTokenList");var fre=Ye,hre=kT.includes,dre=nt,pre=Ig,mre=dre(function(){return!Array(1).includes()});fre({target:"Array",proto:!0,forced:mre},{includes:function(e){return hre(this,e,arguments.length>1?arguments[1]:void 0)}});pre("includes");var NN=pd,vre=TypeError,uF=function(t,e){if(!delete t[e])throw vre("Cannot delete property "+NN(e)+" of "+NN(t))},PN=FT,gre=Math.floor,dE=function(t,e){var r=t.length,n=gre(r/2);return r<8?yre(t,e):bre(t,dE(PN(t,0,n),e),dE(PN(t,n),e),e)},yre=function(t,e){for(var r=t.length,n=1,i,o;n<r;){for(o=n,i=t[n];o&&e(t[o-1],i)>0;)t[o]=t[--o];o!==n++&&(t[o]=i)}return t},bre=function(t,e,r,n){for(var i=e.length,o=r.length,a=0,s=0;a<i||s<o;)t[a+s]=a<i&&s<o?n(e[a],r[s])<=0?e[a++]:r[s++]:a<i?e[a++]:r[s++];return t},wre=dE,Sre=nt,wd=function(t,e){var r=[][t];return!!r&&Sre(function(){r.call(null,e||function(){return 1},1)})},Rre=Iu,MN=Rre.match(/firefox\/(\d+)/i),Ere=!!MN&&+MN[1],Cre=Iu,Ore=/MSIE|Trident/.test(Cre),Tre=Iu,kN=Tre.match(/AppleWebKit\/(\d+)\./),_re=!!kN&&+kN[1],Are=Ye,cF=rt,Ire=md,Nre=Kn,xN=Mi,Pre=uF,$N=Dr,l_=nt,Mre=wre,kre=wd,LN=Ere,xre=Ore,DN=vg,FN=_re,ws=[],HN=cF(ws.sort),$re=cF(ws.push),Lre=l_(function(){ws.sort(void 0)}),Dre=l_(function(){ws.sort(null)}),Fre=kre("sort"),fF=!l_(function(){if(DN)return DN<70;if(!(LN&&LN>3)){if(xre)return!0;if(FN)return FN<603;var t="",e,r,n,i;for(e=65;e<76;e++){switch(r=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)ws.push({k:r+i,v:n})}for(ws.sort(function(o,a){return a.v-o.v}),i=0;i<ws.length;i++)r=ws[i].k.charAt(0),t.charAt(t.length-1)!==r&&(t+=r);return t!=="DGBEFHACIJK"}}),Hre=Lre||!Dre||!Fre||!fF,Ure=function(t){return function(e,r){return r===void 0?-1:e===void 0?1:t!==void 0?+t(e,r)||0:$N(e)>$N(r)?1:-1}};Are({target:"Array",proto:!0,forced:Hre},{sort:function(e){e!==void 0&&Ire(e);var r=Nre(this);if(fF)return e===void 0?HN(r):HN(r,e);var n=[],i=xN(r),o,a;for(a=0;a<i;a++)a in r&&$re(n,r[a]);for(Mre(n,Ure(e)),o=xN(n),a=0;a<o;)r[a]=n[a++];for(;a<i;)Pre(r,a++);return r}});var Bre=Nr,Vre=bd,jre=TypeError,Wre=Object.getOwnPropertyDescriptor,Gre=Bre&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),zre=Gre?function(t,e){if(Vre(t)&&!Wre(t,"length").writable)throw jre("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},Yre=TypeError,Kre=9007199254740991,hF=function(t){if(t>Kre)throw Yre("Maximum allowed index exceeded");return t},Xre=nt,qre=qt,Qre=vg,Zre=qre("species"),Pg=function(t){return Qre>=51||!Xre(function(){var e=[],r=e.constructor={};return r[Zre]=function(){return{foo:1}},e[t](Boolean).foo!==1})},Jre=Ye,ene=Kn,tne=wg,rne=Ks,nne=Mi,ine=zre,one=hF,ane=VT,sne=yd,_S=uF,lne=Pg,une=lne("splice"),cne=Math.max,fne=Math.min;Jre({target:"Array",proto:!0,forced:!une},{splice:function(e,r){var n=ene(this),i=nne(n),o=tne(e,i),a=arguments.length,s,l,u,c,f,h;for(a===0?s=l=0:a===1?(s=0,l=i-o):(s=a-2,l=fne(cne(rne(r),0),i-o)),one(i+s-l),u=ane(n,l),c=0;c<l;c++)f=o+c,f in n&&sne(u,c,n[f]);if(u.length=l,s<l){for(c=o;c<i-l;c++)f=c+l,h=c+s,f in n?n[h]=n[f]:_S(n,h);for(c=i;c>i-l+s;c--)_S(n,c-1)}else if(s>l)for(c=i-l;c>o;c--)f=c+l-1,h=c+s-1,f in n?n[h]=n[f]:_S(n,h);for(c=0;c<s;c++)n[c+o]=arguments[c+2];return ine(n,i-l+s),u}});var hne=Sr,dne=Math.floor,pne=Number.isInteger||function(e){return!hne(e)&&isFinite(e)&&dne(e)===e},mne=Ye,vne=pne;mne({target:"Number",stat:!0},{isInteger:vne});var gne=rt,dF=gne(1 .valueOf),pF=`	
\v\f\r                　\u2028\u2029\uFEFF`,yne=rt,bne=Yn,wne=Dr,Sne=pF,UN=yne("".replace),L0="["+Sne+"]",Rne=RegExp("^"+L0+L0+"*"),Ene=RegExp(L0+L0+"*$"),AS=function(t){return function(e){var r=wne(bne(e));return t&1&&(r=UN(r,Rne,"")),t&2&&(r=UN(r,Ene,"")),r}},mF={start:AS(1),end:AS(2),trim:AS(3)},Cne=Nr,u_=Vt,vF=rt,One=T2,Tne=di,BN=fr,_ne=i_,Ane=Ys,Ine=gg,gF=jL,Nne=nt,Pne=Mu.f,Mne=Ho.f,kne=Jr.f,xne=dF,$ne=mF.trim,pE="Number",fs=u_[pE],IS=fs.prototype,Lne=u_.TypeError,Dne=vF("".slice),yy=vF("".charCodeAt),Fne=function(t){var e=gF(t,"number");return typeof e=="bigint"?e:Hne(e)},Hne=function(t){var e=gF(t,"number"),r,n,i,o,a,s,l,u;if(Ine(e))throw Lne("Cannot convert a Symbol value to a number");if(typeof e=="string"&&e.length>2){if(e=$ne(e),r=yy(e,0),r===43||r===45){if(n=yy(e,2),n===88||n===120)return NaN}else if(r===48){switch(yy(e,1)){case 66:case 98:i=2,o=49;break;case 79:case 111:i=8,o=55;break;default:return+e}for(a=Dne(e,2),s=a.length,l=0;l<s;l++)if(u=yy(a,l),u<48||u>o)return NaN;return parseInt(a,i)}}return+e};if(One(pE,!fs(" 0o1")||!fs("0b1")||fs("+0x1"))){for(var Gu=function(e){var r=arguments.length<1?0:fs(Fne(e)),n=this;return Ane(IS,n)&&Nne(function(){xne(n)})?_ne(Object(r),n,Gu):r},VN=Cne?Pne(fs):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),NS=0,by;VN.length>NS;NS++)BN(fs,by=VN[NS])&&!BN(Gu,by)&&kne(Gu,by,Mne(fs,by));Gu.prototype=IS,IS.constructor=Gu,Tne(u_,pE,Gu,{constructor:!0})}var Une=Ye,jN=bd,Bne=I2,Vne=Sr,WN=wg,jne=Mi,Wne=hi,Gne=yd,zne=qt,Yne=Pg,Kne=Tg,Xne=Yne("slice"),qne=zne("species"),PS=Array,Qne=Math.max;Une({target:"Array",proto:!0,forced:!Xne},{slice:function(e,r){var n=Wne(this),i=jne(n),o=WN(e,i),a=WN(r===void 0?i:r,i),s,l,u;if(jN(n)&&(s=n.constructor,Bne(s)&&(s===PS||jN(s.prototype))?s=void 0:Vne(s)&&(s=s[qne],s===null&&(s=void 0)),s===PS||s===void 0))return Kne(n,o,a);for(l=new(s===void 0?PS:s)(Qne(a-o,0)),u=0;o<a;o++,u++)o in n&&Gne(l,u,n[o]);return l.length=u,l}});var Zne=Ye,Jne=nt,eie=bd,tie=Sr,rie=Kn,nie=Mi,GN=hF,zN=yd,iie=VT,oie=Pg,aie=qt,sie=vg,yF=aie("isConcatSpreadable"),lie=sie>=51||!Jne(function(){var t=[];return t[yF]=!1,t.concat()[0]!==t}),uie=oie("concat"),cie=function(t){if(!tie(t))return!1;var e=t[yF];return e!==void 0?!!e:eie(t)},fie=!lie||!uie;Zne({target:"Array",proto:!0,arity:1,forced:fie},{concat:function(e){var r=rie(this),n=iie(r,0),i=0,o,a,s,l,u;for(o=-1,s=arguments.length;o<s;o++)if(u=o===-1?r:arguments[o],cie(u))for(l=nie(u),GN(i+l),a=0;a<l;a++,i++)a in u&&zN(n,i,u[a]);else GN(i+1),zN(n,i++,u);return n.length=i,n}});var hie=Kn,YN=wg,die=Mi,pie=function(e){for(var r=hie(this),n=die(r),i=arguments.length,o=YN(i>1?arguments[1]:void 0,n),a=i>2?arguments[2]:void 0,s=a===void 0?n:YN(a,n);s>o;)r[o++]=e;return r},mie=Ye,vie=pie,gie=Ig;mie({target:"Array",proto:!0},{fill:vie});gie("fill");var yie=Ye,bie=xu.map,wie=Pg,Sie=wie("map");yie({target:"Array",proto:!0,forced:!Sie},{map:function(e){return bie(this,e,arguments.length>1?arguments[1]:void 0)}});var Rie=Rr,bF=function(){var t=Rie(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},c_=nt,Eie=Vt,f_=Eie.RegExp,h_=c_(function(){var t=f_("a","y");return t.lastIndex=2,t.exec("abcd")!=null}),Cie=h_||c_(function(){return!f_("a","y").sticky}),Oie=h_||c_(function(){var t=f_("^r","gy");return t.lastIndex=2,t.exec("str")!=null}),d_={BROKEN_CARET:Oie,MISSED_STICKY:Cie,UNSUPPORTED_Y:h_},Tie=nt,_ie=Vt,Aie=_ie.RegExp,wF=Tie(function(){var t=Aie(".","s");return!(t.dotAll&&t.exec(`
`)&&t.flags==="s")}),Iie=nt,Nie=Vt,Pie=Nie.RegExp,SF=Iie(function(){var t=Pie("(?<a>b)","g");return t.exec("b").groups.a!=="b"||"b".replace(t,"$<a>c")!=="bc"}),$c=Lr,D2=rt,Mie=Dr,kie=bF,xie=d_,$ie=vd,Lie=gd,Die=Ya.get,Fie=wF,Hie=SF,Uie=$ie("native-string-replace",String.prototype.replace),D0=RegExp.prototype.exec,mE=D0,Bie=D2("".charAt),Vie=D2("".indexOf),jie=D2("".replace),MS=D2("".slice),vE=function(){var t=/a/,e=/b*/g;return $c(D0,t,"a"),$c(D0,e,"a"),t.lastIndex!==0||e.lastIndex!==0}(),RF=xie.BROKEN_CARET,gE=/()??/.exec("")[1]!==void 0,Wie=vE||gE||RF||Fie||Hie;Wie&&(mE=function(e){var r=this,n=Die(r),i=Mie(e),o=n.raw,a,s,l,u,c,f,h;if(o)return o.lastIndex=r.lastIndex,a=$c(mE,o,i),r.lastIndex=o.lastIndex,a;var d=n.groups,p=RF&&r.sticky,m=$c(kie,r),y=r.source,S=0,R=i;if(p&&(m=jie(m,"y",""),Vie(m,"g")===-1&&(m+="g"),R=MS(i,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&Bie(i,r.lastIndex-1)!==`
`)&&(y="(?: "+y+")",R=" "+R,S++),s=new RegExp("^(?:"+y+")",m)),gE&&(s=new RegExp("^"+y+"$(?!\\s)",m)),vE&&(l=r.lastIndex),u=$c(D0,p?s:r,R),p?u?(u.input=MS(u.input,S),u[0]=MS(u[0],S),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:vE&&u&&(r.lastIndex=r.global?u.index+u[0].length:l),gE&&u&&u.length>1&&$c(Uie,u[0],s,function(){for(c=1;c<arguments.length-2;c++)arguments[c]===void 0&&(u[c]=void 0)}),u&&d)for(u.groups=f=Lie(null),c=0;c<d.length;c++)h=d[c],f[h[0]]=u[h[1]];return u});var F2=mE,Gie=Ye,KN=F2;Gie({target:"RegExp",proto:!0,forced:/./.exec!==KN},{exec:KN});var XN=rt,qN=di,zie=F2,QN=nt,EF=qt,Yie=Pu,Kie=EF("species"),kS=RegExp.prototype,H2=function(t,e,r,n){var i=EF(t),o=!QN(function(){var u={};return u[i]=function(){return 7},""[t](u)!=7}),a=o&&!QN(function(){var u=!1,c=/a/;return t==="split"&&(c={},c.constructor={},c.constructor[Kie]=function(){return c},c.flags="",c[i]=/./[i]),c.exec=function(){return u=!0,null},c[i](""),!u});if(!o||!a||r){var s=XN(/./[i]),l=e(i,""[t],function(u,c,f,h,d){var p=XN(u),m=c.exec;return m===zie||m===kS.exec?o&&!d?{done:!0,value:s(c,f,h)}:{done:!0,value:p(f,c,h)}:{done:!1}});qN(String.prototype,t,l[0]),qN(kS,i,l[1])}n&&Yie(kS[i],"sham",!0)},Xie=s_.charAt,p_=function(t,e,r){return e+(r?Xie(t,e).length:1)},m_=rt,qie=Kn,Qie=Math.floor,xS=m_("".charAt),Zie=m_("".replace),$S=m_("".slice),Jie=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,eoe=/\$([$&'`]|\d{1,2})/g,toe=function(t,e,r,n,i,o){var a=r+t.length,s=n.length,l=eoe;return i!==void 0&&(i=qie(i),l=Jie),Zie(o,l,function(u,c){var f;switch(xS(c,0)){case"$":return"$";case"&":return t;case"`":return $S(e,0,r);case"'":return $S(e,a);case"<":f=i[$S(c,1,-1)];break;default:var h=+c;if(h===0)return u;if(h>s){var d=Qie(h/10);return d===0?u:d<=s?n[d-1]===void 0?xS(c,1):n[d-1]+xS(c,1):u}f=n[h-1]}return f===void 0?"":f})},ZN=Lr,roe=Rr,noe=ir,ioe=za,ooe=F2,aoe=TypeError,U2=function(t,e){var r=t.exec;if(noe(r)){var n=ZN(r,t,e);return n!==null&&roe(n),n}if(ioe(t)==="RegExp")return ZN(ooe,t,e);throw aoe("RegExp#exec called on incompatible receiver")},soe=$u,JN=Lr,B2=rt,loe=H2,uoe=nt,coe=Rr,foe=ir,hoe=ro,doe=Ks,poe=ku,zu=Dr,moe=Yn,voe=p_,goe=Nu,yoe=toe,boe=U2,woe=qt,yE=woe("replace"),Soe=Math.max,Roe=Math.min,Eoe=B2([].concat),LS=B2([].push),eP=B2("".indexOf),tP=B2("".slice),Coe=function(t){return t===void 0?t:String(t)},Ooe=function(){return"a".replace(/./,"$0")==="$0"}(),rP=function(){return/./[yE]?/./[yE]("a","$0")==="":!1}(),Toe=!uoe(function(){var t=/./;return t.exec=function(){var e=[];return e.groups={a:"7"},e},"".replace(t,"$<a>")!=="7"});loe("replace",function(t,e,r){var n=rP?"$":"$0";return[function(o,a){var s=moe(this),l=hoe(o)?void 0:goe(o,yE);return l?JN(l,o,s,a):JN(e,zu(s),o,a)},function(i,o){var a=coe(this),s=zu(i);if(typeof o=="string"&&eP(o,n)===-1&&eP(o,"$<")===-1){var l=r(e,a,s,o);if(l.done)return l.value}var u=foe(o);u||(o=zu(o));var c=a.global;if(c){var f=a.unicode;a.lastIndex=0}for(var h=[];;){var d=boe(a,s);if(d===null||(LS(h,d),!c))break;var p=zu(d[0]);p===""&&(a.lastIndex=voe(s,poe(a.lastIndex),f))}for(var m="",y=0,S=0;S<h.length;S++){d=h[S];for(var R=zu(d[0]),E=Soe(Roe(doe(d.index),s.length),0),O=[],A=1;A<d.length;A++)LS(O,Coe(d[A]));var B=d.groups;if(u){var j=Eoe([R],O,E,s);B!==void 0&&LS(j,B);var J=zu(soe(o,void 0,j))}else J=yoe(R,s,E,O,B,o);E>=y&&(m+=tP(s,y,E)+J,y=E+R.length)}return m+tP(s,y)}]},!Toe||!Ooe||rP);var _oe=Rr,Aoe=XD,Ioe=function(t,e,r,n){try{return n?e(_oe(r)[0],r[1]):e(r)}catch(i){Aoe(t,"throw",i)}},Noe=Cg,Poe=Lr,Moe=Kn,koe=Ioe,xoe=YD,$oe=I2,Loe=Mi,nP=yd,Doe=KD,Foe=t_,iP=Array,Hoe=function(e){var r=Moe(e),n=$oe(this),i=arguments.length,o=i>1?arguments[1]:void 0,a=o!==void 0;a&&(o=Noe(o,i>2?arguments[2]:void 0));var s=Foe(r),l=0,u,c,f,h,d,p;if(s&&!(this===iP&&xoe(s)))for(h=Doe(r,s),d=h.next,c=n?new this:[];!(f=Poe(d,h)).done;l++)p=a?koe(h,o,[f.value,l],!0):f.value,nP(c,l,p);else for(u=Loe(r),c=n?new this(u):iP(u);u>l;l++)p=a?o(r[l],l):r[l],nP(c,l,p);return c.length=l,c},Uoe=Ye,Boe=Hoe,Voe=ZD,joe=!Voe(function(t){Array.from(t)});Uoe({target:"Array",stat:!0,forced:joe},{from:Boe});var Woe=Ye,Goe=rt,zoe=kT.indexOf,Yoe=wd,bE=Goe([].indexOf),oP=!!bE&&1/bE([1],1,-0)<0,Koe=Yoe("indexOf");Woe({target:"Array",proto:!0,forced:oP||!Koe},{indexOf:function(e){var r=arguments.length>1?arguments[1]:void 0;return oP?bE(this,e,r)||0:zoe(this,e,r)}});var Xoe=Ye,qoe=rt,Qoe=bd,Zoe=qoe([].reverse),aP=[1,2];Xoe({target:"Array",proto:!0,forced:String(aP)===String(aP.reverse())},{reverse:function(){return Qoe(this)&&(this.length=this.length),Zoe(this)}});var Joe=xu.forEach,eae=wd,tae=eae("forEach"),rae=tae?[].forEach:function(e){return Joe(this,e,arguments.length>1?arguments[1]:void 0)},sP=Vt,lP=iF,nae=oF,DS=rae,iae=Pu,CF=function(t){if(t&&t.forEach!==DS)try{iae(t,"forEach",DS)}catch{t.forEach=DS}};for(var FS in lP)lP[FS]&&CF(sP[FS]&&sP[FS].prototype);CF(nae);var oae=TypeError,OF=function(t,e){if(t<e)throw oae("Not enough arguments");return t},wE=Vt,aae=$u,sae=ir,lae=Iu,uae=Tg,cae=OF,fae=/MSIE .\./.test(lae),hae=wE.Function,uP=function(t){return fae?function(e,r){var n=cae(arguments.length,1)>2,i=sae(e)?e:hae(e),o=n?uae(arguments,2):void 0;return t(n?function(){aae(i,this,o)}:i,r)}:t},TF={setTimeout:uP(wE.setTimeout),setInterval:uP(wE.setInterval)},dae=Ye,pae=Vt,cP=TF.setInterval;dae({global:!0,bind:!0,forced:pae.setInterval!==cP},{setInterval:cP});var mae=Ye,vae=Vt,fP=TF.setTimeout;mae({global:!0,bind:!0,forced:vae.setTimeout!==fP},{setTimeout:fP});var gae=Iu,yae=/(?:ipad|iphone|ipod).*applewebkit/i.test(gae),bae=za,wae=Vt,_F=bae(wae.process)=="process",ai=Vt,Sae=$u,Rae=Cg,hP=ir,Eae=fr,Cae=nt,dP=rD,Oae=Tg,pP=C2,Tae=OF,_ae=yae,Aae=_F,SE=ai.setImmediate,RE=ai.clearImmediate,Iae=ai.process,HS=ai.Dispatch,Nae=ai.Function,mP=ai.MessageChannel,Pae=ai.String,US=0,Cp={},vP="onreadystatechange",Qp,nl,BS,VS;try{Qp=ai.location}catch{}var v_=function(t){if(Eae(Cp,t)){var e=Cp[t];delete Cp[t],e()}},jS=function(t){return function(){v_(t)}},gP=function(t){v_(t.data)},yP=function(t){ai.postMessage(Pae(t),Qp.protocol+"//"+Qp.host)};(!SE||!RE)&&(SE=function(e){Tae(arguments.length,1);var r=hP(e)?e:Nae(e),n=Oae(arguments,1);return Cp[++US]=function(){Sae(r,void 0,n)},nl(US),US},RE=function(e){delete Cp[e]},Aae?nl=function(t){Iae.nextTick(jS(t))}:HS&&HS.now?nl=function(t){HS.now(jS(t))}:mP&&!_ae?(BS=new mP,VS=BS.port2,BS.port1.onmessage=gP,nl=Rae(VS.postMessage,VS)):ai.addEventListener&&hP(ai.postMessage)&&!ai.importScripts&&Qp&&Qp.protocol!=="file:"&&!Cae(yP)?(nl=yP,ai.addEventListener("message",gP,!1)):vP in pP("script")?nl=function(t){dP.appendChild(pP("script"))[vP]=function(){dP.removeChild(this),v_(t)}}:nl=function(t){setTimeout(jS(t),0)});var AF={set:SE,clear:RE},Mae=Ye,kae=Vt,bP=AF.clear;Mae({global:!0,bind:!0,enumerable:!0,forced:kae.clearImmediate!==bP},{clearImmediate:bP});var xae=Ye,$ae=Vt,wP=AF.set;xae({global:!0,bind:!0,enumerable:!0,forced:$ae.setImmediate!==wP},{setImmediate:wP});var Lae=L2,Dae=tF;Lae("Map",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Dae);var Fae=Ye,Hae=nt,Uae=Kn,IF=$2,Bae=UD,Vae=Hae(function(){IF(1)});Fae({target:"Object",stat:!0,forced:Vae,sham:!Bae},{getPrototypeOf:function(e){return IF(Uae(e))}});var jae=Sr,Wae=za,Gae=qt,zae=Gae("match"),g_=function(t){var e;return jae(t)&&((e=t[zae])!==void 0?!!e:Wae(t)=="RegExp")},Yae=g_,Kae=TypeError,y_=function(t){if(Yae(t))throw Kae("The method doesn't accept regular expressions");return t},Xae=qt,qae=Xae("match"),b_=function(t){var e=/./;try{"/./"[t](e)}catch{try{return e[qae]=!1,"/./"[t](e)}catch{}}return!1},Qae=Ye,Zae=rt,Jae=y_,ese=Yn,SP=Dr,tse=b_,rse=Zae("".indexOf);Qae({target:"String",proto:!0,forced:!tse("includes")},{includes:function(e){return!!~rse(SP(ese(this)),SP(Jae(e)),arguments.length>1?arguments[1]:void 0)}});var nse=Ye,ise=xu.filter,ose=Pg,ase=ose("filter");nse({target:"Array",proto:!0,forced:!ase},{filter:function(e){return ise(this,e,arguments.length>1?arguments[1]:void 0)}});var sse=Lr,lse=fr,use=Ys,cse=bF,RP=RegExp.prototype,NF=function(t){var e=t.flags;return e===void 0&&!("flags"in RP)&&!lse(t,"flags")&&use(RP,t)?sse(cse,t):e},fse=Jr.f,hse=function(t,e,r){r in t||fse(t,r,{configurable:!0,get:function(){return e[r]},set:function(n){e[r]=n}})},dse=Nr,w_=Vt,Mg=rt,pse=T2,mse=i_,vse=Pu,gse=Mu.f,EP=Ys,yse=g_,CP=Dr,bse=NF,PF=d_,wse=hse,Sse=di,Rse=nt,Ese=fr,Cse=Ya.enforce,Ose=JD,Tse=qt,MF=wF,kF=SF,_se=Tse("match"),As=w_.RegExp,Oc=As.prototype,Ase=w_.SyntaxError,Ise=Mg(Oc.exec),F0=Mg("".charAt),OP=Mg("".replace),TP=Mg("".indexOf),Nse=Mg("".slice),Pse=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,ou=/a/g,WS=/a/g,Mse=new As(ou)!==ou,xF=PF.MISSED_STICKY,kse=PF.UNSUPPORTED_Y,xse=dse&&(!Mse||xF||MF||kF||Rse(function(){return WS[_se]=!1,As(ou)!=ou||As(WS)==WS||As(ou,"i")!="/a/i"})),$se=function(t){for(var e=t.length,r=0,n="",i=!1,o;r<=e;r++){if(o=F0(t,r),o==="\\"){n+=o+F0(t,++r);continue}!i&&o==="."?n+="[\\s\\S]":(o==="["?i=!0:o==="]"&&(i=!1),n+=o)}return n},Lse=function(t){for(var e=t.length,r=0,n="",i=[],o={},a=!1,s=!1,l=0,u="",c;r<=e;r++){if(c=F0(t,r),c==="\\")c=c+F0(t,++r);else if(c==="]")a=!1;else if(!a)switch(!0){case c==="[":a=!0;break;case c==="(":Ise(Pse,Nse(t,r+1))&&(r+=2,s=!0),n+=c,l++;continue;case(c===">"&&s):if(u===""||Ese(o,u))throw new Ase("Invalid capture group name");o[u]=!0,i[i.length]=[u,l],s=!1,u="";continue}s?u+=c:n+=c}return[n,i]};if(pse("RegExp",xse)){for(var il=function(e,r){var n=EP(Oc,this),i=yse(e),o=r===void 0,a=[],s=e,l,u,c,f,h,d;if(!n&&i&&o&&e.constructor===il)return e;if((i||EP(Oc,e))&&(e=e.source,o&&(r=bse(s))),e=e===void 0?"":CP(e),r=r===void 0?"":CP(r),s=e,MF&&"dotAll"in ou&&(u=!!r&&TP(r,"s")>-1,u&&(r=OP(r,/s/g,""))),l=r,xF&&"sticky"in ou&&(c=!!r&&TP(r,"y")>-1,c&&kse&&(r=OP(r,/y/g,""))),kF&&(f=Lse(e),e=f[0],a=f[1]),h=mse(As(e,r),n?this:Oc,il),(u||c||a.length)&&(d=Cse(h),u&&(d.dotAll=!0,d.raw=il($se(e),l)),c&&(d.sticky=!0),a.length&&(d.groups=a)),e!==s)try{vse(h,"source",s===""?"(?:)":s)}catch{}return h},_P=gse(As),AP=0;_P.length>AP;)wse(il,As,_P[AP++]);Oc.constructor=il,il.prototype=Oc,Sse(w_,"RegExp",il,{constructor:!0})}Ose("RegExp");var Dse=yg.PROPER,Fse=di,Hse=Rr,IP=Dr,Use=nt,Bse=NF,S_="toString",Vse=RegExp.prototype,$F=Vse[S_],jse=Use(function(){return $F.call({source:"a",flags:"b"})!="/a/b"}),Wse=Dse&&$F.name!=S_;(jse||Wse)&&Fse(RegExp.prototype,S_,function(){var e=Hse(this),r=IP(e.source),n=IP(Bse(e));return"/"+r+"/"+n},{unsafe:!0});var Gse=Ye,zse=rt,Yse=mg,Kse=hi,Xse=wd,qse=zse([].join),Qse=Yse!=Object,Zse=Xse("join",",");Gse({target:"Array",proto:!0,forced:Qse||!Zse},{join:function(e){return qse(Kse(this),e===void 0?",":e)}});var Jse=yg.PROPER,ele=nt,NP=pF,PP="​᠎",tle=function(t){return ele(function(){return!!NP[t]()||PP[t]()!==PP||Jse&&NP[t].name!==t})},rle=Ye,nle=mF.trim,ile=tle;rle({target:"String",proto:!0,forced:ile("trim")},{trim:function(){return nle(this)}});function EE(t){"@babel/helpers - typeof";return EE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},EE(t)}function R_(t){return window.requestAnimationFrame(t)}function ole(){return!!document.documentElement.classList}function ale(){return!!document.createTextNode("test").textContent}function sle(){return!!window.getComputedStyle}function H0(t){window.cancelAnimationFrame(t)}function LF(){return"ontouchstart"in window}var CE;function lle(){var t=document.createElement("TABLE");t.style.borderSpacing="0",t.style.borderWidth="0",t.style.padding="0";var e=document.createElement("TBODY");t.appendChild(e),e.appendChild(document.createElement("TR")),e.firstChild.appendChild(document.createElement("TD")),e.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",t.insertBefore(r,e),document.body.appendChild(t),CE=t.offsetHeight<2*t.lastChild.offsetHeight,document.body.removeChild(t)}function DF(){return CE===void 0&&lle(),CE}var Yu;function ule(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Yu||((typeof Intl>"u"?"undefined":EE(Intl))==="object"?Yu=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Yu=function(n,i){return"".concat(n).localeCompare(i)}:Yu=function(n,i){return n===i?0:n>i?-1:1},Yu)}var Dd;function cle(){if(Dd!==void 0)return Dd;try{var t={get passive(){Dd=!0}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch{Dd=!1}return Dd}var fle=UT,hle=sD;fle("toPrimitive");hle();var dle=Rr,ple=UL,mle=TypeError,vle=function(t){if(dle(this),t==="string"||t==="default")t="string";else if(t!=="number")throw mle("Incorrect hint");return ple(this,t)},gle=fr,yle=di,ble=vle,wle=qt,MP=wle("toPrimitive"),kP=Date.prototype;gle(kP,MP)||yle(kP,MP,ble);var Sle=I2,Rle=pd,Ele=TypeError,FF=function(t){if(Sle(t))return t;throw Ele(Rle(t)+" is not a constructor")},xP=Rr,Cle=FF,Ole=ro,Tle=qt,_le=Tle("species"),Ale=function(t,e){var r=xP(t).constructor,n;return r===void 0||Ole(n=xP(r)[_le])?e:Cle(n)},Ile=$u,Fd=Lr,E_=rt,Nle=H2,Ple=Rr,Mle=ro,kle=g_,$P=Yn,xle=Ale,$le=p_,Lle=ku,GS=Dr,Dle=Nu,LP=FT,DP=U2,Fle=F2,Hle=d_,Ule=nt,Ku=Hle.UNSUPPORTED_Y,FP=4294967295,Ble=Math.min,HF=[].push,Vle=E_(/./.exec),Xu=E_(HF),Hd=E_("".slice),jle=!Ule(function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var r="ab".split(t);return r.length!==2||r[0]!=="a"||r[1]!=="b"});Nle("split",function(t,e,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(i,o){var a=GS($P(this)),s=o===void 0?FP:o>>>0;if(s===0)return[];if(i===void 0)return[a];if(!kle(i))return Fd(e,a,i,s);for(var l=[],u=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(i.sticky?"y":""),c=0,f=new RegExp(i.source,u+"g"),h,d,p;(h=Fd(Fle,f,a))&&(d=f.lastIndex,!(d>c&&(Xu(l,Hd(a,c,h.index)),h.length>1&&h.index<a.length&&Ile(HF,l,LP(h,1)),p=h[0].length,c=d,l.length>=s)));)f.lastIndex===h.index&&f.lastIndex++;return c===a.length?(p||!Vle(f,""))&&Xu(l,""):Xu(l,Hd(a,c)),l.length>s?LP(l,0,s):l}:"0".split(void 0,0).length?n=function(i,o){return i===void 0&&o===0?[]:Fd(e,this,i,o)}:n=e,[function(o,a){var s=$P(this),l=Mle(o)?void 0:Dle(o,t);return l?Fd(l,o,s,a):Fd(n,GS(s),o,a)},function(i,o){var a=Ple(this),s=GS(i),l=r(n,a,s,o,n!==e);if(l.done)return l.value;var u=xle(a,RegExp),c=a.unicode,f=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(Ku?"g":"y"),h=new u(Ku?"^(?:"+a.source+")":a,f),d=o===void 0?FP:o>>>0;if(d===0)return[];if(s.length===0)return DP(h,s)===null?[s]:[];for(var p=0,m=0,y=[];m<s.length;){h.lastIndex=Ku?0:m;var S=DP(h,Ku?Hd(s,m):s),R;if(S===null||(R=Ble(Lle(h.lastIndex+(Ku?m:0)),s.length))===p)m=$le(s,m,c);else{if(Xu(y,Hd(s,p,m)),y.length===d)return y;for(var E=1;E<=S.length-1;E++)if(Xu(y,S[E]),y.length===d)return y;m=p=R}}return Xu(y,Hd(s,p)),y}]},!jle,Ku);function Wle(t){for(var e=t.length,r=0;r<e;)t[r]=[t[r]],r+=1}function HP(t,e){for(var r=e.length,n=0;n<r;)t.push(e[n]),n+=1}function H1(t){var e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;for(var r=t.length,n=t[0].length,i=0;i<r;i++)for(var o=0;o<n;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function gn(t,e,r,n){var i=-1,o=t,a=r;Array.isArray(t)||(o=Array.from(t));var s=o.length;for(i+=1;i<s;)a=e(a,o[i],i,o),i+=1;return a}function _i(t,e){var r=0,n=t;Array.isArray(t)||(n=Array.from(t));for(var i=n.length,o=[],a=-1;r<i;){var s=n[r];e(s,r,n)&&(a+=1,o[a]=s),r+=1}return o}function st(t,e){var r=0,n=t;Array.isArray(t)||(n=Array.from(t));for(var i=n.length,o=[],a=-1;r<i;){var s=n[r];a+=1,o[a]=e(s,r,n),r+=1}return o}function D(t,e){var r=0,n=t;Array.isArray(t)||(n=Array.from(t));for(var i=n.length;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function UF(t){var e=[];return D(t,function(r){e.indexOf(r)===-1&&e.push(r)}),e}function UP(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=[].concat(e),i=n[0],o=n.slice(1),a=i;return D(o,function(s){a=a.filter(function(l){return!s.includes(l)})}),a}function BP(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function VP(t,e,r){return e=Gle(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gle(t){var e=zle(t,"string");return Va(e)==="symbol"?e:String(e)}function zle(t,e){if(Va(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Va(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Va(t){"@babel/helpers - typeof";return Va=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Va(t)}function Zp(t){var e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},ut(t,function(r,n){n!=="__children"&&(r&&Va(r)==="object"&&!Array.isArray(r)?e[n]=Zp(r):Array.isArray(r)?r.length&&Va(r[0])==="object"&&!Array.isArray(r[0])?e[n]=[Zp(r[0])]:e[n]=[]:e[n]=null)})),e}function Xs(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function $r(t,e,r){var n=Array.isArray(r);return ut(e,function(i,o){(n===!1||r.includes(o))&&(t[o]=i)}),t}function V2(t,e){ut(e,function(r,n){e[n]&&Va(e[n])==="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),V2(t[n],e[n])):t[n]=e[n]})}function An(t){return Va(t)==="object"?JSON.parse(JSON.stringify(t)):t}function Bn(t){var e={};return ut(t,function(r,n){e[n]=r}),e}function Kt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return D(r,function(i){t.MIXINS.push(i.MIXIN_NAME),ut(i,function(o,a){if(t.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof o=="function")t.prototype[a]=o;else{var s=function(c,f){var h="_".concat(c),d=function(m){var y=m;return(Array.isArray(y)||lt(y))&&(y=An(y)),y};return function(){return this[h]===void 0&&(this[h]=d(f)),this[h]}},l=function(c){var f="_".concat(c);return function(h){this[f]=h}};Object.defineProperty(t.prototype,a,{get:s(a,o),set:l(a),configurable:!0})}})}),t}function C_(t,e){return JSON.stringify(t)===JSON.stringify(e)}function lt(t){return Object.prototype.toString.call(t)==="[object Object]"}function Ka(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function ut(t,e){for(var r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function Yle(t,e){var r=e.split("."),n=t;return ut(r,function(i){if(n=n[i],n===void 0)return n=void 0,!1}),n}function zS(t,e,r){var n=e.split("."),i=t;n.forEach(function(o,a){a!==n.length-1?(wr(i,o)||(i[o]={}),i=i[o]):i[o]=r})}function O_(t){if(!lt(t))return 0;var e=function r(n){var i=0;return lt(n)?ut(n,function(o,a){a!=="__children"&&(i+=r(o))}):i+=1,i};return e(t)}function cf(t){var e,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),i=(e={_touched:!1},VP(e,n,t),VP(e,"isTouched",function(){return this._touched}),e);return Object.defineProperty(i,r,{get:function(){return this[n]},set:function(a){this._touched=!0,this[n]=a},enumerable:!0,configurable:!0}),i}function wr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var xn=function(e){var r={value:!1};return r.test=function(n,i){r.value=e(n,i)},r},Bo={chrome:xn(function(t,e){return/Chrome/.test(t)&&/Google/.test(e)}),chromeWebKit:xn(function(t){return/CriOS/.test(t)}),edge:xn(function(t){return/Edge/.test(t)}),edgeWebKit:xn(function(t){return/EdgiOS/.test(t)}),firefox:xn(function(t){return/Firefox/.test(t)}),firefoxWebKit:xn(function(t){return/FxiOS/.test(t)}),ie:xn(function(t){return/Trident/.test(t)}),ie9:xn(function(){return!!document.documentMode}),mobile:xn(function(t){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)}),safari:xn(function(t,e){return/Safari/.test(t)&&/Apple Computer/.test(e)})},kg={mac:xn(function(t){return/^Mac/.test(t)}),win:xn(function(t){return/^Win/.test(t)}),linux:xn(function(t){return/^Linux/.test(t)}),ios:xn(function(t){return/iPhone|iPad|iPod/i.test(t)})};function Kle(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.userAgent,r=e===void 0?navigator.userAgent:e,n=t.vendor,i=n===void 0?navigator.vendor:n;ut(Bo,function(o){var a=o.test;return void a(r,i)})}function Xle(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.platform,r=e===void 0?navigator.platform:e;ut(kg,function(n){var i=n.test;return void i(r)})}Kle();Xle();function BF(){return Bo.chrome.value}function qle(){return Bo.chromeWebKit.value}function YS(){return Bo.firefox.value}function Qle(){return Bo.firefoxWebKit.value}function Zle(){return Bo.safari.value}function Jle(){return Bo.edge.value}function eue(){return Bo.ie.value}function tue(){return Bo.ie9.value}function Ao(){return Bo.mobile.value}function VF(){return kg.ios.value}function jF(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,e=t.maxTouchPoints;return e>2&&kg.mac.value}function jP(){return kg.win.value}function WP(){return kg.mac.value}/*! @license DOMPurify 2.4.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.0/LICENSE */function gs(t){"@babel/helpers - typeof";return gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gs(t)}function OE(t,e){return OE=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},OE(t,e)}function rue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function U1(t,e,r){return rue()?U1=Reflect.construct:U1=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&OE(u,a.prototype),u},U1.apply(null,arguments)}function Hi(t){return nue(t)||iue(t)||oue(t)||aue()}function nue(t){if(Array.isArray(t))return TE(t)}function iue(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function oue(t,e){if(t){if(typeof t=="string")return TE(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TE(t,e)}}function TE(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function aue(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sue=Object.hasOwnProperty,GP=Object.setPrototypeOf,lue=Object.isFrozen,uue=Object.getPrototypeOf,cue=Object.getOwnPropertyDescriptor,In=Object.freeze,ko=Object.seal,fue=Object.create,WF=typeof Reflect<"u"&&Reflect,U0=WF.apply,_E=WF.construct;U0||(U0=function(e,r,n){return e.apply(r,n)});In||(In=function(e){return e});ko||(ko=function(e){return e});_E||(_E=function(e,r){return U1(e,Hi(r))});var hue=Ji(Array.prototype.forEach),zP=Ji(Array.prototype.pop),Ud=Ji(Array.prototype.push),B1=Ji(String.prototype.toLowerCase),due=Ji(String.prototype.match),es=Ji(String.prototype.replace),pue=Ji(String.prototype.indexOf),mue=Ji(String.prototype.trim),wn=Ji(RegExp.prototype.test),KS=vue(TypeError);function Ji(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return U0(t,e,n)}}function vue(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return _E(t,r)}}function pt(t,e,r){r=r||B1,GP&&GP(t,null);for(var n=e.length;n--;){var i=e[n];if(typeof i=="string"){var o=r(i);o!==i&&(lue(e)||(e[n]=o),i=o)}t[i]=!0}return t}function ol(t){var e=fue(null),r;for(r in t)U0(sue,t,[r])&&(e[r]=t[r]);return e}function wy(t,e){for(;t!==null;){var r=cue(t,e);if(r){if(r.get)return Ji(r.get);if(typeof r.value=="function")return Ji(r.value)}t=uue(t)}function n(i){return console.warn("fallback value for",i),null}return n}var YP=In(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),XS=In(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),qS=In(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),gue=In(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),QS=In(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),yue=In(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),KP=In(["#text"]),XP=In(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),ZS=In(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),qP=In(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Sy=In(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),bue=ko(/\{\{[\w\W]*|[\w\W]*\}\}/gm),wue=ko(/<%[\w\W]*|[\w\W]*%>/gm),Sue=ko(/^data-[\-\w.\u00B7-\uFFFF]/),Rue=ko(/^aria-[\-\w]+$/),Eue=ko(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Cue=ko(/^(?:\w+script|data):/i),Oue=ko(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Tue=ko(/^html$/i),_ue=function(){return typeof window>"u"?null:window},Aue=function(e,r){if(gs(e)!=="object"||typeof e.createPolicy!="function")return null;var n=null,i="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(i)&&(n=r.currentScript.getAttribute(i));var o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML:function(s){return s},createScriptURL:function(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function GF(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_ue(),e=function(G){return GF(G)};if(e.version="2.4.0",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var r=t.document,n=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,a=t.Node,s=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,f=t.HTMLFormElement,h=t.DOMParser,d=t.trustedTypes,p=s.prototype,m=wy(p,"cloneNode"),y=wy(p,"nextSibling"),S=wy(p,"childNodes"),R=wy(p,"parentNode");if(typeof o=="function"){var E=n.createElement("template");E.content&&E.content.ownerDocument&&(n=E.content.ownerDocument)}var O=Aue(d,r),A=O?O.createHTML(""):"",B=n,j=B.implementation,J=B.createNodeIterator,Y=B.createDocumentFragment,q=B.getElementsByTagName,ee=r.importNode,ae={};try{ae=ol(n).documentMode?n.documentMode:{}}catch{}var ne={};e.isSupported=typeof R=="function"&&j&&typeof j.createHTMLDocument<"u"&&ae!==9;var ue=bue,me=wue,Re=Sue,ge=Rue,I=Cue,v=Oue,b=Eue,w=null,_=pt({},[].concat(Hi(YP),Hi(XS),Hi(qS),Hi(QS),Hi(KP))),M=null,L=pt({},[].concat(Hi(XP),Hi(ZS),Hi(qP),Hi(Sy))),H=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Z=null,te=null,ie=!0,oe=!0,ve=!1,ke=!1,pe=!1,Ce=!1,re=!1,Ve=!1,Ze=!1,Ge=!1,je=!0,ze=!1,T="user-content-",k=!0,$=!1,W={},F=null,K=pt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),V=null,U=pt({},["audio","video","img","source","image","track"]),X=null,z=pt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Q="http://www.w3.org/1998/Math/MathML",de="http://www.w3.org/2000/svg",Ee="http://www.w3.org/1999/xhtml",Fe=Ee,ct=!1,dt,Ft=["application/xhtml+xml","text/html"],Je="text/html",xe,Ot=null,Tt=n.createElement("form"),yt=function(G){return G instanceof RegExp||G instanceof Function},er=function(G){Ot&&Ot===G||((!G||gs(G)!=="object")&&(G={}),G=ol(G),dt=Ft.indexOf(G.PARSER_MEDIA_TYPE)===-1?dt=Je:dt=G.PARSER_MEDIA_TYPE,xe=dt==="application/xhtml+xml"?function(fe){return fe}:B1,w="ALLOWED_TAGS"in G?pt({},G.ALLOWED_TAGS,xe):_,M="ALLOWED_ATTR"in G?pt({},G.ALLOWED_ATTR,xe):L,X="ADD_URI_SAFE_ATTR"in G?pt(ol(z),G.ADD_URI_SAFE_ATTR,xe):z,V="ADD_DATA_URI_TAGS"in G?pt(ol(U),G.ADD_DATA_URI_TAGS,xe):U,F="FORBID_CONTENTS"in G?pt({},G.FORBID_CONTENTS,xe):K,Z="FORBID_TAGS"in G?pt({},G.FORBID_TAGS,xe):{},te="FORBID_ATTR"in G?pt({},G.FORBID_ATTR,xe):{},W="USE_PROFILES"in G?G.USE_PROFILES:!1,ie=G.ALLOW_ARIA_ATTR!==!1,oe=G.ALLOW_DATA_ATTR!==!1,ve=G.ALLOW_UNKNOWN_PROTOCOLS||!1,ke=G.SAFE_FOR_TEMPLATES||!1,pe=G.WHOLE_DOCUMENT||!1,Ve=G.RETURN_DOM||!1,Ze=G.RETURN_DOM_FRAGMENT||!1,Ge=G.RETURN_TRUSTED_TYPE||!1,re=G.FORCE_BODY||!1,je=G.SANITIZE_DOM!==!1,ze=G.SANITIZE_NAMED_PROPS||!1,k=G.KEEP_CONTENT!==!1,$=G.IN_PLACE||!1,b=G.ALLOWED_URI_REGEXP||b,Fe=G.NAMESPACE||Ee,G.CUSTOM_ELEMENT_HANDLING&&yt(G.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(H.tagNameCheck=G.CUSTOM_ELEMENT_HANDLING.tagNameCheck),G.CUSTOM_ELEMENT_HANDLING&&yt(G.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(H.attributeNameCheck=G.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),G.CUSTOM_ELEMENT_HANDLING&&typeof G.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(H.allowCustomizedBuiltInElements=G.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ke&&(oe=!1),Ze&&(Ve=!0),W&&(w=pt({},Hi(KP)),M=[],W.html===!0&&(pt(w,YP),pt(M,XP)),W.svg===!0&&(pt(w,XS),pt(M,ZS),pt(M,Sy)),W.svgFilters===!0&&(pt(w,qS),pt(M,ZS),pt(M,Sy)),W.mathMl===!0&&(pt(w,QS),pt(M,qP),pt(M,Sy))),G.ADD_TAGS&&(w===_&&(w=ol(w)),pt(w,G.ADD_TAGS,xe)),G.ADD_ATTR&&(M===L&&(M=ol(M)),pt(M,G.ADD_ATTR,xe)),G.ADD_URI_SAFE_ATTR&&pt(X,G.ADD_URI_SAFE_ATTR,xe),G.FORBID_CONTENTS&&(F===K&&(F=ol(F)),pt(F,G.FORBID_CONTENTS,xe)),k&&(w["#text"]=!0),pe&&pt(w,["html","head","body"]),w.table&&(pt(w,["tbody"]),delete Z.tbody),In&&In(G),Ot=G)},_t=pt({},["mi","mo","mn","ms","mtext"]),pr=pt({},["foreignobject","desc","title","annotation-xml"]),Gt=pt({},["title","style","font","a","script"]),At=pt({},XS);pt(At,qS),pt(At,gue);var wt=pt({},QS);pt(wt,yue);var Vu=function(G){var fe=R(G);(!fe||!fe.tagName)&&(fe={namespaceURI:Ee,tagName:"template"});var Te=B1(G.tagName),Pt=B1(fe.tagName);return G.namespaceURI===de?fe.namespaceURI===Ee?Te==="svg":fe.namespaceURI===Q?Te==="svg"&&(Pt==="annotation-xml"||_t[Pt]):!!At[Te]:G.namespaceURI===Q?fe.namespaceURI===Ee?Te==="math":fe.namespaceURI===de?Te==="math"&&pr[Pt]:!!wt[Te]:G.namespaceURI===Ee?fe.namespaceURI===de&&!pr[Pt]||fe.namespaceURI===Q&&!_t[Pt]?!1:!wt[Te]&&(Gt[Te]||!At[Te]):!1},ln=function(G){Ud(e.removed,{element:G});try{G.parentNode.removeChild(G)}catch{try{G.outerHTML=A}catch{G.remove()}}},Pd=function(G,fe){try{Ud(e.removed,{attribute:fe.getAttributeNode(G),from:fe})}catch{Ud(e.removed,{attribute:null,from:fe})}if(fe.removeAttribute(G),G==="is"&&!M[G])if(Ve||Ze)try{ln(fe)}catch{}else try{fe.setAttribute(G,"")}catch{}},t4=function(G){var fe,Te;if(re)G="<remove></remove>"+G;else{var Pt=due(G,/^[\r\n\t ]+/);Te=Pt&&Pt[0]}dt==="application/xhtml+xml"&&(G='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+G+"</body></html>");var Pn=O?O.createHTML(G):G;if(Fe===Ee)try{fe=new h().parseFromString(Pn,dt)}catch{}if(!fe||!fe.documentElement){fe=j.createDocument(Fe,"template",null);try{fe.documentElement.innerHTML=ct?"":Pn}catch{}}var un=fe.body||fe.documentElement;return G&&Te&&un.insertBefore(n.createTextNode(Te),un.childNodes[0]||null),Fe===Ee?q.call(fe,pe?"html":"body")[0]:pe?fe.documentElement:un},r4=function(G){return J.call(G.ownerDocument||G,G,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},_Y=function(G){return G instanceof f&&(typeof G.nodeName!="string"||typeof G.textContent!="string"||typeof G.removeChild!="function"||!(G.attributes instanceof c)||typeof G.removeAttribute!="function"||typeof G.setAttribute!="function"||typeof G.namespaceURI!="string"||typeof G.insertBefore!="function")},Md=function(G){return gs(a)==="object"?G instanceof a:G&&gs(G)==="object"&&typeof G.nodeType=="number"&&typeof G.nodeName=="string"},zo=function(G,fe,Te){ne[G]&&hue(ne[G],function(Pt){Pt.call(e,fe,Te,Ot)})},n4=function(G){var fe;if(zo("beforeSanitizeElements",G,null),_Y(G)||wn(/[\u0080-\uFFFF]/,G.nodeName))return ln(G),!0;var Te=xe(G.nodeName);if(zo("uponSanitizeElement",G,{tagName:Te,allowedTags:w}),G.hasChildNodes()&&!Md(G.firstElementChild)&&(!Md(G.content)||!Md(G.content.firstElementChild))&&wn(/<[/\w]/g,G.innerHTML)&&wn(/<[/\w]/g,G.textContent)||Te==="select"&&wn(/<template/i,G.innerHTML))return ln(G),!0;if(!w[Te]||Z[Te]){if(!Z[Te]&&o4(Te)&&(H.tagNameCheck instanceof RegExp&&wn(H.tagNameCheck,Te)||H.tagNameCheck instanceof Function&&H.tagNameCheck(Te)))return!1;if(k&&!F[Te]){var Pt=R(G)||G.parentNode,Pn=S(G)||G.childNodes;if(Pn&&Pt)for(var un=Pn.length,tn=un-1;tn>=0;--tn)Pt.insertBefore(m(Pn[tn],!0),y(G))}return ln(G),!0}return G instanceof s&&!Vu(G)||(Te==="noscript"||Te==="noembed")&&wn(/<\/no(script|embed)/i,G.innerHTML)?(ln(G),!0):(ke&&G.nodeType===3&&(fe=G.textContent,fe=es(fe,ue," "),fe=es(fe,me," "),G.textContent!==fe&&(Ud(e.removed,{element:G.cloneNode()}),G.textContent=fe)),zo("afterSanitizeElements",G,null),!1)},i4=function(G,fe,Te){if(je&&(fe==="id"||fe==="name")&&(Te in n||Te in Tt))return!1;if(!(oe&&!te[fe]&&wn(Re,fe))){if(!(ie&&wn(ge,fe))){if(!M[fe]||te[fe]){if(!(o4(G)&&(H.tagNameCheck instanceof RegExp&&wn(H.tagNameCheck,G)||H.tagNameCheck instanceof Function&&H.tagNameCheck(G))&&(H.attributeNameCheck instanceof RegExp&&wn(H.attributeNameCheck,fe)||H.attributeNameCheck instanceof Function&&H.attributeNameCheck(fe))||fe==="is"&&H.allowCustomizedBuiltInElements&&(H.tagNameCheck instanceof RegExp&&wn(H.tagNameCheck,Te)||H.tagNameCheck instanceof Function&&H.tagNameCheck(Te))))return!1}else if(!X[fe]){if(!wn(b,es(Te,v,""))){if(!((fe==="src"||fe==="xlink:href"||fe==="href")&&G!=="script"&&pue(Te,"data:")===0&&V[G])){if(!(ve&&!wn(I,es(Te,v,"")))){if(Te)return!1}}}}}}return!0},o4=function(G){return G.indexOf("-")>0},a4=function(G){var fe,Te,Pt,Pn;zo("beforeSanitizeAttributes",G,null);var un=G.attributes;if(un){var tn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:M};for(Pn=un.length;Pn--;){fe=un[Pn];var oy=fe,cn=oy.name,qw=oy.namespaceURI;if(Te=cn==="value"?fe.value:mue(fe.value),Pt=xe(cn),tn.attrName=Pt,tn.attrValue=Te,tn.keepAttr=!0,tn.forceKeepAttr=void 0,zo("uponSanitizeAttribute",G,tn),Te=tn.attrValue,!tn.forceKeepAttr&&(Pd(cn,G),!!tn.keepAttr)){if(wn(/\/>/i,Te)){Pd(cn,G);continue}ke&&(Te=es(Te,ue," "),Te=es(Te,me," "));var s4=xe(G.nodeName);if(i4(s4,Pt,Te)){if(ze&&(Pt==="id"||Pt==="name")&&(Pd(cn,G),Te=T+Te),O&&gs(d)==="object"&&typeof d.getAttributeType=="function"&&!qw)switch(d.getAttributeType(s4,Pt)){case"TrustedHTML":Te=O.createHTML(Te);break;case"TrustedScriptURL":Te=O.createScriptURL(Te);break}try{qw?G.setAttributeNS(qw,cn,Te):G.setAttribute(cn,Te),zP(e.removed)}catch{}}}}zo("afterSanitizeAttributes",G,null)}},AY=function He(G){var fe,Te=r4(G);for(zo("beforeSanitizeShadowDOM",G,null);fe=Te.nextNode();)zo("uponSanitizeShadowNode",fe,null),!n4(fe)&&(fe.content instanceof i&&He(fe.content),a4(fe));zo("afterSanitizeShadowDOM",G,null)};return e.sanitize=function(He){var G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},fe,Te,Pt,Pn,un;if(ct=!He,ct&&(He="<!-->"),typeof He!="string"&&!Md(He)){if(typeof He.toString!="function")throw KS("toString is not a function");if(He=He.toString(),typeof He!="string")throw KS("dirty is not a string, aborting")}if(!e.isSupported){if(gs(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof He=="string")return t.toStaticHTML(He);if(Md(He))return t.toStaticHTML(He.outerHTML)}return He}if(Ce||er(G),e.removed=[],typeof He=="string"&&($=!1),$){if(He.nodeName){var tn=xe(He.nodeName);if(!w[tn]||Z[tn])throw KS("root node is forbidden and cannot be sanitized in-place")}}else if(He instanceof a)fe=t4("<!---->"),Te=fe.ownerDocument.importNode(He,!0),Te.nodeType===1&&Te.nodeName==="BODY"||Te.nodeName==="HTML"?fe=Te:fe.appendChild(Te);else{if(!Ve&&!ke&&!pe&&He.indexOf("<")===-1)return O&&Ge?O.createHTML(He):He;if(fe=t4(He),!fe)return Ve?null:Ge?A:""}fe&&re&&ln(fe.firstChild);for(var oy=r4($?He:fe);Pt=oy.nextNode();)Pt.nodeType===3&&Pt===Pn||n4(Pt)||(Pt.content instanceof i&&AY(Pt.content),a4(Pt),Pn=Pt);if(Pn=null,$)return He;if(Ve){if(Ze)for(un=Y.call(fe.ownerDocument);fe.firstChild;)un.appendChild(fe.firstChild);else un=fe;return M.shadowroot&&(un=ee.call(r,un,!0)),un}var cn=pe?fe.outerHTML:fe.innerHTML;return pe&&w["!doctype"]&&fe.ownerDocument&&fe.ownerDocument.doctype&&fe.ownerDocument.doctype.name&&wn(Tue,fe.ownerDocument.doctype.name)&&(cn="<!DOCTYPE "+fe.ownerDocument.doctype.name+`>
`+cn),ke&&(cn=es(cn,ue," "),cn=es(cn,me," ")),O&&Ge?O.createHTML(cn):cn},e.setConfig=function(He){er(He),Ce=!0},e.clearConfig=function(){Ot=null,Ce=!1},e.isValidAttribute=function(He,G,fe){Ot||er({});var Te=xe(He),Pt=xe(G);return i4(Te,Pt,fe)},e.addHook=function(He,G){typeof G=="function"&&(ne[He]=ne[He]||[],Ud(ne[He],G))},e.removeHook=function(He){if(ne[He])return zP(ne[He])},e.removeHooks=function(He){ne[He]&&(ne[He]=[])},e.removeAllHooks=function(){ne={}},e}var Iue=GF(),Nue=Ye,Pue=s_.codeAt;Nue({target:"String",proto:!0},{codePointAt:function(e){return Pue(this,e)}});var Mue=Ks,kue=Dr,xue=Yn,$ue=RangeError,T_=function(e){var r=kue(xue(this)),n="",i=Mue(e);if(i<0||i==1/0)throw $ue("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(r+=r))i&1&&(n+=r);return n},zF=rt,Lue=ku,QP=Dr,Due=T_,Fue=Yn,Hue=zF(Due),Uue=zF("".slice),Bue=Math.ceil,ZP=function(t){return function(e,r,n){var i=QP(Fue(e)),o=Lue(r),a=i.length,s=n===void 0?" ":QP(n),l,u;return o<=a||s==""?i:(l=o-a,u=Hue(s,Bue(l/s.length)),u.length>l&&(u=Uue(u,0,l)),t?i+u:u+i)}},Vue={start:ZP(!1),end:ZP(!0)},jue=Iu,Wue=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(jue),Gue=Ye,zue=Vue.start,Yue=Wue;Gue({target:"String",proto:!0,forced:Yue},{padStart:function(e){return zue(this,e,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var YF;function se(){return YF.apply(null,arguments)}function Kue(t){YF=t}function eo(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function au(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function It(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function __(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(It(t,e))return!1;return!0}function kn(t){return t===void 0}function ja(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function xg(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function KF(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function Ss(t,e){for(var r in e)It(e,r)&&(t[r]=e[r]);return It(e,"toString")&&(t.toString=e.toString),It(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Vo(t,e,r,n){return yH(t,e,r,n,!0).utc()}function Xue(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ot(t){return t._pf==null&&(t._pf=Xue()),t._pf}var AE;Array.prototype.some?AE=Array.prototype.some:AE=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function A_(t){if(t._isValid==null){var e=ot(t),r=AE.call(e.parsedDateParts,function(i){return i!=null}),n=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r);if(t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n}return t._isValid}function j2(t){var e=Vo(NaN);return t!=null?Ss(ot(e),t):ot(e).userInvalidated=!0,e}var JP=se.momentProperties=[],JS=!1;function I_(t,e){var r,n,i,o=JP.length;if(kn(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),kn(e._i)||(t._i=e._i),kn(e._f)||(t._f=e._f),kn(e._l)||(t._l=e._l),kn(e._strict)||(t._strict=e._strict),kn(e._tzm)||(t._tzm=e._tzm),kn(e._isUTC)||(t._isUTC=e._isUTC),kn(e._offset)||(t._offset=e._offset),kn(e._pf)||(t._pf=ot(e)),kn(e._locale)||(t._locale=e._locale),o>0)for(r=0;r<o;r++)n=JP[r],i=e[n],kn(i)||(t[n]=i);return t}function $g(t){I_(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),JS===!1&&(JS=!0,se.updateOffset(this),JS=!1)}function to(t){return t instanceof $g||t!=null&&t._isAMomentObject!=null}function XF(t){se.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function ki(t,e){var r=!0;return Ss(function(){if(se.deprecationHandler!=null&&se.deprecationHandler(null,t),r){var n=[],i,o,a,s=arguments.length;for(o=0;o<s;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(a in arguments[0])It(arguments[0],a)&&(i+=a+": "+arguments[0][a]+", ");i=i.slice(0,-2)}else i=arguments[o];n.push(i)}XF(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var e8={};function qF(t,e){se.deprecationHandler!=null&&se.deprecationHandler(t,e),e8[t]||(XF(e),e8[t]=!0)}se.suppressDeprecationWarnings=!1;se.deprecationHandler=null;function jo(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function que(t){var e,r;for(r in t)It(t,r)&&(e=t[r],jo(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function IE(t,e){var r=Ss({},t),n;for(n in e)It(e,n)&&(au(t[n])&&au(e[n])?(r[n]={},Ss(r[n],t[n]),Ss(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)It(t,n)&&!It(e,n)&&au(t[n])&&(r[n]=Ss({},r[n]));return r}function N_(t){t!=null&&this.set(t)}var NE;Object.keys?NE=Object.keys:NE=function(t){var e,r=[];for(e in t)It(t,e)&&r.push(e);return r};var Que={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Zue(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return jo(n)?n.call(e,r):n}function xo(t,e,r){var n=""+Math.abs(t),i=e-n.length,o=t>=0;return(o?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var P_=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ry=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,e6={},Vc={};function We(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(Vc[t]=i),e&&(Vc[e[0]]=function(){return xo(i.apply(this,arguments),e[1],e[2])}),r&&(Vc[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function Jue(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function ece(t){var e=t.match(P_),r,n;for(r=0,n=e.length;r<n;r++)Vc[e[r]]?e[r]=Vc[e[r]]:e[r]=Jue(e[r]);return function(i){var o="",a;for(a=0;a<n;a++)o+=jo(e[a])?e[a].call(i,t):e[a];return o}}function V1(t,e){return t.isValid()?(e=QF(e,t.localeData()),e6[e]=e6[e]||ece(e),e6[e](t)):t.localeData().invalidDate()}function QF(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(Ry.lastIndex=0;r>=0&&Ry.test(t);)t=t.replace(Ry,n),Ry.lastIndex=0,r-=1;return t}var tce={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function rce(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(P_).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var nce="Invalid date";function ice(){return this._invalidDate}var oce="%d",ace=/\d{1,2}/;function sce(t){return this._ordinal.replace("%d",t)}var lce={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function uce(t,e,r,n){var i=this._relativeTime[r];return jo(i)?i(t,e,r,n):i.replace(/%d/i,t)}function cce(t,e){var r=this._relativeTime[t>0?"future":"past"];return jo(r)?r(e):r.replace(/%s/i,e)}var Op={};function yn(t,e){var r=t.toLowerCase();Op[r]=Op[r+"s"]=Op[e]=t}function xi(t){return typeof t=="string"?Op[t]||Op[t.toLowerCase()]:void 0}function M_(t){var e={},r,n;for(n in t)It(t,n)&&(r=xi(n),r&&(e[r]=t[n]));return e}var ZF={};function bn(t,e){ZF[t]=e}function fce(t){var e=[],r;for(r in t)It(t,r)&&e.push({unit:r,priority:ZF[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}function W2(t){return t%4===0&&t%100!==0||t%400===0}function Ei(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function vt(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Ei(e)),r}function Sd(t,e){return function(r){return r!=null?(JF(this,t,r),se.updateOffset(this,e),this):B0(this,t)}}function B0(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function JF(t,e,r){t.isValid()&&!isNaN(r)&&(e==="FullYear"&&W2(t.year())&&t.month()===1&&t.date()===29?(r=vt(r),t._d["set"+(t._isUTC?"UTC":"")+e](r,t.month(),q2(r,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](r))}function hce(t){return t=xi(t),jo(this[t])?this[t]():this}function dce(t,e){if(typeof t=="object"){t=M_(t);var r=fce(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=xi(t),jo(this[t]))return this[t](e);return this}var eH=/\d/,pi=/\d\d/,tH=/\d{3}/,k_=/\d{4}/,G2=/[+-]?\d{6}/,Jt=/\d\d?/,rH=/\d\d\d\d?/,nH=/\d\d\d\d\d\d?/,z2=/\d{1,3}/,x_=/\d{1,4}/,Y2=/[+-]?\d{1,6}/,Rd=/\d+/,K2=/[+-]?\d+/,pce=/Z|[+-]\d\d:?\d\d/gi,X2=/Z|[+-]\d\d(?::?\d\d)?/gi,mce=/[+-]?\d+(\.\d{1,3})?/,Lg=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,V0;V0={};function Me(t,e,r){V0[t]=jo(e)?e:function(n,i){return n&&r?r:e}}function vce(t,e){return It(V0,t)?V0[t](e._strict,e._locale):new RegExp(gce(t))}function gce(t){return oi(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,o){return r||n||i||o}))}function oi(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var PE={};function jt(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),ja(e)&&(n=function(o,a){a[e]=vt(o)}),i=t.length,r=0;r<i;r++)PE[t[r]]=n}function Dg(t,e){jt(t,function(r,n,i,o){i._w=i._w||{},e(r,i._w,i,o)})}function yce(t,e,r){e!=null&&It(PE,t)&&PE[t](e,r._a,r,t)}var vn=0,fa=1,To=2,Ur=3,Xi=4,ha=5,Il=6,bce=7,wce=8;function Sce(t,e){return(t%e+e)%e}var Tr;Array.prototype.indexOf?Tr=Array.prototype.indexOf:Tr=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function q2(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=Sce(e,12);return t+=(e-r)/12,r===1?W2(t)?29:28:31-r%7%2}We("M",["MM",2],"Mo",function(){return this.month()+1});We("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});We("MMMM",0,0,function(t){return this.localeData().months(this,t)});yn("month","M");bn("month",8);Me("M",Jt);Me("MM",Jt,pi);Me("MMM",function(t,e){return e.monthsShortRegex(t)});Me("MMMM",function(t,e){return e.monthsRegex(t)});jt(["M","MM"],function(t,e){e[fa]=vt(t)-1});jt(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[fa]=i:ot(r).invalidMonth=t});var Rce="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),iH="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),oH=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Ece=Lg,Cce=Lg;function Oce(t,e){return t?eo(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||oH).test(e)?"format":"standalone"][t.month()]:eo(this._months)?this._months:this._months.standalone}function Tce(t,e){return t?eo(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[oH.test(e)?"format":"standalone"][t.month()]:eo(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function _ce(t,e,r){var n,i,o,a=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=Vo([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return r?e==="MMM"?(i=Tr.call(this._shortMonthsParse,a),i!==-1?i:null):(i=Tr.call(this._longMonthsParse,a),i!==-1?i:null):e==="MMM"?(i=Tr.call(this._shortMonthsParse,a),i!==-1?i:(i=Tr.call(this._longMonthsParse,a),i!==-1?i:null)):(i=Tr.call(this._longMonthsParse,a),i!==-1?i:(i=Tr.call(this._shortMonthsParse,a),i!==-1?i:null))}function Ace(t,e,r){var n,i,o;if(this._monthsParseExact)return _ce.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=Vo([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function aH(t,e){var r;if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=vt(e);else if(e=t.localeData().monthsParse(e),!ja(e))return t}return r=Math.min(t.date(),q2(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,r),t}function sH(t){return t!=null?(aH(this,t),se.updateOffset(this,!0),this):B0(this,"Month")}function Ice(){return q2(this.year(),this.month())}function Nce(t){return this._monthsParseExact?(It(this,"_monthsRegex")||lH.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(It(this,"_monthsShortRegex")||(this._monthsShortRegex=Ece),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function Pce(t){return this._monthsParseExact?(It(this,"_monthsRegex")||lH.call(this),t?this._monthsStrictRegex:this._monthsRegex):(It(this,"_monthsRegex")||(this._monthsRegex=Cce),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function lH(){function t(a,s){return s.length-a.length}var e=[],r=[],n=[],i,o;for(i=0;i<12;i++)o=Vo([2e3,i]),e.push(this.monthsShort(o,"")),r.push(this.months(o,"")),n.push(this.months(o,"")),n.push(this.monthsShort(o,""));for(e.sort(t),r.sort(t),n.sort(t),i=0;i<12;i++)e[i]=oi(e[i]),r[i]=oi(r[i]);for(i=0;i<24;i++)n[i]=oi(n[i]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}We("Y",0,0,function(){var t=this.year();return t<=9999?xo(t,4):"+"+t});We(0,["YY",2],0,function(){return this.year()%100});We(0,["YYYY",4],0,"year");We(0,["YYYYY",5],0,"year");We(0,["YYYYYY",6,!0],0,"year");yn("year","y");bn("year",1);Me("Y",K2);Me("YY",Jt,pi);Me("YYYY",x_,k_);Me("YYYYY",Y2,G2);Me("YYYYYY",Y2,G2);jt(["YYYYY","YYYYYY"],vn);jt("YYYY",function(t,e){e[vn]=t.length===2?se.parseTwoDigitYear(t):vt(t)});jt("YY",function(t,e){e[vn]=se.parseTwoDigitYear(t)});jt("Y",function(t,e){e[vn]=parseInt(t,10)});function Tp(t){return W2(t)?366:365}se.parseTwoDigitYear=function(t){return vt(t)+(vt(t)>68?1900:2e3)};var uH=Sd("FullYear",!0);function Mce(){return W2(this.year())}function kce(t,e,r,n,i,o,a){var s;return t<100&&t>=0?(s=new Date(t+400,e,r,n,i,o,a),isFinite(s.getFullYear())&&s.setFullYear(t)):s=new Date(t,e,r,n,i,o,a),s}function Jp(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function j0(t,e,r){var n=7+e-r,i=(7+Jp(t,0,n).getUTCDay()-e)%7;return-i+n-1}function cH(t,e,r,n,i){var o=(7+r-n)%7,a=j0(t,n,i),s=1+7*(e-1)+o+a,l,u;return s<=0?(l=t-1,u=Tp(l)+s):s>Tp(t)?(l=t+1,u=s-Tp(t)):(l=t,u=s),{year:l,dayOfYear:u}}function em(t,e,r){var n=j0(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,o,a;return i<1?(a=t.year()-1,o=i+Da(a,e,r)):i>Da(t.year(),e,r)?(o=i-Da(t.year(),e,r),a=t.year()+1):(a=t.year(),o=i),{week:o,year:a}}function Da(t,e,r){var n=j0(t,e,r),i=j0(t+1,e,r);return(Tp(t)-n+i)/7}We("w",["ww",2],"wo","week");We("W",["WW",2],"Wo","isoWeek");yn("week","w");yn("isoWeek","W");bn("week",5);bn("isoWeek",5);Me("w",Jt);Me("ww",Jt,pi);Me("W",Jt);Me("WW",Jt,pi);Dg(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=vt(t)});function xce(t){return em(t,this._week.dow,this._week.doy).week}var $ce={dow:0,doy:6};function Lce(){return this._week.dow}function Dce(){return this._week.doy}function Fce(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function Hce(t){var e=em(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}We("d",0,"do","day");We("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});We("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});We("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});We("e",0,0,"weekday");We("E",0,0,"isoWeekday");yn("day","d");yn("weekday","e");yn("isoWeekday","E");bn("day",11);bn("weekday",11);bn("isoWeekday",11);Me("d",Jt);Me("e",Jt);Me("E",Jt);Me("dd",function(t,e){return e.weekdaysMinRegex(t)});Me("ddd",function(t,e){return e.weekdaysShortRegex(t)});Me("dddd",function(t,e){return e.weekdaysRegex(t)});Dg(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:ot(r).invalidWeekday=t});Dg(["d","e","E"],function(t,e,r,n){e[n]=vt(t)});function Uce(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function Bce(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function $_(t,e){return t.slice(e,7).concat(t.slice(0,e))}var Vce="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),fH="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),jce="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Wce=Lg,Gce=Lg,zce=Lg;function Yce(t,e){var r=eo(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?$_(r,this._week.dow):t?r[t.day()]:r}function Kce(t){return t===!0?$_(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function Xce(t){return t===!0?$_(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function qce(t,e,r){var n,i,o,a=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=Vo([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return r?e==="dddd"?(i=Tr.call(this._weekdaysParse,a),i!==-1?i:null):e==="ddd"?(i=Tr.call(this._shortWeekdaysParse,a),i!==-1?i:null):(i=Tr.call(this._minWeekdaysParse,a),i!==-1?i:null):e==="dddd"?(i=Tr.call(this._weekdaysParse,a),i!==-1||(i=Tr.call(this._shortWeekdaysParse,a),i!==-1)?i:(i=Tr.call(this._minWeekdaysParse,a),i!==-1?i:null)):e==="ddd"?(i=Tr.call(this._shortWeekdaysParse,a),i!==-1||(i=Tr.call(this._weekdaysParse,a),i!==-1)?i:(i=Tr.call(this._minWeekdaysParse,a),i!==-1?i:null)):(i=Tr.call(this._minWeekdaysParse,a),i!==-1||(i=Tr.call(this._weekdaysParse,a),i!==-1)?i:(i=Tr.call(this._shortWeekdaysParse,a),i!==-1?i:null))}function Qce(t,e,r){var n,i,o;if(this._weekdaysParseExact)return qce.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=Vo([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function Zce(t){if(!this.isValid())return t!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=Uce(t,this.localeData()),this.add(t-e,"d")):e}function Jce(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function efe(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=Bce(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function tfe(t){return this._weekdaysParseExact?(It(this,"_weekdaysRegex")||L_.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(It(this,"_weekdaysRegex")||(this._weekdaysRegex=Wce),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function rfe(t){return this._weekdaysParseExact?(It(this,"_weekdaysRegex")||L_.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(It(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Gce),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function nfe(t){return this._weekdaysParseExact?(It(this,"_weekdaysRegex")||L_.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(It(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=zce),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function L_(){function t(c,f){return f.length-c.length}var e=[],r=[],n=[],i=[],o,a,s,l,u;for(o=0;o<7;o++)a=Vo([2e3,1]).day(o),s=oi(this.weekdaysMin(a,"")),l=oi(this.weekdaysShort(a,"")),u=oi(this.weekdays(a,"")),e.push(s),r.push(l),n.push(u),i.push(s),i.push(l),i.push(u);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function D_(){return this.hours()%12||12}function ife(){return this.hours()||24}We("H",["HH",2],0,"hour");We("h",["hh",2],0,D_);We("k",["kk",2],0,ife);We("hmm",0,0,function(){return""+D_.apply(this)+xo(this.minutes(),2)});We("hmmss",0,0,function(){return""+D_.apply(this)+xo(this.minutes(),2)+xo(this.seconds(),2)});We("Hmm",0,0,function(){return""+this.hours()+xo(this.minutes(),2)});We("Hmmss",0,0,function(){return""+this.hours()+xo(this.minutes(),2)+xo(this.seconds(),2)});function hH(t,e){We(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}hH("a",!0);hH("A",!1);yn("hour","h");bn("hour",13);function dH(t,e){return e._meridiemParse}Me("a",dH);Me("A",dH);Me("H",Jt);Me("h",Jt);Me("k",Jt);Me("HH",Jt,pi);Me("hh",Jt,pi);Me("kk",Jt,pi);Me("hmm",rH);Me("hmmss",nH);Me("Hmm",rH);Me("Hmmss",nH);jt(["H","HH"],Ur);jt(["k","kk"],function(t,e,r){var n=vt(t);e[Ur]=n===24?0:n});jt(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});jt(["h","hh"],function(t,e,r){e[Ur]=vt(t),ot(r).bigHour=!0});jt("hmm",function(t,e,r){var n=t.length-2;e[Ur]=vt(t.substr(0,n)),e[Xi]=vt(t.substr(n)),ot(r).bigHour=!0});jt("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[Ur]=vt(t.substr(0,n)),e[Xi]=vt(t.substr(n,2)),e[ha]=vt(t.substr(i)),ot(r).bigHour=!0});jt("Hmm",function(t,e,r){var n=t.length-2;e[Ur]=vt(t.substr(0,n)),e[Xi]=vt(t.substr(n))});jt("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[Ur]=vt(t.substr(0,n)),e[Xi]=vt(t.substr(n,2)),e[ha]=vt(t.substr(i))});function ofe(t){return(t+"").toLowerCase().charAt(0)==="p"}var afe=/[ap]\.?m?\.?/i,sfe=Sd("Hours",!0);function lfe(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var pH={calendar:Que,longDateFormat:tce,invalidDate:nce,ordinal:oce,dayOfMonthOrdinalParse:ace,relativeTime:lce,months:Rce,monthsShort:iH,week:$ce,weekdays:Vce,weekdaysMin:jce,weekdaysShort:fH,meridiemParse:afe},rr={},Bd={},tm;function ufe(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function t8(t){return t&&t.toLowerCase().replace("_","-")}function cfe(t){for(var e=0,r,n,i,o;e<t.length;){for(o=t8(t[e]).split("-"),r=o.length,n=t8(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=Q2(o.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&ufe(o,n)>=r-1)break;r--}e++}return tm}function ffe(t){return t.match("^[^/\\\\]*$")!=null}function Q2(t){var e=null,r;if(rr[t]===void 0&&typeof module<"u"&&module&&module.exports&&ffe(t))try{e=tm._abbr,r=kY,r("./locale/"+t),Is(e)}catch{rr[t]=null}return rr[t]}function Is(t,e){var r;return t&&(kn(e)?r=Xa(t):r=F_(t,e),r?tm=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),tm._abbr}function F_(t,e){if(e!==null){var r,n=pH;if(e.abbr=t,rr[t]!=null)qF("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=rr[t]._config;else if(e.parentLocale!=null)if(rr[e.parentLocale]!=null)n=rr[e.parentLocale]._config;else if(r=Q2(e.parentLocale),r!=null)n=r._config;else return Bd[e.parentLocale]||(Bd[e.parentLocale]=[]),Bd[e.parentLocale].push({name:t,config:e}),null;return rr[t]=new N_(IE(n,e)),Bd[t]&&Bd[t].forEach(function(i){F_(i.name,i.config)}),Is(t),rr[t]}else return delete rr[t],null}function hfe(t,e){if(e!=null){var r,n,i=pH;rr[t]!=null&&rr[t].parentLocale!=null?rr[t].set(IE(rr[t]._config,e)):(n=Q2(t),n!=null&&(i=n._config),e=IE(i,e),n==null&&(e.abbr=t),r=new N_(e),r.parentLocale=rr[t],rr[t]=r),Is(t)}else rr[t]!=null&&(rr[t].parentLocale!=null?(rr[t]=rr[t].parentLocale,t===Is()&&Is(t)):rr[t]!=null&&delete rr[t]);return rr[t]}function Xa(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return tm;if(!eo(t)){if(e=Q2(t),e)return e;t=[t]}return cfe(t)}function dfe(){return NE(rr)}function H_(t){var e,r=t._a;return r&&ot(t).overflow===-2&&(e=r[fa]<0||r[fa]>11?fa:r[To]<1||r[To]>q2(r[vn],r[fa])?To:r[Ur]<0||r[Ur]>24||r[Ur]===24&&(r[Xi]!==0||r[ha]!==0||r[Il]!==0)?Ur:r[Xi]<0||r[Xi]>59?Xi:r[ha]<0||r[ha]>59?ha:r[Il]<0||r[Il]>999?Il:-1,ot(t)._overflowDayOfYear&&(e<vn||e>To)&&(e=To),ot(t)._overflowWeeks&&e===-1&&(e=bce),ot(t)._overflowWeekday&&e===-1&&(e=wce),ot(t).overflow=e),t}var pfe=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,mfe=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,vfe=/Z|[+-]\d\d(?::?\d\d)?/,Ey=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],t6=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],gfe=/^\/?Date\((-?\d+)/i,yfe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,bfe={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function mH(t){var e,r,n=t._i,i=pfe.exec(n)||mfe.exec(n),o,a,s,l,u=Ey.length,c=t6.length;if(i){for(ot(t).iso=!0,e=0,r=u;e<r;e++)if(Ey[e][1].exec(i[1])){a=Ey[e][0],o=Ey[e][2]!==!1;break}if(a==null){t._isValid=!1;return}if(i[3]){for(e=0,r=c;e<r;e++)if(t6[e][1].exec(i[3])){s=(i[2]||" ")+t6[e][0];break}if(s==null){t._isValid=!1;return}}if(!o&&s!=null){t._isValid=!1;return}if(i[4])if(vfe.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=a+(s||"")+(l||""),B_(t)}else t._isValid=!1}function wfe(t,e,r,n,i,o){var a=[Sfe(t),iH.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return o&&a.push(parseInt(o,10)),a}function Sfe(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function Rfe(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Efe(t,e,r){if(t){var n=fH.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return ot(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function Cfe(t,e,r){if(t)return bfe[t];if(e)return 0;var n=parseInt(r,10),i=n%100,o=(n-i)/100;return o*60+i}function vH(t){var e=yfe.exec(Rfe(t._i)),r;if(e){if(r=wfe(e[4],e[3],e[2],e[5],e[6],e[7]),!Efe(e[1],r,t))return;t._a=r,t._tzm=Cfe(e[8],e[9],e[10]),t._d=Jp.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),ot(t).rfc2822=!0}else t._isValid=!1}function Ofe(t){var e=gfe.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(mH(t),t._isValid===!1)delete t._isValid;else return;if(vH(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:se.createFromInputFallback(t)}se.createFromInputFallback=ki("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Tc(t,e,r){return t??e??r}function Tfe(t){var e=new Date(se.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function U_(t){var e,r,n=[],i,o,a;if(!t._d){for(i=Tfe(t),t._w&&t._a[To]==null&&t._a[fa]==null&&_fe(t),t._dayOfYear!=null&&(a=Tc(t._a[vn],i[vn]),(t._dayOfYear>Tp(a)||t._dayOfYear===0)&&(ot(t)._overflowDayOfYear=!0),r=Jp(a,0,t._dayOfYear),t._a[fa]=r.getUTCMonth(),t._a[To]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Ur]===24&&t._a[Xi]===0&&t._a[ha]===0&&t._a[Il]===0&&(t._nextDay=!0,t._a[Ur]=0),t._d=(t._useUTC?Jp:kce).apply(null,n),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Ur]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(ot(t).weekdayMismatch=!0)}}function _fe(t){var e,r,n,i,o,a,s,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,a=4,r=Tc(e.GG,t._a[vn],em(Zt(),1,4).year),n=Tc(e.W,1),i=Tc(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,a=t._locale._week.doy,u=em(Zt(),o,a),r=Tc(e.gg,t._a[vn],u.year),n=Tc(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),n<1||n>Da(r,o,a)?ot(t)._overflowWeeks=!0:l!=null?ot(t)._overflowWeekday=!0:(s=cH(r,n,i,o,a),t._a[vn]=s.year,t._dayOfYear=s.dayOfYear)}se.ISO_8601=function(){};se.RFC_2822=function(){};function B_(t){if(t._f===se.ISO_8601){mH(t);return}if(t._f===se.RFC_2822){vH(t);return}t._a=[],ot(t).empty=!0;var e=""+t._i,r,n,i,o,a,s=e.length,l=0,u,c;for(i=QF(t._f,t._locale).match(P_)||[],c=i.length,r=0;r<c;r++)o=i[r],n=(e.match(vce(o,t))||[])[0],n&&(a=e.substr(0,e.indexOf(n)),a.length>0&&ot(t).unusedInput.push(a),e=e.slice(e.indexOf(n)+n.length),l+=n.length),Vc[o]?(n?ot(t).empty=!1:ot(t).unusedTokens.push(o),yce(o,n,t)):t._strict&&!n&&ot(t).unusedTokens.push(o);ot(t).charsLeftOver=s-l,e.length>0&&ot(t).unusedInput.push(e),t._a[Ur]<=12&&ot(t).bigHour===!0&&t._a[Ur]>0&&(ot(t).bigHour=void 0),ot(t).parsedDateParts=t._a.slice(0),ot(t).meridiem=t._meridiem,t._a[Ur]=Afe(t._locale,t._a[Ur],t._meridiem),u=ot(t).era,u!==null&&(t._a[vn]=t._locale.erasConvertYear(u,t._a[vn])),U_(t),H_(t)}function Afe(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function Ife(t){var e,r,n,i,o,a,s=!1,l=t._f.length;if(l===0){ot(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,a=!1,e=I_({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],B_(e),A_(e)&&(a=!0),o+=ot(e).charsLeftOver,o+=ot(e).unusedTokens.length*10,ot(e).score=o,s?o<n&&(n=o,r=e):(n==null||o<n||a)&&(n=o,r=e,a&&(s=!0));Ss(t,r||e)}function Nfe(t){if(!t._d){var e=M_(t._i),r=e.day===void 0?e.date:e.day;t._a=KF([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),U_(t)}}function Pfe(t){var e=new $g(H_(gH(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function gH(t){var e=t._i,r=t._f;return t._locale=t._locale||Xa(t._l),e===null||r===void 0&&e===""?j2({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),to(e)?new $g(H_(e)):(xg(e)?t._d=e:eo(r)?Ife(t):r?B_(t):Mfe(t),A_(t)||(t._d=null),t))}function Mfe(t){var e=t._i;kn(e)?t._d=new Date(se.now()):xg(e)?t._d=new Date(e.valueOf()):typeof e=="string"?Ofe(t):eo(e)?(t._a=KF(e.slice(0),function(r){return parseInt(r,10)}),U_(t)):au(e)?Nfe(t):ja(e)?t._d=new Date(e):se.createFromInputFallback(t)}function yH(t,e,r,n,i){var o={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(au(t)&&__(t)||eo(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=r,o._i=t,o._f=e,o._strict=n,Pfe(o)}function Zt(t,e,r,n){return yH(t,e,r,n,!1)}var kfe=ki("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Zt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:j2()}),xfe=ki("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Zt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:j2()});function bH(t,e){var r,n;if(e.length===1&&eo(e[0])&&(e=e[0]),!e.length)return Zt();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function $fe(){var t=[].slice.call(arguments,0);return bH("isBefore",t)}function Lfe(){var t=[].slice.call(arguments,0);return bH("isAfter",t)}var Dfe=function(){return Date.now?Date.now():+new Date},Vd=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Ffe(t){var e,r=!1,n,i=Vd.length;for(e in t)if(It(t,e)&&!(Tr.call(Vd,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[Vd[n]]){if(r)return!1;parseFloat(t[Vd[n]])!==vt(t[Vd[n]])&&(r=!0)}return!0}function Hfe(){return this._isValid}function Ufe(){return no(NaN)}function Z2(t){var e=M_(t),r=e.year||0,n=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,a=e.day||0,s=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=Ffe(e),this._milliseconds=+c+u*1e3+l*6e4+s*1e3*60*60,this._days=+a+o*7,this._months=+i+n*3+r*12,this._data={},this._locale=Xa(),this._bubble()}function j1(t){return t instanceof Z2}function ME(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function Bfe(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,a;for(a=0;a<n;a++)vt(t[a])!==vt(e[a])&&o++;return o+i}function wH(t,e){We(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+xo(~~(r/60),2)+e+xo(~~r%60,2)})}wH("Z",":");wH("ZZ","");Me("Z",X2);Me("ZZ",X2);jt(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=V_(X2,t)});var Vfe=/([\+\-]|\d\d)/gi;function V_(t,e){var r=(e||"").match(t),n,i,o;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(Vfe)||["-",0,0],o=+(i[1]*60)+vt(i[2]),o===0?0:i[0]==="+"?o:-o)}function j_(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(to(t)||xg(t)?t.valueOf():Zt(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),se.updateOffset(r,!1),r):Zt(t).local()}function kE(t){return-Math.round(t._d.getTimezoneOffset())}se.updateOffset=function(){};function jfe(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=V_(X2,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=kE(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?EH(this,no(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,se.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:kE(this)}function Wfe(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function Gfe(t){return this.utcOffset(0,t)}function zfe(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(kE(this),"m")),this}function Yfe(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=V_(pce,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function Kfe(t){return this.isValid()?(t=t?Zt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function Xfe(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function qfe(){if(!kn(this._isDSTShifted))return this._isDSTShifted;var t={},e;return I_(t,this),t=gH(t),t._a?(e=t._isUTC?Vo(t._a):Zt(t._a),this._isDSTShifted=this.isValid()&&Bfe(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Qfe(){return this.isValid()?!this._isUTC:!1}function Zfe(){return this.isValid()?this._isUTC:!1}function SH(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Jfe=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,ehe=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function no(t,e){var r=t,n=null,i,o,a;return j1(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:ja(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=Jfe.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:vt(n[To])*i,h:vt(n[Ur])*i,m:vt(n[Xi])*i,s:vt(n[ha])*i,ms:vt(ME(n[Il]*1e3))*i}):(n=ehe.exec(t))?(i=n[1]==="-"?-1:1,r={y:al(n[2],i),M:al(n[3],i),w:al(n[4],i),d:al(n[5],i),h:al(n[6],i),m:al(n[7],i),s:al(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=the(Zt(r.from),Zt(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),o=new Z2(r),j1(t)&&It(t,"_locale")&&(o._locale=t._locale),j1(t)&&It(t,"_isValid")&&(o._isValid=t._isValid),o}no.fn=Z2.prototype;no.invalid=Ufe;function al(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function r8(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function the(t,e){var r;return t.isValid()&&e.isValid()?(e=j_(e,t),t.isBefore(e)?r=r8(t,e):(r=r8(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function RH(t,e){return function(r,n){var i,o;return n!==null&&!isNaN(+n)&&(qF(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=r,r=n,n=o),i=no(r,n),EH(this,i,t),this}}function EH(t,e,r,n){var i=e._milliseconds,o=ME(e._days),a=ME(e._months);t.isValid()&&(n=n??!0,a&&aH(t,B0(t,"Month")+a*r),o&&JF(t,"Date",B0(t,"Date")+o*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&se.updateOffset(t,o||a))}var rhe=RH(1,"add"),nhe=RH(-1,"subtract");function CH(t){return typeof t=="string"||t instanceof String}function ihe(t){return to(t)||xg(t)||CH(t)||ja(t)||ahe(t)||ohe(t)||t===null||t===void 0}function ohe(t){var e=au(t)&&!__(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,a=n.length;for(i=0;i<a;i+=1)o=n[i],r=r||It(t,o);return e&&r}function ahe(t){var e=eo(t),r=!1;return e&&(r=t.filter(function(n){return!ja(n)&&CH(t)}).length===0),e&&r}function she(t){var e=au(t)&&!__(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<n.length;i+=1)o=n[i],r=r||It(t,o);return e&&r}function lhe(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function uhe(t,e){arguments.length===1&&(arguments[0]?ihe(arguments[0])?(t=arguments[0],e=void 0):she(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||Zt(),n=j_(r,this).startOf("day"),i=se.calendarFormat(this,n)||"sameElse",o=e&&(jo(e[i])?e[i].call(this,r):e[i]);return this.format(o||this.localeData().calendar(i,this,Zt(r)))}function che(){return new $g(this)}function fhe(t,e){var r=to(t)?t:Zt(t);return this.isValid()&&r.isValid()?(e=xi(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function hhe(t,e){var r=to(t)?t:Zt(t);return this.isValid()&&r.isValid()?(e=xi(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function dhe(t,e,r,n){var i=to(t)?t:Zt(t),o=to(e)?e:Zt(e);return this.isValid()&&i.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(o,r):!this.isAfter(o,r))):!1}function phe(t,e){var r=to(t)?t:Zt(t),n;return this.isValid()&&r.isValid()?(e=xi(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function mhe(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function vhe(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function ghe(t,e,r){var n,i,o;if(!this.isValid())return NaN;if(n=j_(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=xi(e),e){case"year":o=W1(this,n)/12;break;case"month":o=W1(this,n);break;case"quarter":o=W1(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:Ei(o)}function W1(t,e){if(t.date()<e.date())return-W1(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,o;return e-n<0?(i=t.clone().add(r-1,"months"),o=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),o=(e-n)/(i-n)),-(r+o)||0}se.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";se.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function yhe(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function bhe(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?V1(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):jo(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",V1(r,"Z")):V1(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function whe(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(r+n+i+o)}function She(t){t||(t=this.isUtc()?se.defaultFormatUtc:se.defaultFormat);var e=V1(this,t);return this.localeData().postformat(e)}function Rhe(t,e){return this.isValid()&&(to(t)&&t.isValid()||Zt(t).isValid())?no({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Ehe(t){return this.from(Zt(),t)}function Che(t,e){return this.isValid()&&(to(t)&&t.isValid()||Zt(t).isValid())?no({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Ohe(t){return this.to(Zt(),t)}function OH(t){var e;return t===void 0?this._locale._abbr:(e=Xa(t),e!=null&&(this._locale=e),this)}var TH=ki("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function _H(){return this._locale}var W0=1e3,jc=60*W0,G0=60*jc,AH=(365*400+97)*24*G0;function Wc(t,e){return(t%e+e)%e}function IH(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-AH:new Date(t,e,r).valueOf()}function NH(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-AH:Date.UTC(t,e,r)}function The(t){var e,r;if(t=xi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?NH:IH,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Wc(e+(this._isUTC?0:this.utcOffset()*jc),G0);break;case"minute":e=this._d.valueOf(),e-=Wc(e,jc);break;case"second":e=this._d.valueOf(),e-=Wc(e,W0);break}return this._d.setTime(e),se.updateOffset(this,!0),this}function _he(t){var e,r;if(t=xi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?NH:IH,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=G0-Wc(e+(this._isUTC?0:this.utcOffset()*jc),G0)-1;break;case"minute":e=this._d.valueOf(),e+=jc-Wc(e,jc)-1;break;case"second":e=this._d.valueOf(),e+=W0-Wc(e,W0)-1;break}return this._d.setTime(e),se.updateOffset(this,!0),this}function Ahe(){return this._d.valueOf()-(this._offset||0)*6e4}function Ihe(){return Math.floor(this.valueOf()/1e3)}function Nhe(){return new Date(this.valueOf())}function Phe(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function Mhe(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function khe(){return this.isValid()?this.toISOString():null}function xhe(){return A_(this)}function $he(){return Ss({},ot(this))}function Lhe(){return ot(this).overflow}function Dhe(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}We("N",0,0,"eraAbbr");We("NN",0,0,"eraAbbr");We("NNN",0,0,"eraAbbr");We("NNNN",0,0,"eraName");We("NNNNN",0,0,"eraNarrow");We("y",["y",1],"yo","eraYear");We("y",["yy",2],0,"eraYear");We("y",["yyy",3],0,"eraYear");We("y",["yyyy",4],0,"eraYear");Me("N",W_);Me("NN",W_);Me("NNN",W_);Me("NNNN",Khe);Me("NNNNN",Xhe);jt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?ot(r).era=i:ot(r).invalidEra=t});Me("y",Rd);Me("yy",Rd);Me("yyy",Rd);Me("yyyy",Rd);Me("yo",qhe);jt(["y","yy","yyy","yyyy"],vn);jt(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[vn]=r._locale.eraYearOrdinalParse(t,i):e[vn]=parseInt(t,10)});function Fhe(t,e){var r,n,i,o=this._eras||Xa("en")._eras;for(r=0,n=o.length;r<n;++r){switch(typeof o[r].since){case"string":i=se(o[r].since).startOf("day"),o[r].since=i.valueOf();break}switch(typeof o[r].until){case"undefined":o[r].until=1/0;break;case"string":i=se(o[r].until).startOf("day").valueOf(),o[r].until=i.valueOf();break}}return o}function Hhe(t,e,r){var n,i,o=this.eras(),a,s,l;for(t=t.toUpperCase(),n=0,i=o.length;n<i;++n)if(a=o[n].name.toUpperCase(),s=o[n].abbr.toUpperCase(),l=o[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(s===t)return o[n];break;case"NNNN":if(a===t)return o[n];break;case"NNNNN":if(l===t)return o[n];break}else if([a,s,l].indexOf(t)>=0)return o[n]}function Uhe(t,e){var r=t.since<=t.until?1:-1;return e===void 0?se(t.since).year():se(t.since).year()+(e-t.offset)*r}function Bhe(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function Vhe(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function jhe(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function Whe(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-se(i[t].since).year())*r+i[t].offset;return this.year()}function Ghe(t){return It(this,"_erasNameRegex")||G_.call(this),t?this._erasNameRegex:this._erasRegex}function zhe(t){return It(this,"_erasAbbrRegex")||G_.call(this),t?this._erasAbbrRegex:this._erasRegex}function Yhe(t){return It(this,"_erasNarrowRegex")||G_.call(this),t?this._erasNarrowRegex:this._erasRegex}function W_(t,e){return e.erasAbbrRegex(t)}function Khe(t,e){return e.erasNameRegex(t)}function Xhe(t,e){return e.erasNarrowRegex(t)}function qhe(t,e){return e._eraYearOrdinalRegex||Rd}function G_(){var t=[],e=[],r=[],n=[],i,o,a=this.eras();for(i=0,o=a.length;i<o;++i)e.push(oi(a[i].name)),t.push(oi(a[i].abbr)),r.push(oi(a[i].narrow)),n.push(oi(a[i].name)),n.push(oi(a[i].abbr)),n.push(oi(a[i].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}We(0,["gg",2],0,function(){return this.weekYear()%100});We(0,["GG",2],0,function(){return this.isoWeekYear()%100});function J2(t,e){We(0,[t,t.length],0,e)}J2("gggg","weekYear");J2("ggggg","weekYear");J2("GGGG","isoWeekYear");J2("GGGGG","isoWeekYear");yn("weekYear","gg");yn("isoWeekYear","GG");bn("weekYear",1);bn("isoWeekYear",1);Me("G",K2);Me("g",K2);Me("GG",Jt,pi);Me("gg",Jt,pi);Me("GGGG",x_,k_);Me("gggg",x_,k_);Me("GGGGG",Y2,G2);Me("ggggg",Y2,G2);Dg(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=vt(t)});Dg(["gg","GG"],function(t,e,r,n){e[n]=se.parseTwoDigitYear(t)});function Qhe(t){return PH.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Zhe(t){return PH.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Jhe(){return Da(this.year(),1,4)}function ede(){return Da(this.isoWeekYear(),1,4)}function tde(){var t=this.localeData()._week;return Da(this.year(),t.dow,t.doy)}function rde(){var t=this.localeData()._week;return Da(this.weekYear(),t.dow,t.doy)}function PH(t,e,r,n,i){var o;return t==null?em(this,n,i).year:(o=Da(t,n,i),e>o&&(e=o),nde.call(this,t,e,r,n,i))}function nde(t,e,r,n,i){var o=cH(t,e,r,n,i),a=Jp(o.year,0,o.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}We("Q",0,"Qo","quarter");yn("quarter","Q");bn("quarter",7);Me("Q",eH);jt("Q",function(t,e){e[fa]=(vt(t)-1)*3});function ide(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}We("D",["DD",2],"Do","date");yn("date","D");bn("date",9);Me("D",Jt);Me("DD",Jt,pi);Me("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});jt(["D","DD"],To);jt("Do",function(t,e){e[To]=vt(t.match(Jt)[0])});var MH=Sd("Date",!0);We("DDD",["DDDD",3],"DDDo","dayOfYear");yn("dayOfYear","DDD");bn("dayOfYear",4);Me("DDD",z2);Me("DDDD",tH);jt(["DDD","DDDD"],function(t,e,r){r._dayOfYear=vt(t)});function ode(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}We("m",["mm",2],0,"minute");yn("minute","m");bn("minute",14);Me("m",Jt);Me("mm",Jt,pi);jt(["m","mm"],Xi);var ade=Sd("Minutes",!1);We("s",["ss",2],0,"second");yn("second","s");bn("second",15);Me("s",Jt);Me("ss",Jt,pi);jt(["s","ss"],ha);var sde=Sd("Seconds",!1);We("S",0,0,function(){return~~(this.millisecond()/100)});We(0,["SS",2],0,function(){return~~(this.millisecond()/10)});We(0,["SSS",3],0,"millisecond");We(0,["SSSS",4],0,function(){return this.millisecond()*10});We(0,["SSSSS",5],0,function(){return this.millisecond()*100});We(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});We(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});We(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});We(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});yn("millisecond","ms");bn("millisecond",16);Me("S",z2,eH);Me("SS",z2,pi);Me("SSS",z2,tH);var Rs,kH;for(Rs="SSSS";Rs.length<=9;Rs+="S")Me(Rs,Rd);function lde(t,e){e[Il]=vt(("0."+t)*1e3)}for(Rs="S";Rs.length<=9;Rs+="S")jt(Rs,lde);kH=Sd("Milliseconds",!1);We("z",0,0,"zoneAbbr");We("zz",0,0,"zoneName");function ude(){return this._isUTC?"UTC":""}function cde(){return this._isUTC?"Coordinated Universal Time":""}var ce=$g.prototype;ce.add=rhe;ce.calendar=uhe;ce.clone=che;ce.diff=ghe;ce.endOf=_he;ce.format=She;ce.from=Rhe;ce.fromNow=Ehe;ce.to=Che;ce.toNow=Ohe;ce.get=hce;ce.invalidAt=Lhe;ce.isAfter=fhe;ce.isBefore=hhe;ce.isBetween=dhe;ce.isSame=phe;ce.isSameOrAfter=mhe;ce.isSameOrBefore=vhe;ce.isValid=xhe;ce.lang=TH;ce.locale=OH;ce.localeData=_H;ce.max=xfe;ce.min=kfe;ce.parsingFlags=$he;ce.set=dce;ce.startOf=The;ce.subtract=nhe;ce.toArray=Phe;ce.toObject=Mhe;ce.toDate=Nhe;ce.toISOString=bhe;ce.inspect=whe;typeof Symbol<"u"&&Symbol.for!=null&&(ce[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ce.toJSON=khe;ce.toString=yhe;ce.unix=Ihe;ce.valueOf=Ahe;ce.creationData=Dhe;ce.eraName=Bhe;ce.eraNarrow=Vhe;ce.eraAbbr=jhe;ce.eraYear=Whe;ce.year=uH;ce.isLeapYear=Mce;ce.weekYear=Qhe;ce.isoWeekYear=Zhe;ce.quarter=ce.quarters=ide;ce.month=sH;ce.daysInMonth=Ice;ce.week=ce.weeks=Fce;ce.isoWeek=ce.isoWeeks=Hce;ce.weeksInYear=tde;ce.weeksInWeekYear=rde;ce.isoWeeksInYear=Jhe;ce.isoWeeksInISOWeekYear=ede;ce.date=MH;ce.day=ce.days=Zce;ce.weekday=Jce;ce.isoWeekday=efe;ce.dayOfYear=ode;ce.hour=ce.hours=sfe;ce.minute=ce.minutes=ade;ce.second=ce.seconds=sde;ce.millisecond=ce.milliseconds=kH;ce.utcOffset=jfe;ce.utc=Gfe;ce.local=zfe;ce.parseZone=Yfe;ce.hasAlignedHourOffset=Kfe;ce.isDST=Xfe;ce.isLocal=Qfe;ce.isUtcOffset=Zfe;ce.isUtc=SH;ce.isUTC=SH;ce.zoneAbbr=ude;ce.zoneName=cde;ce.dates=ki("dates accessor is deprecated. Use date instead.",MH);ce.months=ki("months accessor is deprecated. Use month instead",sH);ce.years=ki("years accessor is deprecated. Use year instead",uH);ce.zone=ki("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Wfe);ce.isDSTShifted=ki("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",qfe);function fde(t){return Zt(t*1e3)}function hde(){return Zt.apply(null,arguments).parseZone()}function xH(t){return t}var Nt=N_.prototype;Nt.calendar=Zue;Nt.longDateFormat=rce;Nt.invalidDate=ice;Nt.ordinal=sce;Nt.preparse=xH;Nt.postformat=xH;Nt.relativeTime=uce;Nt.pastFuture=cce;Nt.set=que;Nt.eras=Fhe;Nt.erasParse=Hhe;Nt.erasConvertYear=Uhe;Nt.erasAbbrRegex=zhe;Nt.erasNameRegex=Ghe;Nt.erasNarrowRegex=Yhe;Nt.months=Oce;Nt.monthsShort=Tce;Nt.monthsParse=Ace;Nt.monthsRegex=Pce;Nt.monthsShortRegex=Nce;Nt.week=xce;Nt.firstDayOfYear=Dce;Nt.firstDayOfWeek=Lce;Nt.weekdays=Yce;Nt.weekdaysMin=Xce;Nt.weekdaysShort=Kce;Nt.weekdaysParse=Qce;Nt.weekdaysRegex=tfe;Nt.weekdaysShortRegex=rfe;Nt.weekdaysMinRegex=nfe;Nt.isPM=ofe;Nt.meridiem=lfe;function z0(t,e,r,n){var i=Xa(),o=Vo().set(n,e);return i[r](o,t)}function $H(t,e,r){if(ja(t)&&(e=t,t=void 0),t=t||"",e!=null)return z0(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=z0(t,n,r,"month");return i}function z_(t,e,r,n){typeof t=="boolean"?(ja(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,ja(e)&&(r=e,e=void 0),e=e||"");var i=Xa(),o=t?i._week.dow:0,a,s=[];if(r!=null)return z0(e,(r+o)%7,n,"day");for(a=0;a<7;a++)s[a]=z0(e,(a+o)%7,n,"day");return s}function dde(t,e){return $H(t,e,"months")}function pde(t,e){return $H(t,e,"monthsShort")}function mde(t,e,r){return z_(t,e,r,"weekdays")}function vde(t,e,r){return z_(t,e,r,"weekdaysShort")}function gde(t,e,r){return z_(t,e,r,"weekdaysMin")}Is("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=vt(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});se.lang=ki("moment.lang is deprecated. Use moment.locale instead.",Is);se.langData=ki("moment.langData is deprecated. Use moment.localeData instead.",Xa);var Yo=Math.abs;function yde(){var t=this._data;return this._milliseconds=Yo(this._milliseconds),this._days=Yo(this._days),this._months=Yo(this._months),t.milliseconds=Yo(t.milliseconds),t.seconds=Yo(t.seconds),t.minutes=Yo(t.minutes),t.hours=Yo(t.hours),t.months=Yo(t.months),t.years=Yo(t.years),this}function LH(t,e,r,n){var i=no(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function bde(t,e){return LH(this,t,e,1)}function wde(t,e){return LH(this,t,e,-1)}function n8(t){return t<0?Math.floor(t):Math.ceil(t)}function Sde(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,o,a,s,l;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=n8(xE(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=Ei(t/1e3),n.seconds=i%60,o=Ei(i/60),n.minutes=o%60,a=Ei(o/60),n.hours=a%24,e+=Ei(a/24),l=Ei(DH(e)),r+=l,e-=n8(xE(l)),s=Ei(r/12),r%=12,n.days=e,n.months=r,n.years=s,this}function DH(t){return t*4800/146097}function xE(t){return t*146097/4800}function Rde(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=xi(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+DH(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(xE(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function Ede(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+vt(this._months/12)*31536e6:NaN}function qa(t){return function(){return this.as(t)}}var Cde=qa("ms"),Ode=qa("s"),Tde=qa("m"),_de=qa("h"),Ade=qa("d"),Ide=qa("w"),Nde=qa("M"),Pde=qa("Q"),Mde=qa("y");function kde(){return no(this)}function xde(t){return t=xi(t),this.isValid()?this[t+"s"]():NaN}function Lu(t){return function(){return this.isValid()?this._data[t]:NaN}}var $de=Lu("milliseconds"),Lde=Lu("seconds"),Dde=Lu("minutes"),Fde=Lu("hours"),Hde=Lu("days"),Ude=Lu("months"),Bde=Lu("years");function Vde(){return Ei(this.days()/7)}var oa=Math.round,Lc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function jde(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function Wde(t,e,r,n){var i=no(t).abs(),o=oa(i.as("s")),a=oa(i.as("m")),s=oa(i.as("h")),l=oa(i.as("d")),u=oa(i.as("M")),c=oa(i.as("w")),f=oa(i.as("y")),h=o<=r.ss&&["s",o]||o<r.s&&["ss",o]||a<=1&&["m"]||a<r.m&&["mm",a]||s<=1&&["h"]||s<r.h&&["hh",s]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(h=h||c<=1&&["w"]||c<r.w&&["ww",c]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||f<=1&&["y"]||["yy",f],h[2]=e,h[3]=+t>0,h[4]=n,jde.apply(null,h)}function Gde(t){return t===void 0?oa:typeof t=="function"?(oa=t,!0):!1}function zde(t,e){return Lc[t]===void 0?!1:e===void 0?Lc[t]:(Lc[t]=e,t==="s"&&(Lc.ss=e-1),!0)}function Yde(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Lc,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},Lc,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),o=Wde(this,!r,n,i),r&&(o=i.pastFuture(+this,o)),i.postformat(o)}var r6=Math.abs;function qu(t){return(t>0)-(t<0)||+t}function ew(){if(!this.isValid())return this.localeData().invalidDate();var t=r6(this._milliseconds)/1e3,e=r6(this._days),r=r6(this._months),n,i,o,a,s=this.asSeconds(),l,u,c,f;return s?(n=Ei(t/60),i=Ei(n/60),t%=60,n%=60,o=Ei(r/12),r%=12,a=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=s<0?"-":"",u=qu(this._months)!==qu(s)?"-":"",c=qu(this._days)!==qu(s)?"-":"",f=qu(this._milliseconds)!==qu(s)?"-":"",l+"P"+(o?u+o+"Y":"")+(r?u+r+"M":"")+(e?c+e+"D":"")+(i||n||t?"T":"")+(i?f+i+"H":"")+(n?f+n+"M":"")+(t?f+a+"S":"")):"P0D"}var Et=Z2.prototype;Et.isValid=Hfe;Et.abs=yde;Et.add=bde;Et.subtract=wde;Et.as=Rde;Et.asMilliseconds=Cde;Et.asSeconds=Ode;Et.asMinutes=Tde;Et.asHours=_de;Et.asDays=Ade;Et.asWeeks=Ide;Et.asMonths=Nde;Et.asQuarters=Pde;Et.asYears=Mde;Et.valueOf=Ede;Et._bubble=Sde;Et.clone=kde;Et.get=xde;Et.milliseconds=$de;Et.seconds=Lde;Et.minutes=Dde;Et.hours=Fde;Et.days=Hde;Et.weeks=Vde;Et.months=Ude;Et.years=Bde;Et.humanize=Yde;Et.toISOString=ew;Et.toString=ew;Et.toJSON=ew;Et.locale=OH;Et.localeData=_H;Et.toIsoString=ki("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ew);Et.lang=TH;We("X",0,0,"unix");We("x",0,0,"valueOf");Me("x",K2);Me("X",mce);jt("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});jt("x",function(t,e,r){r._d=new Date(vt(t))});//! moment.js
se.version="2.29.4";Kue(Zt);se.fn=ce;se.min=$fe;se.max=Lfe;se.now=Dfe;se.utc=Vo;se.unix=fde;se.months=dde;se.isDate=xg;se.locale=Is;se.invalid=j2;se.duration=no;se.isMoment=to;se.weekdays=mde;se.parseZone=hde;se.localeData=Xa;se.isDuration=j1;se.monthsShort=pde;se.weekdaysMin=gde;se.defineLocale=F_;se.updateLocale=hfe;se.locales=dfe;se.weekdaysShort=vde;se.normalizeUnits=xi;se.relativeTimeRounding=Gde;se.relativeTimeThreshold=zde;se.calendarFormat=lhe;se.prototype=ce;se.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const Kde=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"}));function kt(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var i=gn(t,function(o,a,s){var l=a.replace(/\r?\n\s*/g,""),u=r[s]?r[s]:"";return o+l+u},"");return i.trim()}var i8,o8,a8,s8,l8,u8;function Gc(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function $E(t){"@babel/helpers - typeof";return $E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$E(t)}function Ar(t){var e;switch($E(t)){case"string":case"number":e="".concat(t);break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function Ae(t){return typeof t<"u"}function zt(t){return typeof t>"u"}function Br(t){return t===null||t===""||zt(t)}function Xde(t){return Object.prototype.toString.call(t)==="[object RegExp]"}var pp="length",_p=function(e){return parseInt(e,16)},c8=function(e){return parseInt(e,10)},Y0=function(e,r,n){return e.substr(r,n)},Ap=function(e){return e.codePointAt(0)-65},LE=function(e){return"".concat(e).replace(/\-/g,"")},qde=function(e){return _p(Y0(LE(e),_p("12"),Ap("F")))/(_p(Y0(LE(e),Ap("B"),~~![][pp]))||9)},Qde=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},f8=!1,h8={invalid:function(){return kt(i8||(i8=Gc([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(e){var r=e.keyValidityDate,n=e.hotVersion;return kt(o8||(o8=Gc([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return kt(a8||(a8=Gc([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},d8={invalid:function(){return kt(s8||(s8=Gc([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(e){var r=e.keyValidityDate,n=e.hotVersion;return kt(l8||(l8=Gc([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return kt(u8||(u8=Gc([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function Zde(t,e){var r=!Br(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="12.4.0",o,a="invalid",s="invalid";t=LE(t||"");var l=Jde(t);if(r||n||l)if(l){var u=se("23/05/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),f=qde(t);o=se((f+1)*864e5,"x").format("MMMM DD, YYYY"),c>f?(a="expired",s="expired"):(a="valid",s="valid")}else n?(a="non_commercial",s="valid"):(a="invalid",s="invalid");else a="missing",s="missing";if(Qde()&&(a="valid",s="valid"),!f8&&a!=="valid"){var h=h8[a]({keyValidityDate:o,hotVersion:i});h&&console[a==="non_commercial"?"info":"warn"](h8[a]({keyValidityDate:o,hotVersion:i})),f8=!0}if(s!=="valid"&&e.parentNode){var d=d8[s]({keyValidityDate:o,hotVersion:i});if(d){var p=document.createElement("div");p.className="hot-display-license-info",p.innerHTML=d8[s]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(p,e.nextSibling)}}}function Jde(t){var e=[][pp],r=e;if(t[pp]!==Ap("Z"))return!1;for(var n="",i="B<H4P+".split(""),o=Ap(i.shift());o;o=Ap(i.shift()||"A"))--o<""[pp]?r=r|(c8("".concat(c8(_p(n)+(_p(Y0(t,Math.abs(o),2))+[]).padStart(2,"0"))))%97||2)>>1:n=Y0(t,o,o?i[pp]===1?9:8:6);return r===e}function Qi(t){return t[0].toUpperCase()+t.substr(1)}function FH(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function HH(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function UH(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(t).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n]})}function p8(t){return Y_("".concat(t),{ALLOWED_TAGS:[]})}function Y_(t,e){return Iue.sanitize(t,e)}function m8(t){return npe(t)||rpe(t)||tpe(t)||epe()}function epe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tpe(t,e){if(t){if(typeof t=="string")return DE(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DE(t,e)}}function rpe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function npe(t){if(Array.isArray(t))return DE(t)}function DE(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ipe(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function ope(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function K0(t){return ope(t)&&t.parent}function su(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,i=n.ELEMENT_NODE,o=n.DOCUMENT_FRAGMENT_NODE,a=t;a!=null&&a!==r;){var s=a,l=s.nodeType,u=s.nodeName;if(l===i&&(e.includes(u)||e.includes(a)))return a;var c=a,f=c.host;f&&l===o?a=f:a=a.parentNode}return null}function Cy(t,e,r){for(var n=[],i=t;i&&(i=su(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;var o=n.length;return o?n[o-1]:null}function lu(t,e){var r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function ape(t){var e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function sl(t,e,r){var n=r.parentElement.querySelector(".ht_clone_".concat(t));return n?n.contains(e):null}var FE,HE,UE;function Oy(t){return!t||!t.length?[]:t.filter(function(e){return!!e})}if(ole()){var v8=function(e){var r=e.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};FE=function(e,r){return e.classList===void 0||typeof r!="string"||r===""?!1:e.classList.contains(r)},HE=function(e,r){var n=e.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=Oy(i),i.length>0)if(v8(n)){var o;(o=e.classList).add.apply(o,m8(i))}else for(var a=0;i[a];)e.classList.add(i[a]),a+=1},UE=function(e,r){var n=e.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=Oy(i),i.length>0)if(v8(n)){var o;(o=e.classList).remove.apply(o,m8(i))}else for(var a=0;i[a];)e.classList.remove(i[a]),a+=1}}else{var n6=function(e){return new RegExp("(\\s|^)".concat(e,"(\\s|$)"))};FE=function(e,r){return e.className!==void 0&&n6(r).test(e.className)},HE=function(e,r){var n=e.className,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=Oy(i),n==="")n=i.join(" ");else for(var o=0;o<i.length;o++)i[o]&&!n6(i[o]).test(n)&&(n+=" ".concat(i[o]));e.className=n},UE=function(e,r){var n=0,i=e.className,o=r;for(typeof o=="string"&&(o=o.split(" ")),o=Oy(o);o[n];)i=i.replace(n6(o[n])," ").trim(),n+=1;e.className!==i&&(e.className=i)}}function Xe(t,e){return FE(t,e)}function le(t,e){HE(t,e)}function qe(t,e){UE(t,e)}function BH(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1)for(var e=t.childNodes,r=e.length-1;r>=0;r--)BH(e[r])}function $o(t){for(var e;e=t.lastChild;)t.removeChild(e)}var spe=/(<(.*)>|&(.*);)/;function Ed(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;spe.test(e)?t.innerHTML=r?Y_(e):e:hu(t,e)}function hu(t,e){var r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?ale?r.textContent=e:r.data=e:($o(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function rm(t){for(var e=t.ownerDocument.documentElement,r=t;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return rm(r.host.impl);if(r.host)return rm(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function xr(t){var e=t.ownerDocument,r=e.defaultView,n=e.documentElement,i=t,o,a,s,l;if(DF()&&i.firstChild&&i.firstChild.nodeName==="CAPTION")return l=i.getBoundingClientRect(),{top:l.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:l.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(o=i.offsetLeft,a=i.offsetTop,s=i;(i=i.offsetParent)&&i!==e.body;)o+=i.offsetLeft,a+=i.offsetTop,s=i;return s&&s.style.position==="fixed"&&(o+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:o,top:a}}function nm(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,e=t.scrollY;return e===void 0&&(e=t.document.documentElement.scrollTop),e}function ff(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,e=t.scrollX;return e===void 0&&(e=t.document.documentElement.scrollLeft),e}function X0(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?nm(e):t.scrollTop}function BE(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?ff(e):t.scrollLeft}function q0(t){var e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);for(var n=["auto","scroll"],i=sle(),o=t.parentNode;o&&o.style&&e.body!==o;){var a=o.style,s=a.overflow,l=a.overflowX,u=a.overflowY;if([s,l,u].includes("scroll"))return o;if(i){var c=r.getComputedStyle(o);if(s=c.overflow,l=c.overflowX,u=c.overflowY,n.includes(s)||n.includes(l)||n.includes(u))return o}if(o.clientHeight<=o.scrollHeight+1&&(n.includes(u)||n.includes(s))||o.clientWidth<=o.scrollWidth+1&&(n.includes(l)||n.includes(s)))return o;o=o.parentNode}return r}function hf(t){for(var e=t.ownerDocument,r=e.defaultView,n=t.parentNode;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var i=du(n,r),o=["scroll","hidden","auto"],a=i.getPropertyValue("overflow"),s=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(a)||o.includes(s)||o.includes(l))return n;n=n.parentNode}return r}function im(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?"".concat(r.innerWidth,"px"):e==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=t.style[e];if(n!==""&&n!==void 0)return n;var i=du(t,r);if(i[e]!==""&&i[e]!==void 0)return i[e]}function du(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function Ut(t){return t.offsetWidth}function ur(t){return DF()&&t.firstChild&&t.firstChild.nodeName==="CAPTION"?t.offsetHeight+t.firstChild.offsetHeight:t.offsetHeight}function Es(t){return t.clientHeight||t.innerHeight}function G1(t){return t.clientWidth||t.innerWidth}function VH(t){var e=t.ownerDocument;if(t.selectionStart)return t.selectionStart;if(e.selection){t.focus();var r=e.selection.createRange();if(r===null)return 0;var n=t.createTextRange(),i=n.duplicate();return n.moveToBookmark(r.getBookmark()),i.setEndPoint("EndToStart",n),i.text.length}return 0}function lpe(t){var e=t.ownerDocument;if(t.selectionEnd)return t.selectionEnd;if(e.selection){var r=e.selection.createRange();if(r===null)return 0;var n=t.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function upe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,e=t.document,r="";return t.getSelection?r=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(r=e.selection.createRange().text),r}function g8(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,e=t.document;t.getSelection?t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges():e.selection&&e.selection.empty()}function tw(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{var n=t.parentNode,i=n.style.display;n.style.display="block",t.setSelectionRange(e,r),n.style.display=i}}}var i6;function cpe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=t.createElement("div");e.style.height="200px",e.style.width="100%";var r=t.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);var n=e.offsetWidth;r.style.overflow="scroll";var i=e.offsetWidth;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),n-i}function Xr(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return i6===void 0&&(i6=cpe(t)),i6}function fpe(t){return t.offsetWidth!==t.clientWidth}function hpe(t){return t.offsetHeight!==t.clientHeight}function K_(t,e,r){tue()?(t.style.top=r,t.style.left=e):Zle()?t.style["-webkit-transform"]="translate3d(".concat(e,",").concat(r,",0)"):t.style.transform="translate3d(".concat(e,",").concat(r,",0)")}function rw(t){t.style.transform&&t.style.transform!==""?t.style.transform="":t.style["-webkit-transform"]&&t.style["-webkit-transform"]!==""&&(t.style["-webkit-transform"]="")}function Q0(t){var e=["INPUT","SELECT","TEXTAREA"];return t&&(e.indexOf(t.nodeName)>-1||t.contentEditable==="true")}function X_(t){return Q0(t)&&t.hasAttribute("data-hot-input")===!1}function dpe(t){var e=t.ownerDocument.activeElement;X_(e)||t.select()}function jH(t){return!t.parentNode}function ppe(t,e){var r=new IntersectionObserver(function(n,i){n.forEach(function(o){o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body});r.observe(t)}function Xt(t){return typeof t=="function"}function WH(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var o=this,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout(function(){n=t.apply(o,s)},e),n}return i}function GH(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return t.apply(this,r.concat(a))}}function mpe(t){var e=t.length;function r(n){return function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];var l=n.concat(a),u;return l.length>=e?u=t.apply(this,l):u=r(l),u}}return r([])}function VE(t,e,r,n,i,o,a,s){return Ae(s)?t.call(e,r,n,i,o,a,s):Ae(a)?t.call(e,r,n,i,o,a):Ae(o)?t.call(e,r,n,i,o):Ae(i)?t.call(e,r,n,i):Ae(n)?t.call(e,r,n):Ae(r)?t.call(e,r):t.call(e)}function Dt(){if(Ae(console)){var t;(t=console).warn.apply(t,arguments)}}function q_(){if(Ae(console)){var t;(t=console).error.apply(t,arguments)}}var vpe=rt,y8=o_,Ty=Ag.getWeakData,gpe=n_,ype=Rr,bpe=ro,o6=Sr,wpe=r_,zH=xu,b8=fr,YH=Ya,Spe=YH.set,Rpe=YH.getterFor,Epe=zH.find,Cpe=zH.findIndex,Ope=vpe([].splice),Tpe=0,_y=function(t){return t.frozen||(t.frozen=new KH)},KH=function(){this.entries=[]},a6=function(t,e){return Epe(t.entries,function(r){return r[0]===e})};KH.prototype={get:function(t){var e=a6(this,t);if(e)return e[1]},has:function(t){return!!a6(this,t)},set:function(t,e){var r=a6(this,t);r?r[1]=e:this.entries.push([t,e])},delete:function(t){var e=Cpe(this.entries,function(r){return r[0]===t});return~e&&Ope(this.entries,e,1),!!~e}};var XH={getConstructor:function(t,e,r,n){var i=t(function(l,u){gpe(l,o),Spe(l,{type:e,id:Tpe++,frozen:void 0}),bpe(u)||wpe(u,l[n],{that:l,AS_ENTRIES:r})}),o=i.prototype,a=Rpe(e),s=function(l,u,c){var f=a(l),h=Ty(ype(u),!0);return h===!0?_y(f).set(u,c):h[f.id]=c,l};return y8(o,{delete:function(l){var u=a(this);if(!o6(l))return!1;var c=Ty(l);return c===!0?_y(u).delete(l):c&&b8(c,u.id)&&delete c[u.id]},has:function(u){var c=a(this);if(!o6(u))return!1;var f=Ty(u);return f===!0?_y(c).has(u):f&&b8(f,c.id)}}),y8(o,r?{get:function(u){var c=a(this);if(o6(u)){var f=Ty(u);return f===!0?_y(c).get(u):f?f[c.id]:void 0}},set:function(u,c){return s(this,u,c)}}:{add:function(u){return s(this,u,!0)}}),i}},w8=Vt,Ay=rt,_pe=o_,Ape=Ag,Ipe=L2,qH=XH,Iy=Sr,Ny=FD,Py=Ya.enforce,Npe=XL,Ppe=!w8.ActiveXObject&&"ActiveXObject"in w8,jd,QH=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Mpe=Ipe("WeakMap",QH,qH);if(Npe&&Ppe){jd=qH.getConstructor(QH,"WeakMap",!0),Ape.enable();var Wd=Mpe.prototype,S8=Ay(Wd.delete),My=Ay(Wd.has),R8=Ay(Wd.get),E8=Ay(Wd.set);_pe(Wd,{delete:function(t){if(Iy(t)&&!Ny(t)){var e=Py(this);return e.frozen||(e.frozen=new jd),S8(this,t)||e.frozen.delete(t)}return S8(this,t)},has:function(e){if(Iy(e)&&!Ny(e)){var r=Py(this);return r.frozen||(r.frozen=new jd),My(this,e)||r.frozen.has(e)}return My(this,e)},get:function(e){if(Iy(e)&&!Ny(e)){var r=Py(this);return r.frozen||(r.frozen=new jd),My(this,e)?R8(this,e):r.frozen.get(e)}return R8(this,e)},set:function(e,r){if(Iy(e)&&!Ny(e)){var n=Py(this);n.frozen||(n.frozen=new jd),My(this,e)?E8(this,e,r):n.frozen.set(e,r)}else E8(this,e,r);return this}})}var Le={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:YS()?182:174,AUDIO_MUTE:YS()?181:173,AUDIO_UP:YS()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},kpe=[Le.ALT,Le.ARROW_DOWN,Le.ARROW_LEFT,Le.ARROW_RIGHT,Le.ARROW_UP,Le.AUDIO_DOWN,Le.AUDIO_MUTE,Le.AUDIO_UP,Le.BACKSPACE,Le.CAPS_LOCK,Le.DELETE,Le.END,Le.ENTER,Le.ESCAPE,Le.F1,Le.F2,Le.F3,Le.F4,Le.F5,Le.F6,Le.F7,Le.F8,Le.F9,Le.F10,Le.F11,Le.F12,Le.F13,Le.F14,Le.F15,Le.F16,Le.F17,Le.F18,Le.F19,Le.HOME,Le.INSERT,Le.MEDIA_NEXT,Le.MEDIA_PLAY_PAUSE,Le.MEDIA_PREV,Le.MEDIA_STOP,Le.NULL,Le.NUM_LOCK,Le.PAGE_DOWN,Le.PAGE_UP,Le.PAUSE,Le.SCROLL_LOCK,Le.SHIFT,Le.TAB];function xpe(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function ZH(t){return kpe.includes(t)}function $pe(t){return[Le.CONTROL,Le.COMMAND_LEFT,Le.COMMAND_RIGHT,Le.COMMAND_FIREFOX].includes(t)}function om(t,e){var r=e.split("|"),n=!1;return D(r,function(i){if(t===Le[i])return n=!0,!1}),n}function Lo(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function _c(t){return t.isImmediatePropagationEnabled===!1}function pu(t){return t.button===2}function Q_(t){return t.button===0}function am(t){"@babel/helpers - typeof";return am=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},am(t)}var C8;function Lpe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O8(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Fpe(n.key),n)}}function Dpe(t,e,r){return e&&O8(t.prototype,e),r&&O8(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fpe(t){var e=Hpe(t,"string");return am(e)==="symbol"?e:String(e)}function Hpe(t,e){if(am(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(am(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Upe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var Qu=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Bpe=kt(C8||(C8=Upe([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),s6=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),l6=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),JH=function(){function t(){Lpe(this,t),this.globalBucket=this.createEmptyBucket()}return Dpe(t,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return D(Qu,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var i=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))D(n,function(l){return i.add(r,l,o)});else{s6.has(r)&&Dt(UH(Bpe,{hookName:r,removedInVersion:s6.get(r)})),l6.has(r)&&Dt(l6.get(r));var a=this.getBucket(o);if(typeof a[r]>"u"&&(this.register(r),a[r]=[]),n.skip=!1,a[r].indexOf(n)===-1){var s=!1;n.initialHook&&D(a[r],function(l,u){if(l.initialHook)return a[r][u]=n,s=!0,!1}),s||a[r].push(n)}}return this}},{key:"once",value:function(r,n){var i=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?D(n,function(a){return i.once(r,a,o)}):(n.runOnce=!0,this.add(r,n,o))}},{key:"remove",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=this.getBucket(i);return typeof o[r]<"u"&&o[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=this.getBucket(n);return!!(i[r]!==void 0&&i[r].length)}},{key:"run",value:function(r,n,i,o,a,s,l,u){{var c=this.globalBucket[n],f=c?c.length:0,h=0;if(f)for(;h<f;){if(!c[h]||c[h].skip){h+=1;continue}var d=VE(c[h],r,i,o,a,s,l,u);d!==void 0&&(i=d),c[h]&&c[h].runOnce&&this.remove(n,c[h]),h+=1}}{var p=this.getBucket(r)[n],m=p?p.length:0,y=0;if(m)for(;y<m;){if(!p[y]||p[y].skip){y+=1;continue}var S=VE(p[y],r,i,o,a,s,l,u);S!==void 0&&(i=S),p[y]&&p[y].runOnce&&this.remove(n,p[y],r),y+=1}}return i}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ut(this.getBucket(r),function(n,i,o){return o[i].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||Qu.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&Qu.splice(Qu.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return l6.has(r)||s6.has(r)}},{key:"isRegistered",value:function(r){return Qu.indexOf(r)>=0}},{key:"getRegistered",value:function(){return Qu}}],[{key:"getSingleton",value:function(){return jpe()}}]),t}(),Vpe=new JH;function jpe(){return Vpe}const Ne=JH;function T8(t){return Ype(t)||zpe(t)||Gpe(t)||Wpe()}function Wpe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gpe(t,e){if(t){if(typeof t=="string")return jE(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jE(t,e)}}function zpe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Ype(t){if(Array.isArray(t))return jE(t)}function jE(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var u6=new Map;function $i(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";u6.has(t)||u6.set(t,new Map);var e=u6.get(t);function r(s,l){e.set(s,l)}function n(s){return e.get(s)}function i(s){return e.has(s)}function o(){return T8(e.keys())}function a(){return T8(e.values())}return{register:r,getItem:n,hasItem:i,getNames:o,getValues:a}}var WE=new WeakMap,Fg=$i("editors"),Kpe=Fg.register,eU=Fg.getItem,tU=Fg.hasItem;Fg.getNames;Fg.getValues;function Xpe(t){var e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},Ne.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function rU(t,e){var r;if(typeof t=="function")WE.get(t)||ri(null,t),r=WE.get(t);else if(typeof t=="string")r=eU(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(t,'"'));return r.getInstance(e)}function _8(t){if(typeof t=="function")return t;if(!tU(t))throw Error('No registered editor found under "'.concat(t,'" name'));return eU(t).getConstructor()}function ri(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);var r=new Xpe(e);typeof t=="string"&&Kpe(t,r),WE.set(e,r)}function sm(t){"@babel/helpers - typeof";return sm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sm(t)}function qpe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qpe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Jpe(n.key),n)}}function Zpe(t,e,r){return e&&Qpe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Jpe(t){var e=eme(t,"string");return sm(e)==="symbol"?e:String(e)}function eme(t,e){if(sm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(sm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var tme=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;qpe(this,t),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}return Zpe(t,[{key:"addEventListener",value:function(r,n,i){var o=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(l){i.call(this,rme(l))}return typeof a!="boolean"&&!cle()&&(a=!1),this.context.eventListeners.push({element:r,event:n,callback:i,callbackProxy:s,options:a,eventManager:this}),r.addEventListener(n,s,a),function(){o.removeEventListener(r,n,i)}}},{key:"removeEventListener",value:function(r,n,i){for(var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=this.context.eventListeners.length,s;a;)if(a-=1,s=this.context.eventListeners[a],s.event===n&&s.element===r){if(i&&i!==s.callback||o&&s.eventManager!==this)continue;this.context.eventListeners.splice(a,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var i=this.context.eventListeners[n];r&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options))}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var i=r.document,o=r;i||(i=r.ownerDocument?r.ownerDocument:r,o=i.defaultView);var a={bubbles:!0,cancelable:n!=="mousemove",view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},s;i.createEvent?(s=i.createEvent("MouseEvents"),s.initMouseEvent(n,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,i.body.parentNode)):s=i.createEventObject(),r.dispatchEvent?r.dispatchEvent(s):r.fireEvent("on".concat(n),s)}}]),t}();function rme(t){var e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Lo(this)},t}const hr=tme;function lm(t){"@babel/helpers - typeof";return lm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lm(t)}function nme(t,e){return sme(t)||ame(t,e)||ome(t,e)||ime()}function ime(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ome(t,e){if(t){if(typeof t=="string")return A8(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A8(t,e)}}function A8(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ame(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function sme(t){if(Array.isArray(t))return t}function lme(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ume(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fme(n.key),n)}}function cme(t,e,r){return e&&ume(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function fme(t){var e=hme(t,"string");return lm(e)==="symbol"?e:String(e)}function hme(t,e){if(lm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(lm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var nw="editorManager.navigation",Ip="editorManager.handlingEditor",GE=function(){function t(e,r,n){var i=this;lme(this,t),this.instance=e,this.tableMeta=r,this.selection=n,this.eventManager=new hr(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var o=this.instance.getShortcutManager();o.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(a){return i.onAfterDocumentKeyDown(a)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!i.destroyed&&i.instance.isListening()&&i.openEditor("",a)}),this.instance.view._wt.update("onCellDblClick",function(a,s,l){return i.onCellDblClick(a,s,l)})}return cme(t,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),i=n.getContext("grid"),o=n.getContext("editor"),a={group:Ip};o.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(l,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],a),i.addShortcuts([{keys:[["F2"]],callback:function(l){r.openEditor(null,l,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(l,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,l,!0):r.moveSelectionAfterEnter(u.includes("shift")),Lo(l)}}],a)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(m){m&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,i=n.row,o=n.col,a=this.instance.runHooks("modifyGetCellCoords",i,o),s=i,l=o;if(Array.isArray(a)){var u=nme(a,2);s=u[0],l=u[1]}this.cellProperties=this.instance.getCellMeta(s,l);var c=this.instance.rootDocument.activeElement;if(c&&X_(c)&&c.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var f=this.instance.getCell(i,o,!0);if(f){var h=this.instance.getCellEditor(this.cellProperties),d=this.instance.colToProp(l),p=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(s),l);this.activeEditor=rU(h,this.instance),this.activeEditor.prepare(i,o,d,f,p,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var o=this.instance.getSelectedRangeLast().highlight,a=o.row,s=o.col,l=this.instance.rowIndexMapper.getRenderableFromVisualIndex(a),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(s);this.instance.view.scrollViewport(this.instance._createCellCoords(l,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,i){this.activeEditor?this.activeEditor.finishEditing(r,n,i):i&&i(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,i=n.row,o=n.col,a=this.instance,s=a.rowIndexMapper,l=a.columnIndexMapper,u=s.isHidden(this.instance.toPhysicalRow(i))||l.isHidden(this.instance.toPhysicalColumn(o));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var i=r.keyCode;if(this.selection.isSelected()){var o=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!ZH(i)&&!$pe(i)&&!o&&!this.isEditorOpened()){var a=this.instance.getShortcutManager(),s=a.getContext("editor"),l={runOnlyIf:function(){return Ae(n.instance.getSelected())},group:nw};s.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],l),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,i){i.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),t}(),I8=new WeakMap;GE.getInstance=function(t,e,r){var n=I8.get(t);return n||(n=new GE(t,e,r),I8.set(t,n)),n};const dme=GE;var pme=Ye,mme=Kn,nU=Eg,vme=nt,gme=vme(function(){nU(1)});pme({target:"Object",stat:!0,forced:gme},{keys:function(e){return nU(mme(e))}});var yme=Ye,bme=T_;yme({target:"String",proto:!0},{repeat:bme});var wme=Lr,Sme=H2,Rme=Rr,Eme=ro,Cme=ku,c6=Dr,Ome=Yn,Tme=Nu,_me=p_,N8=U2;Sme("match",function(t,e,r){return[function(i){var o=Ome(this),a=Eme(i)?void 0:Tme(i,t);return a?wme(a,i,o):new RegExp(i)[t](c6(o))},function(n){var i=Rme(this),o=c6(n),a=r(e,i,o);if(a.done)return a.value;if(!i.global)return N8(i,o);var s=i.unicode;i.lastIndex=0;for(var l=[],u=0,c;(c=N8(i,o))!==null;){var f=c6(c[0]);l[u]=f,f===""&&(i.lastIndex=_me(o,Cme(i.lastIndex),s)),u++}return u===0?null:l}]});var Ame=$u,Ime=hi,Nme=Ks,Pme=Mi,Mme=wd,kme=Math.min,zE=[].lastIndexOf,iU=!!zE&&1/[1].lastIndexOf(1,-0)<0,xme=Mme("lastIndexOf"),$me=iU||!xme,Lme=$me?function(e){if(iU)return Ame(zE,this,arguments)||0;var r=Ime(this),n=Pme(r),i=n-1;for(arguments.length>1&&(i=kme(i,Nme(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in r&&r[i]===e)return i||0;return-1}:zE,Dme=Ye,P8=Lme;Dme({target:"Array",proto:!0,forced:P8!==[].lastIndexOf},{lastIndexOf:P8});var Fme=md,Hme=Kn,Ume=mg,Bme=Mi,Vme=TypeError,M8=function(t){return function(e,r,n,i){Fme(r);var o=Hme(e),a=Ume(o),s=Bme(o),l=t?s-1:0,u=t?-1:1;if(n<2)for(;;){if(l in a){i=a[l],l+=u;break}if(l+=u,t?l<0:s<=l)throw Vme("Reduce of empty array with no initial value")}for(;t?l>=0:s>l;l+=u)l in a&&(i=r(i,a[l],l,o));return i}},jme={left:M8(!1),right:M8(!0)},Wme=Ye,Gme=jme.left,zme=wd,k8=vg,Yme=_F,Kme=zme("reduce"),Xme=!Yme&&k8>79&&k8<83;Wme({target:"Array",proto:!0,forced:!Kme||Xme},{reduce:function(e){var r=arguments.length;return Gme(this,e,r,r>1?arguments[1]:void 0)}});var qme=Ye,Qme=xu.findIndex,Zme=Ig,YE="findIndex",oU=!0;YE in[]&&Array(1)[YE](function(){oU=!1});qme({target:"Array",proto:!0,forced:oU},{findIndex:function(e){return Qme(this,e,arguments.length>1?arguments[1]:void 0)}});Zme(YE);function f6(t){return rve(t)||tve(t)||eve(t)||Jme()}function Jme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eve(t,e){if(t){if(typeof t=="string")return KE(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KE(t,e)}}function tve(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function rve(t){if(Array.isArray(t))return KE(t)}function KE(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var aU={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},nve=new RegExp(Object.keys(aU).map(function(t){return"(".concat(t,")")}).join("|"),"gi");function ive(t){return(t&&t.nodeName||"")==="TABLE"}function x8(t){for(var e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData.apply(t,n),o=i.length,a=o>0?i[0].length:0,s=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,f=e?1:0,h=0;h<o;h+=1){for(var d=e&&h===0,p=[],m=0;m<a;m+=1){var y=!d&&r&&m===0,S="";if(d)S="<th>".concat(t.getColHeader(m-c),"</th>");else if(y)S="<th>".concat(t.getRowHeader(h-f),"</th>");else{var R=i[h][m],E=t.getCellMeta(h-f,m-c),O=E.hidden,A=E.rowspan,B=E.colspan;if(!O){var j=[];if(A&&j.push('rowspan="'.concat(A,'"')),B&&j.push('colspan="'.concat(B,'"')),Br(R))S="<td ".concat(j.join(" "),"></td>");else{var J=R.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");S="<td ".concat(j.join(" "),">").concat(J,"</td>")}}}p.push(S)}var Y=["<tr>"].concat(p,["</tr>"]).join("");d?l.splice(1,0,Y):u.splice(-1,0,Y)}return s.splice(1,0,l.join(""),u.join("")),s.join("")}function $8(t){for(var e=t.length,r=["<table>"],n=0;n<e;n+=1){var i=t[n],o=i.length,a=[];n===0&&r.push("<tbody>");for(var s=0;s<o;s+=1){var l=i[s],u=Br(l)?"":l.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,function(c){return'<span style="mso-spacerun: yes">'.concat("&nbsp;".repeat(c.length-1)," </span>")}).replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function ove(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);var o=t;if(typeof o=="string"){var a=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(_){var M=_.match(/<td\b[^>]*?>/g)[0],L=_.substring(M.length,_.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),H="</td>";return"".concat(M).concat(L).concat(H)});i.insertAdjacentHTML("afterbegin","".concat(a)),o=i.querySelector("table")}if(!(!o||!ive(o))){var s=i.querySelector('meta[name$="enerator"]'),l=o.querySelector("tbody th")!==null,u=o.querySelector("tr"),c=u?Array.from(u.cells).reduce(function(_,M){return _+M.colSpan},0)-(l?1:0):0,f=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[],d=!1,p=0,m=0;if(o.tHead){var y=Array.from(o.tHead.rows).filter(function(_){var M=_.querySelector("td")!==null;return M&&h.push(_),!M});p=y.length,d=p>0,p>1?r.nestedHeaders=Array.from(y).reduce(function(_,M){var L=Array.from(M.cells).reduce(function(H,Z,te){if(l&&te===0)return H;var ie=Z.colSpan,oe=Z.innerHTML,ve=ie>1?{label:oe,colspan:ie}:oe;return H.push(ve),H},[]);return _.push(L),_},[]):d&&(r.colHeaders=Array.from(y[0].children).reduce(function(_,M,L){return l&&L===0||_.push(M.innerHTML),_},[]))}h.length&&(r.fixedRowsTop=h.length),f.length&&(r.fixedRowsBottom=f.length);var S=[].concat(h,f6(Array.from(o.tBodies).reduce(function(_,M){return _.push.apply(_,f6(Array.from(M.rows))),_},[])),f6(f));m=S.length;for(var R=new Array(m),E=0;E<m;E++)R[E]=new Array(c);for(var O=[],A=[],B=0;B<m;B++)for(var j=S[B],J=Array.from(j.cells),Y=J.length,q=0;q<Y;q++){var ee=J[q],ae=ee.nodeName,ne=ee.innerHTML,ue=ee.rowSpan,me=ee.colSpan,Re=R[B].findIndex(function(_){return _===void 0});if(ae==="TD"){if(ue>1||me>1){for(var ge=B;ge<B+ue;ge++)if(ge<m)for(var I=Re;I<Re+me;I++)R[ge][I]=null;var v=ee.getAttribute("style"),b=v&&v.includes("mso-ignore:colspan");b||O.push({col:Re,row:B,rowspan:ue,colspan:me})}var w="";s&&/excel/gi.test(s.content)?w=ne.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):w=ne.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),R[B][Re]=w.replace(nve,function(_){return aU[_]})}else A.push(ne)}return O.length&&(r.mergeCells=O),A.length&&(r.rowHeaders=A),R.length&&(r.data=R),r}}function ave(t){return cve(t)||uve(t)||lve(t)||sve()}function sve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lve(t,e){if(t){if(typeof t=="string")return XE(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XE(t,e)}}function uve(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function cve(t){if(Array.isArray(t))return XE(t)}function XE(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function qE(t){"@babel/helpers - typeof";return qE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qE(t)}function Ln(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=qE(t);if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);var n=Array.from(new Set(["."].concat(ave(e)))).map(function(i){return"\\".concat(i)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function fve(t){return Ln(t,[","])}function De(t,e,r){var n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function QE(t,e,r){var n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function sU(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function hve(t){return mve(t)||pve(t)||lU(t)||dve()}function dve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pve(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function mve(t){if(Array.isArray(t))return ZE(t)}function vve(t,e){return bve(t)||yve(t,e)||lU(t,e)||gve()}function gve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lU(t,e){if(t){if(typeof t=="string")return ZE(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZE(t,e)}}function ZE(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function yve(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function bve(t){if(Array.isArray(t))return t}var JE="asc",wve="desc",L8=new Map([[JE,[-1,1]],[wve,[1,-1]]]),Sve=function(e){return"The priority '".concat(e,"' is already declared in a map.")},Rve=function(e){return"The priority '".concat(e,"' is not a number.")};function Eve(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.errorPriorityExists,r=t.errorPriorityNaN,n=new Map;e=Xt(e)?e:Sve,r=Xt(r)?r:Rve;function i(a,s){if(!Ln(a))throw new Error(r(a));if(n.has(a))throw new Error(e(a));n.set(a,s)}function o(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:JE,s=L8.get(a)||L8.get(JE),l=vve(s,2),u=l[0],c=l[1];return hve(n).sort(function(f,h){return f[0]<h[0]?u:c}).map(function(f){return f[1]})}return{addItem:i,getItems:o}}var Cve=Ye,Ove=xu.find,Tve=Ig,eC="find",uU=!0;eC in[]&&Array(1)[eC](function(){uU=!1});Cve({target:"Array",proto:!0,forced:uU},{find:function(e){return Ove(this,e,arguments.length>1?arguments[1]:void 0)}});Tve(eC);function _ve(t){return Nve(t)||Ive(t)||cU(t)||Ave()}function Ave(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ive(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Nve(t){if(Array.isArray(t))return tC(t)}function D8(t,e){return kve(t)||Mve(t,e)||cU(t,e)||Pve()}function Pve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cU(t,e){if(t){if(typeof t=="string")return tC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tC(t,e)}}function tC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Mve(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function kve(t){if(Array.isArray(t))return t}var xve=function(e){return"The id '".concat(e,"' is already declared in a map.")};function iw(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.errorIdExists,r=new Map;e=Xt(e)?e:xve;function n(c,f){if(u(c))throw new Error(e(c));r.set(c,f)}function i(c){return r.delete(c)}function o(){r.clear()}function a(c){var f=l().find(function(p){var m=D8(p,2),y=m[0],S=m[1];return c===S?y:!1})||[null],h=D8(f,1),d=h[0];return d}function s(c){return r.get(c)}function l(){return _ve(r)}function u(c){return r.has(c)}return{addItem:n,clear:o,getId:a,getItem:s,getItems:l,hasItem:u,removeItem:i}}function $ve(t){return Hve(t)||Fve(t)||Dve(t)||Lve()}function Lve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dve(t,e){if(t){if(typeof t=="string")return rC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rC(t,e)}}function Fve(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Hve(t){if(Array.isArray(t))return rC(t)}function rC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Uve=function(e){return"'".concat(e,"' value is already declared in a unique set.")};function Bve(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.errorItemExists,r=new Set;e=Xt(e)?e:Uve;function n(a){if(r.has(a))throw new Error(e(a));r.add(a)}function i(){return $ve(r)}function o(){r.clear()}return{addItem:n,clear:o,getItems:i}}function Vve(t,e){return Gve(t)||Wve(t,e)||fU(t,e)||jve()}function jve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wve(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function Gve(t){if(Array.isArray(t))return t}function F8(t){return Kve(t)||Yve(t)||fU(t)||zve()}function zve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fU(t,e){if(t){if(typeof t=="string")return nC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nC(t,e)}}function Yve(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Kve(t){if(Array.isArray(t))return nC(t)}function nC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Z_=function(e){return'There is already registered "'.concat(e,'" plugin.')},Xve=function(e){return'There is already registered plugin on priority "'.concat(e,'".')},qve=function(e){return'The priority "'.concat(e,'" is not a number.')},hU=Eve({errorPriorityExists:Xve,errorPriorityNaN:qve}),dU=Bve({errorItemExists:Z_}),iC=iw({errorIdExists:Z_});function pU(){return[].concat(F8(hU.getItems()),F8(dU.getItems()))}function J_(t){var e=Qi(t);return iC.getItem(e)}function Qve(t){return!!J_(t)}function Ct(t,e,r){var n=Jve(t,e,r),i=Vve(n,3);t=i[0],e=i[1],r=i[2],J_(t)===void 0&&Zve(t,e,r)}function Zve(t,e,r){var n=Qi(t);if(iC.hasItem(n))throw new Error(Z_(n));r===void 0?dU.addItem(n):hU.addItem(r,n),iC.addItem(n,e)}function Jve(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}var Hg=$i("renderers"),ege=Hg.register,tge=Hg.getItem,mU=Hg.hasItem;Hg.getNames;Hg.getValues;function H8(t){if(typeof t=="function")return t;if(!mU(t))throw Error('No registered renderer found under "'.concat(t,'" name'));return tge(t)}function na(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),ege(t,e)}var Ug=$i("validators"),rge=Ug.register,nge=Ug.getItem,vU=Ug.hasItem;Ug.getNames;Ug.getValues;function ige(t){if(typeof t=="function")return t;if(!vU(t))throw Error('No registered validator found under "'.concat(t,'" name'));return nge(t)}function mp(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),rge(t,e)}var Tl=1,pn=2;function um(t){"@babel/helpers - typeof";return um=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},um(t)}function oge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function U8(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sge(n.key),n)}}function age(t,e,r){return e&&U8(t.prototype,e),r&&U8(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function sge(t){var e=lge(t,"string");return um(e)==="symbol"?e:String(e)}function lge(t,e){if(um(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(um(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Zu=new WeakMap,uge=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.viewportSize,n=e.scrollOffset,i=e.totalItems,o=e.itemSizeFn,a=e.overrideFn,s=e.calculationType,l=e.stretchMode,u=e.stretchingItemWidthFn,c=u===void 0?function(h){return h}:u,f=e.inlineStartOffset;oge(this,t),Zu.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:i,columnWidthFn:o,overrideFn:a,calculationType:s,stretchingColumnWidthFn:c,inlineStartOffset:f}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return age(t,[{key:"calculate",value:function(){for(var r=0,n=!0,i=[],o,a=0,s=0,l=Zu.get(this),u=l.calculationType,c=l.overrideFn,f=l.scrollOffset,h=Math.max(l.scrollOffset,0),d=l.totalColumns,p=l.viewportWidth,m=h>0?p+1:p,y=0;y<d;y++)if(o=this._getColumnWidth(y),r<=h&&u!==pn&&(this.startColumn=y,a=o),r>=h&&r+(u===pn?o:0)<=h+m&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=y,a=o),this.endColumn=y),i.push(r),r+=o,s=o,u!==pn&&(this.endColumn=y),r>=h+p){n=!1;break}var S=f+p-m,R=u===pn?0:s,E=u===pn?a:0;if(S<-1*l.inlineStartOffset||f>i.at(-1)+R||-1*l.scrollOffset-l.viewportWidth>-1*E?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var O=i[this.endColumn]+o-i[this.startColumn-1];if((O<=p||u!==pn)&&(this.startColumn-=1),O>p)break}u===Tl&&this.startColumn!==null&&c&&c(this),this.startPosition=i[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var i=Zu.get(this),o=i.totalColumns,a=0,s=0;s<o;s++){var l=this._getColumnWidth(s),u=i.stretchingColumnWidthFn(void 0,s);typeof u=="number"?n-=u:a+=l}var c=n-a;if(this.stretch==="all"&&c>0)this.stretchAllRatio=n/a,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var f=this._getColumnWidth(o-1),h=c+f;this.stretchLastWidth=h>=0?h:f}}}},{key:"getStretchedColumnWidth",value:function(r,n){var i=null;return this.stretch==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(r)),i}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var i=0,o=Zu.get(this),a=o.totalColumns;if(!this.stretchAllColumnsWidth[r]){var s=Math.round(n*this.stretchAllRatio),l=o.stretchingColumnWidthFn(s,r);l===void 0?this.stretchAllColumnsWidth[r]=s:this.stretchAllColumnsWidth[r]=isNaN(l)?this._getColumnWidth(r):l}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)i+=this.stretchAllColumnsWidth[u];i!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-i)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=Zu.get(this),i=n.totalColumns;return r===i-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=Zu.get(this).columnWidthFn(r);return isNaN(n)&&(n=t.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),t}();const eA=uge;function cm(t){"@babel/helpers - typeof";return cm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cm(t)}function cge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function B8(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hge(n.key),n)}}function fge(t,e,r){return e&&B8(t.prototype,e),r&&B8(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function hge(t){var e=dge(t,"string");return cm(e)==="symbol"?e:String(e)}function dge(t,e){if(cm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(cm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var V8=new WeakMap,pge=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.viewportSize,n=e.scrollOffset,i=e.totalItems,o=e.itemSizeFn,a=e.overrideFn,s=e.calculationType,l=e.scrollbarHeight;cge(this,t),V8.set(this,{viewportHeight:r,scrollOffset:n,totalRows:i,rowHeightFn:o,overrideFn:a,calculationType:s,horizontalScrollbarHeight:l}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return fge(t,[{key:"calculate",value:function(){for(var r=V8.get(this),n=r.calculationType,i=r.overrideFn,o=r.rowHeightFn,a=r.scrollOffset,s=Math.max(r.scrollOffset,0),l=r.totalRows,u=r.viewportHeight,c=r.horizontalScrollbarHeight||0,f=0,h=!0,d=[],p,m=0,y=0,S=0;S<l;S++)if(p=o(S),isNaN(p)&&(p=t.DEFAULT_HEIGHT),f<=s&&n!==pn&&(this.startRow=S,m=p),f>=s&&f+(n===pn?p:0)<=s+u-c&&(this.startRow===null&&(this.startRow=S,m=p),this.endRow=S),d.push(f),f+=p,y=p,n!==pn&&(this.endRow=S),f>=s+u-c){h=!1;break}var R=a+u-c,E=n===pn?m:0,O=n===pn?0:y;if(R<E||a>d.at(-1)+O?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===l-1&&h)for(this.startRow=this.endRow;this.startRow>0;){var A=d[this.endRow]+p-d[this.startRow-1];if((A<=u-c||n!==pn)&&(this.startRow-=1),A>=u-c)break}n===Tl&&this.startRow!==null&&i&&i(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),l<this.endRow&&(this.endRow=l-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),t}();const gU=pge;function fm(t){"@babel/helpers - typeof";return fm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fm(t)}function mge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vge(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yU(n.key),n)}}function gge(t,e,r){return e&&vge(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function yge(t,e,r){bge(t,e),e.set(t,r)}function bge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function j8(t,e,r){return e=yU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yU(t){var e=wge(t,"string");return fm(e)==="symbol"?e:String(e)}function wge(t,e){if(fm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(fm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gd(t,e){var r=bU(t,e,"get");return Sge(t,r)}function Sge(t,e){return e.get?e.get.call(t):e.value}function Rge(t,e,r){var n=bU(t,e,"set");return Ege(t,n,r),r}function bU(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function Ege(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var ll=new WeakMap,Cge=function(){function t(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;mge(this,t),j8(this,"row",null),j8(this,"col",null),yge(this,ll,{writable:!0,value:!1}),Rge(this,ll,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}return gge(t,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(Gd(this,ll)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(Gd(this,ll)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(Gd(this,ll)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(Gd(this,ll)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new t(this.row,this.col,Gd(this,ll))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),t}();const Z0=Cge;function hm(t){"@babel/helpers - typeof";return hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hm(t)}function Oge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tge(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wU(n.key),n)}}function _ge(t,e,r){return e&&Tge(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Age(t,e,r){Ige(t,e),e.set(t,r)}function Ige(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function h6(t,e,r){return e=wU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wU(t){var e=Nge(t,"string");return hm(e)==="symbol"?e:String(e)}function Nge(t,e){if(hm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(hm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function so(t,e){var r=SU(t,e,"get");return Pge(t,r)}function Pge(t,e){return e.get?e.get.call(t):e.value}function Mge(t,e,r){var n=SU(t,e,"set");return kge(t,n,r),r}function SU(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function kge(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var vi=new WeakMap,xge=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Oge(this,t),h6(this,"highlight",null),h6(this,"from",null),h6(this,"to",null),Age(this,vi,{writable:!0,value:!1}),this.highlight=e.clone().normalize(),this.from=r.clone(),this.to=n.clone(),Mge(this,vi,i)}return _ge(t,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,i=r.col,o=this.getOuterTopStartCorner(),a=this.getOuterBottomEndCorner();return o.row<=n&&a.row>=n&&o.col<=i&&a.col>=i}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>i.row||r.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(i.row,r.row),Math.max(i.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),a=r.getOuterTopStartCorner(),s=r.getOuterBottomEndCorner(),l=Math.min(n.row,a.row),u=Math.min(n.col,a.col),c=Math.max(i.row,s.row),f=Math.max(i.col,s.col),h=this._createCellCoords(l,u),d=this._createCellCoords(c,f);return this.from=h,this.to=d,this.setDirection(o),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var i=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=i[0],this.to=i[1];break;case"SE-NW":var o=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=o[0],this.to=o[1];break;case"SW-NE":var a=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=a[0],this.to=a[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return so(this,vi)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return so(this,vi)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return so(this,vi)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return so(this,vi)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return so(this,vi)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return so(this,vi)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return so(this,vi)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return so(this,vi)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof Z0))return!1;if(n){var i=n.from,o=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(i.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,i.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},o=[];return n.top===i.top&&o.push("top"),n.right===i.right&&o.push("right"),n.bottom===i.bottom&&o.push("bottom"),n.left===i.left&&o.push("left"),o}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],o=r.row;o<=n.row;o++)for(var a=r.col;a<=n.col;a++)!(this.from.row===o&&this.from.col===a)&&!(this.to.row===o&&this.to.col===a)&&i.push(this._createCellCoords(o,a));return i}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],o=r.row;o<=n.row;o++)for(var a=r.col;a<=n.col;a++)r.row===o&&r.col===a?i.push(r):n.row===o&&n.col===a?i.push(n):i.push(this._createCellCoords(o,a));return i}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=n.row;o<=i.row;o++)for(var a=n.col;a<=i.col;a++){var s=r(o,a);if(s===!1)return}}},{key:"clone",value:function(){return new t(this.highlight,this.from,this.to,so(this,vi))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new Z0(r,n,so(this,vi))}}]),t}();const tA=xge;var $ge=Ye,Lge=QT;$ge({target:"Object",stat:!0},{setPrototypeOf:Lge});var RU=rt,Dge=md,Fge=Sr,Hge=fr,W8=Tg,Uge=hg,EU=Function,Bge=RU([].concat),Vge=RU([].join),d6={},jge=function(t,e,r){if(!Hge(d6,e)){for(var n=[],i=0;i<e;i++)n[i]="a["+i+"]";d6[e]=EU("C,a","return new C("+Vge(n,",")+")")}return d6[e](t,r)},Wge=Uge?EU.bind:function(e){var r=Dge(this),n=r.prototype,i=W8(arguments,1),o=function(){var s=Bge(i,W8(arguments));return this instanceof o?jge(r,s.length,s):r.apply(e,s)};return Fge(n)&&(o.prototype=n),o},Gge=Ye,zge=Uo,p6=$u,Yge=Wge,G8=FF,Kge=Rr,z8=Sr,Xge=gd,CU=nt,rA=zge("Reflect","construct"),qge=Object.prototype,Qge=[].push,OU=CU(function(){function t(){}return!(rA(function(){},[],t)instanceof t)}),TU=!CU(function(){rA(function(){})}),Y8=OU||TU;Gge({target:"Reflect",stat:!0,forced:Y8,sham:Y8},{construct:function(e,r){G8(e),Kge(r);var n=arguments.length<3?e:G8(arguments[2]);if(TU&&!OU)return rA(e,r,n);if(e==n){switch(r.length){case 0:return new e;case 1:return new e(r[0]);case 2:return new e(r[0],r[1]);case 3:return new e(r[0],r[1],r[2]);case 4:return new e(r[0],r[1],r[2],r[3])}var i=[null];return p6(Qge,i,r),new(p6(Yge,e,i))}var o=n.prototype,a=Xge(z8(o)?o:qge),s=p6(e,a,r);return z8(s)?s:a}});function dm(t){"@babel/helpers - typeof";return dm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dm(t)}function Zge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jge(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tye(n.key),n)}}function eye(t,e,r){return e&&Jge(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function tye(t){var e=rye(t,"string");return dm(e)==="symbol"?e:String(e)}function rye(t,e){if(dm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(dm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Ju=new WeakMap,nye=function(){function t(e,r,n,i,o,a){var s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Zge(this,t),this.wtSettings=n,this.domBindings=r,this.wtTable=o,this.selections=a,this.parent=s,this.eventManager=i,this.facadeGetter=e,Ju.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return eye(t,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(o){return r.onContextMenu(o)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(o){return r.onMouseOver(o)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(o){return r.onMouseOut(o)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(a){return r.onTouchStart(a)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(a){return r.onTouchEnd(a)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},i=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(a){return r.onMouseUp(a)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(a){return r.onMouseDown(a)})};Ao()?n():(LF()&&n(),i())}},{key:"selectedCellWasTouched",value:function(r){var n=Ju.get(this),i=this.parentCell(r),o=i.coords;if(n.selectedCellBeforeTouchEnd&&o){var a=[o.row,n.selectedCellBeforeTouchEnd.from.row],s=a[0],l=a[1],u=[o.col,n.selectedCellBeforeTouchEnd.from.col],c=u[0],f=u[1];return s===l&&c===f}return!1}},{key:"parentCell",value:function(r){var n={},i=this.wtTable.TABLE,o=Cy(r,["TD","TH"],i);return o?(n.coords=this.wtTable.getCoords(o),n.TD=o):Xe(r,"wtBorder")&&Xe(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):Xe(r,"wtBorder")&&Xe(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=Ju.get(this),i=this.domBindings.rootDocument.activeElement,o=GH(ipe,r.target),a=r.target;if(!(a===i||o(0)===i||o(1)===i)){var s=this.parentCell(a);Xe(a,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,a):s.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,s.coords,s.TD),(r.button===0||this.touchApplied)&&s.TD&&(n.dblClickOrigin[0]=s.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,i=Cy(r.target,["TD","TH"],n),o=this.parent||this;i&&i!==o.lastMouseOver&&lu(i,n)&&(o.lastMouseOver=i,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(i),i))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,i=Cy(r.target,["TD","TH"],n),o=Cy(r.relatedTarget,["TD","TH"],n),a=this.parent||this;i&&i!==o&&lu(i,n)&&(this.callListener("onCellMouseOut",r,this.wtTable.getCoords(i),i),o===null&&(a.lastMouseOver=null))}}},{key:"onMouseUp",value:function(r){var n=Ju.get(this),i=this.parentCell(r.target);i.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,i.coords,i.TD),!(r.button!==0&&!this.touchApplied)&&(i.TD===n.dblClickOrigin[0]&&i.TD===n.dblClickOrigin[1]?(Xe(r.target,"corner")?this.callListener("onCellCornerDblClick",r,i.coords,i.TD):this.callListener("onCellDblClick",r,i.coords,i.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):i.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=i.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=Ju.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,i=r.target,o=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,a=Ae(o)&&o.row>=0&&o.col>=0,s=r.cancelable&&a&&this.wtSettings.getSetting("isDataViewInstance");if(s){var l=["A","BUTTON","INPUT"];VF()&&(qle()||Qle())&&this.selectedCellWasTouched(i)&&!l.includes(i.tagName)?r.preventDefault():this.selectedCellWasTouched(i)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,i,o){var a=this.wtSettings.getSettingPure(r);a&&a(n,i,o,this.facadeGetter())}},{key:"destroy",value:function(){var r=Ju.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),t}();const _U=nye;function pm(t){"@babel/helpers - typeof";return pm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pm(t)}function iye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oye(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sye(n.key),n)}}function aye(t,e,r){return e&&oye(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function sye(t){var e=lye(t,"string");return pm(e)==="symbol"?e:String(e)}function lye(t,e){if(pm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(pm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var uye=function(){function t(e,r,n){iye(this,t),this.offset=e,this.total=r,this.countTH=n}return aye(t,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),t}();const cye=uye;function mm(t){"@babel/helpers - typeof";return mm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mm(t)}function fye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hye(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,pye(n.key),n)}}function dye(t,e,r){return e&&hye(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function pye(t){var e=mye(t,"string");return mm(e)==="symbol"?e:String(e)}function mye(t,e){if(mm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(mm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var vye=function(){function t(e,r,n){fye(this,t),this.offset=e,this.total=r,this.countTH=n}return dye(t,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),t}();const gye=vye;var yye=0,J0=1,eb=2;function vm(t){"@babel/helpers - typeof";return vm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vm(t)}function bye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wye(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Rye(n.key),n)}}function Sye(t,e,r){return e&&wye(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Rye(t){var e=Eye(t,"string");return vm(e)==="symbol"?e:String(e)}function Eye(t,e){if(vm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(vm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var K8=function(){function t(){bye(this,t),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return Sye(t,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),t}();function gm(t){"@babel/helpers - typeof";return gm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gm(t)}function Cye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Oye(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_ye(n.key),n)}}function Tye(t,e,r){return e&&Oye(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function _ye(t){var e=Aye(t,"string");return gm(e)==="symbol"?e:String(e)}function Aye(t,e){if(gm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(gm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Iye=function(){function t(){Cye(this,t),this.size=new K8,this.workingSpace=yye,this.sharedSize=null}return Tye(t,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof K8}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=J0,r.workingSpace=eb,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=eb,r.workingSpace=J0,this.sharedSize=r.getViewSize()}}]),t}();function ym(t){"@babel/helpers - typeof";return ym=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ym(t)}function Nye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Pye(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,kye(n.key),n)}}function Mye(t,e,r){return e&&Pye(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function kye(t){var e=xye(t,"string");return ym(e)==="symbol"?e:String(e)}function xye(t,e){if(ym(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(ym(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var AU=function(){function t(e,r,n){Nye(this,t),this.rootNode=e,this.nodesPool=r,this.sizeSet=new Iye,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return Mye(t,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,i=0;if(this.isSharedViewSet())for(var o=r.firstElementChild;o;){if(o.tagName===this.childNodeType)i+=1;else if(n.isPlaceOn(J0))break;o=o.nextElementSibling}else i=r.childElementCount;return i}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,i=this.isSharedViewSet(),o=n.getViewSize(),a=o.nextSize,s=this.getRenderedChildCount();s<a;){var l=this.nodesPool();!i||i&&n.isPlaceOn(eb)?r.appendChild(l):r.insertBefore(l,r.firstChild),s+=1}for(var u=i&&n.isPlaceOn(J0);s>a;)r.removeChild(u?r.firstChild:r.lastChild),s-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,i=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(eb)&&(i+=n.sharedSize.nextSize);var o=r.childNodes[i];if(o.tagName!==this.childNodeType){var a=this.nodesPool();r.replaceChild(a,o),o=a}this.collectedNodes.push(o),this.visualIndex+=1}},{key:"end",value:function(){}}]),t}();function df(t){"@babel/helpers - typeof";return df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},df(t)}function $ye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Lye(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Fye(n.key),n)}}function Dye(t,e,r){return e&&Lye(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fye(t){var e=Hye(t,"string");return df(e)==="symbol"?e:String(e)}function Hye(t,e){if(df(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(df(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Uye(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oC(t,e)}function oC(t,e){return oC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},oC(t,e)}function Bye(t){var e=Wye();return function(){var n=tb(t),i;if(e){var o=tb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Vye(this,i)}}function Vye(t,e){if(e&&(df(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jye(t)}function jye(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Wye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tb(t){return tb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tb(t)}var IU=function(t){Uye(r,t);var e=Bye(r);function r(){return $ye(this,r),e.apply(this,arguments)}return Dye(r,[{key:"prependView",value:function(i){return this.sizeSet.prepend(i.sizeSet),i.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(i){return this.sizeSet.append(i.sizeSet),i.sizeSet.prepend(this.sizeSet),this}}]),r}(AU);function bm(t){"@babel/helpers - typeof";return bm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bm(t)}function Gye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zye(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Kye(n.key),n)}}function Yye(t,e,r){return e&&zye(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Kye(t){var e=Xye(t,"string");return bm(e)==="symbol"?e:String(e)}function Xye(t,e){if(bm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(bm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var qye=function(){function t(e){Gye(this,t),this.nodeType=e.toUpperCase()}return Yye(t,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),t}();function wm(t){"@babel/helpers - typeof";return wm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wm(t)}function Qye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zye(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,e1e(n.key),n)}}function Jye(t,e,r){return e&&Zye(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function e1e(t){var e=t1e(t,"string");return wm(e)==="symbol"?e:String(e)}function t1e(t,e){if(wm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(wm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Bg=function(){function t(e,r){Qye(this,t),this.nodesPool=typeof e=="string"?new qye(e):null,this.nodeType=e,this.rootNode=r,this.table=null,this.renderedNodes=0}return Jye(t,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),t}();function pf(t){"@babel/helpers - typeof";return pf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pf(t)}function r1e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n1e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,o1e(n.key),n)}}function i1e(t,e,r){return e&&n1e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function o1e(t){var e=a1e(t,"string");return pf(e)==="symbol"?e:String(e)}function a1e(t,e){if(pf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(pf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function s1e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&aC(t,e)}function aC(t,e){return aC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},aC(t,e)}function l1e(t){var e=f1e();return function(){var n=rb(t),i;if(e){var o=rb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return u1e(this,i)}}function u1e(t,e){if(e&&(pf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c1e(t)}function c1e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rb(t){return rb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rb(t)}var h1e=function(t){s1e(r,t);var e=l1e(r);function r(){var n;return r1e(this,r),n=e.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return i1e(r,[{key:"obtainOrderView",value:function(i){var o=this,a;return this.orderViews.has(i)?a=this.orderViews.get(i):(a=new IU(i,function(s){return o.nodesPool.obtain(o.sourceRowIndex,s)},this.nodeType),this.orderViews.set(i,a)),a}},{key:"render",value:function(){for(var i=this.table,o=i.rowsToRender,a=i.rowHeaderFunctions,s=i.rowHeadersCount,l=i.rows,u=i.cells,c=0;c<o;c++){var f=this.table.renderedRowToSource(c),h=l.getRenderedNode(c);this.sourceRowIndex=f;var d=this.obtainOrderView(h),p=u.obtainOrderView(h);d.appendView(p).setSize(s).setOffset(this.table.renderedColumnToSource(0)).start();for(var m=0;m<s;m++){d.render();var y=d.getCurrentNode();y.className="",y.removeAttribute("style"),a[m](f,y,m)}d.end()}}}]),r}(Bg);function mf(t){"@babel/helpers - typeof";return mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mf(t)}function d1e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p1e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,v1e(n.key),n)}}function m1e(t,e,r){return e&&p1e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function v1e(t){var e=g1e(t,"string");return mf(e)==="symbol"?e:String(e)}function g1e(t,e){if(mf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(mf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function y1e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sC(t,e)}function sC(t,e){return sC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sC(t,e)}function b1e(t){var e=R1e();return function(){var n=nb(t),i;if(e){var o=nb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return w1e(this,i)}}function w1e(t,e){if(e&&(mf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return S1e(t)}function S1e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function R1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nb(t){return nb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nb(t)}var E1e=function(t){y1e(r,t);var e=b1e(r);function r(n){return d1e(this,r),e.call(this,null,n)}return m1e(r,[{key:"adjust",value:function(){var i=this.table,o=i.columnHeadersCount,a=i.rowHeadersCount,s=this.rootNode.firstChild;if(o){for(var l=this.table.columnsToRender,u=l+a,c=0,f=o;c<f;c++){for(s=this.rootNode.childNodes[c],s||(s=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(s)),this.renderedNodes=s.childNodes.length;this.renderedNodes<u;)s.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)s.removeChild(s.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>o)for(var d=o;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else s&&$o(s)}},{key:"render",value:function(){for(var i=this.table.columnHeadersCount,o=0;o<i;o+=1)for(var a=this.table,s=a.columnHeaderFunctions,l=a.columnsToRender,u=a.rowHeadersCount,c=this.rootNode.childNodes[o],f=-1*u;f<l;f+=1){var h=this.table.renderedColumnToSource(f),d=c.childNodes[f+u];d.className="",d.removeAttribute("style"),s[o](h,d,o)}}}]),r}(Bg);function vf(t){"@babel/helpers - typeof";return vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vf(t)}function C1e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O1e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_1e(n.key),n)}}function T1e(t,e,r){return e&&O1e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function _1e(t){var e=A1e(t,"string");return vf(e)==="symbol"?e:String(e)}function A1e(t,e){if(vf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(vf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function I1e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lC(t,e)}function lC(t,e){return lC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},lC(t,e)}function N1e(t){var e=k1e();return function(){var n=ib(t),i;if(e){var o=ib(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return P1e(this,i)}}function P1e(t,e){if(e&&(vf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return M1e(t)}function M1e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function k1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ib(t){return ib=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ib(t)}var x1e=function(t){I1e(r,t);var e=N1e(r);function r(n){return C1e(this,r),e.call(this,null,n)}return T1e(r,[{key:"adjust",value:function(){for(var i=this.table,o=i.columnsToRender,a=i.rowHeadersCount,s=o+a;this.renderedNodes<s;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>s;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var i=this.table,o=i.columnsToRender,a=i.rowHeadersCount,s=0;s<a;s++){var l=this.table.renderedColumnToSource(s),u=this.table.columnUtils.getHeaderWidth(l);this.rootNode.childNodes[s].style.width="".concat(u,"px")}for(var c=0;c<o;c++){var f=this.table.renderedColumnToSource(c),h=this.table.columnUtils.getStretchedColumnWidth(f);this.rootNode.childNodes[c+a].style.width="".concat(h,"px")}var d=this.rootNode.firstChild;d&&le(d,"rowHeader")}}]),r}(Bg);function gf(t){"@babel/helpers - typeof";return gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gf(t)}var X8;function $1e(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function L1e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function D1e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,H1e(n.key),n)}}function F1e(t,e,r){return e&&D1e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function H1e(t){var e=U1e(t,"string");return gf(e)==="symbol"?e:String(e)}function U1e(t,e){if(gf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(gf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function B1e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&uC(t,e)}function uC(t,e){return uC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},uC(t,e)}function V1e(t){var e=G1e();return function(){var n=ob(t),i;if(e){var o=ob(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return j1e(this,i)}}function j1e(t,e){if(e&&(gf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return W1e(t)}function W1e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function G1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ob(t){return ob=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ob(t)}var q8=!1,z1e=function(t){B1e(r,t);var e=V1e(r);function r(n){var i;return L1e(this,r),i=e.call(this,"TR",n),i.orderView=new AU(n,function(o){return i.nodesPool.obtain(o)},i.nodeType),i}return F1e(r,[{key:"getRenderedNode",value:function(i){return this.orderView.getNode(i)}},{key:"render",value:function(){var i=this.table.rowsToRender;!q8&&i>1e3&&(q8=!0,Dt(kt(X8||(X8=$1e([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(i).setOffset(this.table.renderedRowToSource(0)).start();for(var o=0;o<i;o++)this.orderView.render();this.orderView.end()}}]),r}(Bg);function yf(t){"@babel/helpers - typeof";return yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yf(t)}function Y1e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function K1e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,q1e(n.key),n)}}function X1e(t,e,r){return e&&K1e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function q1e(t){var e=Q1e(t,"string");return yf(e)==="symbol"?e:String(e)}function Q1e(t,e){if(yf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(yf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Z1e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cC(t,e)}function cC(t,e){return cC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},cC(t,e)}function J1e(t){var e=r0e();return function(){var n=ab(t),i;if(e){var o=ab(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return e0e(this,i)}}function e0e(t,e){if(e&&(yf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t0e(t)}function t0e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function r0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ab(t){return ab=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ab(t)}var n0e=function(t){Z1e(r,t);var e=J1e(r);function r(){var n;return Y1e(this,r),n=e.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return X1e(r,[{key:"obtainOrderView",value:function(i){var o=this,a;return this.orderViews.has(i)?a=this.orderViews.get(i):(a=new IU(i,function(s){return o.nodesPool.obtain(o.sourceRowIndex,s)},this.nodeType),this.orderViews.set(i,a)),a}},{key:"render",value:function(){for(var i=this.table,o=i.rowsToRender,a=i.columnsToRender,s=i.rows,l=i.rowHeaders,u=0;u<o;u++){var c=this.table.renderedRowToSource(u),f=s.getRenderedNode(u);this.sourceRowIndex=c;var h=this.obtainOrderView(f),d=l.obtainOrderView(f);h.prependView(d).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var p=0;p<a;p++){h.render();var m=h.getCurrentNode(),y=this.table.renderedColumnToSource(p);Xe(m,"hide")||(m.className=""),m.removeAttribute("style"),m.removeAttribute("dir"),this.table.cellRenderer(c,y,m)}h.end()}}}]),r}(Bg);function Sm(t){"@babel/helpers - typeof";return Sm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sm(t)}function i0e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o0e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s0e(n.key),n)}}function a0e(t,e,r){return e&&o0e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function s0e(t){var e=l0e(t,"string");return Sm(e)==="symbol"?e:String(e)}function l0e(t,e){if(Sm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Sm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var u0e=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;i0e(this,t),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return a0e(t,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,i=r.columnHeaders,o=r.colGroup,a=r.rows,s=r.cells;n.setTable(this),i.setTable(this),o.setTable(this),a.setTable(this),s.setTable(this),this.rowHeaders=n,this.columnHeaders=i,this.colGroup=o,this.rows=a,this.cells=s}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,i=0;i<r;i++){var o=n.getRenderedNode(i);if(o.firstChild){var a=this.renderedRowToSource(i),s=this.rowUtils.getHeight(a);s?o.firstChild.style.height="".concat(s-1,"px"):o.firstChild.style.height=""}}}}]),t}();function Rm(t){"@babel/helpers - typeof";return Rm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rm(t)}function c0e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f0e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,d0e(n.key),n)}}function h0e(t,e,r){return e&&f0e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function d0e(t){var e=p0e(t,"string");return Rm(e)==="symbol"?e:String(e)}function p0e(t,e){if(Rm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Rm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var m0e=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.TABLE,n=e.THEAD,i=e.COLGROUP,o=e.TBODY,a=e.rowUtils,s=e.columnUtils,l=e.cellRenderer;c0e(this,t),this.renderer=new u0e(r,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new h1e,columnHeaders:new E1e(n),colGroup:new x1e(i),rows:new z1e(o),cells:new n0e}),this.renderer.setAxisUtils(a,s)}return h0e(t,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),t}();function Em(t){"@babel/helpers - typeof";return Em=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Em(t)}function v0e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g0e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,b0e(n.key),n)}}function y0e(t,e,r){return e&&g0e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function b0e(t){var e=w0e(t,"string");return Em(e)==="symbol"?e:String(e)}function w0e(t,e){if(Em(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Em(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var S0e=function(){function t(e,r){v0e(this,t),this.dataAccessObject=e,this.wtSettings=r,this.headerWidths=new Map}return y0e(t,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,i=this.getWidth(r);if(n){var o=n.getStretchedColumnWidth(r,i);o&&(i=o)}return i}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return i!==void 0&&(n=n?Math.max(n,i):i),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,i=n.wtTable,o=n.wtViewport,a=n.cloneSource,s=a?a.wtTable.holder:i.holder,l=s.offsetHeight<s.scrollHeight?Xr():0,u=r.getSetting("rowHeaderWidth");if(o.columnsRenderCalculator.refreshStretching(o.getViewportWidth()-l),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var c=r.getSetting("rowHeaders").length,f=r.getSetting("defaultColumnWidth"),h=0;h<c;h++){var d=Array.isArray(u)?u[h]:u;d=d??f,this.headerWidths.set(h,d)}}}]),t}();function Cm(t){"@babel/helpers - typeof";return Cm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cm(t)}function R0e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E0e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,O0e(n.key),n)}}function C0e(t,e,r){return e&&E0e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function O0e(t){var e=T0e(t,"string");return Cm(e)==="symbol"?e:String(e)}function T0e(t,e){if(Cm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Cm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var _0e=function(){function t(e,r){R0e(this,t),this.dataAccessObject=e,this.wtSettings=r}return C0e(t,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),i=this.dataAccessObject.wtViewport.oversizedRows[r];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}]),t}();function Om(t){"@babel/helpers - typeof";return Om=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Om(t)}function A0e(t){return P0e(t)||N0e(t)||NU(t)||I0e()}function I0e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function N0e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function P0e(t){if(Array.isArray(t))return fC(t)}function M0e(t,e){return $0e(t)||x0e(t,e)||NU(t,e)||k0e()}function k0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NU(t,e){if(t){if(typeof t=="string")return fC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fC(t,e)}}function fC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function x0e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function $0e(t){if(Array.isArray(t))return t}function L0e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function D0e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,PU(n.key),n)}}function F0e(t,e,r){return e&&D0e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function lo(t,e,r){return e=PU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PU(t){var e=H0e(t,"string");return Om(e)==="symbol"?e:String(e)}function H0e(t,e){if(Om(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Om(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var U0e=function(){function t(e,r,n,i,o){var a=this;L0e(this,t),lo(this,"wtSettings",null),lo(this,"domBindings",void 0),lo(this,"TBODY",null),lo(this,"THEAD",null),lo(this,"COLGROUP",null),lo(this,"hasTableHeight",!0),lo(this,"hasTableWidth",!0),lo(this,"isTableVisible",!1),lo(this,"tableOffset",0),lo(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,BH(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return a._modifyRowHeaderWidth(s)}),this.rowUtils=new _0e(this.dataAccessObject,this.wtSettings),this.columnUtils=new S0e(this.dataAccessObject,this.wtSettings),this.tableRenderer=new m0e({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return F0e(t,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Xe(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,r),i.appendChild(r)),i.style.position="relative",i}},{key:"createHider",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Xe(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,r),i.appendChild(r)),i}},{key:"createHolder",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Xe(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",n&&n.insertBefore(i,r),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),i.appendChild(r)),i}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,i=this.dataAccessObject,o=i.wtOverlays,a=i.wtViewport,s=n.getSetting("totalRows"),l=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),c=u.length,f=n.getSetting("columnHeaders"),h=f.length,d=!1,p=r;if(this.isMaster&&(this.holderOffset=xr(this.holder),p=a.createRenderCalculators(p),c&&!n.getSetting("fixedColumnsStart"))){var m=o.inlineStartOverlay.getScrollPosition(),y=this.correctHeaderWidth;this.correctHeaderWidth=m!==0,y!==this.correctHeaderWidth&&(p=!1)}if(this.isMaster&&(d=o.updateStateOfRendering()),p)this.isMaster&&a.createVisibleCalculators(),o&&o.refresh(!0);else{this.isMaster?this.tableOffset=xr(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var S=s>0?this.getFirstRenderedRow():0,R=l>0?this.getFirstRenderedColumn():0;this.rowFilter=new gye(S,s,h),this.columnFilter=new cye(R,l,c);var E=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var O={};this.wtSettings.getSetting("beforeDraw",!0,O),E=O.skipRender!==!0}if(E){this.tableRenderer.setHeaderContentRenderers(u,f),(this.is(_o)||this.is(Ns))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var A;if(this.isMaster&&(A=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(_o))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var B=Ut(this.hider),j=Ut(this.TABLE);B!==0&&j!==B&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),A!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(_o)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var J=!1;return this.isMaster&&(J=o.topOverlay.resetFixedPosition(),o.bottomOverlay.clone&&(J=o.bottomOverlay.resetFixedPosition()||J),J=o.inlineStartOverlay.resetFixedPosition()||J,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition()),J?(o.refreshAll(),o.adjustElementsSize()):this.refreshSelections(p),d&&o.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),i=this.wtSettings.getSetting("columnHeaders").length,o=this.wtSettings.getSetting("defaultRowHeight"),a,s,l,u=this.wtSettings.getSetting("columnHeaderHeight")||[];i;)i-=1,a=this.getColumnHeaderHeight(i),s=this.getColumnHeader(n,i),s&&(l=Es(s),(!a&&o<l||a<l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),Array.isArray(u)?u[i]!==null&&u[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(u[i]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,o=r.getSetting("columnHeaders"),a=0,s=o.length;a<s;a++)if(i[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(i[a],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(_o))&&!r.getSetting("externalRowCalculator"))for(var i=this.getRenderedRowsCount(),o=0;o<i;o++){var a=this.rowFilter.renderedToSource(o);n.oversizedRows&&n.oversizedRows[a]&&(n.oversizedRows[a]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),i=0,o=n.length;i<o;i++)qe(n[i],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,i=this.dataAccessObject.selections;if(i){var o=Array.from(i),a=o.length;if(r){for(var s=[],l=0;l<a;l++){for(var u=o[l].settings,c=u.highlightHeaderClassName,f=u.highlightRowClassName,h=u.highlightColumnClassName,d=o[l].classNames,p=d.length,m=0;m<p;m++)s.includes(d[m])||s.push(d[m]);c&&!s.includes(c)&&s.push(c),f&&!s.includes(f)&&s.push(f),h&&!s.includes(h)&&s.push(h)}var y=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(y))for(var S=0;S<y.length;S++)s.push(y[S]);for(var R=s.length,E=0;E<R;E++)this.removeClassFromCells(s[E])}for(var O=0;O<a;O++)o[O].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,i=r.col,o=this.wtSettings.getSetting("onModifyGetCellCoords",n,i);if(o&&Array.isArray(o)){var a=M0e(o,2);n=a[0],i=a[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;var s=this.getRow(n);if(!s&&n>=0)throw new Error("TR was expected to be rendered but is not");var l=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!l&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return l}},{key:"getRow",value:function(r){var n=null,i=null;if(r<0){var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceRowToVisibleColHeadedRow(r),i=this.THEAD}else{var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceToRendered(r),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(o){var a=o.childNodes[i];a&&n.push(a)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var i=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=i)){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return o==null?void 0:o.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],i=this.wtSettings.getSetting("rowHeaders").length,o=0;o<i;o++){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],s=a==null?void 0:a.childNodes[o];s&&n.push(s)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=su(n,["TD","TH"])),n===null)return null;var i=n.parentNode,o=i.parentNode,a=ape(i),s=n.cellIndex;if(sl(gu,n,this.wtRootElement)||sl(mu,n,this.wtRootElement))o.nodeName==="THEAD"&&(a-=o.childNodes.length);else if(sl(Ns,n,this.wtRootElement)||sl(_o,n,this.wtRootElement)){var l=this.wtSettings.getSetting("totalRows");a=l-o.childNodes.length+a}else o===this.THEAD?a=this.rowFilter.visibleColHeadedRowToSourceRow(a):a=this.rowFilter.renderedToSource(a);return sl(gu,n,this.wtRootElement)||sl(vu,n,this.wtRootElement)||sl(Ns,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(a,s)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),i=Es(this.TBODY)-1,o,a,s,l,u;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,s=this.rowFilter.renderedToSource(r),o=this.getRowHeight(s),l=this.getTrForRow(s),u=l.querySelector("th"),u?a=Es(u):a=Es(l)-1,(!o&&this.wtSettings.getSetting("defaultRowHeight")<a||o<a)&&(a+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=a)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return Ut(this.TABLE)}},{key:"getHeight",value:function(){return ur(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=Ut(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=ur(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return rm(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=Xt(r)?r():null;return Array.isArray(n)?(n=A0e(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),t}();const Cd=U0e;var B0e="stickyRowsBottom",MU={getFirstRenderedRow:function(){var e=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=e-r;return e===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Ka(MU,"MIXIN_NAME",B0e,{writable:!1,enumerable:!1});const kU=MU;var V0e="stickyColumnsStart",xU={getFirstRenderedColumn:function(){var e=this.wtSettings.getSetting("totalColumns");return e===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Ka(xU,"MIXIN_NAME",V0e,{writable:!1,enumerable:!1});const nA=xU;function hC(t){"@babel/helpers - typeof";return hC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hC(t)}function j0e(t,e,r){return Object.defineProperty(t,"prototype",{writable:!1}),t}function W0e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function G0e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dC(t,e)}function dC(t,e){return dC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},dC(t,e)}function z0e(t){var e=X0e();return function(){var n=sb(t),i;if(e){var o=sb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Y0e(this,i)}}function Y0e(t,e){if(e&&(hC(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return K0e(t)}function K0e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function X0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sb(t){return sb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sb(t)}var iA=function(t){G0e(r,t);var e=z0e(r);function r(n,i,o,a){return W0e(this,r),e.call(this,n,i,o,a,Ns)}return j0e(r)}(Cd);Kt(iA,kU);Kt(iA,nA);const q0e=iA;var mu="top",_o="bottom",vu="inline_start",gu="top_inline_start_corner",Ns="bottom_inline_start_corner",Q0e=[mu,_o,vu,gu,Ns],Z0e=new Map([[mu,"ht_clone_".concat(mu)],[_o,"ht_clone_".concat(_o)],[vu,"ht_clone_".concat(vu," ht_clone_left")],[gu,"ht_clone_".concat(gu," ht_clone_top_left_corner")],[Ns,"ht_clone_".concat(Ns," ht_clone_bottom_left_corner")]]);function Tm(t){"@babel/helpers - typeof";return Tm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tm(t)}function J0e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ebe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$U(n.key),n)}}function tbe(t,e,r){return e&&ebe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function m6(t,e,r){return e=$U(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $U(t){var e=rbe(t,"string");return Tm(e)==="symbol"?e:String(e)}function rbe(t,e){if(Tm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Tm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var nbe=function(){function t(e){J0e(this,t),m6(this,"dataAccessObject",void 0),m6(this,"lastScrolledColumnPos",-1),m6(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}return tbe(t,[{key:"scrollViewport",value:function(r,n,i,o,a){var s=this.scrollViewportHorizontally(r.col,i,a),l=this.scrollViewportVertically(r.row,n,o);return s||l}},{key:"scrollViewportHorizontally",value:function(r,n,i){var o=this.dataAccessObject,a=o.drawn,s=o.totalColumns;if(!a||!Number.isInteger(r)||r<0||r>s)return!1;var l=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),c=n===void 0&&i===void 0,f=this.dataAccessObject,h=f.fixedColumnsStart,d=f.inlineStartOverlay;if(c&&r<h)return!1;var p=!1;return l===-1?p=d.scrollTo(r,c?r>this.lastScrolledColumnPos:n):(c&&(r<l||r>u)||!c)&&(p=d.scrollTo(r,c?r>u:n)),p&&(this.lastScrolledColumnPos=r),p}},{key:"scrollViewportVertically",value:function(r,n,i){var o=this.dataAccessObject,a=o.drawn,s=o.totalRows;if(!a||!Number.isInteger(r)||r<0||r>s)return!1;var l=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),c=n===void 0&&i===void 0,f=this.dataAccessObject,h=f.fixedRowsBottom,d=f.fixedRowsTop,p=f.topOverlay;if(c&&(r<d||r>s-h-1))return!1;var m=!1;return l===-1?m=p.scrollTo(r,c?r>this.lastScrolledRowPos:i):(c&&(r<l||r>u)||!c)&&(m=p.scrollTo(r,c?r>u:i)),m&&(this.lastScrolledRowPos=r),m}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,o=r.wtViewport,a=r.totalRows,s=r.fixedRowsTop,l=r.rootWindow,u=i.getFirstVisibleRow();if(n.mainTableScrollableElement===l){var c=xr(i.wtRootElement),f=Es(i.hider),h=Es(l),d=X0(l,l);if(c.top+f-h<=d){var p=o.getColumnHeaderHeight();p+=n.sumCellSizes(0,s);for(var m=a;m>0;m--)if(p+=n.sumCellSizes(m-1,m),c.top+f-p<=d){u=m;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,o=r.wtViewport,a=r.totalRows,s=r.rootWindow,l=i.getLastVisibleRow();if(n.mainTableScrollableElement===s){var u=xr(i.wtRootElement),c=X0(s,s);if(u.top>c){for(var f=Es(s),h=o.getColumnHeaderHeight(),d=1;d<=a;d++)if(h+=n.sumCellSizes(d-1,d),u.top+h-c>=f){l=d-2;break}}}return l}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,i=r.wtTable,o=r.wtViewport,a=r.totalColumns,s=r.rootWindow,l=i.getFirstVisibleColumn();if(n.mainTableScrollableElement===s){var u=xr(i.wtRootElement),c=G1(i.hider),f=G1(s),h=Math.abs(BE(s,s));if(u.left+c-f<=h){for(var d=o.getRowHeaderWidth(),p=a;p>0;p--)if(d+=n.sumCellSizes(p-1,p),u.left+c-d<=h){l=p;break}}}return l}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,i=r.inlineStartOverlay,o=r.wtTable,a=r.wtViewport,s=r.totalColumns,l=r.rootWindow,u=o.getLastVisibleColumn();if(i.mainTableScrollableElement===l){var c=n.getSetting("rtlMode"),f=null;if(c){var h=o.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document,p=d.documentElement.offsetWidth;f=Math.abs(h.right-p)}else{var m=xr(o.wtRootElement);f=m.left}var y=Math.abs(BE(l,l));if(f>y){for(var S=G1(l),R=a.getRowHeaderWidth(),E=1;E<=s;E++)if(R+=i.sumCellSizes(E-1,E),f+R-y>=S){u=E-2;break}}}return u}}]),t}();const ibe=nbe;function _m(t){"@babel/helpers - typeof";return _m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_m(t)}function obe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function abe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,LU(n.key),n)}}function sbe(t,e,r){return e&&abe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Di(t,e,r){return e=LU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LU(t){var e=lbe(t,"string");return _m(e)==="symbol"?e:String(e)}function lbe(t,e){if(_m(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(_m(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var oA=function(){function t(e,r){obe(this,t),Di(this,"wtTable",void 0),Di(this,"wtScroll",void 0),Di(this,"wtViewport",void 0),Di(this,"wtOverlays",void 0),Di(this,"selections",void 0),Di(this,"wtEvent",void 0),Di(this,"guid","wt_".concat(FH())),Di(this,"drawInterrupted",!1),Di(this,"drawn",!1),Di(this,"domBindings",void 0),Di(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new ibe(this.createScrollDao())}return sbe(t,[{key:"eventManager",get:function(){return new hr(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(o,a){hu(a,r[o])}])}}},{key:"createCellCoords",value:function(r,n){return new Z0(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,i){return new tA(r,n,i,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var i=this.wtSettings.getSetting("totalRows"),o=this.wtSettings.getSetting("fixedRowsTop"),a=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<o&&r.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<o)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<s&&r.row>=i-a){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<i&&r.row>=i-a&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,i,o,a){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,i,o,a)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),t}();function bf(t){"@babel/helpers - typeof";return bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bf(t)}function ube(t,e,r){return Object.defineProperty(t,"prototype",{writable:!1}),t}function cbe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fbe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pC(t,e)}function pC(t,e){return pC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},pC(t,e)}function hbe(t){var e=pbe();return function(){var n=lb(t),i;if(e){var o=lb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return dbe(this,i)}}function dbe(t,e){if(e&&(bf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return z1(t)}function z1(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pbe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lb(t){return lb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lb(t)}function Q8(t,e,r){return e=mbe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mbe(t){var e=vbe(t,"string");return bf(e)==="symbol"?e:String(e)}function vbe(t,e){if(bf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(bf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var gbe=function(t){fbe(r,t);var e=hbe(r);function r(n,i,o){var a;cbe(this,r),a=e.call(this,n,i),Q8(z1(a),"cloneSource",void 0),Q8(z1(a),"cloneOverlay",void 0);var s=a.wtSettings.getSetting("facade",z1(a));return a.cloneSource=o.source,a.cloneOverlay=o.overlay,a.wtTable=a.cloneOverlay.createTable(a.getTableDao(),s,a.domBindings,a.wtSettings),a.wtViewport=o.viewport,a.selections=o.selections,a.wtEvent=new _U(s,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections,o.event),a.findOriginalHeaders(),a}return ube(r)}(oA);function Am(t){"@babel/helpers - typeof";return Am=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Am(t)}function ybe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bbe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,DU(n.key),n)}}function wbe(t,e,r){return e&&bbe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Sbe(t,e,r){return e=DU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DU(t){var e=Rbe(t,"string");return Am(e)==="symbol"?e:String(e)}function Rbe(t,e){if(Am(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Am(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Vg=function(){function t(e,r,n,i,o){ybe(this,t),Sbe(this,"wtSettings",null),Ka(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=r,this.wtSettings=i;var a=this.wot.wtTable,s=a.TABLE,l=a.hider,u=a.spreader,c=a.holder,f=a.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=l,this.spreader=u,this.holder=c,this.wtRootElement=f,this.trimmingContainer=hf(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return wbe(t,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=hf(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=q0(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,i){if(this.clone.wtTable.holder.contains(r)===!1){Dt("The provided element is not a child of the ".concat(this.type," overlay"));return}var o=this.mainTableScrollableElement===this.domBindings.rootWindow,a=i<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),l=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,c={start:this.getRelativeStartPosition(u),top:u.offsetTop},f={start:this.getRelativeStartPosition(r),top:r.offsetTop},h=null;return o?h=this.getRelativeCellPositionWithinWindow(s,a,f,c):h=this.getRelativeCellPositionWithinHolder(s,l,a,f,c),h}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,i,o){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect(),s=0,l=0;if(!n)s=o.start;else{var u=a.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(a.left+a.width+Xr())),s=u<=0?-1*u:0}if(r){var c=this.clone.wtTable.TABLE.getBoundingClientRect();l=c.top-a.top}else l=o.top;return{start:i.start+s,top:i.top+l}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,i,o,a){var s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},l=0,u=0;if(i||(l=s.horizontal-a.start),n){var c=this.wot.wtTable.wtRootElement.getBoundingClientRect(),f=this.clone.wtTable.TABLE.getBoundingClientRect();u=f.top*-1+c.top}else r||(u=s.vertical-a.top);return{start:o.start-l,top:o.top-u}}},{key:"makeClone",value:function(){if(Q0e.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,a=i.createElement("DIV"),s=i.createElement("TABLE"),l=r.wtRootElement.parentNode;a.className="".concat(Z0e.get(this.type)," handsontable"),a.setAttribute("dir",this.isRtl()?"rtl":"ltr"),a.style.position="absolute",a.style.top=0,a.style.overflow="visible",this.isRtl()?a.style.right=0:a.style.left=0,s.className=r.TABLE.className,a.appendChild(s),l.appendChild(a);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===mu||u==="vertical"&&this.type===vu?this.mainTableScrollableElement=o:o.getComputedStyle(l).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=q0(r.TABLE),new gbe(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=r.style,o=n.style,a=r.parentNode.style;D([i,o,a],function(s){s.width="",s.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),t}();function wf(t){"@babel/helpers - typeof";return wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wf(t)}function Y1(t,e,r){return FU()?Y1=Reflect.construct.bind():Y1=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&ub(u,a.prototype),u},Y1.apply(null,arguments)}function Ebe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cbe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Tbe(n.key),n)}}function Obe(t,e,r){return e&&Cbe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Tbe(t){var e=_be(t,"string");return wf(e)==="symbol"?e:String(e)}function _be(t,e){if(wf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(wf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Abe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ub(t,e)}function ub(t,e){return ub=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ub(t,e)}function Ibe(t){var e=FU();return function(){var n=cb(t),i;if(e){var o=cb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Nbe(this,i)}}function Nbe(t,e){if(e&&(wf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pbe(t)}function Pbe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function FU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cb(t){return cb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cb(t)}var Mbe=function(t){Abe(r,t);var e=Ibe(r);function r(n,i,o,a,s,l){var u;return Ebe(this,r),u=e.call(this,n,i,Ns,o,a),u.bottomOverlay=s,u.inlineStartOverlay=l,u}return Obe(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return Y1(q0e,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot;if(this.updateTrimmingContainer(),!i.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(o.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();o.style[this.isRtl()?"right":"left"]="".concat(a,"px"),o.style.bottom="".concat(s,"px")}else rw(o),this.repositionOverlay();var l=ur(this.clone.wtTable.TABLE),u=Ut(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),o.style.height="".concat(l,"px"),o.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var i=this.wot,o=i.wtTable,a=i.wtViewport,s=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-o.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Xr(s)),l.style.bottom="".concat(u,"px")}}]),r}(Vg),kbe="calculatedColumns",HU={getFirstRenderedColumn:function(){var e=this.dataAccessObject.startColumnRendered;return e===null?-1:e},getFirstVisibleColumn:function(){var e=this.dataAccessObject.startColumnVisible;return e===null?-1:e},getLastRenderedColumn:function(){var e=this.dataAccessObject.endColumnRendered;return e===null?-1:e},getLastVisibleColumn:function(){var e=this.dataAccessObject.endColumnVisible;return e===null?-1:e},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Ka(HU,"MIXIN_NAME",kbe,{writable:!1,enumerable:!1});const aA=HU;function mC(t){"@babel/helpers - typeof";return mC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mC(t)}function xbe(t,e,r){return Object.defineProperty(t,"prototype",{writable:!1}),t}function $be(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Lbe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vC(t,e)}function vC(t,e){return vC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vC(t,e)}function Dbe(t){var e=Ube();return function(){var n=fb(t),i;if(e){var o=fb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Fbe(this,i)}}function Fbe(t,e){if(e&&(mC(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hbe(t)}function Hbe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ube(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fb(t){return fb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fb(t)}var sA=function(t){Lbe(r,t);var e=Dbe(r);function r(n,i,o,a){return $be(this,r),e.call(this,n,i,o,a,_o)}return xbe(r)}(Cd);Kt(sA,kU);Kt(sA,aA);const Bbe=sA;function Sf(t){"@babel/helpers - typeof";return Sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sf(t)}function K1(t,e,r){return BU()?K1=Reflect.construct.bind():K1=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&hb(u,a.prototype),u},K1.apply(null,arguments)}function Vbe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jbe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,VU(n.key),n)}}function Wbe(t,e,r){return e&&jbe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gbe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hb(t,e)}function hb(t,e){return hb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},hb(t,e)}function zbe(t){var e=BU();return function(){var n=db(t),i;if(e){var o=db(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ybe(this,i)}}function Ybe(t,e){if(e&&(Sf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UU(t)}function UU(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function BU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function db(t){return db=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},db(t)}function Kbe(t,e,r){return e=VU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VU(t){var e=Xbe(t,"string");return Sf(e)==="symbol"?e:String(e)}function Xbe(t,e){if(Sf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Sf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var qbe=function(t){Gbe(r,t);var e=zbe(r);function r(n,i,o,a){var s;return Vbe(this,r),s=e.call(this,n,i,_o,o,a),Kbe(UU(s),"cachedFixedRowsBottom",-1),s.cachedFixedRowsBottom=s.wtSettings.getSetting("fixedRowsBottom"),s}return Wbe(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return K1(Bbe,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.domBindings.rootWindow,o=this.clone.wtTable.holder.parentNode;o.style.top="";var a=0,s=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===i&&(!s||s!=="vertical")?(a=this.getOverlayOffset(),o.style.bottom="".concat(a,"px")):(a=this.getScrollPosition(),this.repositionOverlay());var l=this.adjustHeaderBordersPosition(a);return this.adjustElementsSize(),l}},{key:"repositionOverlay",value:function(){var i=this.wot,o=i.wtTable,a=i.wtViewport,s=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-o.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Xr(s)),l.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===o?(o.scrollTo(ff(o),i),a=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,o){for(var a=this.wot,s=a.wtTable,l=a.wtSettings,u=l.getSetting("defaultRowHeight"),c=i,f=0;c<o;){var h=s.getRowHeight(c);f+=h===void 0?u:h,c+=1}return f}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot,o=i.wtTable,a=i.wtViewport,s=this.domBindings,l=s.rootDocument,u=s.rootWindow,c=Xr(l),f=this.clone.wtTable.holder.parentNode,h=f.style,d=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||d==="horizontal"){var p=a.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(p-=c),p=Math.min(p,o.wtRootElement.scrollWidth),h.width="".concat(p,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var m=ur(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(m=0),h.height="".concat(m,"px")}},{key:"adjustRootChildrenSize",value:function(){var i=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height=i.parentNode.style.height}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",o=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?o.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):o.style[i]=""}},{key:"scrollTo",value:function(i,o){var a=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;o&&l.offsetHeight!==l.clientHeight&&(u=Xr(this.domBindings.rootDocument)),o?(a+=this.sumCellSizes(0,i+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),i),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return X0(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===i&&(!o||o!=="vertical")){var s=this.wot.wtTable.getTotalHeight(),l=this.clone.wtTable.getTotalHeight(),u=s-l,c=this.domBindings.rootDocument.documentElement.clientHeight;a=Math.max(this.getTableParentOffset()-this.getScrollPosition()-c+s,0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(i){var o=this.wtSettings.getSetting("fixedRowsBottom"),a=this.cachedFixedRowsBottom!==o,s=this.wtSettings.getSetting("columnHeaders"),l=!1;if((a||o===0)&&s.length>0){var u=this.wot.wtTable.holder.parentNode,c=Xe(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),i||this.wtSettings.getSetting("totalRows")===0?(le(u,"innerBorderBottom"),l=!c):(qe(u,"innerBorderBottom"),l=c)}return l}}]),r}(Vg),Qbe="calculatedRows",jU={getFirstRenderedRow:function(){var e=this.dataAccessObject.startRowRendered;return e===null?-1:e},getFirstVisibleRow:function(){var e=this.dataAccessObject.startRowVisible;return e===null?-1:e},getLastRenderedRow:function(){var e=this.dataAccessObject.endRowRendered;return e===null?-1:e},getLastVisibleRow:function(){var e=this.dataAccessObject.endRowVisible;return e===null?-1:e},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Ka(jU,"MIXIN_NAME",Qbe,{writable:!1,enumerable:!1});const WU=jU;function gC(t){"@babel/helpers - typeof";return gC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gC(t)}function Zbe(t,e,r){return Object.defineProperty(t,"prototype",{writable:!1}),t}function Jbe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e2e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yC(t,e)}function yC(t,e){return yC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yC(t,e)}function t2e(t){var e=i2e();return function(){var n=pb(t),i;if(e){var o=pb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return r2e(this,i)}}function r2e(t,e){if(e&&(gC(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return n2e(t)}function n2e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function i2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pb(t){return pb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pb(t)}var lA=function(t){e2e(r,t);var e=t2e(r);function r(n,i,o,a){return Jbe(this,r),e.call(this,n,i,o,a,vu)}return Zbe(r)}(Cd);Kt(lA,WU);Kt(lA,nA);const o2e=lA;function Rf(t){"@babel/helpers - typeof";return Rf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rf(t)}function X1(t,e,r){return GU()?X1=Reflect.construct.bind():X1=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&mb(u,a.prototype),u},X1.apply(null,arguments)}function a2e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s2e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,u2e(n.key),n)}}function l2e(t,e,r){return e&&s2e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function u2e(t){var e=c2e(t,"string");return Rf(e)==="symbol"?e:String(e)}function c2e(t,e){if(Rf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Rf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function f2e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mb(t,e)}function mb(t,e){return mb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mb(t,e)}function h2e(t){var e=GU();return function(){var n=vb(t),i;if(e){var o=vb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return d2e(this,i)}}function d2e(t,e){if(e&&(Rf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return p2e(t)}function p2e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function GU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vb(t){return vb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vb(t)}var m2e=function(t){f2e(r,t);var e=h2e(r);function r(n,i,o,a){return a2e(this,r),e.call(this,n,i,vu,o,a)}return l2e(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return X1(o2e,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot.wtTable;if(!this.needFullRender||!i.holder.parentNode)return!1;var o=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode,s=this.wtSettings.getSetting("preventOverflow"),l=0;this.trimmingContainer===o&&(!s||s!=="horizontal")?(l=this.getOverlayOffset()*(this.isRtl()?-1:1),K_(a,"".concat(l,"px"),"0px")):(l=this.getScrollPosition(),rw(a));var u=this.adjustHeaderBordersPosition(l);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,a=!1;return this.isRtl()&&(i=-i),this.mainTableScrollableElement===o&&o.scrollX!==i?(o.scrollTo(i,nm(o)),a=!0):this.mainTableScrollableElement.scrollLeft!==i&&(this.mainTableScrollableElement.scrollLeft=i,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(i,o){for(var a=this.wtSettings.getSetting("defaultColumnWidth"),s=i,l=0;s<o;)l+=this.wot.wtTable.getStretchedColumnWidth(s)||a,s+=1;return l}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,o=this.domBindings,a=o.rootDocument,s=o.rootWindow,l=Xr(a),u=this.clone.wtTable.holder.parentNode,c=u.style,f=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||f==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=l),h=Math.min(h,i.wtRootElement.scrollHeight),c.height="".concat(h,"px")}else c.height="";this.clone.wtTable.holder.style.height=c.height;var d=Ut(this.clone.wtTable.TABLE);c.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,o=this.clone.wtTable.holder,a=this.wot.selections,s=this.facadeGetter(),l=Math.abs((i=a==null?void 0:a.getCell().getBorder(s).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.height=this.hider.style.height,o.style.height=o.parentNode.style.height,o.style.width="".concat(parseInt(o.parentNode.style.width,10)+l,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalColumns"),o=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style[o]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(i,o){var a=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;if(o){var c=this.wot.wtTable.getColumnWidth(i),f=this.wot.wtViewport.getViewportWidth();c>f&&(o=!1)}return o&&l.offsetWidth!==l.clientWidth&&(u=Xr(this.domBindings.rootDocument)),o?(a+=this.sumCellSizes(0,i+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),i),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var i=this.wtSettings.getSetting("preventOverflow"),o=0;return!i&&this.trimmingContainer===this.domBindings.rootWindow&&(o=this.wot.wtTable.holderOffset.left),o}},{key:"getScrollPosition",value:function(){return Math.abs(BE(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===i&&(!o||o!=="horizontal")){this.isRtl()?a=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var s=this.wot.wtTable.getTotalWidth(),l=this.clone.wtTable.getTotalWidth(),u=s-l;a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(i){var o=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("rowHeaders"),s=this.wtSettings.getSetting("fixedColumnsStart"),l=this.wtSettings.getSetting("totalRows");l?qe(o,"emptyRows"):le(o,"emptyRows");var u=!1;if(s&&!a.length)le(o,"innerBorderLeft innerBorderInlineStart");else if(!s&&a.length){var c=Xe(o,"innerBorderInlineStart");i?(le(o,"innerBorderLeft innerBorderInlineStart"),u=!c):(qe(o,"innerBorderLeft innerBorderInlineStart"),u=c)}return u}}]),r}(Vg),v2e="stickyRowsTop",zU={getFirstRenderedRow:function(){var e=this.wtSettings.getSetting("totalRows");return e===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Ka(zU,"MIXIN_NAME",v2e,{writable:!1,enumerable:!1});const YU=zU;function bC(t){"@babel/helpers - typeof";return bC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bC(t)}function g2e(t,e,r){return Object.defineProperty(t,"prototype",{writable:!1}),t}function y2e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b2e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wC(t,e)}function wC(t,e){return wC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},wC(t,e)}function w2e(t){var e=E2e();return function(){var n=gb(t),i;if(e){var o=gb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return S2e(this,i)}}function S2e(t,e){if(e&&(bC(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return R2e(t)}function R2e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function E2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gb(t){return gb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gb(t)}var uA=function(t){b2e(r,t);var e=w2e(r);function r(n,i,o,a){return y2e(this,r),e.call(this,n,i,o,a,gu)}return g2e(r)}(Cd);Kt(uA,YU);Kt(uA,nA);const C2e=uA;function Ef(t){"@babel/helpers - typeof";return Ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ef(t)}function q1(t,e,r){return KU()?q1=Reflect.construct.bind():q1=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&yb(u,a.prototype),u},q1.apply(null,arguments)}function O2e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T2e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,XU(n.key),n)}}function _2e(t,e,r){return e&&T2e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function A2e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yb(t,e)}function yb(t,e){return yb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yb(t,e)}function I2e(t){var e=KU();return function(){var n=bb(t),i;if(e){var o=bb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return N2e(this,i)}}function N2e(t,e){if(e&&(Ef(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SC(t)}function SC(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function KU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bb(t){return bb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bb(t)}function Z8(t,e,r){return e=XU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XU(t){var e=P2e(t,"string");return Ef(e)==="symbol"?e:String(e)}function P2e(t,e){if(Ef(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ef(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var M2e=function(t){A2e(r,t);var e=I2e(r);function r(n,i,o,a,s,l){var u;return O2e(this,r),u=e.call(this,n,i,gu,o,a),Z8(SC(u),"topOverlay",void 0),Z8(SC(u),"inlineStartOverlay",void 0),u.topOverlay=s,u.inlineStartOverlay=l,u}return _2e(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return q1(C2e,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var o=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),a=this.topOverlay.getOverlayOffset();K_(i,"".concat(o,"px"),"".concat(a,"px"))}else rw(i);var s=ur(this.clone.wtTable.TABLE),l=Ut(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),i.style.height="".concat(s,"px"),i.style.width="".concat(l,"px"),!1}}]),r}(Vg);function RC(t){"@babel/helpers - typeof";return RC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},RC(t)}function k2e(t,e,r){return Object.defineProperty(t,"prototype",{writable:!1}),t}function x2e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $2e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&EC(t,e)}function EC(t,e){return EC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},EC(t,e)}function L2e(t){var e=H2e();return function(){var n=wb(t),i;if(e){var o=wb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return D2e(this,i)}}function D2e(t,e){if(e&&(RC(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return F2e(t)}function F2e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function H2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wb(t){return wb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wb(t)}var cA=function(t){$2e(r,t);var e=L2e(r);function r(n,i,o,a){return x2e(this,r),e.call(this,n,i,o,a,mu)}return k2e(r)}(Cd);Kt(cA,YU);Kt(cA,aA);const U2e=cA;function Cf(t){"@babel/helpers - typeof";return Cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cf(t)}function Q1(t,e,r){return QU()?Q1=Reflect.construct.bind():Q1=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&Sb(u,a.prototype),u},Q1.apply(null,arguments)}function B2e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function V2e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ZU(n.key),n)}}function j2e(t,e,r){return e&&V2e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function W2e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Sb(t,e)}function Sb(t,e){return Sb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Sb(t,e)}function G2e(t){var e=QU();return function(){var n=Rb(t),i;if(e){var o=Rb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return z2e(this,i)}}function z2e(t,e){if(e&&(Cf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qU(t)}function qU(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function QU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Rb(t){return Rb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rb(t)}function Y2e(t,e,r){return e=ZU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZU(t){var e=K2e(t,"string");return Cf(e)==="symbol"?e:String(e)}function K2e(t,e){if(Cf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Cf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var X2e=function(t){W2e(r,t);var e=G2e(r);function r(n,i,o,a){var s;return B2e(this,r),s=e.call(this,n,i,mu,o,a),Y2e(qU(s),"cachedFixedRowsTop",-1),s.cachedFixedRowsTop=s.wtSettings.getSetting("fixedRowsTop"),s}return j2e(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return Q1(U2e,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode,o=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),s=0,l=!1;if(this.trimmingContainer===o&&(!a||a!=="vertical")){var u=this.wot.wtTable,c=u.hider.getBoundingClientRect(),f=Math.ceil(c.bottom),h=i.offsetHeight;l=f===h,s=this.getOverlayOffset(),K_(i,"0px","".concat(s,"px"))}else s=this.getScrollPosition(),rw(i);var d=this.adjustHeaderBordersPosition(s,l);return this.adjustElementsSize(),d}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===o&&o.scrollY!==i?(o.scrollTo(ff(o),i),a=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,o){for(var a=this.wtSettings.getSetting("defaultRowHeight"),s=i,l=0;s<o;){var u=this.wot.wtTable.getRowHeight(s);l+=u===void 0?a:u,s+=1}return l}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,o=this.domBindings,a=o.rootDocument,s=o.rootWindow,l=Xr(a),u=this.clone.wtTable.holder.parentNode,c=u.style,f=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||f==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=l),h=Math.min(h,i.wtRootElement.scrollWidth),c.width="".concat(h,"px")}else c.width="";this.clone.wtTable.holder.style.width=c.width;var d=ur(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),c.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,o=this.clone.wtTable.holder,a=this.wot.selections,s=this.facadeGetter(),l=Math.abs((i=a==null?void 0:a.getCell().getBorder(s).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height="".concat(parseInt(o.parentNode.style.height,10)+l,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",o=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?o.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):o.style[i]=""}},{key:"scrollTo",value:function(i,o){var a=this.wot,s=this.wtSettings,l=a.cloneSource?a.cloneSource:a,u=l.wtTable.holder,c=this.getTableParentOffset(),f=0;if(o){var h=this.wot.wtTable.getRowHeight(i),d=this.wot.wtViewport.getViewportHeight();h>d&&(o=!1)}if(o&&u.offsetHeight!==u.clientHeight&&(f=Xr(this.domBindings.rootDocument)),o){var p=s.getSetting("fixedRowsBottom"),m=s.getSetting("totalRows");c+=this.sumCellSizes(0,i+1),c-=a.wtViewport.getViewportHeight()-this.sumCellSizes(m-p,m),c+=1}else c+=this.sumCellSizes(s.getSetting("fixedRowsTop"),i);return c+=f,this.setScrollPosition(c)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return X0(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===i&&(!o||o!=="vertical")){var s=this.wot.wtTable.getTotalHeight(),l=this.clone.wtTable.getTotalHeight(),u=s-l;a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.wot.wtTable.holder.parentNode,s=this.wtSettings.getSetting("totalColumns");s?qe(a,"emptyColumns"):le(a,"emptyColumns");var l=!1;if(!o){var u=this.wtSettings.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==u,f=this.wtSettings.getSetting("columnHeaders");if((c||u===0)&&f.length>0){var h=Xe(a,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),i||this.wtSettings.getSetting("totalRows")===0?(le(a,"innerBorderTop"),l=!h):(qe(a,"innerBorderTop"),l=h)}}return l}}]),r}(Vg);function Im(t){"@babel/helpers - typeof";return Im=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Im(t)}function ys(t,e,r){return q2e()?ys=Reflect.construct.bind():ys=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&CC(u,a.prototype),u},ys.apply(null,arguments)}function q2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function CC(t,e){return CC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},CC(t,e)}function Q2e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Z2e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,JU(n.key),n)}}function J2e(t,e,r){return e&&Z2e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ko(t,e,r){return e=JU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JU(t){var e=ewe(t,"string");return Im(e)==="symbol"?e:String(e)}function ewe(t,e){if(Im(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Im(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var twe=function(){function t(e,r,n,i,o,a){var s=this;Q2e(this,t),Ko(this,"wot",null),Ko(this,"topOverlay",null),Ko(this,"bottomOverlay",null),Ko(this,"inlineStartOverlay",null),Ko(this,"topInlineStartCornerOverlay",null),Ko(this,"bottomInlineStartCornerOverlay",null),Ko(this,"browserLineHeight",void 0),Ko(this,"wtSettings",null),Ko(this,"resizeObserver",new ResizeObserver(function(h){R_(function(){!Array.isArray(h)||!h.length||s.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;var l=this.domBindings,u=l.rootDocument,c=l.rootWindow;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Xr(u);var f=c.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=f?a.holder:q0(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=c.scrollX,this.lastScrollY=c.scrollY}return J2e(t,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,i=r.rootDocument,o=n.getComputedStyle(i.body),a=parseInt(o.lineHeight,10),s=parseInt(o.fontSize,10)*1.2;this.browserLineHeight=a||s}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=ys(X2e,r),this.bottomOverlay=ys(qbe,r),this.inlineStartOverlay=ys(m2e,r),this.topInlineStartCornerOverlay=ys(M2e,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=ys(Mbe,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,a=this.topOverlay.mainTableScrollableElement,s=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(i.documentElement,"keydown",function(p){return r.onKeyDown(p)}),this.eventManager.addEventListener(i.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(i,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(a,"scroll",function(p){return r.onTableScroll(p)},{passive:!0}),a!==s&&this.eventManager.addEventListener(s,"scroll",function(p){return r.onTableScroll(p)},{passive:!0});var l=o.devicePixelRatio&&o.devicePixelRatio>1,u=this.scrollableElement===o,c=this.wtSettings.getSetting("preventWheel"),f={passive:u};(c||l||!BF())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(p){return r.onCloneWheel(p,c)},f);var h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(function(p){if(p&&p.needFullRender){var m=p.clone.wtTable.holder;r.eventManager.addEventListener(m,"wheel",function(y){return r.onCloneWheel(y,c)},f)}});var d;this.eventManager.addEventListener(o,"resize",function(){clearTimeout(d),d=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,a=r.target;this.keyPressed&&(o!==n&&a!==n&&!r.target.contains(o)||i!==n&&a!==n&&!r.target.contains(i))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var i=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,s=r.target,l=a!==i&&s!==i&&!s.contains(a),u=o!==i&&s!==i&&!s.contains(o);if(!(this.keyPressed&&(l||u))){var c=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==i&&c)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=om(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,i=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);var o=this.scrollVertically(n),a=this.scrollHorizontally(i);return o||a}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,o=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=o[0],s=o[1];if(this.horizontalScrolling=n.scrollLeft!==a||this.lastScrollX!==r.scrollX,this.verticalScrolling=i.scrollTop!==s||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=a;var l=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;l&&(l.scrollLeft=a)}this.verticalScrolling&&(i.scrollTop=s),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,i=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=q0(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,i=r.clientHeight,o=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),o}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,i=this.wtTable,o=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),l=n.getColumnHeaderHeight(),u=i.hider.style;if(u.width="".concat(s+this.inlineStartOverlay.sumCellSizes(0,o),"px"),u.height="".concat(l+this.topOverlay.sumCellSizes(0,a)+1,"px"),this.scrollbarSize>0){var c=i.wtRootElement,f=c.scrollHeight,h=c.scrollWidth,d=i.holder,p=d.scrollHeight,m=d.scrollWidth;this.hasScrollbarRight=f<p,this.hasScrollbarBottom=h<m,this.hasScrollbarRight&&i.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&i.hider.scrollHeight+this.scrollbarSize>f&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],i=null;return D(n,function(o){o&&o.clone&&o.clone.wtTable.TABLE.contains(r)&&(i=o.clone)}),i}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];D(n,function(i){i&&(i.clone.wtTable.TABLE.className=r.className)})}}]),t}();const rwe=twe;function Nm(t){"@babel/helpers - typeof";return Nm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nm(t)}function nwe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iwe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,eB(n.key),n)}}function owe(t,e,r){return e&&iwe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function J8(t,e,r){return e=eB(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eB(t){var e=awe(t,"string");return Nm(e)==="symbol"?e:String(e)}function awe(t,e){if(Nm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Nm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var swe=function(){function t(e){var r=this;nwe(this,t),J8(this,"settings",{}),J8(this,"defaults",Object.freeze(this.getDefaults())),ut(this.defaults,function(n,i){if(e[i]!==void 0)r.settings[i]=e[i];else{if(n===void 0)throw new Error('A required setting "'.concat(i,'" was not provided'));r.settings[i]=n}})}return owe(t,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(i,o,a){var s=r.getSetting("data",i,o);hu(a,s??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(i){return i},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(i){return i},onBeforeHighlightingColumnHeader:function(i){return i},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var i=this;return n===void 0?ut(r,function(o,a){i.settings[a]=o}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,i,o,a){return typeof this.settings[r]=="function"?this.settings[r](n,i,o,a):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),t}();function Of(t){"@babel/helpers - typeof";return Of=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Of(t)}function lwe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function uwe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fwe(n.key),n)}}function cwe(t,e,r){return e&&uwe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function fwe(t){var e=hwe(t,"string");return Of(e)==="symbol"?e:String(e)}function hwe(t,e){if(Of(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Of(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function dwe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&OC(t,e)}function OC(t,e){return OC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},OC(t,e)}function pwe(t){var e=gwe();return function(){var n=Eb(t),i;if(e){var o=Eb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return mwe(this,i)}}function mwe(t,e){if(e&&(Of(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vwe(t)}function vwe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gwe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eb(t){return Eb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eb(t)}var fA=function(t){dwe(r,t);var e=pwe(r);function r(n,i,o,a){return lwe(this,r),e.call(this,n,i,o,a,"master")}return cwe(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var i=hf(this.wtRootElement),o=this.domBindings.rootWindow;if(i===o){var a=this.wtSettings.getSetting("preventOverflow");a||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var s=i.parentElement,l=im(i,"height",o),u=im(i,"overflow",o),c=this.holder.style,f=i.scrollWidth,h=i.scrollHeight,d=i.getBoundingClientRect(),p=d.width,m=d.height,y=["auto","hidden","scroll"];if(s&&y.includes(u)){var S=i.cloneNode(!1);S.style.overflow="auto",S.style.position="absolute",i.nextElementSibling?s.insertBefore(S,i.nextElementSibling):s.appendChild(S);var R=parseInt(du(S,o).height,10);s.removeChild(S),R===0&&(m=0)}m=Math.min(m,h),c.height=l==="auto"?"auto":"".concat(m,"px"),p=Math.min(p,f),c.width="".concat(p,"px"),c.overflow="",this.hasTableHeight=c.height==="auto"?!0:m>0,this.hasTableWidth=p>0}this.isTableVisible=rm(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var i=this.wtSettings,o=this.dataAccessObject.wtViewport,a="master",s=i.getSetting("columnHeaders"),l=s.length;if(l&&!o.hasOversizedColumnHeadersMarked[a]){for(var u=i.getSetting("rowHeaders"),c=u.length,f=this.getRenderedColumnsCount(),h=0;h<l;h++)for(var d=-1*c;d<f;d++)this.markIfOversizedColumnHeader(d);o.hasOversizedColumnHeadersMarked[a]=!0}}}]),r}(Cd);Kt(fA,WU);Kt(fA,aA);const ywe=fA;function Pm(t){"@babel/helpers - typeof";return Pm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pm(t)}function bwe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wwe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Rwe(n.key),n)}}function Swe(t,e,r){return e&&wwe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Rwe(t){var e=Ewe(t,"string");return Pm(e)==="symbol"?e:String(e)}function Ewe(t,e){if(Pm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Pm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Cwe=function(){function t(e,r,n,i,o){var a=this;bwe(this,t),this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return Swe(t,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,i=0;if(n===this.domBindings.rootWindow)i=r.documentElement.clientHeight;else{var o=ur(n);i=o>0&&n.clientHeight>0?n.clientHeight:1/0}return i}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=i.documentElement.offsetWidth,l=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),c=r.getSetting("rtlMode"),f=this.wtTable.TABLE.getBoundingClientRect(),h=c?f.right-s:f.left,d=s-h,p,m;if(u)return Ut(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?p=Math.min(d,s):p=Math.min(this.getContainerFillWidth(),d,s),a===o&&l>0&&this.sumColumnWidths(0,l-1)>p)return i.documentElement.clientWidth;if(a!==o&&(m=im(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o),m==="scroll"||m==="hidden"||m==="auto"))return Math.max(p,a.clientWidth);var y=r.getSetting("stretchH");return y==="none"||!y?Math.max(p,Ut(this.wtTable.TABLE)):p}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var i=0,o=r;o<n;)i+=this.wtTable.getColumnWidth(o),o+=1;return i}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var i=n.offsetWidth;return this.containerWidth=i,r.removeChild(n),i}},{key:"getWorkspaceOffset",value:function(){return xr(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=ur(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var i=0,o=n.length;i<o;i++)this.rowHeaderWidth+=r[i]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var a=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var s=0,l=n.length;s<l;s++)a?(this.rowHeaderWidth+=Ut(a),a=a.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Tl,n=this.wtSettings,i=this.wtTable,o,a,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===Tl?o=1/0:o=this.getViewportHeight();var l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,u=n.getSetting("fixedRowsTop"),c=n.getSetting("fixedRowsBottom"),f=n.getSetting("totalRows");return u&&l>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,u),l+=s,o-=s),c&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(f-c,f),o-=s),i.holder.clientHeight===i.holder.offsetHeight?a=0:a=Xr(this.domBindings.rootDocument),new gU({viewportSize:o,scrollOffset:l,totalItems:n.getSetting("totalRows"),itemSizeFn:function(d){return i.getRowHeight(d)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:a})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Tl,n=this.wtSettings,i=this.wtTable,o=this.getViewportWidth(),a=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var s=n.getSetting("fixedColumnsStart");if(s&&a>=0){var l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);a+=l,o-=l}return i.holder.clientWidth!==i.holder.offsetWidth&&(o-=Xr(this.domBindings.rootDocument)),new eA({viewportSize:o,scrollOffset:a,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(c){return i.getColumnWidth(c)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(c,f){return n.getSetting("onBeforeStretchingColumnWidth",c,f)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var i=this.createRowsCalculator(pn),o=this.createColumnsCalculator(pn);this.areAllProposedVisibleRowsAlreadyRendered(i)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(Tl),this.columnsRenderCalculator=this.createColumnsCalculator(Tl)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(pn),this.columnsVisibleCalculator=this.createColumnsCalculator(pn)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,i=r.endRow,o=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!o;var a=this.rowsRenderCalculator,s=a.startRow,l=a.endRow;return n<s||n===s&&n>0?!1:!(i>l||i===l&&i<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,i=r.endColumn,o=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!o;var a=this.columnsRenderCalculator,s=a.startColumn,l=a.endColumn;return n<s||n===s&&n>0?!1:!(i>l||i===l&&i<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){ut(this.hasOversizedColumnHeadersMarked,function(r,n,i){i[n]=void 0})}}]),t}();const Owe=Cwe;function Tf(t){"@babel/helpers - typeof";return Tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tf(t)}function Twe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _we(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Iwe(n.key),n)}}function Awe(t,e,r){return e&&_we(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Iwe(t){var e=Nwe(t,"string");return Tf(e)==="symbol"?e:String(e)}function Nwe(t,e){if(Tf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Tf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Pwe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&TC(t,e)}function TC(t,e){return TC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TC(t,e)}function Mwe(t){var e=xwe();return function(){var n=Cb(t),i;if(e){var o=Cb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return kwe(this,i)}}function kwe(t,e){if(e&&(Tf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _C(t)}function _C(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xwe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cb(t){return Cb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cb(t)}var $we=function(t){Pwe(r,t);var e=Mwe(r);function r(n,i){var o;Twe(this,r),o=e.call(this,n,new swe(i));var a=o.wtSettings.getSetting("facade",_C(o));return o.wtTable=new ywe(o.getTableDao(),a,o.domBindings,o.wtSettings),o.wtViewport=new Owe(o.getViewportDao(),o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.selections=o.wtSettings.getSetting("selections"),o.wtEvent=new _U(a,o.domBindings,o.wtSettings,o.eventManager,o.wtTable,o.selections),o.wtOverlays=new rwe(_C(o),a,o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.exportSettingsAsClassNames(),o.findOriginalHeaders(),o}return Awe(r,[{key:"exportSettingsAsClassNames",value:function(){var i=this,o={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},a=[],s=[];ut(o,function(l,u){i.wtSettings.getSetting(u).length&&s.push(l),a.push(l)}),qe(this.wtTable.wtRootElement.parentNode,a),le(this.wtTable.wtRootElement.parentNode,s)}},{key:"getViewportDao",value:function(){var i=this;return{get wot(){return i},get topOverlayTrimmingContainer(){return i.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return i.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return i.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return i.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return i.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return i.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return i.wtOverlays.topOverlay},get inlineStartOverlay(){return i.wtOverlays.inlineStartOverlay},get bottomOverlay(){return i.wtOverlays.bottomOverlay}}}}]),r}(oA);function Mm(t){"@babel/helpers - typeof";return Mm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mm(t)}function Lwe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dwe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Hwe(n.key),n)}}function Fwe(t,e,r){return e&&Dwe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Hwe(t){var e=Uwe(t,"string");return Mm(e)==="symbol"?e:String(e)}function Uwe(t,e){if(Mm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Mm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Bwe=function(){function t(e){Lwe(this,t),e instanceof oA?this._wot=e:this._initFromSettings(e)}return Fwe(t,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var i=new t(n);return function(){return i}},this._wot=new $we(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,i){return this._wot.createCellRange(r,n,i)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,i,o,a){return this._wot.scrollViewport(r,n,i,o,a)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wot.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wot.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,i,o,a){return this._wot.wtSettings.getSetting(r,n,i,o,a)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),t}(),Vwe=Nr,tB=rt,jwe=Eg,Wwe=hi,Gwe=dg.f,zwe=tB(Gwe),Ywe=tB([].push),e3=function(t){return function(e){for(var r=Wwe(e),n=jwe(r),i=n.length,o=0,a=[],s;i>o;)s=n[o++],(!Vwe||zwe(r,s))&&Ywe(a,t?[s,r[s]]:r[s]);return a}},Kwe={entries:e3(!0),values:e3(!1)},Xwe=Ye,qwe=Kwe.values;Xwe({target:"Object",stat:!0},{values:function(e){return qwe(e)}});function km(t){"@babel/helpers - typeof";return km=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},km(t)}function v6(t,e){return eSe(t)||Jwe(t,e)||Zwe(t,e)||Qwe()}function Qwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zwe(t,e){if(t){if(typeof t=="string")return t3(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t3(t,e)}}function t3(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Jwe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function eSe(t){if(Array.isArray(t))return t}function tSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rSe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,iSe(n.key),n)}}function nSe(t,e,r){return e&&rSe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function iSe(t){var e=oSe(t,"string");return km(e)==="symbol"?e:String(e)}function oSe(t,e){if(km(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(km(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var aSe=function(){function t(e,r){tSe(this,t),r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return nSe(t,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var i=function(l){var u=r.main.childNodes[l];r.eventManager.addEventListener(u,"mouseenter",function(c){return r.onMouseEnter(c,r.main.childNodes[l])})},o=0,a=this.main.childNodes.length;o<a;o++)i(o)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),Lo(r);var i=this,o=this.wot.rootDocument.body,a=n.getBoundingClientRect();n.style.display="none";function s(u){if(u.clientY<Math.floor(a.top)||u.clientY>Math.ceil(a.top+a.height)||u.clientX<Math.floor(a.left)||u.clientX>Math.ceil(a.left+a.width))return!0}function l(u){s(u)&&(i.eventManager.removeEventListener(o,"mousemove",l),n.style.display="block")}this.eventManager.addEventListener(o,"mousemove",l)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var i=["top","start","bottom","end","corner"],o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(var a=0;a<5;a++){var s=i[a],l=n.createElement("div");l.className="wtBorder ".concat(this.settings.className||""),this.settings[s]&&this.settings[s].hide&&(l.className+=" hidden"),o=l.style,o.backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:r.border.color,o.height=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),o.width=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(l)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ao()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,c=u.bordersHolder;c||(c=n.createElement("div"),c.className="htBorders",u.bordersHolder=c,u.spreader.appendChild(c)),c.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var i=10,o=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var a={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px")};ut(a,function(l,u){r.selectionHandles.styles.bottomHitArea[u]=l,r.selectionHandles.styles.topHitArea[u]=l});var s={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};ut(s,function(l,u){r.selectionHandles.styles.bottom[u]=l,r.selectionHandles.styles.top[u]=l}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var i=this.wot.selections.createOrGetArea();return!!(i.cellRange&&(r!==i.cellRange.to.row||n!==i.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,i,o,a,s){var l=this.wot.wtSettings.getSetting("rtlMode"),u=l?"right":"left",c=this.selectionHandles.styles,f=c.top,h=c.topHitArea,d=c.bottom,p=c.bottomHitArea,m=parseInt(f.borderWidth,10),y=parseInt(f.width,10),S=parseInt(h.width,10),R=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();f.top="".concat(parseInt(i-y-1,10),"px"),f[u]="".concat(parseInt(o-y-1,10),"px"),h.top="".concat(parseInt(i-S/4*3,10),"px"),h[u]="".concat(parseInt(o-S/4*3,10),"px");var O=Math.min(parseInt(o+a,10),R-y-m*2),A=Math.min(parseInt(o+a-S/4,10),R-S-m*2);d[u]="".concat(O,"px"),p[u]="".concat(A,"px");var B=Math.min(parseInt(i+s,10),E-y-m*2),j=Math.min(parseInt(i+s-S/4,10),E-S-m*2);d.top="".concat(B,"px"),p.top="".concat(j,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(f.display="block",h.display="block",this.isPartRange(r,n)?(d.display="none",p.display="none"):(d.display="block",p.display="block")):(f.display="none",d.display="none",h.display="none",p.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(f.zIndex="9999",h.zIndex="9999"):(f.zIndex="",h.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,i=n.wtTable,o=n.rootDocument,a=n.rootWindow,s,l,u,c,f,h,d=i.getRenderedRowsCount(),p=0;p<d;p+=1){var m=i.rowFilter.renderedToSource(p);if(m>=r[0]&&m<=r[2]){s=m,f=r[0];break}}for(var y=d-1;y>=0;y-=1){var S=i.rowFilter.renderedToSource(y);if(S>=r[0]&&S<=r[2]){l=S;break}}for(var R=i.getRenderedColumnsCount(),E=0;E<R;E+=1){var O=i.columnFilter.renderedToSource(E);if(O>=r[1]&&O<=r[3]){u=O,h=r[1];break}}for(var A=R-1;A>=0;A-=1){var B=i.columnFilter.renderedToSource(A);if(B>=r[1]&&B<=r[3]){c=B;break}}if(s===void 0||u===void 0){this.disappear();return}var j=i.getCell(this.wot.createCellCoords(s,u)),J=s!==l||u!==c,Y=J?i.getCell(this.wot.createCellCoords(l,c)):j,q=xr(j),ee=J?xr(Y):q,ae=xr(i.TABLE),ne=Ut(i.TABLE),ue=q.top,me=q.left,Re=this.wot.wtSettings.getSetting("rtlMode"),ge=0,I=0;if(Re){var v=Ut(j),b=a.innerWidth-ae.left-ne;I=me+v-ee.left,ge=a.innerWidth-me-v-b-1}else I=ee.left+Ut(Y)-me,ge=me-ae.left-1;if(this.isEntireColumnSelected(s,l)){var w=this.getDimensionsFromHeader("columns",u,c,f,ae),_=null;if(w){var M=v6(w,3);_=M[0],ge=M[1],I=M[2]}_&&(j=_)}var L=ue-ae.top-1,H=ee.top+ur(Y)-ue;if(this.isEntireRowSelected(u,c)){var Z=this.getDimensionsFromHeader("rows",s,l,h,ae),te=null;if(Z){var ie=v6(Z,3);te=ie[0],L=ie[1],H=ie[2]}te&&(j=te)}var oe=du(j,a);parseInt(oe.borderTopWidth,10)>0&&(L+=1,H=H>0?H-1:0),parseInt(oe[Re?"borderRightWidth":"borderLeftWidth"],10)>0&&(ge+=1,I=I>0?I-1:0);var ve=Re?"right":"left";this.topStyle.top="".concat(L,"px"),this.topStyle[ve]="".concat(ge,"px"),this.topStyle.width="".concat(I,"px"),this.topStyle.display="block",this.startStyle.top="".concat(L,"px"),this.startStyle[ve]="".concat(ge,"px"),this.startStyle.height="".concat(H,"px"),this.startStyle.display="block";var ke=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(L+H-ke,"px"),this.bottomStyle[ve]="".concat(ge,"px"),this.bottomStyle.width="".concat(I,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(L,"px"),this.endStyle[ve]="".concat(ge+I-ke,"px"),this.endStyle.height="".concat(H+1,"px"),this.endStyle.display="block";var pe=this.settings.border.cornerVisible;pe=typeof pe=="function"?pe(this.settings.layerLevel):pe;var Ce=this.wot.getSetting("onModifyGetCellCoords",l,c),re=l,Ve=c;if(Ce&&Array.isArray(Ce)){var Ze=v6(Ce,4);re=Ze[2],Ve=Ze[3]}if(Ao()||!pe||this.isPartRange(re,Ve))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(L+H+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[ve]="".concat(ge+I+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var Ge=hf(i.TABLE),je=Ge===a;je&&(Ge=o.documentElement);var ze=parseInt(this.cornerDefaultStyle.width,10)/2,T=parseInt(this.cornerDefaultStyle.height,10)/2;if(c===this.wot.getSetting("totalColumns")-1){var k=je?Y.getBoundingClientRect().left:Y.offsetLeft,$=!1,W=0;Re?(W=k-parseInt(this.cornerDefaultStyle.width,10)/2,$=W<0):(W=k+Ut(Y)+parseInt(this.cornerDefaultStyle.width,10)/2,$=W>=G1(Ge)),$&&(this.cornerStyle[ve]="".concat(Math.floor(ge+I+this.cornerCenterPointOffset-ze),"px"),this.cornerStyle[Re?"borderLeftWidth":"borderRightWidth"]=0)}if(l===this.wot.getSetting("totalRows")-1){var F=je?Y.getBoundingClientRect().top:Y.offsetTop,K=F+ur(Y)+parseInt(this.cornerDefaultStyle.height,10)/2,V=K>=Es(Ge);V&&(this.cornerStyle.top="".concat(Math.floor(L+H+this.cornerCenterPointOffset-T),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}Ao()&&this.updateMultipleSelectionHandlesPosition(l,c,L,ge,I,H)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,i,o,a){var s=this.wot.wtTable,l=s.wtRootElement.parentNode,u=null,c=null,f=null,h=null,d=null,p=null,m=null,y=null;switch(r){case"rows":u=function(){return s.getRowHeader.apply(s,arguments)},c=function(){return ur.apply(void 0,arguments)},f="ht__selection--rows",p="top";break;case"columns":u=function(){return s.getColumnHeader.apply(s,arguments)},c=function(){return Ut.apply(void 0,arguments)},f="ht__selection--columns",p="left";break}if(l.classList.contains(f)){var S=this.wot.getSetting("columnHeaders").length;if(m=u(n,S-o),y=u(i,S-o),!m||!y)return!1;var R=xr(m),E=xr(y);return m&&y&&(h=R[p]-a[p]-1,d=E[p]+c(y)-R[p]),[m,h,d]}return!1}},{key:"changeBorderStyle",value:function(r,n){var i=this[r].style,o=n[r];!o||o.hide?le(this[r],"hidden"):(Xe(this[r],"hidden")&&qe(this[r],"hidden"),i.backgroundColor=o.color,(r==="top"||r==="bottom")&&(i.height="".concat(o.width,"px")),(r==="start"||r==="end")&&(i.width="".concat(o.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},i=this[r].style;i.backgroundColor=n.color,i.width="".concat(n.width,"px"),i.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?le(this[r],"hidden"):qe(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Ao()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),t}();const sSe=aSe;function lSe(t,e){return hSe(t)||fSe(t,e)||cSe(t,e)||uSe()}function uSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cSe(t,e){if(t){if(typeof t=="string")return r3(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return r3(t,e)}}function r3(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function fSe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function hSe(t){if(Array.isArray(t))return t}function _f(t){"@babel/helpers - typeof";return _f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_f(t)}function dSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pSe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vSe(n.key),n)}}function mSe(t,e,r){return e&&pSe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function vSe(t){var e=gSe(t,"string");return _f(e)==="symbol"?e:String(e)}function gSe(t,e){if(_f(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(_f(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var ySe=function(){function t(e,r){dSe(this,t),this.settings=e,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return mSe(t,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new sSe(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,i,o){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,s=r.wtTable.getCell(this.settings.createCellCoords(n,i));if(_f(s)==="object"){var l=o;a&&(l=this.classNameGenerator(s),this.classNames.includes(l)||this.classNames.push(l)),le(s,l)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function i(o){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||a===0)return r;var s=a>=0?a:n,l=r;s-=1;var u=s===0?r:"".concat(r,"-").concat(s);if(Xe(o,u)){var c=s+1;l="".concat(r,"-").concat(c)}else l=i(o,s);return l}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),i=r.wtTable.getRenderedColumnsCount(),o=this.getCorners(),a=lSe(o,4),s=a[0],l=a[1],u=a[2],c=a[3],f=this.settings,h=f.highlightHeaderClassName,d=f.highlightColumnClassName,p=f.highlightRowClassName,m=f.highlightOnlyClosestHeader,y=f.selectionType,S=y===void 0||["active-header","header"].includes(y);if(S&&l!==null&&c!==null)for(var R=0,E=0;E<i;E+=1){var O=r.wtTable.columnFilter.renderedToSource(E);if(O>=l&&O<=c){var A=r.wtTable.getColumnHeaders(O),B=A.length-1;m&&A.length>1&&(A=[A[B]]);for(var j=0;j<A.length;j+=1){var J=[],Y=A[j];h&&J.push(h),d&&J.push(d),j=m?B:j;var q=r.getSetting("onBeforeHighlightingColumnHeader",O,j,{selectionType:y,columnCursor:R,selectionWidth:c-l+1,classNames:J});q!==O&&(Y=r.wtTable.getColumnHeader(q,j)),le(Y,J)}R+=1}}if(s!==null&&u!==null)for(var ee=0,ae=0;ae<n;ae+=1){var ne=r.wtTable.rowFilter.renderedToSource(ae);if(S&&ne>=s&&ne<=u){var ue=r.wtTable.getRowHeaders(ne),me=ue.length-1;m&&ue.length>1&&(ue=[ue[me]]);for(var Re=0;Re<ue.length;Re+=1){var ge=[],I=ue[Re];h&&ge.push(h),p&&ge.push(p),Re=m?me:Re;var v=r.getSetting("onBeforeHighlightingRowHeader",ne,Re,{selectionType:y,rowCursor:ee,selectionHeight:u-s+1,classNames:ge});v!==ne&&(I=r.wtTable.getRowHeader(v,Re)),le(I,ge)}ee+=1}if(l!==null&&c!==null)for(var b=0;b<i;b+=1){var w=r.wtTable.columnFilter.renderedToSource(b);ne>=s&&ne<=u&&w>=l&&w<=c?this.settings.className&&this.addClassAtCoords(r,ne,w,this.settings.className,this.settings.markIntersections):ne>=s&&ne<=u?p&&this.addClassAtCoords(r,ne,w,p):w>=l&&w<=c&&d&&this.addClassAtCoords(r,ne,w,d);var _=r.getSetting("onAfterDrawSelection",ne,w,this.settings.layerLevel);typeof _=="string"&&this.addClassAtCoords(r,ne,w,_)}}r.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&this.getBorder(r).appear(o)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),t}();const bSe=ySe;function n3(t){var e=t.isShiftKey,r=t.isLeftClick,n=t.isRightClick,i=t.coords,o=t.selection,a=t.controller,s=t.cellCoordsFactory,l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!a.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!a.cell?o.setRangeEnd(s(i.row,i.col)):u&&i.row<0&&!a.column?o.setRangeEnd(s(l.to.row,i.col)):c&&i.col<0&&!a.row?o.setRangeEnd(s(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!a.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!a.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{var f=!o.inInSelection(i),h=r||n&&f;i.row<0&&i.col>=0&&!a.column?h&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!a.row?h&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!a.cell?h&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0)}}function wSe(t){var e=t.isLeftClick,r=t.coords,n=t.selection,i=t.controller,o=t.cellCoordsFactory;if(e){var a=n.isSelectedByRowHeader(),s=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();s&&!i.column?n.setRangeEnd(o(u-1,r.col)):a&&!i.row?n.setRangeEnd(o(r.row,l-1)):i.cell||n.setRangeEnd(r)}}var SSe=new Map([["mousedown",n3],["mouseover",wSe],["touchstart",n3]]);function i3(t,e){var r=e.coords,n=e.selection,i=e.controller,o=e.cellCoordsFactory;SSe.get(t.type)({coords:r,selection:n,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:Q_(t)||t.type==="touchstart",isRightClick:pu(t)})}var rB=new WeakMap,hA=Symbol("rootInstance");function RSe(t){rB.set(t,!0)}function ESe(t){return t===hA}function AC(t){return rB.has(t)}function xm(t){"@babel/helpers - typeof";return xm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xm(t)}function zd(t,e){return TSe(t)||OSe(t,e)||nB(t,e)||CSe()}function CSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OSe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function TSe(t){if(Array.isArray(t))return t}function o3(t){return ISe(t)||ASe(t)||nB(t)||_Se()}function _Se(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nB(t,e){if(t){if(typeof t=="string")return IC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IC(t,e)}}function ASe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ISe(t){if(Array.isArray(t))return IC(t)}function IC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function NSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PSe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,iB(n.key),n)}}function MSe(t,e,r){return e&&PSe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function a3(t,e,r){kSe(t,e),e.set(t,r)}function kSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ts(t,e,r){return e=iB(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iB(t){var e=xSe(t,"string");return xm(e)==="symbol"?e:String(e)}function xSe(t,e){if(xm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(xm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function s3(t,e){var r=oB(t,e,"get");return $Se(t,r)}function $Se(t,e){return e.get?e.get.call(t):e.value}function l3(t,e,r){var n=oB(t,e,"set");return LSe(t,n,r),r}function oB(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function LSe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var ul=new WeakMap,g6=new WeakMap,y6=new WeakMap,DSe=function(){function t(e){NSe(this,t),ts(this,"instance",void 0),ts(this,"eventManager",void 0),ts(this,"settings",void 0),ts(this,"THEAD",void 0),ts(this,"TBODY",void 0),ts(this,"_wt",void 0),ts(this,"activeWt",void 0),a3(this,g6,{writable:!0,value:0}),a3(this,y6,{writable:!0,value:0}),ts(this,"postponedAdjustElementsSize",!1),this.instance=e,this.eventManager=new hr(this.instance),this.settings=this.instance.getSettings(),ul.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return MSe(t,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var i=this._wt.getCell(r,n);return i<0?null:i}},{key:"scrollViewport",value:function(r,n,i,o,a){return this._wt.scrollViewport(r,n,i,o,a)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wt.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wt.scrollViewportVertically(r,n,i)}},{key:"createElements",value:function(){var r=ul.get(this),n=this.instance,i=n.rootElement,o=n.rootDocument,a=i.getAttribute("style");a&&i.setAttribute("data-originalstyle",a),le(i,"handsontable"),r.table=o.createElement("TABLE"),le(r.table,"htCore"),this.instance.getSettings().tableClassName&&le(r.table,this.instance.getSettings().tableClassName),this.THEAD=o.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=ul.get(this),i=this.instance,o=i.rootElement,a=i.rootDocument,s=i.selection,l=a.documentElement;this.eventManager.addEventListener(o,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var c=r.instance.rootWindow;g8(c),u.preventDefault(),c.focus()}}),this.eventManager.addEventListener(o,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(o,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&g8(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(l,"keyup",function(u){s.isInProgress()&&!u.shiftKey&&s.finish()}),this.eventManager.addEventListener(l,"mouseup",function(u){s.isInProgress()&&Q_(u)&&s.finish(),n.mouseDown=!1,(X_(a.activeElement)||!s.isSelected()&&!s.isSelectedByAnyHeader()&&!o.contains(u.target)&&!pu(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(l,"contextmenu",function(u){s.isInProgress()&&pu(u)&&(s.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(l,"touchend",function(){s.isInProgress()&&s.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(l,"mousedown",function(u){var c=u.target,f=u.x||u.clientX,h=u.y||u.clientY,d=u.target;if(!(n.mouseDown||!o||!r.instance.view)){var p=r.instance.view._wt.wtTable.holder;if(d===p){var m=Xr(a);if(a.elementFromPoint(f+m,h)!==p||a.elementFromPoint(f,h+m)!==p)return}else for(;d!==l;){if(d===null){if(u.isTargetWebComponent)break;return}if(d===o)return;d=d.parentNode}var y=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(c):r.settings.outsideClickDeselects;y?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||Q0(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,i=r.row,o=r.col;return(n=this.instance)._createCellCoords.apply(n,o3(this.translateFromRenderableToVisualIndex(i,o)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var i=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,o=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=r),o===null&&(o=n),[i,o]}},{key:"countRenderableIndexes",value:function(r,n){var i=Math.min(r.getNotTrimmedIndexesLength(),n),o=r.getNearestNotHiddenIndex(i-1,-1);return o===null?0:r.getRenderableFromVisualIndex(o)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,i,o){if(isNaN(r)||r<0)return 0;var a=i.getNearestNotHiddenIndex(r,n),s=i.getRenderableFromVisualIndex(a);if(!Number.isInteger(s))return 0;var l=0;return n<0?l=s+1:n>0&&(l=o-s),l}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=ul.get(this),i={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return AC(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(c,f){var h;return(h=r.instance).getDataAtCell.apply(h,o3(r.translateFromRenderableToVisualIndex(c,f)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||i.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||i.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var c=[];return r.instance.hasRowHeaders()&&c.push(function(f,h){var d=f>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(f):f;r.appendRowHeader(d,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",c),l3(r,y6,c.length),c},columnHeaders:function(){var c=[];return r.instance.hasColHeaders()&&c.push(function(f,h){var d=f>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(f):f;r.appendColHeader(d,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",c),l3(r,g6,c.length),c},columnWidth:function(c){var f=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.getColWidth(f===null?c:f)},rowHeight:function(c){var f=r.instance.rowIndexMapper.getVisualFromRenderableIndex(c);return r.instance.getRowHeight(f===null?c:f)},cellRenderer:function(c,f,h){var d=r.translateFromRenderableToVisualIndex(c,f),p=zd(d,2),m=p[0],y=p[1],S=r.instance.runHooks("modifyGetCellCoords",m,y),R=m,E=y;if(Array.isArray(S)){var O=zd(S,2);R=O[0],E=O[1]}var A=r.instance.getCellMeta(R,E),B=r.instance.colToProp(E),j=r.instance.getDataAtRowProp(R,B);r.instance.hasHook("beforeValueRender")&&(j=r.instance.runHooks("beforeValueRender",j,A)),r.instance.runHooks("beforeRenderer",h,m,y,B,j,A),r.instance.getCellRenderer(A)(r.instance,h,m,y,B,j,A),r.instance.runHooks("afterRenderer",h,m,y,B,j,A)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(c,f,h,d){var p=r.translateFromRenderableToVisualCoords(f),m={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=d,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",c,p,h,m),!_c(c)&&(i3(c,{coords:p,selection:r.instance.selection,controller:m,cellCoordsFactory:function(S,R){return r.instance._createCellCoords(S,R)}}),r.instance.runHooks("afterOnCellMouseDown",c,p,h),r.activeWt=r._wt)},onCellContextMenu:function(c,f,h,d){var p=r.translateFromRenderableToVisualCoords(f);r.activeWt=d,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",c,p,h),!_c(c)&&(r.instance.runHooks("afterOnCellContextMenu",c,p,h),r.activeWt=r._wt)},onCellMouseOut:function(c,f,h,d){var p=r.translateFromRenderableToVisualCoords(f);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOut",c,p,h),!_c(c)&&(r.instance.runHooks("afterOnCellMouseOut",c,p,h),r.activeWt=r._wt)},onCellMouseOver:function(c,f,h,d){var p=r.translateFromRenderableToVisualCoords(f),m={row:!1,column:!1,cell:!1};r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOver",c,p,h,m),!_c(c)&&(n.mouseDown&&i3(c,{coords:p,selection:r.instance.selection,controller:m,cellCoordsFactory:function(S,R){return r.instance._createCellCoords(S,R)}}),r.instance.runHooks("afterOnCellMouseOver",c,p,h),r.activeWt=r._wt)},onCellMouseUp:function(c,f,h,d){var p=r.translateFromRenderableToVisualCoords(f);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseUp",c,p,h),!(_c(c)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",c,p,h),r.activeWt=r._wt)},onCellCornerMouseDown:function(c){c.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",c)},onCellCornerDblClick:function(c){c.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",c)},beforeDraw:function(c,f){return r.beforeRender(c,f)},onDraw:function(c){return r.afterRender(c)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(c,f,h){var d=r.instance.rowIndexMapper,p=d.getVisualFromRenderableIndex(c),m=r.instance.runHooks("beforeHighlightingRowHeader",p,f,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(m,1))},onBeforeHighlightingColumnHeader:function(c,f,h){var d=r.instance.columnIndexMapper,p=d.getVisualFromRenderableIndex(c),m=r.instance.runHooks("beforeHighlightingColumnHeader",p,f,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(m,1))},onAfterDrawSelection:function(c,f,h){var d,p=r.translateFromRenderableToVisualIndex(c,f),m=zd(p,2),y=m[0],S=m[1],R=r.instance.selection.getSelectedRange(),E=R.size();if(E>0){var O=(h??0)+1-E,A=R.peekByIndex(O);d=[A.from.row,A.from.col,A.to.row,A.to.col]}return r.instance.runHooks("afterDrawSelection",y,S,d,h)},onBeforeDrawBorders:function(c,f){var h=zd(c,4),d=h[0],p=h[1],m=h[2],y=h[3],S=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(d),r.instance.columnIndexMapper.getVisualFromRenderableIndex(p),r.instance.rowIndexMapper.getVisualFromRenderableIndex(m),r.instance.columnIndexMapper.getVisualFromRenderableIndex(y)];return r.instance.runHooks("beforeDrawBorders",S,f)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(c,f){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.runHooks("beforeStretchingColumnWidth",c,h)},onModifyRowHeaderWidth:function(c){return r.instance.runHooks("modifyRowHeaderWidth",c)},onModifyGetCellCoords:function(c,f,h){var d=r.instance.rowIndexMapper,p=r.instance.columnIndexMapper,m=f>=0?p.getVisualFromRenderableIndex(f):f,y=c>=0?d.getVisualFromRenderableIndex(c):c,S=r.instance.runHooks("modifyGetCellCoords",y,m,h);if(Array.isArray(S)){var R=zd(S,4),E=R[0],O=R[1],A=R[2],B=R[3];return[E>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(E,1)):E,O>=0?p.getRenderableFromVisualIndex(p.getNearestNotHiddenIndex(O,1)):O,A>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(A,-1)):A,B>=0?p.getRenderableFromVisualIndex(p.getNearestNotHiddenIndex(B,-1)):B]}},viewportRowCalculatorOverride:function(c){var f=r.settings.viewportRowRenderingOffset;if(f==="auto"&&r.settings.fixedRowsTop&&(f=10),f>0||f==="auto"){var h=r.countRenderableRows(),d=c.startRow,p=c.endRow;if(typeof f=="number")c.startRow=Math.max(d-f,0),c.endRow=Math.min(p+f,h-1);else if(f==="auto"){var m=Math.ceil(p/h*12);c.startRow=Math.max(d-m,0),c.endRow=Math.min(p+m,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",c)},viewportColumnCalculatorOverride:function(c){var f=r.settings.viewportColumnRenderingOffset;if(f==="auto"&&r.settings.fixedColumnsStart&&(f=10),f>0||f==="auto"){var h=r.countRenderableColumns(),d=c.startColumn,p=c.endColumn;if(typeof f=="number"&&(c.startColumn=Math.max(d-f,0),c.endColumn=Math.min(p+f,h-1)),f==="auto"){var m=Math.ceil(p/h*6);c.startColumn=Math.max(d-m,0),c.endColumn=Math.min(p+m,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",c)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var c=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||c}};this.instance.runHooks("beforeInitWalkontable",i),this._wt=new Bwe(i),this.activeWt=this._wt;var o=this._wt.wtTable.spreader,a=this.instance.rootElement.getBoundingClientRect(),s=a.width,l=a.height;this.setLastSize(s,l),this.eventManager.addEventListener(o,"mousedown",function(u){u.target===o&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(o,"contextmenu",function(u){u.target===o&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(Q0(r))return!0;var n=lu(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return ul.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var i=n.firstChild;if(!Xe(i,"relative")){$o(n),this.appendRowHeader(r,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var o=this.instance,a=o.rootDocument,s=o.getRowHeader,l=a.createElement("div"),u=a.createElement("span");l.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,s),l.appendChild(u),n.appendChild(l)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var a=n.firstChild;Xe(a,"relative")?this.updateCellHeader(a.querySelector(".colHeader"),r,i,o):($o(n),this.appendColHeader(r,n,i,o))}else{var s=this.instance.rootDocument,l=s.createElement("div"),u=s.createElement("span");l.className="relative",u.className="colHeader",this.updateCellHeader(u,r,i,o),l.appendChild(u),n.appendChild(l)}this.instance.runHooks("afterGetColHeader",r,n,o)}},{key:"updateCellHeader",value:function(r,n,i){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=n,s=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(Xe(r,"colHeader")?a=s.wtTable.columnFilter.sourceToRendered(n):Xe(r,"rowHeader")&&(a=s.wtTable.rowFilter.sourceToRendered(n))),a>-1?Ed(r,i(n,o)):(hu(r," "),le(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),i=n-r;return i>0?i:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),i=n-r;return i>0?i:0}},{key:"setLastSize",value:function(r,n){var i=ul.get(this),o=[r,n];i.lastWidth=o[0],i.lastHeight=o[1]}},{key:"getLastSize",value:function(){var r=ul.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return s3(this,g6)}},{key:"getRowHeadersCount",value:function(){return s3(this,y6)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),t}();const FSe=DSe;function NC(t){"@babel/helpers - typeof";return NC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},NC(t)}var HSe="ABCDEFGHIJKLMNOPQRSTUVWXYZ",u3=HSe.length;function USe(t){for(var e=t+1,r="",n;e>0;)n=(e-1)%u3,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/u3,10);return r}function c3(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t,n=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(r=[t]),r.forEach(function(i,o){Array.isArray(i)?i.forEach(function(a,s){n.push([o+e,s,a])}):Object.keys(i).forEach(function(a){n.push([o+e,a,i[a]])})}),n}function aB(t){var e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&lt(t[0])&&(e=O_(t[0]))),e}function BSe(t){return!!(Array.isArray(t)&&t.length&&t.every(function(e){return Array.isArray(e)}))}function VSe(t){return!!(Array.isArray(t)&&t.length&&t.every(function(e){return NC(e)==="object"&&!Array.isArray(e)&&e!==null}))}function $m(t){"@babel/helpers - typeof";return $m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$m(t)}function jSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WSe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,zSe(n.key),n)}}function GSe(t,e,r){return e&&WSe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function zSe(t){var e=YSe(t,"string");return $m(e)==="symbol"?e:String(e)}function YSe(t,e){if($m(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if($m(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var KSe=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];jSe(this,t),this.hot=e,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return GSe(t,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,i=[];return D(this.data,function(o,a){var s=n.getAtCell(a,r);i.push(s)}),i}},{key:"getAtRow",value:function(r,n,i){var o=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=n===void 0&&i===void 0,l=null,u=null;if(l=this.modifyRowData(r),Array.isArray(l))u=[],s?l.forEach(function(h,d){u[d]=o.getAtPhysicalCell(r,d,l)}):De(n,i,function(h){u[h-n]=o.getAtPhysicalCell(r,h,l)});else if(lt(l)||Xt(l))if(a?u=[]:u={},!s||a){var c=0,f=this.countFirstRowKeys()-1;De(c,f,function(h){var d=o.colToProp(h);if(h>=(n||c)&&h<=(i||f)&&!Number.isInteger(d)){var p=o.getAtPhysicalCell(r,d,l);a?u.push(p):zS(u,d,p)}})}else ut(l,function(h,d){zS(u,d,o.getAtPhysicalCell(r,d,l))});return u}},{key:"setAtCell",value:function(r,n,i){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var o=cf(i);this.hot.runHooks("modifySourceData",r,n,o,"set"),o.isTouched()&&(i=o.value)}Number.isInteger(n)?this.data[r][n]=i:zS(this.data[r],n,i)}}},{key:"getAtPhysicalCell",value:function(r,n,i){var o=null;if(i&&(typeof n=="string"?o=Yle(i,n):typeof n=="function"?o=n(i):o=i[n]),this.hot.hasHook("modifySourceData")){var a=cf(o);this.hot.runHooks("modifySourceData",r,n,a,"get"),a.isTouched()&&(o=a.value)}return o}},{key:"getAtCell",value:function(r,n){var i=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),i)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,s=null,l=null,u=null,c=null;n===null||i===null?(a=!0,s=0,u=this.countRows()-1):(s=Math.min(n.row,i.row),l=Math.min(n.col,i.col),u=Math.max(n.row,i.row),c=Math.max(n.col,i.col));var f=[];return De(s,u,function(h){f.push(a?r.getAtRow(h,void 0,void 0,o):r.getAtRow(h,l,c,o))}),f}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return aB(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),t}();const XSe=KSe;var f3=fr,qSe=function(t){return t!==void 0&&(f3(t,"value")||f3(t,"writable"))},QSe=Ye,ZSe=Lr,JSe=Sr,e6e=Rr,t6e=qSe,r6e=Ho,n6e=$2;function sB(t,e){var r=arguments.length<3?t:arguments[2],n,i;if(e6e(t)===r)return t[e];if(n=r6e.f(t,e),n)return t6e(n)?n.value:n.get===void 0?void 0:ZSe(n.get,r);if(JSe(i=n6e(t)))return sB(i,e,r)}QSe({target:"Reflect",stat:!0},{get:sB});var i6e=Ye,o6e=nt,a6e=hi,lB=Ho.f,uB=Nr,s6e=o6e(function(){lB(1)}),l6e=!uB||s6e;i6e({target:"Object",stat:!0,forced:l6e,sham:!uB},{getOwnPropertyDescriptor:function(e,r){return lB(a6e(e),r)}});var u6e="localHooks",cB={_localHooks:Object.create(null),addLocalHook:function(e,r){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(r),this},runLocalHooks:function(e,r,n,i,o,a,s){if(this._localHooks[e])for(var l=this._localHooks[e].length,u=0;u<l;u++)VE(this._localHooks[e][u],this,r,n,i,o,a,s)},clearLocalHooks:function(){return this._localHooks={},this}};Ka(cB,"MIXIN_NAME",u6e,{writable:!1,enumerable:!1});const Xn=cB;function Lm(t){"@babel/helpers - typeof";return Lm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lm(t)}function c6e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f6e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,d6e(n.key),n)}}function h6e(t,e,r){return e&&f6e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function d6e(t){var e=p6e(t,"string");return Lm(e)==="symbol"?e:String(e)}function p6e(t,e){if(Lm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Lm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Du=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;c6e(this,t),this.indexedValues=[],this.initValueOrFn=e}return h6e(t,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Xt(this.initValueOrFn)?De(n-1,function(i){return r.indexedValues.push(r.initValueOrFn(i))}):De(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),t}();Kt(Du,Xn);function b6(t){return y6e(t)||g6e(t)||v6e(t)||m6e()}function m6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v6e(t,e){if(t){if(typeof t=="string")return PC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PC(t,e)}}function g6e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function y6e(t){if(Array.isArray(t))return PC(t)}function PC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function dA(t,e,r,n){var i=r.length?r[0]:void 0;return[].concat(b6(t.slice(0,i)),b6(r.map(function(o,a){return Xt(n)?n(o,a):n})),b6(i===void 0?[]:t.slice(i)))}function pA(t,e){return _i(t,function(r,n){return e.includes(n)===!1})}function Af(t){"@babel/helpers - typeof";return Af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Af(t)}function b6e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w6e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,R6e(n.key),n)}}function S6e(t,e,r){return e&&w6e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function R6e(t){var e=E6e(t,"string");return Af(e)==="symbol"?e:String(e)}function E6e(t,e){if(Af(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Af(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Np(){return typeof Reflect<"u"&&Reflect.get?Np=Reflect.get.bind():Np=function(e,r,n){var i=C6e(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Np.apply(this,arguments)}function C6e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=yu(t),t!==null););return t}function O6e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&MC(t,e)}function MC(t,e){return MC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},MC(t,e)}function T6e(t){var e=I6e();return function(){var n=yu(t),i;if(e){var o=yu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _6e(this,i)}}function _6e(t,e){if(e&&(Af(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return A6e(t)}function A6e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function I6e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yu(t){return yu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yu(t)}var qs=function(t){O6e(r,t);var e=T6e(r);function r(){return b6e(this,r),e.apply(this,arguments)}return S6e(r,[{key:"insert",value:function(i,o){this.indexedValues=dA(this.indexedValues,i,o,this.initValueOrFn),Np(yu(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=pA(this.indexedValues,i),Np(yu(r.prototype),"remove",this).call(this,i)}}]),r}(Du);function If(t){"@babel/helpers - typeof";return If=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},If(t)}function N6e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function P6e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,k6e(n.key),n)}}function M6e(t,e,r){return e&&P6e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function k6e(t){var e=x6e(t,"string");return If(e)==="symbol"?e:String(e)}function x6e(t,e){if(If(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(If(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function $6e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kC(t,e)}function kC(t,e){return kC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},kC(t,e)}function L6e(t){var e=H6e();return function(){var n=Ob(t),i;if(e){var o=Ob(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return D6e(this,i)}}function D6e(t,e){if(e&&(If(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return F6e(t)}function F6e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function H6e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ob(t){return Ob=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ob(t)}var ow=function(t){$6e(r,t);var e=L6e(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return N6e(this,r),e.call(this,n)}return M6e(r,[{key:"getHiddenIndexes",value:function(){return gn(this.getValues(),function(i,o,a){return o&&i.push(a),i},[])}}]),r}(qs);function w6(t){return j6e(t)||V6e(t)||B6e(t)||U6e()}function U6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function B6e(t,e){if(t){if(typeof t=="string")return xC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xC(t,e)}}function V6e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function j6e(t){if(Array.isArray(t))return xC(t)}function xC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function mA(t,e,r){return[].concat(w6(t.slice(0,e)),w6(r),w6(t.slice(e)))}function Dm(t,e){return _i(t,function(r){return e.includes(r)===!1})}function vA(t,e){return st(t,function(r){return r-e.filter(function(n){return n<r}).length})}function gA(t,e){var r=e[0],n=e.length;return st(t,function(i){return i>=r?i+n:i})}function Nf(t){"@babel/helpers - typeof";return Nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nf(t)}function W6e(t){return K6e(t)||Y6e(t)||z6e(t)||G6e()}function G6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z6e(t,e){if(t){if(typeof t=="string")return $C(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $C(t,e)}}function Y6e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function K6e(t){if(Array.isArray(t))return $C(t)}function $C(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function X6e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function q6e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hB(n.key),n)}}function Q6e(t,e,r){return e&&q6e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function ua(){return typeof Reflect<"u"&&Reflect.get?ua=Reflect.get.bind():ua=function(e,r,n){var i=Z6e(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},ua.apply(this,arguments)}function Z6e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Wi(t),t!==null););return t}function J6e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&LC(t,e)}function LC(t,e){return LC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},LC(t,e)}function eRe(t){var e=rRe();return function(){var n=Wi(t),i;if(e){var o=Wi(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return tRe(this,i)}}function tRe(t,e){if(e&&(Nf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fB(t)}function fB(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wi(t){return Wi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wi(t)}function nRe(t,e,r){return e=hB(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hB(t){var e=iRe(t,"string");return Nf(e)==="symbol"?e:String(e)}function iRe(t,e){if(Nf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Nf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var aw=function(t){J6e(r,t);var e=eRe(r);function r(){var n;X6e(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),nRe(fB(n),"orderOfIndexes",[]),n}return Q6e(r,[{key:"getValues",value:function(){var i=this;return this.orderOfIndexes.map(function(o){return i.indexedValues[o]})}},{key:"setValues",value:function(i){this.orderOfIndexes=W6e(Array(i.length).keys()),ua(Wi(r.prototype),"setValues",this).call(this,i)}},{key:"setValueAtIndex",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return i<this.indexedValues.length?(this.indexedValues[i]=o,this.orderOfIndexes.includes(i)===!1&&this.orderOfIndexes.splice(a,0,i),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(i){this.orderOfIndexes=Dm(this.orderOfIndexes,[i]),Xt(this.initValueOrFn)?ua(Wi(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn(i)):ua(Wi(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,ua(Wi(r.prototype),"setDefaultValues",this).call(this,i)}},{key:"insert",value:function(i,o){this.indexedValues=dA(this.indexedValues,i,o,this.initValueOrFn),this.orderOfIndexes=gA(this.orderOfIndexes,o),ua(Wi(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=pA(this.indexedValues,i),this.orderOfIndexes=Dm(this.orderOfIndexes,i),this.orderOfIndexes=vA(this.orderOfIndexes,i),ua(Wi(r.prototype),"remove",this).call(this,i)}},{key:"getEntries",value:function(){var i=this;return this.orderOfIndexes.map(function(o){return[o,i.getValueAtIndex(o)]})}}]),r}(Du);function Pf(t){"@babel/helpers - typeof";return Pf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pf(t)}function oRe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function aRe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lRe(n.key),n)}}function sRe(t,e,r){return e&&aRe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function lRe(t){var e=uRe(t,"string");return Pf(e)==="symbol"?e:String(e)}function uRe(t,e){if(Pf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Pf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function cRe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&DC(t,e)}function DC(t,e){return DC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},DC(t,e)}function fRe(t){var e=pRe();return function(){var n=Tb(t),i;if(e){var o=Tb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return hRe(this,i)}}function hRe(t,e){if(e&&(Pf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dRe(t)}function dRe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tb(t){return Tb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tb(t)}var jg=function(t){cRe(r,t);var e=fRe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return oRe(this,r),e.call(this,n)}return sRe(r,[{key:"getTrimmedIndexes",value:function(){return gn(this.getValues(),function(i,o,a){return o&&i.push(a),i},[])}}]),r}(qs),h3=new Map([["indexesSequence",{getListWithInsertedItems:mA,getListWithRemovedItems:Dm}],["physicallyIndexed",{getListWithInsertedItems:dA,getListWithRemovedItems:pA}]]),dB=function(e){if(h3.has(e)===!1)throw new Error("Alter strategy with ID '".concat(e,"' does not exist."));return h3.get(e)};function Mf(t){"@babel/helpers - typeof";return Mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mf(t)}function mRe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vRe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yRe(n.key),n)}}function gRe(t,e,r){return e&&vRe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function yRe(t){var e=bRe(t,"string");return Mf(e)==="symbol"?e:String(e)}function bRe(t,e){if(Mf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Mf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Pp(){return typeof Reflect<"u"&&Reflect.get?Pp=Reflect.get.bind():Pp=function(e,r,n){var i=wRe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Pp.apply(this,arguments)}function wRe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=bu(t),t!==null););return t}function SRe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&FC(t,e)}function FC(t,e){return FC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},FC(t,e)}function RRe(t){var e=ORe();return function(){var n=bu(t),i;if(e){var o=bu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ERe(this,i)}}function ERe(t,e){if(e&&(Mf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CRe(t)}function CRe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ORe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bu(t){return bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bu(t)}var pB=function(t){SRe(r,t);var e=RRe(r);function r(){return mRe(this,r),e.call(this,function(n){return n})}return gRe(r,[{key:"insert",value:function(i,o){var a=gA(this.indexedValues,o);this.indexedValues=mA(a,i,o),Pp(bu(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){var o=Dm(this.indexedValues,i);this.indexedValues=vA(o,i),Pp(bu(r.prototype),"remove",this).call(this,i)}}]),r}(Du),d3=new Map([["hiding",ow],["index",Du],["linkedPhysicalIndexToValue",aw],["physicalIndexToValue",qs],["trimming",jg]]);function TRe(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!d3.has(t))throw new Error('The provided map type ("'.concat(t,'") does not exist.'));return new(d3.get(t))(e)}function Fm(t){"@babel/helpers - typeof";return Fm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fm(t)}function _Re(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ARe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,NRe(n.key),n)}}function IRe(t,e,r){return e&&ARe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function NRe(t){var e=PRe(t,"string");return Fm(e)==="symbol"?e:String(e)}function PRe(t,e){if(Fm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Fm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var yA=function(){function t(){_Re(this,t),this.collection=new Map}return IRe(t,[{key:"register",value:function(r,n){var i=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return i.runLocalHooks("change",n)}))}},{key:"unregister",value:function(r){var n=this.collection.get(r);Ae(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n))}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,i){return r.unregister(i)}),this.collection.clear()}},{key:"get",value:function(r){return zt(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(i){i.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),t}();Kt(yA,Xn);function kf(t){"@babel/helpers - typeof";return kf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kf(t)}function MRe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kRe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$Re(n.key),n)}}function xRe(t,e,r){return e&&kRe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function $Re(t){var e=LRe(t,"string");return kf(e)==="symbol"?e:String(e)}function LRe(t,e){if(kf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(kf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function DRe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&HC(t,e)}function HC(t,e){return HC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},HC(t,e)}function FRe(t){var e=BRe();return function(){var n=_b(t),i;if(e){var o=_b(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return HRe(this,i)}}function HRe(t,e){if(e&&(kf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return URe(t)}function URe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function BRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _b(t){return _b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_b(t)}var p3=function(t){DRe(r,t);var e=FRe(r);function r(n,i){var o;return MRe(this,r),o=e.call(this),o.mergedValuesCache=[],o.aggregationFunction=n,o.fallbackValue=i,o}return xRe(r,[{key:"getMergedValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(i===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var o=st(this.get(),function(f){return f.getValues()}),a=[],s=Ae(o[0])&&o[0].length||0,l=0;l<s;l+=1){for(var u=[],c=0;c<this.getLength();c+=1)u.push(o[c][l]);a.push(u)}return st(a,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(i,o){var a=this.getMergedValues(o)[i];return Ae(a)?a:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(yA);function Hm(t){"@babel/helpers - typeof";return Hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hm(t)}function VRe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jRe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,GRe(n.key),n)}}function WRe(t,e,r){return e&&jRe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function GRe(t){var e=zRe(t,"string");return Hm(e)==="symbol"?e:String(e)}function zRe(t,e){if(Hm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Hm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function YRe(t,e,r){KRe(t,e),e.set(t,r)}function KRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XRe(t,e,r){var n=mB(t,e,"set");return qRe(t,n,r),r}function qRe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function QRe(t,e){var r=mB(t,e,"get");return ZRe(t,r)}function mB(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function ZRe(t,e){return e.get?e.get.call(t):e.value}var S6=new WeakMap,vB=function(){function t(){VRe(this,t),YRe(this,S6,{writable:!0,value:[]})}return WRe(t,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(QRe(this,S6)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){XRe(this,S6,r)}}]),t}();Kt(vB,Xn);function m3(t,e){for(var r=[],n=0,i=0;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function Um(t){"@babel/helpers - typeof";return Um=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Um(t)}function JRe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eEe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rEe(n.key),n)}}function tEe(t,e,r){return e&&eEe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function rEe(t){var e=nEe(t,"string");return Um(e)==="symbol"?e:String(e)}function nEe(t,e){if(Um(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Um(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Yd(t,e,r){iEe(t,e),e.set(t,r)}function iEe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gi(t,e){var r=gB(t,e,"get");return oEe(t,r)}function oEe(t,e){return e.get?e.get.call(t):e.value}function ky(t,e,r){var n=gB(t,e,"set");return aEe(t,n,r),r}function gB(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function aEe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var xy=new WeakMap,Kd=new WeakMap,$y=new WeakMap,Ly=new WeakMap,Dy=new WeakMap,sEe=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.initialIndexValue;JRe(this,t),Yd(this,xy,{writable:!0,value:new Set}),Yd(this,Kd,{writable:!0,value:[]}),Yd(this,$y,{writable:!0,value:[]}),Yd(this,Ly,{writable:!0,value:!1}),Yd(this,Dy,{writable:!0,value:!1}),ky(this,Dy,r??!1)}return tEe(t,[{key:"createObserver",value:function(){var r=this,n=new vB;return gi(this,xy).add(n),n.addLocalHook("unsubscribe",function(){gi(r,xy).delete(n)}),n._writeInitialChanges(m3(gi(this,Kd),gi(this,$y))),n}},{key:"emit",value:function(r){var n=gi(this,$y);(!gi(this,Ly)||gi(this,Kd).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(gi(this,Dy)):ky(this,Kd,new Array(r.length).fill(gi(this,Dy))),gi(this,Ly)||(ky(this,Ly,!0),n=gi(this,Kd)));var i=m3(n,r);gi(this,xy).forEach(function(o){return o._write(i)}),ky(this,$y,r)}}]),t}();function Bm(t){"@babel/helpers - typeof";return Bm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bm(t)}var v3;function R6(t){return fEe(t)||cEe(t)||uEe(t)||lEe()}function lEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uEe(t,e){if(t){if(typeof t=="string")return UC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UC(t,e)}}function cEe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function fEe(t){if(Array.isArray(t))return UC(t)}function UC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function hEe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function dEe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pEe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vEe(n.key),n)}}function mEe(t,e,r){return e&&pEe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function vEe(t){var e=gEe(t,"string");return Bm(e)==="symbol"?e:String(e)}function gEe(t,e){if(Bm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Bm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var g3=new Set(["getFirstNotHiddenIndex"]),BC=function(){function t(){var e=this;dEe(this,t),this.indexesSequence=new pB,this.trimmingMapsCollection=new p3(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new p3(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new yA,this.hidingChangesObservable=new sEe({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){e.indexesSequenceChanged=!0,e.updateCache(),e.runLocalHooks("indexesSequenceChange",e.indexesChangeSource),e.runLocalHooks("change",e.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){e.trimmedIndexesChanged=!0,e.updateCache(),e.runLocalHooks("change",r,e.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){e.hiddenIndexesChanged=!0,e.updateCache(),e.runLocalHooks("change",r,e.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){e.runLocalHooks("change",r,e.variousMapsCollection)})}return mEe(t,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,i){return this.registerMap(r,TRe(n,i))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof jg?this.trimmingMapsCollection.register(r,n):n instanceof ow?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var i=this.getNumberOfIndexes();return i>0&&n.init(i),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return Ae(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return Ae(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return Ae(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return Ae(n)?n:null}},{key:"getFirstNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r-n;g3.has("getFirstNotHiddenIndex")&&(g3.delete("getFirstNotHiddenIndex"),Dt(kt(v3||(v3=hEe([`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next 
                        major release. Please use "getNearestNotHiddenIndex" instead.`],[`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20
                        major release. Please use "getNearestNotHiddenIndex" instead.`])))));var a=this.getPhysicalFromVisualIndex(r);return a===null?i===!0&&o!==r-n?this.getFirstNotHiddenIndex(o,-n,!1,o):null:this.isHidden(a)===!1?r:this.getFirstNotHiddenIndex(r+n,n,i,o)}},{key:"getNearestNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.getPhysicalFromVisualIndex(r);if(o===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var a=Array.from(this.fromVisualToRenderableIndexesCache.keys()),s=-1;return n>0?s=a.findIndex(function(l){return l>r}):s=a.reverse().findIndex(function(l){return l<r}),s===-1?i?this.getNearestNotHiddenIndex(r,-n,!1):null:a[s]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=R6(new Array(r).keys()),this.notHiddenIndexesCache=R6(new Array(r).keys()),this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var i=R6(Array(this.getNumberOfIndexes()-r).keys()).map(function(o){return o+r});this.removeIndexes(i)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(r),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var i=this.getIndexesSequence();return i.filter(function(o){return r.isTrimmed(o)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var i=this.getIndexesSequence();return i.filter(function(o){return r.isHidden(o)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var i=this.getNotTrimmedIndexes();return i.filter(function(o){return r.isHidden(o)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var i=this;typeof r=="number"&&(r=[r]);var o=st(r,function(f){return i.getPhysicalFromVisualIndex(f)}),a=this.getNotTrimmedIndexesLength(),s=r.length,l=Dm(this.getIndexesSequence(),o),u=a-s;if(n+s<a){var c=l.filter(function(f){return i.isTrimmed(f)===!1})[n];u=l.indexOf(c)}this.indexesChangeSource="move",this.setIndexesSequence(mA(l,u,o)),this.indexesChangeSource=void 0}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var i=this.getNotTrimmedIndexes()[r],o=Ae(i)?i:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),s=st(new Array(n).fill(o),function(l,u){return l+u});this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(a,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(a,s),this.hidingMapsCollection.insertToEvery(a,s),this.variousMapsCollection.insertToEvery(a,s),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromRenderableIndex(n),o=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(o,n)}}}]),t}();Kt(BC,Xn);var y3;function yEe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function bEe(t,e){return ut(e,function(r,n){zt(t[n])&&(t[n]=r)}),t}function yB(t){var e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=e.exec(t);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):t}function bB(t){Ae(t)&&q_(kt(y3||(y3=yEe(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),t))}function wEe(t,e){var r=Array.isArray(t)&&Number.isInteger(e);return r?t[e]:t}var wB=$i("phraseFormatters"),SEe=wB.register,REe=wB.getValues;function EEe(t,e){SEe(t,e)}function CEe(){return REe()}EEe("pluralize",wEe);var SB="ContextMenu:items",et=SB,bA="".concat(et,".noItems"),wA="".concat(et,".insertRowAbove"),SA="".concat(et,".insertRowBelow"),RA="".concat(et,".insertColumnOnTheLeft"),EA="".concat(et,".insertColumnOnTheRight"),CA="".concat(et,".removeRow"),OA="".concat(et,".removeColumn"),TA="".concat(et,".undo"),_A="".concat(et,".redo"),AA="".concat(et,".readOnly"),IA="".concat(et,".clearColumn"),NA="".concat(et,".copy"),PA="".concat(et,".copyWithHeaders"),MA="".concat(et,".copyWithGroupHeaders"),kA="".concat(et,".copyHeadersOnly"),xA="".concat(et,".cut"),$A="".concat(et,".freezeColumn"),LA="".concat(et,".unfreezeColumn"),DA="".concat(et,".mergeCells"),FA="".concat(et,".unmergeCells"),HA="".concat(et,".addComment"),UA="".concat(et,".editComment"),BA="".concat(et,".removeComment"),VA="".concat(et,".readOnlyComment"),jA="".concat(et,".align"),WA="".concat(et,".align.left"),GA="".concat(et,".align.center"),zA="".concat(et,".align.right"),YA="".concat(et,".align.justify"),KA="".concat(et,".align.top"),XA="".concat(et,".align.middle"),qA="".concat(et,".align.bottom"),QA="".concat(et,".borders"),ZA="".concat(et,".borders.top"),JA="".concat(et,".borders.right"),e7="".concat(et,".borders.bottom"),t7="".concat(et,".borders.left"),r7="".concat(et,".borders.remove"),n7="".concat(et,".nestedHeaders.insertChildRow"),i7="".concat(et,".nestedHeaders.detachFromParent"),o7="".concat(et,".hideColumn"),a7="".concat(et,".showColumn"),s7="".concat(et,".hideRow"),l7="".concat(et,".showRow"),Nn="Filters:",dr="".concat(Nn,"conditions"),sw="".concat(dr,".none"),u7="".concat(dr,".isEmpty"),c7="".concat(dr,".isNotEmpty"),f7="".concat(dr,".isEqualTo"),h7="".concat(dr,".isNotEqualTo"),d7="".concat(dr,".beginsWith"),p7="".concat(dr,".endsWith"),m7="".concat(dr,".contains"),v7="".concat(dr,".doesNotContain"),OEe="".concat(dr,".byValue"),g7="".concat(dr,".greaterThan"),y7="".concat(dr,".greaterThanOrEqualTo"),b7="".concat(dr,".lessThan"),w7="".concat(dr,".lessThanOrEqualTo"),S7="".concat(dr,".isBetween"),R7="".concat(dr,".isNotBetween"),E7="".concat(dr,".after"),C7="".concat(dr,".before"),O7="".concat(dr,".today"),T7="".concat(dr,".tomorrow"),_7="".concat(dr,".yesterday"),A7="".concat(Nn,"labels.filterByCondition"),I7="".concat(Nn,"labels.filterByValue"),N7="".concat(Nn,"labels.conjunction"),lw="".concat(Nn,"labels.disjunction"),Ab="".concat(Nn,"values.blankCells"),P7="".concat(Nn,"buttons.selectAll"),M7="".concat(Nn,"buttons.clear"),k7="".concat(Nn,"buttons.ok"),x7="".concat(Nn,"buttons.cancel"),$7="".concat(Nn,"buttons.placeholder.search"),L7="".concat(Nn,"buttons.placeholder.value"),D7="".concat(Nn,"buttons.placeholder.secondValue");const TEe=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:HA,CONTEXTMENU_ITEMS_ALIGNMENT:jA,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:qA,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:GA,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:YA,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:WA,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:XA,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:zA,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:KA,CONTEXTMENU_ITEMS_BORDERS:QA,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:e7,CONTEXTMENU_ITEMS_BORDERS_LEFT:t7,CONTEXTMENU_ITEMS_BORDERS_RIGHT:JA,CONTEXTMENU_ITEMS_BORDERS_TOP:ZA,CONTEXTMENU_ITEMS_CLEAR_COLUMN:IA,CONTEXTMENU_ITEMS_COPY:NA,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:kA,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:MA,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:PA,CONTEXTMENU_ITEMS_CUT:xA,CONTEXTMENU_ITEMS_EDIT_COMMENT:UA,CONTEXTMENU_ITEMS_FREEZE_COLUMN:$A,CONTEXTMENU_ITEMS_HIDE_COLUMN:o7,CONTEXTMENU_ITEMS_HIDE_ROW:s7,CONTEXTMENU_ITEMS_INSERT_LEFT:RA,CONTEXTMENU_ITEMS_INSERT_RIGHT:EA,CONTEXTMENU_ITEMS_MERGE_CELLS:DA,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:i7,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:n7,CONTEXTMENU_ITEMS_NO_ITEMS:bA,CONTEXTMENU_ITEMS_READ_ONLY:AA,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:VA,CONTEXTMENU_ITEMS_REDO:_A,CONTEXTMENU_ITEMS_REMOVE_BORDERS:r7,CONTEXTMENU_ITEMS_REMOVE_COLUMN:OA,CONTEXTMENU_ITEMS_REMOVE_COMMENT:BA,CONTEXTMENU_ITEMS_REMOVE_ROW:CA,CONTEXTMENU_ITEMS_ROW_ABOVE:wA,CONTEXTMENU_ITEMS_ROW_BELOW:SA,CONTEXTMENU_ITEMS_SHOW_COLUMN:a7,CONTEXTMENU_ITEMS_SHOW_ROW:l7,CONTEXTMENU_ITEMS_UNDO:TA,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:LA,CONTEXTMENU_ITEMS_UNMERGE_CELLS:FA,CONTEXT_MENU_ITEMS_NAMESPACE:SB,FILTERS_BUTTONS_CANCEL:x7,FILTERS_BUTTONS_CLEAR:M7,FILTERS_BUTTONS_OK:k7,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:$7,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:D7,FILTERS_BUTTONS_PLACEHOLDER_VALUE:L7,FILTERS_BUTTONS_SELECT_ALL:P7,FILTERS_CONDITIONS_AFTER:E7,FILTERS_CONDITIONS_BEFORE:C7,FILTERS_CONDITIONS_BEGINS_WITH:d7,FILTERS_CONDITIONS_BETWEEN:S7,FILTERS_CONDITIONS_BY_VALUE:OEe,FILTERS_CONDITIONS_CONTAINS:m7,FILTERS_CONDITIONS_EMPTY:u7,FILTERS_CONDITIONS_ENDS_WITH:p7,FILTERS_CONDITIONS_EQUAL:f7,FILTERS_CONDITIONS_GREATER_THAN:g7,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:y7,FILTERS_CONDITIONS_LESS_THAN:b7,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:w7,FILTERS_CONDITIONS_NAMESPACE:dr,FILTERS_CONDITIONS_NONE:sw,FILTERS_CONDITIONS_NOT_BETWEEN:R7,FILTERS_CONDITIONS_NOT_CONTAIN:v7,FILTERS_CONDITIONS_NOT_EMPTY:c7,FILTERS_CONDITIONS_NOT_EQUAL:h7,FILTERS_CONDITIONS_TODAY:O7,FILTERS_CONDITIONS_TOMORROW:T7,FILTERS_CONDITIONS_YESTERDAY:_7,FILTERS_DIVS_FILTER_BY_CONDITION:A7,FILTERS_DIVS_FILTER_BY_VALUE:I7,FILTERS_LABELS_CONJUNCTION:N7,FILTERS_LABELS_DISJUNCTION:lw,FILTERS_NAMESPACE:Nn,FILTERS_VALUES_BLANK_CELLS:Ab},Symbol.toStringTag,{value:"Module"}));function Vm(t){"@babel/helpers - typeof";return Vm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vm(t)}var be;function we(t,e,r){return e=_Ee(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _Ee(t){var e=AEe(t,"string");return Vm(e)==="symbol"?e:String(e)}function AEe(t,e){if(Vm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Vm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var IEe=(be={languageCode:"en-US"},we(be,bA,"No available options"),we(be,wA,"Insert row above"),we(be,SA,"Insert row below"),we(be,RA,"Insert column left"),we(be,EA,"Insert column right"),we(be,CA,["Remove row","Remove rows"]),we(be,OA,["Remove column","Remove columns"]),we(be,TA,"Undo"),we(be,_A,"Redo"),we(be,AA,"Read only"),we(be,IA,"Clear column"),we(be,jA,"Alignment"),we(be,WA,"Left"),we(be,GA,"Center"),we(be,zA,"Right"),we(be,YA,"Justify"),we(be,KA,"Top"),we(be,XA,"Middle"),we(be,qA,"Bottom"),we(be,$A,"Freeze column"),we(be,LA,"Unfreeze column"),we(be,QA,"Borders"),we(be,ZA,"Top"),we(be,JA,"Right"),we(be,e7,"Bottom"),we(be,t7,"Left"),we(be,r7,"Remove border(s)"),we(be,HA,"Add comment"),we(be,UA,"Edit comment"),we(be,BA,"Delete comment"),we(be,VA,"Read-only comment"),we(be,DA,"Merge cells"),we(be,FA,"Unmerge cells"),we(be,NA,"Copy"),we(be,PA,["Copy with header","Copy with headers"]),we(be,MA,["Copy with group header","Copy with group headers"]),we(be,kA,["Copy header only","Copy headers only"]),we(be,xA,"Cut"),we(be,n7,"Insert child row"),we(be,i7,"Detach from parent"),we(be,o7,["Hide column","Hide columns"]),we(be,a7,["Show column","Show columns"]),we(be,s7,["Hide row","Hide rows"]),we(be,l7,["Show row","Show rows"]),we(be,sw,"None"),we(be,u7,"Is empty"),we(be,c7,"Is not empty"),we(be,f7,"Is equal to"),we(be,h7,"Is not equal to"),we(be,d7,"Begins with"),we(be,p7,"Ends with"),we(be,m7,"Contains"),we(be,v7,"Does not contain"),we(be,g7,"Greater than"),we(be,y7,"Greater than or equal to"),we(be,b7,"Less than"),we(be,w7,"Less than or equal to"),we(be,S7,"Is between"),we(be,R7,"Is not between"),we(be,E7,"After"),we(be,C7,"Before"),we(be,O7,"Today"),we(be,T7,"Tomorrow"),we(be,_7,"Yesterday"),we(be,Ab,"Blank cells"),we(be,A7,"Filter by condition"),we(be,I7,"Filter by value"),we(be,N7,"And"),we(be,lw,"Or"),we(be,P7,"Select all"),we(be,M7,"Clear"),we(be,k7,"OK"),we(be,x7,"Cancel"),we(be,$7,"Search"),we(be,L7,"Value"),we(be,D7,"Second value"),be);const RB=IEe;var VC=RB.languageCode,uw=$i("languagesDictionaries"),NEe=uw.register,EB=uw.getItem,PEe=uw.hasItem,MEe=uw.getValues;CB(RB);function CB(t,e){var r=t,n=e;return lt(t)&&(n=t,r=n.languageCode),kEe(r,n),NEe(r,An(n)),An(n)}function kEe(t,e){t!==VC&&bEe(e,EB(VC))}function OB(t){return F7(t)?An(EB(t)):null}function F7(t){return PEe(t)}function xEe(){return MEe()}function TB(t,e,r){var n=OB(t);if(n===null)return null;var i=n[e];if(zt(i))return null;var o=$Ee(i,r);return Array.isArray(o)?o[0]:o}function $Ee(t,e){var r=t;return D(CEe(),function(n){r=n(t,e)}),r}function LEe(t){var e=yB(t);return F7(e)||(e=VC,bB(t)),e}var DEe=Ye,FEe=Nr,HEe=JL,UEe=hi,BEe=Ho,VEe=yd;DEe({target:"Object",stat:!0,sham:!FEe},{getOwnPropertyDescriptors:function(e){for(var r=UEe(e),n=BEe.f,i=HEe(r),o={},a=0,s,l;i.length>a;)l=n(r,s=i[a++]),l!==void 0&&VEe(o,s,l);return o}});var cw="active-header",fw="area",jm="cell",H7="fill",Wg="header",U7="custom-selection";function xf(t){"@babel/helpers - typeof";return xf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xf(t)}function jEe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WEe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,AB(n.key),n)}}function GEe(t,e,r){return e&&WEe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Z1(){return typeof Reflect<"u"&&Reflect.get?Z1=Reflect.get.bind():Z1=function(e,r,n){var i=zEe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Z1.apply(this,arguments)}function zEe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=$f(t),t!==null););return t}function YEe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jC(t,e)}function jC(t,e){return jC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},jC(t,e)}function KEe(t){var e=qEe();return function(){var n=$f(t),i;if(e){var o=$f(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return XEe(this,i)}}function XEe(t,e){if(e&&(xf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _B(t)}function _B(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $f(t){return $f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$f(t)}function QEe(t,e,r){return e=AB(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AB(t){var e=ZEe(t,"string");return xf(e)==="symbol"?e:String(e)}function ZEe(t,e){if(xf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(xf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var JEe=function(t){YEe(r,t);var e=KEe(r);function r(n,i){var o;return jEe(this,r),o=e.call(this,n,null),QEe(_B(o),"visualCellRange",null),o.visualCellRange=i||null,o.commit(),o}return GEe(r,[{key:"add",value:function(i){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(i):this.visualCellRange.expand(i),this}},{key:"clear",value:function(){return this.visualCellRange=null,Z1($f(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(i){var o=i.from,a=i.to,s=this.getNearestNotHiddenCoords(o,1),l=this.getNearestNotHiddenCoords(a,-1);if(s===null||l===null)return null;if(s.row>l.row||s.col>l.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;s=o,l=a}return this.settings.createCellRange(s,s,l)}},{key:"getNearestNotHiddenCoords",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:o,s=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),i.row,o);if(s===null)return null;var l=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),i.col,a);return l===null?null:this.settings.createCellCoords(s,l)}},{key:"getNearestNotHiddenIndex",value:function(i,o,a){if(o<0)return o;var s=i.getNearestNotHiddenIndex(o,a),l=this.settings.type==="header"||this.settings.type==="active-header";return l&&s===null?-1:s}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var i=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return i===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(i.from,i.to),this}},{key:"syncWith",value:function(i){var o=i.getVerticalDirection()==="N-S"?1:-1,a=i.getHorizontalDirection()==="W-E"?1:-1,s=this.getNearestNotHiddenCoords(i.from.clone().normalize(),o,a);if(s!==null&&i.overlaps(s)){if(this.cellRange===null){var l=this.settings.visualToRenderableCoords(s);this.cellRange=this.settings.createCellRange(l)}return i.setHighlight(s),this}return i.setHighlight(i.from),this}},{key:"getCorners",value:function(){var i=this.cellRange,o=i.from,a=i.to,s=o.row===null||a.row===null,l=o.col===null||a.col===null,u=this.settings.createCellCoords(s?null:Math.min(o.row,a.row),l?null:Math.min(o.col,a.col)),c=this.settings.createCellCoords(s?null:Math.max(o.row,a.row),l?null:Math.max(o.col,a.col));return[u.row,u.col,c.row,c.col]}},{key:"getVisualCorners",value:function(){var i=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),o=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[i.row,i.col,o.row,o.col]}},{key:"createRenderableCellRange",value:function(i,o){var a=this.settings.visualToRenderableCoords(i),s=this.settings.visualToRenderableCoords(o);return this.settings.createCellRange(a,a,s)}}]),r}(bSe);const Od=JEe;function Wm(t){"@babel/helpers - typeof";return Wm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wm(t)}var eCe=["activeHeaderClassName"];function b3(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function w3(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?b3(Object(r),!0).forEach(function(n){tCe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):b3(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function tCe(t,e,r){return e=rCe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rCe(t){var e=nCe(t,"string");return Wm(e)==="symbol"?e:String(e)}function nCe(t,e){if(Wm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Wm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iCe(t,e){if(t==null)return{};var r=oCe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function oCe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function aCe(t){var e=t.activeHeaderClassName,r=iCe(t,eCe),n=new Od(w3(w3({highlightHeaderClassName:e},r),{},{selectionType:cw}));return n}function Gm(t){"@babel/helpers - typeof";return Gm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gm(t)}var sCe=["layerLevel","areaCornerVisible"];function S3(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function R3(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?S3(Object(r),!0).forEach(function(n){lCe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):S3(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function lCe(t,e,r){return e=uCe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uCe(t){var e=cCe(t,"string");return Gm(e)==="symbol"?e:String(e)}function cCe(t,e){if(Gm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Gm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fCe(t,e){if(t==null)return{};var r=hCe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function hCe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function dCe(t){var e=t.layerLevel,r=t.areaCornerVisible,n=fCe(t,sCe),i=new Od(R3(R3({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:fw}));return i}function zm(t){"@babel/helpers - typeof";return zm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zm(t)}var pCe=["cellCornerVisible"];function E3(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function C3(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?E3(Object(r),!0).forEach(function(n){mCe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):E3(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mCe(t,e,r){return e=vCe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vCe(t){var e=gCe(t,"string");return zm(e)==="symbol"?e:String(e)}function gCe(t,e){if(zm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(zm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yCe(t,e){if(t==null)return{};var r=bCe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function bCe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function wCe(t){var e=t.cellCornerVisible,r=yCe(t,pCe),n=new Od(C3(C3({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e}},r),{},{selectionType:jm}));return n}function Ym(t){"@babel/helpers - typeof";return Ym=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ym(t)}var SCe=["border","visualCellRange"];function O3(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function E6(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?O3(Object(r),!0).forEach(function(n){RCe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):O3(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function RCe(t,e,r){return e=ECe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ECe(t){var e=CCe(t,"string");return Ym(e)==="symbol"?e:String(e)}function CCe(t,e){if(Ym(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ym(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function OCe(t,e){if(t==null)return{};var r=TCe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function TCe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function _Ce(t){var e=t.border,r=t.visualCellRange,n=OCe(t,SCe),i=new Od(E6(E6(E6({},e),n),{},{selectionType:U7}),r);return i}var T3=Nr,ACe=rt,ICe=Lr,NCe=nt,C6=Eg,PCe=Sg,MCe=dg,kCe=Kn,xCe=mg,ec=Object.assign,_3=Object.defineProperty,$Ce=ACe([].concat),LCe=!ec||NCe(function(){if(T3&&ec({b:1},ec(_3({},"a",{enumerable:!0,get:function(){_3(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var t={},e={},r=Symbol(),n="abcdefghijklmnopqrst";return t[r]=7,n.split("").forEach(function(i){e[i]=i}),ec({},t)[r]!=7||C6(ec({},e)).join("")!=n})?function(e,r){for(var n=kCe(e),i=arguments.length,o=1,a=PCe.f,s=MCe.f;i>o;)for(var l=xCe(arguments[o++]),u=a?$Ce(C6(l),a(l)):C6(l),c=u.length,f=0,h;c>f;)h=u[f++],(!T3||ICe(s,l,h))&&(n[h]=l[h]);return n}:ec,DCe=Ye,A3=LCe;DCe({target:"Object",stat:!0,arity:2,forced:Object.assign!==A3},{assign:A3});function Km(t){"@babel/helpers - typeof";return Km=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Km(t)}function I3(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function N3(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?I3(Object(r),!0).forEach(function(n){FCe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):I3(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function FCe(t,e,r){return e=HCe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HCe(t){var e=UCe(t,"string");return Km(e)==="symbol"?e:String(e)}function UCe(t,e){if(Km(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Km(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function BCe(t){if(t==null)throw new TypeError("Cannot destructure "+t)}function VCe(t){var e=Object.assign({},(BCe(t),t)),r=new Od(N3(N3({className:"fill",border:{width:1,color:"#ff0000"}},e),{},{selectionType:H7}));return r}function Xm(t){"@babel/helpers - typeof";return Xm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xm(t)}var jCe=["headerClassName","rowClassName","columnClassName"];function P3(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function M3(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?P3(Object(r),!0).forEach(function(n){WCe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P3(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function WCe(t,e,r){return e=GCe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GCe(t){var e=zCe(t,"string");return Xm(e)==="symbol"?e:String(e)}function zCe(t,e){if(Xm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Xm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YCe(t,e){if(t==null)return{};var r=KCe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function KCe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function XCe(t){var e=t.headerClassName,r=t.rowClassName,n=t.columnClassName,i=YCe(t,jCe),o=new Od(M3(M3({className:"highlight",highlightHeaderClassName:e,highlightRowClassName:r,highlightColumnClassName:n},i),{},{highlightOnlyClosestHeader:!0,selectionType:Wg}));return o}function qm(t){"@babel/helpers - typeof";return qm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qm(t)}function k3(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function qCe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?k3(Object(r),!0).forEach(function(n){QCe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):k3(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function QCe(t,e,r){return e=ZCe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZCe(t){var e=JCe(t,"string");return qm(e)==="symbol"?e:String(e)}function JCe(t,e){if(qm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(qm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var IB=$i("highlight/types"),Td=IB.register,e5e=IB.getItem;Td(cw,aCe);Td(fw,dCe);Td(jm,wCe);Td(U7,_Ce);Td(H7,VCe);Td(Wg,XCe);function tc(t,e){return e5e(t)(qCe({type:t},e))}function Qm(t){"@babel/helpers - typeof";return Qm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qm(t)}function rs(t){return i5e(t)||n5e(t)||r5e(t)||t5e()}function t5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r5e(t,e){if(t){if(typeof t=="string")return WC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WC(t,e)}}function n5e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function i5e(t){if(Array.isArray(t))return WC(t)}function WC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function x3(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Xd(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?x3(Object(r),!0).forEach(function(n){o5e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):x3(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function o5e(t,e,r){return e=NB(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s5e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,NB(n.key),n)}}function l5e(t,e,r){return e&&s5e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function NB(t){var e=u5e(t,"string");return Qm(e)==="symbol"?e:String(e)}function u5e(t,e){if(Qm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Qm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var c5e=function(t){function e(r){a5e(this,e),this.options=r,this.layerLevel=0,this.cell=tc(jm,r),this.fill=tc(H7,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return l5e(e,[{key:"isEnabledFor",value:function(n,i){var o=n;n===jm&&(o="current");var a=this.options.disabledCellSelection(i.row,i.col);return typeof a=="string"&&(a=[a]),a===!1||Array.isArray(a)&&!a.includes(o)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,i;return this.areas.has(n)?i=this.areas.get(n):(i=tc(fw,Xd({layerLevel:n},this.options)),this.areas.set(n,i)),i}},{key:"getAreas",value:function(){return rs(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,i;return this.headers.has(n)?i=this.headers.get(n):(i=tc(Wg,Xd({},this.options)),this.headers.set(n,i)),i}},{key:"getHeaders",value:function(){return rs(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,i;return this.activeHeaders.has(n)?i=this.activeHeaders.get(n):(i=tc(cw,Xd({},this.options)),this.activeHeaders.set(n,i)),i}},{key:"getActiveHeaders",value:function(){return rs(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return rs(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(tc(U7,Xd(Xd({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),D(this.areas.values(),function(n){return void n.clear()}),D(this.headers.values(),function(n){return void n.clear()}),D(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:t,value:function(){return[this.cell,this.fill].concat(rs(this.areas.values()),rs(this.headers.values()),rs(this.activeHeaders.values()),rs(this.customSelections))[Symbol.iterator]()}}]),e}(Symbol.iterator);const f5e=c5e;function Zm(t){"@babel/helpers - typeof";return Zm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zm(t)}function h5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d5e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,m5e(n.key),n)}}function p5e(t,e,r){return e&&d5e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function m5e(t){var e=v5e(t,"string");return Zm(e)==="symbol"?e:String(e)}function v5e(t,e){if(Zm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Zm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var g5e=function(t){function e(r){h5e(this,e),this.ranges=[],this.createCellRange=r}return p5e(e,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(i){return i.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=this.size()+n-1,o;return i>=0&&(o=this.ranges[i]),o}},{key:t,value:function(){return this.ranges[Symbol.iterator]()}}]),e}(Symbol.iterator);const y5e=g5e;function Jm(t){"@babel/helpers - typeof";return Jm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jm(t)}function b5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w5e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,R5e(n.key),n)}}function S5e(t,e,r){return e&&w5e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function R5e(t){var e=E5e(t,"string");return Jm(e)==="symbol"?e:String(e)}function E5e(t,e){if(Jm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Jm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var PB=function(){function t(e,r){b5e(this,t),this.range=e,this.options=r}return S5e(t,[{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.options.createCellCoords(r,n),a=this.range.current().highlight,s=this.options.visualToRenderableCoords(a),l=s.row,u=s.col,c=a,f=0,h=0;if(this.runLocalHooks("beforeTransformStart",o),l!==null&&u!==null){var d=this.options.countRows(),p=this.options.countCols(),m=this.options.fixedRowsBottom(),y=this.options.minSpareRows(),S=this.options.minSpareCols(),R=this.options.autoWrapRow(),E=this.options.autoWrapCol();l+r>d-1?i&&y>0&&!(m&&l>=d-m-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):E&&(o.row=1-d,o.col=u+o.col===p-1?1-p:1):E&&l+o.row<0&&u+o.col>=0&&(o.row=d-1,o.col=u+o.col===0?p-1:-1),u+o.col>p-1?i&&S>0?(this.runLocalHooks("insertColRequire",p),p=this.options.countCols()):R&&(o.row=l+o.row===d-1?1-d:1,o.col=1-p):R&&u+o.col<0&&l+o.row>=0&&(o.row=l+o.row===0?d-1:-1,o.col=p-1);var O=this.options.createCellCoords(l+o.row,u+o.col);f=0,h=0,O.row<0?(f=-1,O.row=0):O.row>0&&O.row>=d&&(f=1,O.row=d-1),O.col<0?(h=-1,O.col=0):O.col>0&&O.col>=p&&(h=1,O.col=p-1),c=this.options.renderableToVisualCoords(O)}return this.runLocalHooks("afterTransformStart",c,f,h),c}},{key:"transformEnd",value:function(r,n){var i=this.options.createCellCoords(r,n),o=this.range.current(),a=o.to,s=0,l=0;this.runLocalHooks("beforeTransformEnd",i);var u=this.options.visualToRenderableCoords(o.highlight),c=u.row,f=u.col;if(c!==null&&f!==null){var h=this.options.countRows(),d=this.options.countCols(),p=this.options.visualToRenderableCoords(o.to),m=p.row,y=p.col,S=this.options.createCellCoords(m+i.row,y+i.col);s=0,l=0,S.row<0?(s=-1,S.row=0):S.row>0&&S.row>=h&&(s=1,S.row=h-1),S.col<0?(l=-1,S.col=0):S.col>0&&S.col>=d&&(l=1,S.col=d-1),a=this.options.renderableToVisualCoords(S)}return this.runLocalHooks("afterTransformEnd",a,s,l),a}}]),t}();Kt(PB,Xn);const C5e=PB;function MB(t,e){return A5e(t)||_5e(t,e)||T5e(t,e)||O5e()}function O5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T5e(t,e){if(t){if(typeof t=="string")return $3(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $3(t,e)}}function $3(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _5e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function A5e(t){if(Array.isArray(t))return t}function GC(t){"@babel/helpers - typeof";return GC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},GC(t)}var hw=0,dw=1,kB=2,B7=3,I5e=[B7,kB],N5e=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],O6=Symbol("root"),L3=Symbol("child");function Lf(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:O6;if(e!==O6&&e!==L3)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(t),n=e===O6,i=hw;if(r){var o=t[0];if(t.length===0)i=dw;else if(n&&o instanceof tA)i=B7;else if(n&&Array.isArray(o))i=Lf(o,L3);else if(t.length>=2&&t.length<=4){var a=!t.some(function(s,l){return!N5e[l].includes(GC(s))});a&&(i=kB)}}return i}function ev(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.keepDirection,n=r===void 0?!1:r,i=e.propToCol;if(!I5e.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){var a=t===B7,s=a?o.from.row:o[0],l=a?o.from.col:o[1],u=a?o.to.row:o[2],c=a?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),zt(u)&&(u=s),zt(c)&&(c=l),!n){var f=s,h=l,d=u,p=c;s=Math.min(f,d),l=Math.min(h,p),u=Math.max(f,d),c=Math.max(h,p)}return[s,l,u,c]}}function P5e(t){var e=Lf(t);if(e===hw||e===dw)return[];var r=ev(e),n=new Set;D(t,function(a){var s=r(a),l=MB(s,4),u=l[1],c=l[3],f=Math.max(u,0),h=c-f+1;D(Array.from(new Array(h),function(d,p){return f+p}),function(d){n.has(d)||n.add(d)})});var i=Array.from(n).sort(function(a,s){return a-s}),o=gn(i,function(a,s,l,u){return l!==0&&s===u[l-1]+1?a[a.length-1][1]+=1:a.push([s,1]),a},[]);return o}function M5e(t){var e=Lf(t);if(e===hw||e===dw)return[];var r=ev(e),n=new Set;D(t,function(a){var s=r(a),l=MB(s,3),u=l[0],c=l[2],f=Math.max(u,0),h=c-f+1;D(Array.from(new Array(h),function(d,p){return f+p}),function(d){n.has(d)||n.add(d)})});var i=Array.from(n).sort(function(a,s){return a-s}),o=gn(i,function(a,s,l,u){return l!==0&&s===u[l-1]+1?a[a.length-1][1]+=1:a.push([s,1]),a},[]);return o}function ns(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof t=="number"&&t>=0&&t<e}function tv(t){"@babel/helpers - typeof";return tv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tv(t)}var D3;function F3(t,e){return L5e(t)||$5e(t,e)||x5e(t,e)||k5e()}function k5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x5e(t,e){if(t){if(typeof t=="string")return H3(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H3(t,e)}}function H3(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function $5e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function L5e(t){if(Array.isArray(t))return t}function D5e(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function F5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function H5e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,B5e(n.key),n)}}function U5e(t,e,r){return e&&H5e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function B5e(t){var e=V5e(t,"string");return tv(e)==="symbol"?e:String(e)}function V5e(t,e){if(tv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(tv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var xB=function(){function t(e,r){var n=this;F5e(this,t),this.settings=e,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new y5e(function(i,o,a){return n.tableProps.createCellRange(i,o,a)}),this.highlight=new f5e({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disabledCellSelection:function(o,a){return n.tableProps.isDisabledCellSelection(o,a)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)},createCellCoords:function(o,a){return n.tableProps.createCellCoords(o,a)},createCellRange:function(o,a,s){return n.tableProps.createCellRange(o,a,s)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new C5e(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)},createCellCoords:function(o,a){return n.tableProps.createCellCoords(o,a)},fixedRowsBottom:function(){return e.fixedRowsBottom},minSpareRows:function(){return e.minSpareRows},minSpareCols:function(){return e.minSpareCols},autoWrapRow:function(){return e.autoWrapRow},autoWrapCol:function(){return e.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(o))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(o))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(o))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(o))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(o))}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(o))})}return U5e(t,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.settings.selectionMode==="multiple",a=zt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,s=r.row<0,l=r.col<0,u=s&&l,c=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(i?"Only":""),c),(!o||o&&!a&&zt(n))&&this.selectedRange.clear(),this.selectedRange.add(c),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&l&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&s&&this.selectedByColumnHeader.add(this.getLayerLevel()),i||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var i=this.selectedRange.current();this.settings.selectionMode!=="single"&&i.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(jm,i.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(i);var o=this.getLayerLevel();o<this.highlight.layerLevel&&(D(this.highlight.getAreas(),function(m){return void m.clear()}),D(this.highlight.getHeaders(),function(m){return void m.clear()}),D(this.highlight.getActiveHeaders(),function(m){return void m.clear()})),this.highlight.useLayerLevel(o);var a=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();if(a.clear(),s.clear(),l.clear(),this.highlight.isEnabledFor(fw,i.highlight)&&(this.isMultiple()||o>=1)&&(a.add(i.from).add(i.to).commit(),o===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(o-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(o)}if(this.highlight.isEnabledFor(Wg,i.highlight)){var c=this.tableProps.countRowsTranslated()===0,f=this.tableProps.countColsTranslated()===0,h=i;if((c||f)&&(h=i.clone()),c&&(h.from.row=-1),f&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),s.add(h.from).commit()):s.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var d=this.tableProps.countCols()===i.getWidth();d&&l.add(this.tableProps.createCellCoords(i.from.row,-1)).add(this.tableProps.createCellCoords(i.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var p=this.tableProps.countRows()===i.getHeight();p&&l.add(this.tableProps.createCellCoords(-1,i.from.col)).add(this.tableProps.createCellCoords(-1,i.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=cf(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,i))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.tableProps.countRows(),o=this.tableProps.countCols();if(!(!r&&!n&&(i===0||o===0))){var a=this.tableProps.createCellCoords(n?-1:0,r?-1:0),s=this.tableProps.createCellCoords(i-1,o-1);this.clear(),this.setRangeStartOnly(a),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(s),this.finish()}}},{key:"selectCells",value:function(r){var n=this,i=Lf(r);if(i===dw)return!1;if(i===hw)throw new Error(kt(D3||(D3=D5e([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var o=ev(i,{propToCol:function(c){return n.tableProps.propToCol(c)},keepDirection:!0}),a=this.tableProps.countRows(),s=this.tableProps.countCols(),l=!r.some(function(u){var c=o(u),f=F3(c,4),h=f[0],d=f[1],p=f[2],m=f[3],y=ns(h,a)&&ns(d,s)&&ns(p,a)&&ns(m,s);return!y});return l&&(this.clear(),D(r,function(u){var c=o(u),f=F3(c,4),h=f[0],d=f[1],p=f[2],m=f[3];n.setRangeStartOnly(n.tableProps.createCellCoords(h,d),!1),n.setRangeEnd(n.tableProps.createCellCoords(p,m)),n.finish()})),l}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=typeof r=="string"?this.tableProps.propToCol(r):r,a=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countCols(),l=this.tableProps.countRows(),u=ns(o,s)&&ns(a,s);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(i,o)),this.setRangeEnd(this.tableProps.createCellCoords(l-1,a)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=this.tableProps.countRows(),a=this.tableProps.countCols(),s=ns(r,o)&&ns(n,o);return s&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,i)),this.setRangeEnd(this.tableProps.createCellCoords(n,a-1)),this.finish()),s}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),i=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var o=0;o<this.selectedRange.size();o+=1){this.highlight.useLayerLevel(o);var a=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();a.commit(),s.commit(),l.commit()}this.highlight.useLayerLevel(i)}}}]),t}();Kt(xB,Xn);const j5e=xB;var W5e=Ye,$B=rt,G5e=Ho.f,z5e=ku,U3=Dr,Y5e=y_,K5e=Yn,X5e=b_,B3=$B("".startsWith),q5e=$B("".slice),Q5e=Math.min,LB=X5e("startsWith"),Z5e=!LB&&!!function(){var t=G5e(String.prototype,"startsWith");return t&&!t.writable}();W5e({target:"String",proto:!0,forced:!Z5e&&!LB},{startsWith:function(e){var r=U3(K5e(this));Y5e(e);var n=z5e(Q5e(arguments.length>1?arguments[1]:void 0,r.length)),i=U3(e);return B3?B3(r,i,n):q5e(r,n,n+i.length)===i}});var V3=/^(\r\n|\n\r|\r|\n)/,J5e=/^[^\t\r\n]+/,j3=/^\t/;function eOe(t){var e=[[""]];if(t.length===0)return e;for(var r=0,n=0,i;t.length>0&&i!==t.length;)if(i=t.length,t.match(j3))t=t.replace(j3,""),r+=1,e[n][r]="";else if(t.match(V3))t=t.replace(V3,""),r=0,n+=1,e[n]=[""];else{var o="";if(t.startsWith('"')){for(var a=0,s=!0;s;){var l=t.slice(0,1);l==='"'&&(a+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&a%2===0)&&(s=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(c){return new Array(Math.floor(c.length/2)).fill('"').join("")})}else{var u=t.match(J5e);o=u?u[0]:"",t=t.slice(o.length)}e[n][r]=o}return e}function Mp(t){var e,r,n,i,o="",a;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(o+="	"),a=t[e][n],typeof a=="string"?a.indexOf(`
`)>-1?o+='"'.concat(a.replace(/"/g,'""'),'"'):o+=a:a==null?o+="":o+=a;e!==r-1&&(o+=`
`)}return o}function T6(t){return iOe(t)||nOe(t)||rOe(t)||tOe()}function tOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rOe(t,e){if(t){if(typeof t=="string")return zC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zC(t,e)}}function nOe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function iOe(t){if(Array.isArray(t))return zC(t)}function zC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Df(t){"@babel/helpers - typeof";return Df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Df(t)}function oOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function W3(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sOe(n.key),n)}}function aOe(t,e,r){return e&&W3(t.prototype,e),r&&W3(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function sOe(t){var e=lOe(t,"string");return Df(e)==="symbol"?e:String(e)}function lOe(t,e){if(Df(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Df(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var uOe=function(){function t(e,r,n){oOe(this,t),this.instance=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return aOe(t,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,i;if(this.colToPropCache=[],this.propToColCache=new Map,n){var o=0,a=0,s=!1;if(typeof n=="function"){var l=O_(r);o=l>0?l:this.countFirstRowKeys(),s=!0}else{var u=this.tableMeta.maxCols;o=Math.min(u,n.length)}for(i=0;i<o;i++){var c=s?n(i):n[i];if(lt(c)){if(typeof c.data<"u"){var f=s?a:i;this.colToPropCache[f]=c.data,this.propToColCache.set(c.data,f)}a+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return aB(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,i){var o=this,a=n,s=i,l;return typeof a>"u"&&(a=0,s=""),Df(r)==="object"&&!Array.isArray(r)&&ut(r,function(u,c){u===null?(l=s+c,o.colToPropCache.push(l),o.propToColCache.set(l,a),a+=1):a=o.recursiveDuckColumns(u,a,"".concat(c,"."))}),a}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&Ae(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(Ae(n))return this.instance.toVisualColumn(n);var i=this.instance.toVisualColumn(r);return i===null?r:i}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?Zp(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=o.source,s=o.mode,l=s===void 0?"above":s,u=this.instance.countSourceRows(),c=u,f=0,h=r;(typeof h!="number"||h>=u)&&(h=u),h<this.instance.countRows()&&(c=this.instance.toPhysicalRow(h));var d=this.instance.runHooks("beforeCreateRow",h,i,a);if(d===!1||c===null)return{delta:0};for(var p=this.tableMeta.maxRows,m=this.getSchema().length,y=[],S=function(){var O=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?O=An(n.getSchema()):(O=[],De(m-1,function(){return O.push(null)})):n.instance.dataType==="function"?O=n.tableMeta.dataSchema(h+f):(O={},V2(O,n.getSchema())),y.push(O),f+=1};f<i&&u+f<p;)S();this.instance.rowIndexMapper.insertIndexes(h,f),l==="below"&&(c=Math.min(c+1,u)),this.spliceData(c,0,y);var R=this.instance.toVisualRow(c);return this.instance.countSourceRows()===y.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),f>0&&(r==null?this.metaManager.createRow(null,f):a!=="auto"&&this.metaManager.createRow(c,i)),this.instance.runHooks("afterCreateRow",R,f,a),this.instance.forceFullRender=!0,{delta:f,startPhysicalIndex:c}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.source,a=i.mode,s=a===void 0?"start":a;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var l=this.dataSource,u=this.tableMeta.maxCols,c=this.instance.countSourceCols(),f=r;(typeof f!="number"||f>=c)&&(f=c);var h=this.instance.runHooks("beforeCreateCol",f,n,o);if(h===!1)return{delta:0};var d=c;f<this.instance.countCols()&&(d=this.instance.toPhysicalColumn(f));var p=this.instance.countSourceRows(),m=this.instance.countCols(),y=0,S=d;s==="end"&&(S=Math.min(S+1,c));for(var R=S;y<n&&m<u;){if(typeof f!="number"||f>=m)if(p>0)for(var E=0;E<p;E+=1)typeof l[E]>"u"&&(l[E]=[]),l[E].push(null);else l.push([null]);else for(var O=0;O<p;O++)l[O].splice(S,0,null);y+=1,S+=1,m+=1}this.instance.columnIndexMapper.insertIndexes(f,y),y>0&&(r==null?this.metaManager.createColumn(null,y):o!=="auto"&&this.metaManager.createColumn(R,n));var A=this.instance.toVisualColumn(R);return this.instance.runHooks("afterCreateCol",A,y,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:y,startPhysicalIndex:R}}},{key:"removeRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,a=Number.isInteger(r)?r:-i,s=this.visualRowsToPhysical(a,i),l=this.instance.countSourceRows();a=(l+a)%l;var u=this.instance.runHooks("beforeRemoveRow",a,s.length,s,o);if(u===!1)return!1;var c=s.length;if(this.filterData(a,c,s),a<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(s);var f=Ae(this.tableMeta.columns)||Ae(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&f===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var h=s.slice(0).sort(function(d,p){return p-d});return h.forEach(function(d){n.metaManager.removeRow(d,1)}),this.instance.runHooks("afterRemoveRow",a,c,s,o),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var o=typeof r!="number"?-n:r;o=(this.instance.countCols()+o)%this.instance.countCols();var a=this.visualColumnsToPhysical(o,n),s=a.slice(0).sort(function(R,E){return E-R}),l=this.instance.runHooks("beforeRemoveCol",o,n,a,i);if(l===!1)return!1;for(var u=!0,c=s.length,f=this.dataSource,h=0;h<c;h++)u&&a[0]!==a[h]-h&&(u=!1);if(u)for(var d=0,p=this.instance.countSourceRows();d<p;d++)f[d].splice(a[0],n),d===0&&this.metaManager.removeColumn(a[0],n);else for(var m=0,y=this.instance.countSourceRows();m<y;m++)for(var S=0;S<c;S++)f[m].splice(s[S],1),m===0&&this.metaManager.removeColumn(s[S],1);return o<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(a),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",o,n,a,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,i){for(var o=this.instance.getDataAtCol(r),a=o.slice(n,n+i),s=o.slice(n+i),l=arguments.length,u=new Array(l>3?l-3:0),c=3;c<l;c++)u[c-3]=arguments[c];HP(u,s);for(var f=0;f<i;)u.push(null),f+=1;return Wle(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),a}},{key:"spliceRow",value:function(r,n,i){for(var o=this.instance.getSourceDataAtRow(r),a=o.slice(n,n+i),s=o.slice(n+i),l=arguments.length,u=new Array(l>3?l-3:0),c=3;c<l;c++)u[c-3]=arguments[c];HP(u,s);for(var f=0;f<i;)u.push(null),f+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),a}},{key:"spliceData",value:function(r,n,i){var o=this,a=this.instance.runHooks("beforeDataSplice",r,n,i);if(a!==!1){var s=[].concat(T6(this.dataSource.slice(0,r)),T6(i),T6(this.dataSource.slice(r)));this.dataSource.length=0,s.forEach(function(l){return o.dataSource.push(l)})}}},{key:"filterData",value:function(r,n,i){var o=this.instance.runHooks("filterData",r,n,i);Array.isArray(o)===!1&&(o=this.dataSource.filter(function(a,s){return i.indexOf(s)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}},{key:"get",value:function(r,n){var i=this.instance.toPhysicalRow(r),o=this.dataSource[i],a=this.instance.runHooks("modifyRowData",i);o=isNaN(a)?a:o;var s=null;if(o&&o.hasOwnProperty&&wr(o,n))s=o[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var l=n.split("."),u=o;if(!u)return null;for(var c=0,f=l.length;c<f;c++)if(u=u[l[c]],typeof u>"u")return null;s=u}else typeof n=="function"&&(s=n(this.dataSource.slice(i,i+1)[0]));if(this.instance.hasHook("modifyData")){var h=cf(s);this.instance.runHooks("modifyData",i,this.propToCol(n),h,"get"),h.isTouched()&&(s=h.value)}return s}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,i){var o=this.instance.toPhysicalRow(r),a=i,s=this.dataSource[o],l=this.instance.runHooks("modifyRowData",o);if(s=isNaN(l)?l:s,this.instance.hasHook("modifyData")){var u=cf(a);this.instance.runHooks("modifyData",o,this.propToCol(n),u,"set"),u.isTouched()&&(a=u.value)}if(s&&s.hasOwnProperty&&wr(s,n))s[n]=a;else if(typeof n=="string"&&n.indexOf(".")>-1){var c=n.split("."),f=s,h=0,d;for(h=0,d=c.length-1;h<d;h++)typeof f[c[h]]>"u"&&(f[c[h]]={}),f=f[c[h]];f[c[h]]=a}else typeof n=="function"?n(this.dataSource.slice(o,o+1)[0],a):s[n]=a}},{key:"visualRowsToPhysical",value:function(r,n){for(var i=this.instance.countSourceRows(),o=[],a=(i+r)%i,s=n,l;a<i&&s;)l=this.instance.toPhysicalRow(a),o.push(l),s-=1,a+=1;return o}},{key:"visualColumnsToPhysical",value:function(r,n){for(var i=this.instance.countCols(),o=[],a=(i+r)%i,s=n;a<i&&s;){var l=this.instance.toPhysicalColumn(a);o.push(l),s-=1,a+=1}return o}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var i=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,t.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,i){var o=[],a,s,l,u=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(u===0||c===0)return[];var f=i===t.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),d=Math.min(Math.max(c-1,0),Math.max(r.col,n.col));for(a=Math.min(r.row,n.row);a<=h;a++){l=[];var p=a>=0?this.instance.toPhysicalRow(a):a;for(s=Math.min(r.col,n.col);s<=d&&p!==null;s++)l.push(f.call(this,a,this.colToProp(s)));p!==null&&o.push(l)}return o}},{key:"getText",value:function(r,n){return Mp(this.getRange(r,n,t.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return Mp(this.getRange(r,n,t.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),t}();const cOe=uOe;var Gg=$i("cellTypes"),fOe=Gg.register,hOe=Gg.getItem,DB=Gg.hasItem;Gg.getNames;Gg.getValues;function dOe(t){if(!DB(t))throw Error('You declared cell type "'.concat(t,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return hOe(t)}function bo(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);var r=e,n=r.editor,i=r.renderer,o=r.validator;n&&ri(t,n),i&&na(t,i),o&&mp(t,o),fOe(t,e)}function pOe(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!wr(e,t)}function pw(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,n=typeof e.type=="string"?dOe(e.type):e.type;if(t._automaticallyAssignedMetaProps&&ut(e,function(o,a){return void t._automaticallyAssignedMetaProps.delete(a)}),!!lt(n)){r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);var i={};ut(n,function(o,a){if(pOe(a,r)){var s;i[a]=o,(s=t._automaticallyAssignedMetaProps)===null||s===void 0||s.add(a)}}),$r(t,i)}}function mOe(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Xs(r,t);for(var n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function J1(t){return Number.isInteger(t)&&t>=0}function e0(t,e){if(!t())throw new Error("Assertion failed: ".concat(e))}function Fy(t){return t==null}function YC(t){"@babel/helpers - typeof";return YC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},YC(t)}const FB=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(e){var r,n,i;for(r=0,n=this.countRows();r<n;r++)if(i=this.getDataAtCell(r,e),Br(i)===!1)return!1;return!0},isEmptyRow:function(e){var r,n,i,o;for(r=0,n=this.countCols();r<n;r++)if(i=this.getDataAtCell(e,r),Br(i)===!1)return YC(i)==="object"?(o=this.getCellMeta(e,r),C_(this.getSchema()[o.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function rv(t){"@babel/helpers - typeof";return rv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rv(t)}function G3(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function z3(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?G3(Object(r),!0).forEach(function(n){vOe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):G3(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function vOe(t,e,r){return e=UB(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gOe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,UB(n.key),n)}}function HB(t,e,r){return e&&gOe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function UB(t){var e=yOe(t,"string");return rv(e)==="symbol"?e:String(e)}function yOe(t,e){if(rv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(rv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function BB(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bOe(){return HB(function t(){BB(this,t)})}var wOe=function(){function t(e){BB(this,t),this.metaCtor=bOe(),this.meta=this.metaCtor.prototype,$r(this.meta,FB()),this.meta.instance=e}return HB(t,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;$r(this.meta,r),pw(this.meta,z3(z3({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),t}();function nv(t){"@babel/helpers - typeof";return nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nv(t)}function SOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ROe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,COe(n.key),n)}}function EOe(t,e,r){return e&&ROe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function COe(t){var e=OOe(t,"string");return nv(e)==="symbol"?e:String(e)}function OOe(t,e){if(nv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(nv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var TOe=function(){function t(e){SOe(this,t);var r=e.getMetaConstructor();this.meta=new r}return EOe(t,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){$r(this.meta,r),pw(this.meta,r,r)}}]),t}();function iv(t){"@babel/helpers - typeof";return iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iv(t)}function Y3(t){return NOe(t)||IOe(t)||AOe(t)||_Oe()}function _Oe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AOe(t,e){if(t){if(typeof t=="string")return KC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KC(t,e)}}function IOe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function NOe(t){if(Array.isArray(t))return KC(t)}function KC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function POe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function MOe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xOe(n.key),n)}}function kOe(t,e,r){return e&&MOe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function xOe(t){var e=$Oe(t,"string");return iv(e)==="symbol"?e:String(e)}function $Oe(t,e){if(iv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(iv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var XC=function(t){function e(r){POe(this,e),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return kOe(e,[{key:"obtain",value:function(n){e0(function(){return J1(n)},"Expecting an unsigned number.");var i=this._getStorageIndexByKey(n),o;if(i>=0)o=this.data[i],o===void 0&&(o=this.valueFactory(n),this.data[i]=o);else if(o=this.valueFactory(n),this.holes.size>0){var a=this.holes.values().next().value;this.holes.delete(a),this.data[a]=o,this.index[n]=a}else this.data.push(o),this.index[n]=this.data.length-1;return o}},{key:"insert",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;e0(function(){return J1(n)||Fy(n)},"Expecting an unsigned number or null/undefined argument.");for(var o=[],a=this.data.length,s=0;s<i;s++)o.push(a+s),this.data.push(void 0);var l=Fy(n)?this.index.length:n;this.index=[].concat(Y3(this.index.slice(0,l)),o,Y3(this.index.slice(l)))}},{key:"remove",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;e0(function(){return J1(n)||Fy(n)},"Expecting an unsigned number or null/undefined argument.");for(var o=this.index.splice(Fy(n)?this.index.length-i:n,i),a=0;a<o.length;a++){var s=o[a];typeof s=="number"&&this.holes.add(s)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return _i(this.data,function(i,o){return!n.holes.has(o)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],i=0;i<this.data.length;i++){var o=this._getKeyByStorageIndex(i);o!==-1&&n.push([o,this.data[i]])}var a=0;return{next:function(){if(a<n.length){var l=n[a];return a+=1,{value:l,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:t,value:function(){return this.entries()}}]),e}(Symbol.iterator);function ov(t){"@babel/helpers - typeof";return ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ov(t)}function LOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function DOe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,HOe(n.key),n)}}function FOe(t,e,r){return e&&DOe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function HOe(t){var e=UOe(t,"string");return ov(e)==="symbol"?e:String(e)}function UOe(t,e){if(ov(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(ov(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var BOe=["data","width"],VOe=function(){function t(e){var r=this;LOe(this,t),this.globalMeta=e,this.metas=new XC(function(){return r._createMeta()})}return FOe(t,[{key:"updateMeta",value:function(r,n){var i=this.getMeta(r);$r(i,n),pw(i,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return mOe(this.globalMeta.getMetaConstructor(),BOe).prototype}}]),t}();function av(t){"@babel/helpers - typeof";return av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},av(t)}function jOe(t){return YOe(t)||zOe(t)||GOe(t)||WOe()}function WOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GOe(t,e){if(t){if(typeof t=="string")return qC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qC(t,e)}}function zOe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function YOe(t){if(Array.isArray(t))return qC(t)}function qC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function KOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function XOe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,QOe(n.key),n)}}function qOe(t,e,r){return e&&XOe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function QOe(t){var e=ZOe(t,"string");return av(e)==="symbol"?e:String(e)}function ZOe(t,e){if(av(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(av(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var JOe=function(){function t(e){var r=this;KOe(this,t),this.columnMeta=e,this.metas=new XC(function(){return r._createRow()})}return qOe(t,[{key:"updateMeta",value:function(r,n,i){var o=this.getMeta(r,n);$r(o,i),pw(o,i)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(r,n)}},{key:"getMeta",value:function(r,n,i){var o=this.metas.obtain(r).obtain(n);return i===void 0?o:o[i]}},{key:"setMeta",value:function(r,n,i,o){var a,s=this.metas.obtain(r).obtain(n);(a=s._automaticallyAssignedMetaProps)===null||a===void 0||a.delete(i),s[i]=o}},{key:"removeMeta",value:function(r,n,i){var o=this.metas.obtain(r).obtain(n);delete o[i]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),i=0;i<n.length;i++)r.push.apply(r,jOe(n[i].values()));return r}},{key:"getMetasAtRow",value:function(r){e0(function(){return J1(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new XC(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),t}();function sv(t){"@babel/helpers - typeof";return sv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sv(t)}function eTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tTe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,nTe(n.key),n)}}function rTe(t,e,r){return e&&tTe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function nTe(t){var e=iTe(t,"string");return sv(e)==="symbol"?e:String(e)}function iTe(t,e){if(sv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(sv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var VB=function(){function t(e){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];eTe(this,t),this.hot=e,this.globalMeta=new wOe(e),this.tableMeta=new TOe(this.globalMeta),this.columnMeta=new VOe(this.globalMeta),this.cellMeta=new JOe(this.columnMeta),i.forEach(function(o){return new o(r)}),this.globalMeta.updateMeta(n)}return rTe(t,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,i){var o=i.visualRow,a=i.visualColumn,s=this.cellMeta.getMeta(r,n);return s.visualRow=o,s.visualCol=a,s.row=r,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}},{key:"getCellMetaKeyValue",value:function(r,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,i)}},{key:"setCellMeta",value:function(r,n,i,o){this.cellMeta.setMeta(r,n,i,o)}},{key:"updateCellMeta",value:function(r,n,i){this.cellMeta.updateMeta(r,n,i)}},{key:"removeCellMeta",value:function(r,n,i){this.cellMeta.removeMeta(r,n,i)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),t}();Kt(VB,Xn);function Ib(t){"@babel/helpers - typeof";return Ib=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ib(t)}function K3(t,e,r,n){var i=n.hotInstance,o=n.dataMap,a=n.dataSource,s=n.internalSource,l=n.source,u=n.metaManager,c=n.firstRun,f=Qi(s),h=i.getSettings();Array.isArray(h.dataSchema)?i.dataType="array":Xt(h.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks("before".concat(f),t,c,l);var d=new cOe(i,t,u);if(e(d),Ib(t)==="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){var p=d.getSchema();t=[];var m,y=0,S=0;for(y=0,S=h.startRows;y<S;y++)if((i.dataType==="object"||i.dataType==="function")&&h.dataSchema)m=An(p),t.push(m);else if(i.dataType==="array")m=An(p[0]),t.push(m);else{m=[];for(var R=0,E=h.startCols;R<E;R++)m.push(null);t.push(m)}}else throw new Error("".concat(s," only accepts array of objects or array of arrays (").concat(Ib(t)," given)"));Array.isArray(t[0])&&(i.dataType="array"),h.data=t,d.dataSource=t,a.data=t,a.dataType=i.dataType,a.colToProp=d.colToProp.bind(d),a.propToCol=d.propToCol.bind(d),a.countCachedColumns=d.countCachedColumns.bind(d),r(d),i.runHooks("after".concat(f),t,c,l),c||(i.runHooks("afterChange",null,s),i.render())}function lv(t){"@babel/helpers - typeof";return lv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lv(t)}function oTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function aTe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lTe(n.key),n)}}function sTe(t,e,r){return e&&aTe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function lTe(t){var e=uTe(t,"string");return lv(e)==="symbol"?e:String(e)}function uTe(t,e){if(lv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(lv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var cTe=function(){function t(e){var r=this;oTe(this,t),this.metaManager=e,this.metaSyncMemo=new Map,e.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),Ne.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return sTe(t,[{key:"extendCellMeta",value:function(r){var n,i=r.row,o=r.col;if(!((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(o))){var a=r.visualRow,s=r.visualCol,l=this.metaManager.hot,u=l.colToProp(s);r.prop=u,l.runHooks("beforeGetCellMeta",a,s,r);var c=wr(r,"type")?r.type:null,f=Xt(r.cells)?r.cells(i,o,u):null;if(c)if(f){var h;f.type=(h=f.type)!==null&&h!==void 0?h:c}else f={type:c};f&&this.metaManager.updateCellMeta(i,o,f),l.runHooks("afterGetCellMeta",a,s,r),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(o)}}}]),t}();function uv(t){"@babel/helpers - typeof";return uv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uv(t)}function fTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hTe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,pTe(n.key),n)}}function dTe(t,e,r){return e&&hTe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function pTe(t){var e=mTe(t,"string");return uv(e)==="symbol"?e:String(e)}function mTe(t,e){if(uv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(uv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var vTe=function(){function t(e){fTe(this,t),this.metaManager=e,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var i=this.metaManager.hot.isRtl();if(i&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,i,o){if(!o)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return dTe(t,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,i){var o=n.target,a=n.onChange,s=a===void 0?function(){}:a,l=typeof o=="string",u=l?o:i,c="_".concat(u);r.metaManager.globalMeta.meta[c]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(i,c,s),l&&r.installPropWatcher(o,c,s)})}},{key:"installPropWatcher",value:function(r,n,i){var o=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(s){var l=!o.usageTracker.has(r);o.usageTracker.add(r),i.call(o,r,s,l),this[n]=s},enumerable:!0,configurable:!0})}}]),t}(),X3=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Hy=function(e){return e.map(function(r){var n=r.toLowerCase();return X3.has(n)?X3.get(n):n}).sort().join("+")},gTe=function(e){return e.split("+")},q3=function(e){return e.toLowerCase()},Q3;function yTe(t){return STe(t)||wTe(t)||jB(t)||bTe()}function bTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wTe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function STe(t){if(Array.isArray(t))return QC(t)}function RTe(t,e){return OTe(t)||CTe(t,e)||jB(t,e)||ETe()}function ETe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jB(t,e){if(t){if(typeof t=="string")return QC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QC(t,e)}}function QC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function CTe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function OTe(t){if(Array.isArray(t))return t}function TTe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var _Te=function(e){var r=iw({errorIdExists:function(c){return'The "'.concat(c,'" shortcut is already registered in the "').concat(e,'" context.')}}),n=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=c.keys,h=c.callback,d=c.group,p=c.runOnlyIf,m=p===void 0?function(){return!0}:p,y=c.captureCtrl,S=y===void 0?!1:y,R=c.preventDefault,E=R===void 0?!0:R,O=c.stopPropagation,A=O===void 0?!1:O,B=c.relativeToGroup,j=c.position;if(zt(d))throw new Error("You need to define the shortcut's group.");if(Xt(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(f)===!1)throw new Error(kt(Q3||(Q3=TTe([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var J={callback:h,group:d,runOnlyIf:m,captureCtrl:S,preventDefault:E,stopPropagation:A};if(Ae(B)){var Y=[B,j];J.relativeToGroup=Y[0],J.position=Y[1]}f.forEach(function(q){var ee=Hy(q),ae=r.hasItem(ee);if(ae){var ne=r.getItem(ee),ue=ne.findIndex(function(me){return me.group===B});ue!==-1?j==="before"?ue-=1:ue+=1:ue=ne.length,ne.splice(ue,0,J)}else r.addItem(ee,[J])})},i=function(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};c.forEach(function(h){ut(f,function(d,p){Object.prototype.hasOwnProperty.call(h,p)===!1&&(h[p]=f[p])}),n(h)})},o=function(c){var f=Hy(c);r.removeItem(f)},a=function(c){var f=r.getItems();f.forEach(function(h){var d=RTe(h,2),p=d[0],m=d[1],y=m.filter(function(S){return S.group!==c});y.length===0?o(gTe(p)):(m.length=0,m.push.apply(m,yTe(y)))})},s=function(c){var f=Hy(c),h=r.getItem(f);return Ae(h)?h.slice():[]},l=function(c){var f=Hy(c);return r.hasItem(f)};return{addShortcut:n,addShortcuts:i,getShortcuts:s,hasShortcut:l,removeShortcutsByKeys:o,removeShortcutsByGroup:a}};function ATe(){var t=new Set;return{press:function(r){t.add(r)},release:function(r){t.delete(r)},releaseAll:function(){t.clear()},isPressed:function(r){return t.has(r)}}}var ITe=["meta","alt","shift","control"],qd=ATe();function NTe(t,e,r,n,i){var o=function(d){return ITe.includes(d)},a=function(d){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,m=[];return d.altKey&&m.push("alt"),p&&(d.ctrlKey||d.metaKey)?m.push("control/meta"):(d.ctrlKey&&m.push("control"),d.metaKey&&m.push("meta")),d.shiftKey&&m.push("shift"),m},s=function(d){if(e(d)!==!1){var p=r(d);if(!(d.keyCode===229||p===!1||_c(d))){var m=q3(d.key),y=[];o(m)?qd.press(m):y=a(d);var S=[m].concat(y),R=i(d,S);!R&&(WP()&&y.includes("meta")||!WP()&&y.includes("control"))&&i(d,[m].concat(a(d,!0))),n(d)}}},l=function(d){if(e(d)!==!1){var p=q3(d.key);o(p)!==!1&&qd.release(p)}},u=function(){qd.releaseAll()},c=function(){for(var d=t;d;)d.document.documentElement.addEventListener("keydown",s),d.document.documentElement.addEventListener("keyup",l),d.document.documentElement.addEventListener("blur",u),d=K0(d)},f=function(){for(var d=t;d;)d.document.documentElement.removeEventListener("keydown",s),d.document.documentElement.removeEventListener("keyup",l),d.document.documentElement.removeEventListener("blur",u),d=K0(d)};return{mount:c,unmount:f,isPressed:function(d){return qd.isPressed(d)},releasePressedKeys:function(){return qd.releaseAll()}}}var PTe=function(e){var r=e.ownerWindow,n=e.handleEvent,i=e.beforeKeyDown,o=e.afterKeyDown,a=iw({errorIdExists:function(m){return'The "'.concat(m,'" context name is already registered.')}}),s="grid",l=function(m){var y=_Te(m);return a.addItem(m,y),y},u=function(){return s},c=function(m){return a.getItem(m)},f=function(m){s=m},h=!1,d=NTe(r,n,i,o,function(p,m){var y=c(u()),S=!1;if(!y.hasShortcut(m))return S;for(var R=y.getShortcuts(m),E=0;E<R.length;E++){var O=R[E],A=O.callback,B=O.runOnlyIf,j=O.preventDefault,J=O.stopPropagation,Y=O.captureCtrl;if(B(p)!==!1&&(h=Y,S=A(p,m)===!1,h=!1,j&&p.preventDefault(),J&&p.stopPropagation(),S))break}return S});return d.mount(),{addContext:l,getActiveContextName:u,getContext:c,setActiveContextName:f,isCtrlPressed:function(){return!h&&(d.isPressed("control")||d.isPressed("meta"))},releasePressedKeys:function(){return d.releasePressedKeys()},destroy:function(){return d.unmount()}}},Z3,J3;function Mn(t){"@babel/helpers - typeof";return Mn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mn(t)}function eM(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function uo(t,e){return xTe(t)||kTe(t,e)||WB(t,e)||MTe()}function MTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kTe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function xTe(t){if(Array.isArray(t))return t}function rc(t){return DTe(t)||LTe(t)||WB(t)||$Te()}function $Te(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WB(t,e){if(t){if(typeof t=="string")return ZC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZC(t,e)}}function LTe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function DTe(t){if(Array.isArray(t))return ZC(t)}function ZC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var FTe="gridDefault",_6=null,Uy=new Set;function V7(t,e){var r,n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,a=this,s=new hr(a),l,u,c,f,h=!0;ESe(i)&&RSe(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=(r=e==null?void 0:e.layoutDirection)!==null&&r!==void 0?r:"inherit",p=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",p),this.isRtl=function(){return p==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},e.language=LEe(e.language);var m=new VB(a,e,[cTe,vTe]),y=m.getTableMeta(),S=m.getGlobalMeta(),R=iw();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),AC(this)&&Zde(e.licenseKey,t),this.guid="ht_".concat(FH()),this.columnIndexMapper=new BC,this.rowIndexMapper=new BC,this.columnIndexMapper.addLocalHook("indexesSequenceChange",function(v){a.runHooks("afterColumnSequenceChange",v)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",function(v){a.runHooks("afterRowSequenceChange",v)}),u=new XSe(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var E=function(b){var w=b.row,_=b.col;return a._createCellCoords(w>=0?a.rowIndexMapper.getRenderableFromVisualIndex(w):w,_>=0?a.columnIndexMapper.getRenderableFromVisualIndex(_):_)},O=function(b){var w=b.row,_=b.col;return a._createCellCoords(w>=0?a.rowIndexMapper.getVisualFromRenderableIndex(w):w,_>=0?a.columnIndexMapper.getVisualFromRenderableIndex(_):_)},A=new j5e(y,{rowIndexMapper:function(){return a.rowIndexMapper},columnIndexMapper:function(){return a.columnIndexMapper},countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(b){return l.propToCol(b)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return a.getShortcutManager()},createCellCoords:function(b,w){return a._createCellCoords(b,w)},createCellRange:function(b,w,_){return a._createCellRange(b,w,_)},visualToRenderableCoords:E,renderableToVisualCoords:O,isDisabledCellSelection:function(b,w){return a.getCellMeta(b,w).disableVisualSelection}});this.selection=A;var B=function(b){var w=b.hiddenIndexesChanged;w&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",B),this.rowIndexMapper.addLocalHook("cacheUpdated",B),this.selection.addLocalHook("beforeSetRangeStart",function(v){n.runHooks("beforeSetRangeStart",v)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(v){n.runHooks("beforeSetRangeStartOnly",v)}),this.selection.addLocalHook("beforeSetRangeEnd",function(v){n.runHooks("beforeSetRangeEnd",v),v.row<0&&(v.row=n.view._wt.wtTable.getFirstVisibleRow()),v.col<0&&(v.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(v){var b=cf(!1),w=n.selection.getSelectedRange(),_=w.current(),M=_.from,L=_.to,H=w.size()-1;n.runHooks("afterSelection",M.row,M.col,L.row,L.col,b,H),n.runHooks("afterSelectionByProp",M.row,a.colToProp(M.col),L.row,a.colToProp(L.col),b,H);var Z=n.selection.isSelectedByAnyHeader(),te=n.selection.selectedRange.current(),ie=!0;o&&(ie=!1),b.isTouched()&&(ie=!b.value);var oe=n.selection.isSelectedByRowHeader(),ve=n.selection.isSelectedByColumnHeader();ie!==!1&&(Z?oe?n.view.scrollViewportVertically(a.rowIndexMapper.getRenderableFromVisualIndex(v.row)):ve&&n.view.scrollViewportHorizontally(a.columnIndexMapper.getRenderableFromVisualIndex(v.col)):te&&!n.selection.isMultiple()?n.view.scrollViewport(E(te.from)):n.view.scrollViewport(E(v))),oe&&ve?le(n.rootElement,["ht__selection--rows","ht__selection--columns"]):oe?(qe(n.rootElement,"ht__selection--columns"),le(n.rootElement,"ht__selection--rows")):ve?(qe(n.rootElement,"ht__selection--rows"),le(n.rootElement,"ht__selection--columns")):qe(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(v){var b=v.length-1,w=v[b],_=w.from,M=w.to;n.runHooks("afterSelectionEnd",_.row,_.col,M.row,M.col,b),n.runHooks("afterSelectionEndByProp",_.row,a.colToProp(_.col),M.row,a.colToProp(M.col),b)}),this.selection.addLocalHook("afterIsMultipleSelection",function(v){var b=n.runHooks("afterIsMultipleSelection",v.value);v.value&&(v.value=b)}),this.selection.addLocalHook("beforeModifyTransformStart",function(v){n.runHooks("modifyTransformStart",v)}),this.selection.addLocalHook("afterModifyTransformStart",function(v,b,w){n.runHooks("afterModifyTransformStart",v,b,w)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(v){n.runHooks("modifyTransformEnd",v)}),this.selection.addLocalHook("afterModifyTransformEnd",function(v,b,w){n.runHooks("afterModifyTransformEnd",v,b,w)}),this.selection.addLocalHook("afterDeselect",function(){f.destroyEditor(),n._refreshBorders(),qe(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(v){n.alter("insert_row_above",v,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(v){n.alter("insert_col_start",v,1,"auto")}),c={alter:function(b,w){var _,M,L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,H=arguments.length>3?arguments[3]:void 0,Z=arguments.length>4?arguments[4]:void 0,te=function(Je){if(Je.length===0)return[];var xe=rc(Je);xe.sort(function(Tt,yt){var er=uo(Tt,1),_t=er[0],pr=uo(yt,1),Gt=pr[0];return _t===Gt?0:_t>Gt?1:-1});var Ot=gn(xe,function(Tt,yt){var er=uo(yt,2),_t=er[0],pr=er[1],Gt=Tt[Tt.length-1],At=uo(Gt,2),wt=At[0],Vu=At[1],ln=wt+Vu;if(_t<=ln){var Pd=Math.max(pr-(ln-_t),0);Gt[1]+=Pd}else Tt.push([_t,pr]);return Tt},[xe[0]]);return Ot};switch(b){case"insert_row":Uy.has(b)||(Uy.add(b),Dt(kt(Z3||(Z3=eM(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),b)));case"insert_row_below":case"insert_row_above":var ie=a.countSourceRows();if(y.maxRows===ie)return;var oe=b==="insert_row_below"?"below":"above";w=(_=w)!==null&&_!==void 0?_:b==="insert_row"||oe==="below"?ie:0;var ve=l.createRow(w,L,{source:H,mode:oe}),ke=ve.delta,pe=ve.startPhysicalIndex;if(ke){var Ce=A.selectedRange.current(),re=Ce==null?void 0:Ce.from,Ve=re==null?void 0:re.row,Ze=a.toVisualRow(pe);if(A.isSelectedByCorner())a.selectAll();else if(Ae(Ve)&&Ve>=Ze){var Ge=Ce.to,je=Ge.row,ze=Ge.col,T=re.col;A.isSelectedByRowHeader()&&(T=-1),A.getSelectedRange().pop(),A.setRangeStartOnly(a._createCellCoords(Ve+ke,T),!0),A.setRangeEnd(a._createCellCoords(je+ke,ze))}else a._refreshBorders()}break;case"insert_col":Uy.has(b)||(Uy.add(b),Dt(kt(J3||(J3=eM(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),b)));case"insert_col_start":case"insert_col_end":var k=b==="insert_col_end"?"end":"start";w=(M=w)!==null&&M!==void 0?M:b==="insert_col"||k==="end"?a.countSourceCols():0;var $=l.createCol(w,L,{source:H,mode:k}),W=$.delta,F=$.startPhysicalIndex;if(W){if(Array.isArray(y.colHeaders)){var K=[a.toVisualColumn(F),0];K.length+=W,Array.prototype.splice.apply(y.colHeaders,K)}var V=A.selectedRange.current(),U=V==null?void 0:V.from,X=U==null?void 0:U.col,z=a.toVisualColumn(F);if(A.isSelectedByCorner())a.selectAll();else if(Ae(X)&&X>=z){var Q=V.to,de=Q.row,Ee=Q.col,Fe=U.row;A.isSelectedByColumnHeader()&&(Fe=-1),A.getSelectedRange().pop(),A.setRangeStartOnly(a._createCellCoords(Fe,X+W),!0),A.setRangeEnd(a._createCellCoords(de,Ee+W))}else a._refreshBorders()}break;case"remove_row":var ct=function(Je){var xe=0;D(Je,function(Ot){var Tt=uo(Ot,2),yt=Tt[0],er=Tt[1],_t=Br(yt)?a.countRows()-1:Math.max(yt-xe,0);Number.isInteger(yt)&&(yt=Math.max(yt-xe,0));var pr=l.removeRow(yt,er,H);if(pr){var Gt=a.countRows(),At=y.fixedRowsTop;At>=_t+1&&(y.fixedRowsTop-=Math.min(er,At-_t));var wt=y.fixedRowsBottom;wt&&_t>=Gt-wt&&(y.fixedRowsBottom-=Math.min(er,wt)),xe+=er}})};Array.isArray(w)?ct(te(w)):ct([[w,L]]),c.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var dt=function(Je){var xe=0;D(Je,function(Ot){var Tt=uo(Ot,2),yt=Tt[0],er=Tt[1],_t=Br(yt)?a.countCols()-1:Math.max(yt-xe,0),pr=a.toPhysicalColumn(_t);Number.isInteger(yt)&&(yt=Math.max(yt-xe,0));var Gt=l.removeCol(yt,er,H);if(Gt){var At=y.fixedColumnsStart;At>=_t+1&&(y.fixedColumnsStart-=Math.min(er,At-_t)),Array.isArray(y.colHeaders)&&(typeof pr>"u"&&(pr=-1),y.colHeaders.splice(pr,er)),xe+=er}})};Array.isArray(w)?dt(te(w)):dt([[w,L]]),c.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(b,'"'))}Z||c.adjustRowsAndCols()},adjustRowsAndCols:function(){var b=y.minRows,w=y.minSpareRows,_=y.minCols,M=y.minSpareCols;if(a.countRows()===0&&a.countCols()===0&&A.deselect(),b){var L=a.countRows();L<b&&l.createRow(L,b-L,{source:"auto"})}if(w){var H=a.countEmptyRows(!0);if(H<w){var Z=w-H,te=Math.min(Z,y.maxRows-a.countSourceRows());l.createRow(a.countRows(),te,{source:"auto"})}}{var ie;(_||M)&&(ie=a.countEmptyCols(!0));var oe=a.countCols();if(_&&!y.columns&&oe<_){var ve=_-oe;ie+=ve,l.createCol(oe,ve,{source:"auto"})}if(M&&!y.columns&&a.dataType==="array"&&ie<M){oe=a.countCols();var ke=M-ie,pe=Math.min(ke,y.maxCols-oe);l.createCol(oe,pe,{source:"auto"})}}if(A.isSelected()){var Ce=a.countRows(),re=a.countCols();D(A.selectedRange,function(Ve){var Ze=!1,Ge=Ve.from.row,je=Ve.from.col,ze=Ve.to.row,T=Ve.to.col;Ge>Ce-1?(Ge=Ce-1,Ze=!0,ze>Ge&&(ze=Ge)):ze>Ce-1&&(ze=Ce-1,Ze=!0,Ge>ze&&(Ge=ze)),je>re-1?(je=re-1,Ze=!0,T>je&&(T=je)):T>re-1&&(T=re-1,Ze=!0,je>T&&(je=T)),Ze&&a.selectCell(Ge,je,ze,T)})}a.view&&a.view.adjustElementsSize()},populateFromArray:function(b,w,_,M,L,H,Z){var te,ie,oe,ve,ke=[],pe={},Ce=[],re=b.row,Ve=b.col;if(ie=w.length,ie===0)return!1;var Ze=0,Ge=0;switch(lt(_)&&(Ze=_.col-Ve+1,Ge=_.row-re+1),L){case"shift_down":var je=H1(w),ze=je.length,T=Math.max(ze,Ze),k=a.getData().slice(re),$=H1(k).slice(Ve,Ve+T);for(oe=0;oe<T;oe+=1)if(oe<ze){for(te=0,ie=je[oe].length;te<Ge-ie;te+=1)je[oe].push(je[oe][te%ie]);oe<$.length?Ce.push(je[oe].concat($[oe])):Ce.push(je[oe].concat(new Array(k.length).fill(null)))}else Ce.push(je[oe%ze].concat($[oe]));a.populateFromArray(re,Ve,H1(Ce));break;case"shift_right":var W=w.length,F=Math.max(W,Ge),K=a.getData().slice(re).map(function(At){return At.slice(Ve)});for(te=0;te<F;te+=1)if(te<W){for(oe=0,ve=w[te].length;oe<Ze-ve;oe+=1)w[te].push(w[te][oe%ve]);if(te<K.length)for(var V=0;V<K[te].length;V+=1)w[te].push(K[te][V]);else{var U;(U=w[te]).push.apply(U,rc(new Array(K[0].length).fill(null)))}}else w.push(w[te%ie].slice(0,F).concat(K[te]));a.populateFromArray(re,Ve,w);break;case"overwrite":default:pe.row=b.row,pe.col=b.col;var X={row:_&&b?_.row-b.row+1:1,col:_&&b?_.col-b.col+1:1},z=0,Q=0,de=!0,Ee,Fe=function(wt){var Vu=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,ln=w[wt%w.length];return Vu!==null?ln[Vu%ln.length]:ln},ct=w.length,dt=_?_.row-b.row+1:0;for(_?ie=dt:ie=Math.max(ct,dt),te=0;te<ie&&!(_&&pe.row>_.row&&dt>ct||!y.allowInsertRow&&pe.row>a.countRows()-1||pe.row>=y.maxRows);te++){var Ft=te-z,Je=Fe(Ft).length,xe=_?_.col-b.col+1:0;if(_?ve=xe:ve=Math.max(Je,xe),pe.col=b.col,Ee=a.getCellMeta(pe.row,pe.col),(M==="CopyPaste.paste"||M==="Autofill.fill")&&Ee.skipRowOnPaste){z+=1,pe.row+=1,ie+=1;continue}for(Q=0,oe=0;oe<ve&&!(_&&pe.col>_.col&&xe>Je||!y.allowInsertColumn&&pe.col>a.countCols()-1||pe.col>=y.maxCols);oe++){if(Ee=a.getCellMeta(pe.row,pe.col),(M==="CopyPaste.paste"||M==="Autofill.fill")&&Ee.skipColumnOnPaste){Q+=1,pe.col+=1,ve+=1;continue}if(Ee.readOnly&&M!=="UndoRedo.undo"){pe.col+=1;continue}var Ot=oe-Q,Tt=Fe(Ft,Ot),yt=a.getDataAtCell(pe.row,pe.col),er={row:Ft,col:Ot};if(M==="Autofill.fill"){var _t=a.runHooks("beforeAutofillInsidePopulate",er,H,w,Z,{},X);_t&&(Tt=zt(_t.value)?Tt:_t.value)}if(Tt!==null&&Mn(Tt)==="object")if(Array.isArray(Tt)&&yt===null&&(yt=[]),yt===null||Mn(yt)!=="object")de=!1;else{var pr=Zp(Array.isArray(yt)?yt:yt[0]||yt),Gt=Zp(Array.isArray(Tt)?Tt:Tt[0]||Tt);C_(pr,Gt)||Array.isArray(pr)&&Array.isArray(Gt)?Tt=An(Tt):de=!1}else yt!==null&&Mn(yt)==="object"&&(de=!1);de&&ke.push([pe.row,pe.col,Tt]),de=!0,pe.col+=1}pe.row+=1}a.setDataAtCell(ke,null,null,M||"populateFromArray");break}}};function j(v){var b=yB(v);F7(b)?(a.runHooks("beforeLanguageChange",b),S.language=b,a.runHooks("afterLanguageChange",b)):bB(v)}function J(v,b){var w=v==="className"?a.rootElement:a.table;if(h)le(w,b);else{var _=[],M=[];S[v]&&(_=Array.isArray(S[v])?S[v]:BP(S[v])),b&&(M=Array.isArray(b)?b:BP(b));var L=UP(_,M),H=UP(M,_);L.length&&qe(w,L),H.length&&le(w,H)}S[v]=b}this.init=function(){u.setData(y.data),a.runHooks("beforeInit"),(Ao()||jF())&&le(a.rootElement,"mobile"),this.updateSettings(y,!0),this.view=new FSe(this),f=dme.getInstance(a,y,A),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&a.rootElement.offsetParent===null&&ppe(a.rootElement,function(){a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),Mn(h)==="object"&&(a.runHooks("afterChange",h[0],h[1]),h=!1),a.runHooks("afterInit")};function Y(){var v=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,v=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&v===!1&&(v=!0,this.onQueueEmpty(this.valid))}}}function q(v){var b=v.replace(",",".");return isNaN(parseFloat(b))===!1?parseFloat(b):v}function ee(v,b,w){if(v.length){var _=a.getActiveEditor(),M=a.runHooks("beforeChange",v,b||"edit"),L=!0;if(M===!1){_&&_.cancelChanges();return}var H=new Y;H.onQueueEmpty=function(Ce){_&&L&&_.cancelChanges(),w(Ce)};for(var Z=v.length-1;Z>=0;Z--)if(v[Z]===null)v.splice(Z,1);else{var te=uo(v[Z],4),ie=te[0],oe=te[1],ve=te[3],ke=l.propToCol(oe),pe=a.getCellMeta(ie,ke);pe.type==="numeric"&&typeof ve=="string"&&fve(ve)&&(v[Z][3]=q(ve)),a.getCellValidator(pe)&&(H.addValidatorToQueue(),a.validateCell(v[Z][3],pe,function(Ce,re){return function(Ve){if(typeof Ve!="boolean")throw new Error("Validation error: result is not boolean");if(Ve===!1&&re.allowInvalid===!1){L=!1,v.splice(Ce,1),re.valid=!0;var Ze=a.getCell(re.visualRow,re.visualCol);Ze!==null&&qe(Ze,y.invalidCellClassName)}H.removeValidatorFormQueue()}}(Z,pe),b))}H.checkIfQueueIsEmpty()}}function ae(v,b){var w=v.length-1;if(!(w<0)){for(;w>=0;w--){var _=!1;if(v[w]===null){v.splice(w,1);continue}if(!((v[w][2]===null||v[w][2]===void 0)&&(v[w][3]===null||v[w][3]===void 0))){if(y.allowInsertRow)for(;v[w][0]>a.countRows()-1;){var M=l.createRow(void 0,void 0,{source:b}),L=M.delta;if(L===0){_=!0;break}}if(a.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;l.propToCol(v[w][1])>a.countCols()-1;){var H=l.createCol(void 0,void 0,{source:b}),Z=H.delta;if(Z===0){_=!0;break}}_||l.set(v[w][0],v[w][1],v[w][3])}}a.forceFullRender=!0,c.adjustRowsAndCols(),a.runHooks("beforeChangeRender",v,b),f.lockEditor(),a._refreshBorders(null),f.unlockEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",v,b||"edit");var te=a.getActiveEditor();te&&Ae(te.refreshValue)&&te.refreshValue()}}this._createCellCoords=function(v,b){return a.view._wt.createCellCoords(v,b)},this._createCellRange=function(v,b,w){return a.view._wt.createCellRange(v,b,w)},this.validateCell=function(v,b,w,_){var M=a.getCellValidator(b);function L(H){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!Z||b.hidden===!0){w(H);return}var te=b.visualCol,ie=b.visualRow,oe=a.getCell(ie,te,!0);if(oe&&oe.nodeName!=="TH"){var ve=a.rowIndexMapper.getRenderableFromVisualIndex(ie),ke=a.columnIndexMapper.getRenderableFromVisualIndex(te);a.view._wt.getSetting("cellRenderer",ve,ke,oe)}w(H)}Xde(M)&&(M=function(H){return function(Z,te){te(H.test(Z))}}(M)),Xt(M)?(v=a.runHooks("beforeValidate",v,b.visualRow,b.prop,_),a._registerImmediate(function(){M.call(b,v,function(H){a&&(H=a.runHooks("afterValidate",H,v,b.visualRow,b.prop,_),b.valid=H,L(H),a.runHooks("postAfterValidate",H,v,b.visualRow,b.prop,_))})})):a._registerImmediate(function(){b.valid=!0,L(b.valid,!1)})};function ne(v,b,w){return Array.isArray(v)?v:[[v,b,w]]}this.setDataAtCell=function(v,b,w,_){var M=ne(v,b,w),L=[],H=_,Z,te,ie;for(Z=0,te=M.length;Z<te;Z++){if(Mn(M[Z])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof M[Z][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");M[Z][1]>=this.countCols()?ie=M[Z][1]:ie=l.colToProp(M[Z][1]),L.push([M[Z][0],ie,u.getAtCell(this.toPhysicalRow(M[Z][0]),M[Z][1]),M[Z][2]])}!H&&Mn(v)==="object"&&(H=b),a.runHooks("afterSetDataAtCell",L,H),ee(L,H,function(){ae(L,H)})},this.setDataAtRowProp=function(v,b,w,_){var M=ne(v,b,w),L=[],H=_,Z,te;for(Z=0,te=M.length;Z<te;Z++)L.push([M[Z][0],M[Z][1],u.getAtCell(this.toPhysicalRow(M[Z][0]),M[Z][1]),M[Z][2]]);!H&&Mn(v)==="object"&&(H=b),a.runHooks("afterSetDataAtRowProp",L,H),ee(L,H,function(){ae(L,H)})},this.listen=function(){a&&!a.isListening()&&(_6=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(_6=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return _6===a.guid},this.destroyEditor=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(v,b)},this.populateFromArray=function(v,b,w,_,M,L,H,Z,te){if(!(Mn(w)==="object"&&Mn(w[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var ie=typeof _=="number"?a._createCellCoords(_,M):null;return c.populateFromArray(a._createCellCoords(v,b),w,ie,L,H,Z,te)},this.spliceCol=function(v,b,w){for(var _,M=arguments.length,L=new Array(M>3?M-3:0),H=3;H<M;H++)L[H-3]=arguments[H];return(_=l).spliceCol.apply(_,[v,b,w].concat(L))},this.spliceRow=function(v,b,w){for(var _,M=arguments.length,L=new Array(M>3?M-3:0),H=3;H<M;H++)L[H-3]=arguments[H];return(_=l).spliceRow.apply(_,[v,b,w].concat(L))},this.getSelected=function(){if(A.isSelected())return st(A.getSelectedRange(),function(v){var b=v.from,w=v.to;return[b.row,b.col,w.row,w.col]})},this.getSelectedLast=function(){var v=this.getSelected(),b;return v&&v.length>0&&(b=v[v.length-1]),b},this.getSelectedRange=function(){if(A.isSelected())return Array.from(A.getSelectedRange())},this.getSelectedRangeLast=function(){var v=this.getSelectedRange(),b;return v&&v.length>0&&(b=v[v.length-1]),b},this.emptySelectedCells=function(v){var b=this;if(!(!A.isSelected()||this.countRows()===0||this.countCols()===0)){var w=[];D(A.getSelectedRange(),function(_){var M=_.getTopStartCorner(),L=_.getBottomEndCorner();De(M.row,L.row,function(H){De(M.col,L.col,function(Z){b.getCellMeta(H,Z).readOnly||w.push([H,Z,null])})})}),w.length>0&&this.setDataAtCell(w,v)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var v=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(v,0),!this.isRenderSuspended()&&v===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(f.lockEditor(),this._refreshBorders(null),f.unlockEditor()))},this.batchRender=function(v){this.suspendRender();var b=v();return this.resumeRender(),b},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,b=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(b,0),(!this.isExecutionSuspended()&&b===this.executionSuspendedCounter||v)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(v){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var w=v();return this.resumeExecution(b),w},this.batch=function(v){this.suspendRender(),this.suspendExecution();var b=v();return this.resumeExecution(),this.resumeRender(),b},this.refreshDimensions=function(){if(a.view){var v=a.view.getLastSize(),b=v.width,w=v.height,_=a.rootElement.getBoundingClientRect(),M=_.width,L=_.height,H=M!==b||L!==w,Z=a.runHooks("beforeRefreshDimensions",{width:b,height:w},{width:M,height:L},H)===!1;Z||((H||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(M,L),a.render()),a.runHooks("afterRefreshDimensions",{width:b,height:w},{width:M,height:L},H))}},this.updateData=function(v,b){var w=this;K3(v,function(_){l=_},function(_){l=_,a.columnIndexMapper.fitToLength(w.getInitialColumnCount()),a.rowIndexMapper.fitToLength(w.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:a,dataMap:l,dataSource:u,internalSource:"updateData",source:b,metaManager:m,firstRun:h})},this.loadData=function(v,b){K3(v,function(w){l=w},function(){m.clearCellsCache(),a.initIndexMappers(),c.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:a,dataMap:l,dataSource:u,internalSource:"loadData",source:b,metaManager:m,firstRun:h})},this.getInitialColumnCount=function(){var v=y.columns,b=0;if(Array.isArray(v))b=v.length;else if(Xt(v))if(a.dataType==="array")for(var w=this.countSourceCols(),_=0;_<w;_+=1)v(_)&&(b+=1);else(a.dataType==="object"||a.dataType==="function")&&(b=l.colToPropCache.length);else if(Ae(y.dataSchema)){var M=l.getSchema();b=Array.isArray(M)?M.length:O_(M)}else b=this.countSourceCols();return b},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(v,b,w,_){return zt(v)?l.getAll():l.getRange(a._createCellCoords(v,b),a._createCellCoords(w,_),l.DESTINATION_RENDERER)},this.getCopyableText=function(v,b,w,_){return l.getCopyableText(a._createCellCoords(v,b),a._createCellCoords(w,_))},this.getCopyableData=function(v,b){return l.getCopyable(v,l.colToProp(b))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(v){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,w=(h?a.loadData:a.updateData).bind(this),_=!1,M,L;if(Ae(v.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Ae(v.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Ae(v.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(M in v)M==="data"||(M==="language"?j(v.language):M==="className"?J("className",v.className):M==="tableClassName"&&a.table?(J("tableClassName",v.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):Ne.getSingleton().isRegistered(M)||Ne.getSingleton().isDeprecated(M)?(Xt(v[M])||Array.isArray(v[M]))&&(v[M].initialHook=!0,a.addHook(M,v[M])):!b&&wr(v,M)&&(S[M]=v[M]));v.data===void 0&&y.data===void 0?w(null,"updateSettings"):v.data!==void 0?w(v.data,"updateSettings"):v.columns!==void 0&&(l.createMap(),a.initIndexMappers());var H=a.countCols(),Z=y.columns;if(Z&&Xt(Z)&&(_=!0),(v.cell!==void 0||v.cells!==void 0||v.columns!==void 0)&&m.clearCache(),H>0)for(M=0,L=0;M<H;M++){if(Z){var te=_?Z(M):Z[L];te&&m.updateColumnMeta(L,te)}L+=1}Ae(v.cell)&&ut(v.cell,function(Ce){a.setCellMetaObject(Ce.row,Ce.col,Ce)}),a.runHooks("afterCellMetaReset");var ie=a.rootElement.style.height;ie!==""&&(ie=parseInt(a.rootElement.style.height,10));var oe=v.height;if(Xt(oe)&&(oe=oe()),b){var ve=a.rootElement.getAttribute("style");ve&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(oe===null){var ke=a.rootElement.getAttribute("data-initialstyle");ke&&(ke.indexOf("height")>-1||ke.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",ke):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else oe!==void 0&&(a.rootElement.style.height=isNaN(oe)?"".concat(oe):"".concat(oe,"px"),a.rootElement.style.overflow="hidden");if(typeof v.width<"u"){var pe=v.width;Xt(pe)&&(pe=pe()),a.rootElement.style.width=isNaN(pe)?"".concat(pe):"".concat(pe,"px")}b||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",v)),c.adjustRowsAndCols(),a.view&&!h&&(a.forceFullRender=!0,f.lockEditor(),a._refreshBorders(null),a.view._wt.wtOverlays.adjustElementsSize(),f.unlockEditor()),!b&&a.view&&(ie===""||oe===""||oe===void 0)&&ie!==oe&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var v=a.getSelectedLast();if(y.getValue){if(Xt(y.getValue))return y.getValue.call(a);if(v)return a.getData()[v[0][0]][y.getValue]}else if(v)return a.getDataAtCell(v[0],v[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(v,b,w,_,M){c.alter(v,b,w,_,M)},this.getCell=function(v,b){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,_=b,M=v;if(b>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(b)))return null;_=this.columnIndexMapper.getRenderableFromVisualIndex(b)}if(v>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(v)))return null;M=this.rowIndexMapper.getRenderableFromVisualIndex(v)}return M===null||_===null?null:a.view.getCellAtCoords(a._createCellCoords(M,_),w)},this.getCoords=function(v){var b=this.view._wt.wtTable.getCoords(v);if(b===null)return null;var w=b.row,_=b.col,M=w,L=_;return w>=0&&(M=this.rowIndexMapper.getVisualFromRenderableIndex(w)),_>=0&&(L=this.columnIndexMapper.getVisualFromRenderableIndex(_)),a._createCellCoords(M,L)},this.colToProp=function(v){return l.colToProp(v)},this.propToCol=function(v){return l.propToCol(v)},this.toVisualRow=function(v){return n.rowIndexMapper.getVisualFromPhysicalIndex(v)},this.toVisualColumn=function(v){return n.columnIndexMapper.getVisualFromPhysicalIndex(v)},this.toPhysicalRow=function(v){return n.rowIndexMapper.getPhysicalFromVisualIndex(v)},this.toPhysicalColumn=function(v){return n.columnIndexMapper.getPhysicalFromVisualIndex(v)},this.getDataAtCell=function(v,b){return l.get(v,l.colToProp(b))},this.getDataAtRowProp=function(v,b){return l.get(v,b)},this.getDataAtCol=function(v){for(var b=[],w=l.getRange(a._createCellCoords(0,v),a._createCellCoords(y.data.length-1,v),l.DESTINATION_RENDERER),_=0;_<w.length;_+=1)for(var M=0;M<w[_].length;M+=1)b.push(w[_][M]);return b},this.getDataAtProp=function(v){for(var b=[],w=l.getRange(a._createCellCoords(0,l.propToCol(v)),a._createCellCoords(y.data.length-1,l.propToCol(v)),l.DESTINATION_RENDERER),_=0;_<w.length;_+=1)for(var M=0;M<w[_].length;M+=1)b.push(w[_][M]);return b},this.getSourceData=function(v,b,w,_){var M;return v===void 0?M=u.getData():M=u.getByRange(a._createCellCoords(v,b),a._createCellCoords(w,_)),M},this.getSourceDataArray=function(v,b,w,_){var M;return v===void 0?M=u.getData(!0):M=u.getByRange(a._createCellCoords(v,b),a._createCellCoords(w,_),!0),M},this.getSourceDataAtCol=function(v){return u.getAtColumn(v)},this.setSourceDataAtCell=function(v,b,w,_){var M=ne(v,b,w),L=this.hasHook("afterSetSourceDataAtCell"),H=[];L&&D(M,function(te){var ie=uo(te,3),oe=ie[0],ve=ie[1],ke=ie[2];H.push([oe,ve,u.getAtCell(oe,ve),ke])}),D(M,function(te){var ie=uo(te,3),oe=ie[0],ve=ie[1],ke=ie[2];u.setAtCell(oe,ve,ke)}),L&&this.runHooks("afterSetSourceDataAtCell",H,_),this.render();var Z=a.getActiveEditor();Z&&Ae(Z.refreshValue)&&Z.refreshValue()},this.getSourceDataAtRow=function(v){return u.getAtRow(v)},this.getSourceDataAtCell=function(v,b){return u.getAtCell(v,b)},this.getDataAtRow=function(v){var b=l.getRange(a._createCellCoords(v,0),a._createCellCoords(v,this.countCols()-1),l.DESTINATION_RENDERER);return b[0]||[]},this.getDataType=function(v,b,w,_){var M=this,L=v===void 0?[0,0,this.countRows(),this.countCols()]:[v,b,w,_],H=L[0],Z=L[1],te=L[2],ie=L[3],oe=null,ve=null;te===void 0&&(te=H),ie===void 0&&(ie=Z);var ke="mixed";return De(Math.max(Math.min(H,te),0),Math.max(H,te),function(pe){var Ce=!0;return De(Math.max(Math.min(Z,ie),0),Math.max(Z,ie),function(re){var Ve=M.getCellMeta(pe,re);return ve=Ve.type,oe?Ce=oe===ve:oe=ve,Ce}),ke=Ce?ve:"mixed",Ce}),ke},this.removeCellMeta=function(v,b,w){var _=[this.toPhysicalRow(v),this.toPhysicalColumn(b)],M=_[0],L=_[1],H=m.getCellMetaKeyValue(M,L,w),Z=a.runHooks("beforeRemoveCellMeta",v,b,w,H);Z!==!1&&(m.removeCellMeta(M,L,w),a.runHooks("afterRemoveCellMeta",v,b,w,H)),H=null},this.spliceCellsMeta=function(v){for(var b=this,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_=arguments.length,M=new Array(_>2?_-2:0),L=2;L<_;L++)M[L-2]=arguments[L];if(M.length>0&&!Array.isArray(M[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");w>0&&m.removeRow(this.toPhysicalRow(v),w),M.length>0&&D(M.reverse(),function(H){m.createRow(b.toPhysicalRow(v)),D(H,function(Z,te){return b.setCellMetaObject(v,te,Z)})}),a.render()},this.setCellMetaObject=function(v,b,w){var _=this;Mn(w)==="object"&&ut(w,function(M,L){_.setCellMeta(v,b,L,M)})},this.setCellMeta=function(v,b,w,_){var M=a.runHooks("beforeSetCellMeta",v,b,w,_);if(M!==!1){var L=v,H=b;v<this.countRows()&&(L=this.toPhysicalRow(v)),b<this.countCols()&&(H=this.toPhysicalColumn(b)),m.setCellMeta(L,H,w,_),a.runHooks("afterSetCellMeta",v,b,w,_)}},this.getCellsMeta=function(){return m.getCellsMeta()},this.getCellMeta=function(v,b){var w=this.toPhysicalRow(v),_=this.toPhysicalColumn(b);return w===null&&(w=v),_===null&&(_=b),m.getCellMeta(w,_,{visualRow:v,visualColumn:b})},this.getCellMetaAtRow=function(v){return m.getCellsMetaAtRow(v)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||y.columns)},this.getCellRenderer=function(v,b){var w=typeof v=="number"?a.getCellMeta(v,b).renderer:v.renderer;return typeof w=="string"?H8(w):zt(w)?H8("text"):w},this.getCellEditor=function(v,b){var w=typeof v=="number"?a.getCellMeta(v,b).editor:v.editor;return typeof w=="string"?_8(w):zt(w)?_8("text"):w},this.getCellValidator=function(v,b){var w=typeof v=="number"?a.getCellMeta(v,b).validator:v.validator;return typeof w=="string"?ige(w):w},this.validateCells=function(v){this._validateCells(v)},this.validateRows=function(v,b){if(!Array.isArray(v))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(b,v)},this.validateColumns=function(v,b){if(!Array.isArray(v))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(b,void 0,v)},this._validateCells=function(v,b,w){var _=new Y;v&&(_.onQueueEmpty=v);for(var M=a.countRows()-1;M>=0;){if(b!==void 0&&b.indexOf(M)===-1){M-=1;continue}for(var L=a.countCols()-1;L>=0;){if(w!==void 0&&w.indexOf(L)===-1){L-=1;continue}_.addValidatorToQueue(),a.validateCell(a.getDataAtCell(M,L),a.getCellMeta(M,L),function(H){if(typeof H!="boolean")throw new Error("Validation error: result is not boolean");H===!1&&(_.valid=!1),_.removeValidatorFormQueue()},"validateCells"),L-=1}M-=1}_.checkIfQueueIsEmpty()},this.getRowHeader=function(v){var b=y.rowHeaders,w=v;return w!==void 0&&(w=a.runHooks("modifyRowHeader",w)),w===void 0?(b=[],De(a.countRows()-1,function(_){b.push(a.getRowHeader(_))})):Array.isArray(b)&&b[w]!==void 0?b=b[w]:Xt(b)?b=b(w):b&&typeof b!="string"&&typeof b!="number"&&(b=w+1),b},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(var v=0,b=a.countCols();v<b;v++)if(a.getColHeader(v))return!0;return!1},this.getColHeader=function(v){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,w=a.runHooks("modifyColHeader",v);if(w===void 0){for(var _=[],M=a.countCols(),L=0;L<M;L++)_.push(a.getColHeader(L));return _}var H=y.colHeaders,Z=function(ve){for(var ke=[],pe=a.countCols(),Ce=0;Ce<pe;Ce++)Xt(y.columns)&&y.columns(Ce)&&ke.push(Ce);return ke[ve]},te=a.toPhysicalColumn(w),ie=Z(te);return y.colHeaders===!1?H=null:y.columns&&Xt(y.columns)&&y.columns(ie)&&y.columns(ie).title?H=y.columns(ie).title:y.columns&&y.columns[te]&&y.columns[te].title?H=y.columns[te].title:Array.isArray(y.colHeaders)&&y.colHeaders[te]!==void 0?H=y.colHeaders[te]:Xt(y.colHeaders)?H=y.colHeaders(te):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(H=USe(w)),H=a.runHooks("modifyColumnHeaderValue",H,v,b),H},this._getColWidthFromSettings=function(v){var b;if(v>=0){var w=a.getCellMeta(0,v);b=w.width}if((b===void 0||b===y.width)&&(b=y.colWidths),b!=null){switch(Mn(b)){case"object":b=b[v];break;case"function":b=b(v);break}typeof b=="string"&&(b=parseInt(b,10))}return b},this.getColWidth=function(v){var b=a._getColWidthFromSettings(v);return b=a.runHooks("modifyColWidth",b,v),b===void 0&&(b=eA.DEFAULT_WIDTH),b},this._getRowHeightFromSettings=function(v){var b=y.rowHeights;if(b!=null){switch(Mn(b)){case"object":b=b[v];break;case"function":b=b(v);break}typeof b=="string"&&(b=parseInt(b,10))}return b},this.getRowHeight=function(v){var b=a._getRowHeightFromSettings(v);return b=a.runHooks("modifyRowHeight",b,v),b},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){var v=y.maxCols,b=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(v,b)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,b=0;return QE(a.countRows()-1,function(w){if(a.isEmptyRow(w))b+=1;else if(v===!0)return!1}),b},this.countEmptyCols=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,b=0;return QE(a.countCols()-1,function(w){if(a.isEmptyCol(w))b+=1;else if(v===!0)return!1}),b},this.isEmptyRow=function(v){return y.isEmptyRow.call(a,v)},this.isEmptyCol=function(v){return y.isEmptyCol.call(a,v)},this.selectCell=function(v,b,w,_){var M=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,L=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return zt(v)||zt(b)?!1:this.selectCells([[v,b,w,_]],M,L)},this.selectCells=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;b===!1&&(o=!0);var _=A.selectCells(v);return _&&w&&a.listen(),o=!1,_},this.selectColumns=function(v){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v;return A.selectColumns(v,b)},this.selectRows=function(v){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v;return A.selectRows(v,b)},this.deselectCell=function(){A.deselect()},this.selectAll=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,b=v&&this.hasRowHeaders(),w=v&&this.hasColHeaders();o=!0,A.selectAll(b,w),o=!1};var ue=function(b,w){return b.getNearestNotHiddenIndex(w,1,!0)};this.scrollViewportTo=function(v,b){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,_=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,M=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,L=!w,H=!_,Z=v,te=b;if(M){var ie=Number.isInteger(v),oe=Number.isInteger(b),ve=ie?ue(this.rowIndexMapper,v):void 0,ke=oe?ue(this.columnIndexMapper,b):void 0;if(ve===null||ke===null)return!1;Z=ie?a.rowIndexMapper.getRenderableFromVisualIndex(ve):void 0,te=oe?a.columnIndexMapper.getRenderableFromVisualIndex(ke):void 0}var pe=Number.isInteger(Z),Ce=Number.isInteger(te);return pe&&Ce?a.view.scrollViewport(a._createCellCoords(Z,te),L,_,w,H):pe&&Ce===!1?a.view.scrollViewportVertically(Z,L,w):Ce&&pe===!1?a.view.scrollViewportHorizontally(te,_,H):!1},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),m.clearCache(),AC(a)){var v=this.rootDocument.querySelector(".hot-display-license-info");v&&v.parentNode.removeChild(v)}$o(a.rootElement),s.destroy(),f&&f.destroy(),a.batchExecution(function(){a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),R.getItems().forEach(function(b){var w=uo(b,2),_=w[1];_.destroy()}),R.clear(),a.runHooks("afterDestroy")},!0),Ne.getSingleton().destroy(a),ut(a,function(b,w,_){Xt(b)?_[w]=me(w):w!=="guid"&&(_[w]=null)}),a.isDestroyed=!0,l&&l.destroy(),l=null,c=null,A=null,f=null,a=null};function me(v){return function(){throw new Error('The "'.concat(v,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return f.getActiveEditor()},this.getPlugin=function(v){var b=Qi(v);return b==="UndoRedo"?this.undoRedo:R.getItem(b)},this.getPluginName=function(v){return v===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:R.getId(v)},this.getInstance=function(){return a},this.addHook=function(v,b){Ne.getSingleton().add(v,b,a)},this.hasHook=function(v){return Ne.getSingleton().has(v,a)||Ne.getSingleton().has(v)},this.addHookOnce=function(v,b){Ne.getSingleton().once(v,b,a)},this.removeHook=function(v,b){Ne.getSingleton().remove(v,b,a)},this.runHooks=function(v,b,w,_,M,L,H){return Ne.getSingleton().run(a,v,b,w,_,M,L,H)},this.getTranslatedPhrase=function(v,b){return TB(y.language,v,b)},this.toHTML=function(){return x8(n)},this.toTableElement=function(){var v=n.rootDocument.createElement("div");return v.insertAdjacentHTML("afterbegin",x8(n)),v.firstElementChild},this.timeouts=[],this._registerTimeout=function(v){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=v;typeof w=="function"&&(w=setTimeout(w,b)),this.timeouts.push(w)},this._clearTimeouts=function(){D(this.timeouts,function(v){clearTimeout(v)})},this.immediates=[],this._registerImmediate=function(v){this.immediates.push(setImmediate(v))},this._clearImmediates=function(){D(this.immediates,function(v){clearImmediate(v)})},this._refreshBorders=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;f.destroyEditor(v),a.view.render(),b&&A.isSelected()&&f.prepareEditor()},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};var Re=PTe({handleEvent:function(b){var w=a.isListening(),_=(b==null?void 0:b.key)!==void 0;return w&&_},beforeKeyDown:function(b){return n.runHooks("beforeKeyDown",b)},afterKeyDown:function(b){n.isDestroyed||a.runHooks("afterDocumentKeyDown",b)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(v){v.ctrlKey===!1&&v.metaKey===!1&&Re.releasePressedKeys()}),this.getShortcutManager=function(){return Re};var ge=Re.addContext("grid"),I={runOnlyIf:function(){return Ae(a.getSelected())&&a.countRenderedRows()>0&&a.countRenderedCols()>0},group:FTe};Re.setActiveContextName("grid"),ge.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){a.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var b=a.getSelectedRange(),w=b[b.length-1].highlight,_=w.row,M=w.col,L=a.getDataAtCell(_,M),H=new Map,Z=0;Z<b.length;Z++)b[Z].forAll(function(te,ie){if(te>=0&&ie>=0&&(te!==_||ie!==M)){var oe=a.getCellMeta(te,ie),ve=oe.readOnly;ve||H.set("".concat(te,"x").concat(ie),[te,ie,L])}});a.setDataAtCell(Array.from(H.values()))},runOnlyIf:function(){return a.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){A.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){A.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(0,1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){A.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var b=a.getSelectedRangeLast(),w=b.from,_=b.to,M=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);A.setRangeStart(w.clone()),A.setRangeEnd(a._createCellCoords(M,_.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){A.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){A.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){A.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var b=a.getSelectedRangeLast(),w=b.from,_=b.to,M=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);A.setRangeStart(w.clone()),A.setRangeEnd(a._createCellCoords(M,_.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){A.transformStart(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var b,w=a.getSelectedRangeLast().highlight.row,_=(b=a.columnIndexMapper).getNearestNotHiddenIndex.apply(b,rc(a.isRtl()?[a.countCols()-1,-1]:[0,1]));A.setRangeStart(a._createCellCoords(w,_))}},{keys:[["ArrowLeft","Shift"]],callback:function(){A.transformEnd(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var b,w=a.getSelectedRangeLast(),_=w.from,M=w.to,L=(b=a.columnIndexMapper).getNearestNotHiddenIndex.apply(b,rc(a.isRtl()?[a.countCols()-1,-1]:[0,1]));A.setRangeStart(_.clone()),A.setRangeEnd(a._createCellCoords(M.row,L))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){A.transformStart(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var b,w=a.getSelectedRangeLast().highlight.row,_=(b=a.columnIndexMapper).getNearestNotHiddenIndex.apply(b,rc(a.isRtl()?[0,1]:[a.countCols()-1,-1]));A.setRangeStart(a._createCellCoords(w,_))}},{keys:[["ArrowRight","Shift"]],callback:function(){A.transformEnd(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var b,w=a.getSelectedRangeLast(),_=w.from,M=w.to,L=(b=a.columnIndexMapper).getNearestNotHiddenIndex.apply(b,rc(a.isRtl()?[0,1]:[a.countCols()-1,-1]));A.setRangeStart(_.clone()),A.setRangeEnd(a._createCellCoords(M.row,L))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var b=parseInt(a.getSettings().fixedColumnsStart,10),w=a.getSelectedRangeLast().highlight.row,_=a.columnIndexMapper.getNearestNotHiddenIndex(b,1);A.setRangeStart(a._createCellCoords(w,_))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){A.setRangeEnd(a._createCellCoords(A.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var b=parseInt(a.getSettings().fixedRowsTop,10),w=parseInt(a.getSettings().fixedColumnsStart,10),_=a.rowIndexMapper.getNearestNotHiddenIndex(b,1),M=a.columnIndexMapper.getNearestNotHiddenIndex(w,1);A.setRangeStart(a._createCellCoords(_,M))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){A.setRangeStart(a._createCellCoords(a.getSelectedRangeLast().highlight.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){A.setRangeEnd(a._createCellCoords(A.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var b=parseInt(a.getSettings().fixedRowsBottom,10),w=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-b-1,-1),_=a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1);A.setRangeStart(a._createCellCoords(w,_))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){A.transformStart(-a.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var b=a.getSelectedRangeLast(),w=b.to,_=Math.max(w.row-a.countVisibleRows(),0),M=a.rowIndexMapper.getNearestNotHiddenIndex(_,1);if(M!==null){var L=a._createCellCoords(M,w.col),H=w.row-a.view.getFirstFullyVisibleRow(),Z=Math.max(L.row-H,0);A.setRangeEnd(L),a.scrollViewportTo(Z)}}},{keys:[["PageDown"]],callback:function(){A.transformStart(a.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var b=a.getSelectedRangeLast(),w=b.to,_=Math.min(w.row+a.countVisibleRows(),a.countRows()-1),M=a.rowIndexMapper.getNearestNotHiddenIndex(_,-1);if(M!==null){var L=a._createCellCoords(M,w.col),H=w.row-a.view.getFirstFullyVisibleRow(),Z=Math.min(L.row-H,a.countRows()-1);A.setRangeEnd(L),a.scrollViewportTo(Z)}}},{keys:[["Tab"]],callback:function(b){var w=typeof y.tabMoves=="function"?y.tabMoves(b):y.tabMoves;A.transformStart(w.row,w.col,!0)}},{keys:[["Shift","Tab"]],callback:function(b){var w=typeof y.tabMoves=="function"?y.tabMoves(b):y.tabMoves;A.transformStart(-w.row,-w.col)}}],I),pU().forEach(function(v){var b=J_(v);R.addItem(v,new b(n))}),Ne.getSingleton().run(a,"construct")}var HTe="hooksRefRegisterer",GB={_hooksStorage:Object.create(null),addHook:function(e,r){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,r),this._hooksStorage[e].push(r),this},removeHooksByKey:function(e){var r=this;D(this._hooksStorage[e]||[],function(n){r.hot.removeHook(e,n)})},clearHooks:function(){var e=this;ut(this._hooksStorage,function(r,n){return e.removeHooksByKey(n)}),this._hooksStorage={}}};Ka(GB,"MIXIN_NAME",HTe,{writable:!1,enumerable:!1});const UTe=GB;function Ff(t){"@babel/helpers - typeof";return Ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ff(t)}function BTe(t,e){return GTe(t)||WTe(t,e)||jTe(t,e)||VTe()}function VTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jTe(t,e){if(t){if(typeof t=="string")return tM(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tM(t,e)}}function tM(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function WTe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function GTe(t){if(Array.isArray(t))return t}function zTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&JC(t,e)}function JC(t,e){return JC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},JC(t,e)}function YTe(t){var e=qTe();return function(){var n=Nb(t),i;if(e){var o=Nb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return KTe(this,i)}}function KTe(t,e){if(e&&(Ff(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XTe(t)}function XTe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nb(t){return Nb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Nb(t)}function rM(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nM(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,QTe(n.key),n)}}function iM(t,e,r){return e&&nM(t.prototype,e),r&&nM(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function QTe(t){var e=ZTe(t,"string");return Ff(e)==="symbol"?e:String(e)}function ZTe(t,e){if(Ff(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Ff(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var JTe="base",Wr=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),e5="baseEditor",_d=function(){function t(e){rM(this,t),this.hot=e,this.instance=e,this.state=Wr.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return iM(t,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,i,o,a,s){this.TD=o,this.row=r,this.col=n,this.prop=i,this.originalValue=a,this.cellProperties=s,this.state=Wr.VIRGIN}},{key:"extend",value:function(){return function(r){zTe(i,r);var n=YTe(i);function i(){return rM(this,i),n.apply(this,arguments)}return iM(i)}(this.constructor)}},{key:"saveValue",value:function(r,n){var i=this,o,a,s,l;if(n){var u=this.hot.getSelectedLast();o=Math.max(Math.min(u[0],u[2]),0),a=Math.max(Math.min(u[1],u[3]),0),s=Math.max(u[0],u[2]),l=Math.max(u[1],u[3])}else{var c=[this.row,this.col,null,null];o=c[0],a=c[1],s=c[2],l=c[3]}var f=this.hot.runHooks("modifyGetCellCoords",o,a);if(Array.isArray(f)){var h=BTe(f,2);o=h[0],a=h[1]}var d=this.hot.getShortcutManager(),p=d.getContext("editor"),m={runOnlyIf:function(){return Ae(i.hot.getSelected())},group:e5};this.isInFullEditMode()&&p.addShortcuts([{keys:[["ArrowUp"]],callback:function(){i.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){i.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){i.hot.selection.transformStart(0,-1*i.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){i.hot.selection.transformStart(0,i.hot.getDirectionFactor())}}],m),this.hot.populateFromArray(o,a,r,s,l,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===Wr.VIRGIN){var i=this.hot,o=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(i._createCellCoords(o,a)),this.state=Wr.EDITING,this.isInFullEditMode()){var s=typeof r=="string"?r:Ar(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,i){var o=this,a;if(i){var s=this._closeCallback;this._closeCallback=function(f){s&&s(f),i(f),o.hot.view.render()}}if(!this.isWaiting()){var l=this.hot.getShortcutManager(),u=l.getContext("editor");if(u.removeShortcutsByGroup(e5),u.removeShortcutsByGroup(nw),this.state===Wr.VIRGIN){this.hot._registerTimeout(function(){o._fireCallbacks(!0)});return}if(this.state===Wr.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var c=this.getValue();this.cellProperties.trimWhitespace?a=[[typeof c=="string"?String.prototype.trim.call(c||""):c]]:a=[[c]],this.state=Wr.WAITING,this.saveValue(a,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(f){o.state=Wr.FINISHED,o.discardEditor(f)}):(this.state=Wr.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=Wr.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===Wr.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=Wr.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Wr.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===Wr.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var i=this.hot.view._wt,o=i.wtOverlays,a=i.wtViewport,s=this.hot.rootWindow,l=xr(n),u=Ut(n),c=xr(this.hot.rootElement),f=Ut(this.hot.rootElement),h=o.topOverlay.holder,d=o.inlineStartOverlay.holder,p=h!==s?h.scrollTop:0,m=d!==s?d.scrollLeft:0,y=s.innerWidth-c.left-f,S=(r=o.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,R=S.wtTable,E=R.name,O=["master","inline_start"].includes(E)?p:0,A=["master","top","bottom"].includes(E)?m:0,B=l.top===c.top?0:1,j=l.top-c.top-B-O,J=0;this.hot.isRtl()?J=s.innerWidth-l.left-u-y-1+A:J=l.left-c.left-1-A,["top","top_inline_start_corner"].includes(E)&&(j+=o.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(E)&&(J+=Math.abs(o.inlineStartOverlay.getOverlayOffset()));var Y=this.hot.hasColHeaders(),q=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),ee=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),ae=this.hot.rowIndexMapper.getRenderableIndexesLength(),ne=ae-this.hot.view._wt.getSetting("fixedRowsBottom");(Y&&q<=0||q===ne)&&(j+=1),ee<=0&&(J+=1);var ue=a.rowsRenderCalculator.startPosition,me=a.columnsRenderCalculator.startPosition,Re=Math.abs(o.inlineStartOverlay.getScrollPosition()),ge=o.topOverlay.getScrollPosition(),I=Xr(this.hot.rootDocument),v=n.offsetTop+ue-ge,b=0;if(this.hot.isRtl()){var w=n.offsetLeft;w>=0?b=R.getWidth()-n.offsetLeft:b=Math.abs(w),b+=me-Re-u}else b=n.offsetLeft+me-Re;var _=du(this.TD,this.hot.rootWindow),M=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",L=parseInt(_[M],10)>0?0:1,H=parseInt(_.borderTopWidth,10)>0?0:1,Z=Ut(n)+L,te=ur(n)+H,ie=fpe(h)?I:0,oe=hpe(d)?I:0,ve=this.hot.view.maximumVisibleElementWidth(b)-ie+L,ke=Math.max(this.hot.view.maximumVisibleElementHeight(v)-oe+H,23);return{top:j,start:J,height:te,maxHeight:ke,width:Z,maxWidth:ve}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return JTe}}]),t}();Kt(_d,UTe);function e_e(){var t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},e,r=document.body,n=document.createTextNode(""),i=document.createElement("SPAN"),o=function(d,p,m){d.addEventListener(p,m,!1)},a=function(d,p,m){d.removeEventListener(p,m,!1)},s=function(d){var p,m;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=e.value+d:n.data=e.value+d,i.style.position="absolute",i.style.fontSize=f(e).fontSize,i.style.fontFamily=f(e).fontFamily,i.style.whiteSpace="pre",r.appendChild(i),p=i.clientWidth+2,r.removeChild(i),e.style.height=t.minHeight+"px",t.minWidth>p?e.style.width=t.minWidth+"px":p>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=p+"px",m=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>m?e.style.height=t.minHeight+"px":t.maxHeight<m?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=m+"px"},l=function(){window.setTimeout(s,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")t.minHeight=e.clientHeight;else{var p=parseInt(d.minHeight);isNaN(p)||(t.minHeight=p)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")t.maxHeight=e.clientHeight;else{var m=parseInt(d.maxHeight);isNaN(m)||(t.maxHeight=m)}if(d&&d.minWidth)if(d.minWidth=="inherit")t.minWidth=e.clientWidth;else{var y=parseInt(d.minWidth);isNaN(y)||(t.minWidth=y)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")t.maxWidth=e.clientWidth;else{var S=parseInt(d.maxWidth);isNaN(S)||(t.maxWidth=S)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))},c=function(d,p,m){e=d,u(p),e.nodeName=="TEXTAREA"&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),m&&(o(e,"change",s),o(e,"cut",l),o(e,"paste",l),o(e,"drop",l),o(e,"keydown",l),o(e,"focus",s),o(e,"compositionstart",l),o(e,"compositionupdate",l),o(e,"compositionend",l)),s()};function f(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(d,p,m){c(d,p,m)},unObserve:function(){a(e,"change",s),a(e,"cut",l),a(e,"paste",l),a(e,"drop",l),a(e,"keydown",l),a(e,"focus",s),a(e,"compositionstart",l),a(e,"compositionupdate",l),a(e,"compositionend",l)},resize:s}}function oM(t,e){for(var r=VH(e),n=e.value.split(`
`),i=r,o=0,a=0;a<n.length;a++){var s=n[a];a!==0&&(o+=n[a-1].length+1);var l=o+s.length;if(t==="home"?i=o:t==="end"&&(i=l),r<=l)break}tw(e,i)}function Hf(t){"@babel/helpers - typeof";return Hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hf(t)}function aM(t,e){return i_e(t)||n_e(t,e)||r_e(t,e)||t_e()}function t_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r_e(t,e){if(t){if(typeof t=="string")return sM(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sM(t,e)}}function sM(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function n_e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function i_e(t){if(Array.isArray(t))return t}function o_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lM(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s_e(n.key),n)}}function a_e(t,e,r){return e&&lM(t.prototype,e),r&&lM(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function s_e(t){var e=l_e(t,"string");return Hf(e)==="symbol"?e:String(e)}function l_e(t,e){if(Hf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Hf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function kp(){return typeof Reflect<"u"&&Reflect.get?kp=Reflect.get.bind():kp=function(e,r,n){var i=u_e(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},kp.apply(this,arguments)}function u_e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=wu(t),t!==null););return t}function c_e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&t5(t,e)}function t5(t,e){return t5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},t5(t,e)}function f_e(t){var e=d_e();return function(){var n=wu(t),i;if(e){var o=wu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return h_e(this,i)}}function h_e(t,e){if(e&&(Hf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zB(t)}function zB(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wu(t){return wu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wu(t)}var p_e="ht_editor_visible",By="ht_editor_hidden",uM="textEditor",m_e="text",Fu=function(t){c_e(r,t);var e=f_e(r);function r(n){var i;return o_e(this,r),i=e.call(this,n),i.eventManager=new hr(zB(i)),i.autoResize=e_e(),i.TEXTAREA=void 0,i.textareaStyle=void 0,i.TEXTAREA_PARENT=void 0,i.textareaParentStyle=void 0,i.layerClass=void 0,i.createElements(),i.bindEvents(),i.hot.addHookOnce("afterDestroy",function(){return i.destroy()}),i}return a_e(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(i){this.TEXTAREA.value=i}},{key:"open",value:function(){var i=this;this.refreshDimensions(),this.showEditableElement();var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(a){return i.onAfterDocumentKeyDown(a)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(i,o,a,s,l,u){var c=this.state;if(kp(wu(r.prototype),"prepare",this).call(this,i,o,a,s,l,u),!u.readOnly){this.refreshDimensions(!0);var f=u.allowInvalid,h=u.fragmentSelection;f&&(this.TEXTAREA.value=""),c!==Wr.FINISHED&&this.hideEditableElement();var d=!h;d&&!Ao()&&this.focus()}}},{key:"beginEditing",value:function(i,o){this.state===Wr.VIRGIN&&(this.TEXTAREA.value="",kp(wu(r.prototype),"beginEditing",this).call(this,i,o))}},{key:"focus",value:function(){this.TEXTAREA.select(),tw(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var i=this.hot.rootDocument;this.TEXTAREA=i.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,le(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=i.createElement("DIV"),le(this.TEXTAREA_PARENT,"handsontableInputHolder"),Xe(this.TEXTAREA_PARENT,this.layerClass)&&qe(this.TEXTAREA_PARENT,this.layerClass),le(this.TEXTAREA_PARENT,By),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(eue()||Jle())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",qe(this.TEXTAREA_PARENT,this.layerClass),le(this.TEXTAREA_PARENT,By)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var i=this.TEXTAREA_PARENT.childNodes,o=!1;De(i.length-1,function(a){var s=i[a];if(Xe(s,"handsontableEditor"))return o=!0,!1}),Xe(this.TEXTAREA_PARENT,By)&&qe(this.TEXTAREA_PARENT,By),o?(this.layerClass=p_e,le(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),le(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var i=this.hot.toPhysicalRow(this.row),o=this.hot.getSourceDataAtCell(i,this.col);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==Wr.EDITING&&!i)){if(this.TD=this.getEditedCell(),!this.TD){i||this.close();return}var o=this.getEditedCellRect(),a=o.top,s=o.start,l=o.width,u=o.maxWidth,c=o.height,f=o.maxHeight;this.textareaParentStyle.top="".concat(a,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(s,"px"),this.showEditableElement();var h=du(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var d=du(this.TEXTAREA),p=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),m=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),y=l-p,S=c-m,R=u-p,E=f-m;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(y,R),minHeight:Math.min(S,E),maxWidth:R,maxHeight:E},!0)}}},{key:"bindEvents",value:function(){var i=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(o){return o.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(o){return o.stopPropagation()}),VF()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return i.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){i.refreshDimensions(),i.focus()}),this.addHook("afterRowResize",function(){i.refreshDimensions(),i.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),a=o.getContext("editor"),s={runOnlyIf:function(){return Ae(i.hot.getSelected())},group:uM},l=function(){i.hot.rootDocument.execCommand("insertText",!1,`
`)};a.addShortcuts([{keys:[["Tab"]],callback:function(c){var f=i.hot.getSettings(),h=typeof f.tabMoves=="function"?f.tabMoves(c):f.tabMoves;i.hot.selection.transformStart(h.row,h.col,!0)}},{keys:[["Shift","Tab"]],callback:function(c){var f=i.hot.getSettings(),h=typeof f.tabMoves=="function"?f.tabMoves(c):f.tabMoves;i.hot.selection.transformStart(-h.row,-h.col)}},{keys:[["Control","Enter"]],callback:function(){return l(),!1},runOnlyIf:function(c){return!i.hot.selection.isMultiple()&&!c.altKey},relativeToGroup:Ip,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return l(),!1},runOnlyIf:function(){return!i.hot.selection.isMultiple()},relativeToGroup:Ip,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return l(),!1},relativeToGroup:Ip,position:"before"},{keys:[["PageUp"]],callback:function(){i.hot.selection.transformStart(-i.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){i.hot.selection.transformStart(i.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(c,f){var h=aM(f,1),d=h[0];oM(d,i.TEXTAREA)}},{keys:[["End"]],callback:function(c,f){var h=aM(f,1),d=h[0];oM(d,i.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}}],s)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),o=i.getContext("editor");o.removeShortcutsByGroup(nw),o.removeShortcutsByGroup(uM),o.removeShortcutsByGroup(e5)}},{key:"onAfterDocumentKeyDown",value:function(i){var o=[Le.ARROW_UP,Le.ARROW_RIGHT,Le.ARROW_DOWN,Le.ARROW_LEFT];o.indexOf(i.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(i.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return m_e}}]),r}(_d),v_e="base";function zg(t,e,r,n,i,o,a){var s=[],l=[];a.className&&le(e,a.className),a.readOnly&&s.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?s.push(a.invalidCellClassName):l.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&s.push(a.noWordWrapClassName),!o&&a.placeholder&&s.push(a.placeholderCellClassName),qe(e,l),le(e,s)}zg.RENDERER_TYPE=v_e;var g_e="text";function Qs(t,e,r,n,i,o,a){zg.apply(this,[t,e,r,n,i,o,a]);var s=o;if(!s&&a.placeholder&&(s=a.placeholder),s=Ar(s),a.trimWhitespace&&(s=s.trim()),a.rendererTemplate){$o(e);var l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(r),e.appendChild(l)}else hu(e,s)}Qs.RENDERER_TYPE=g_e;var y_e="text",YB={CELL_TYPE:y_e,editor:Fu,renderer:Qs};bo(YB);mt.editors={BaseEditor:_d};function mt(t,e){var r=new V7(t,e||{},hA);return r.init(),r}mt.Core=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new V7(t,e,hA)};mt.DefaultSettings=FB();mt.hooks=Ne.getSingleton();mt.CellCoords=Z0;mt.CellRange=tA;mt.packageName="handsontable";mt.buildDate="23/05/2023 09:21:52";mt.version="12.4.0";mt.languages={dictionaryKeys:TEe,getLanguageDictionary:OB,getLanguagesDictionaries:xEe,registerLanguageDictionary:CB,getTranslatedPhrase:TB};function cM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function b_e(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cM(Object(r),!0).forEach(function(n){w_e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):cM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function cv(t){"@babel/helpers - typeof";return cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cv(t)}function Uf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fM(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,XB(n.key),n)}}function Bf(t,e,r){return e&&fM(t.prototype,e),r&&fM(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function w_e(t,e,r){return e=XB(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fv(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r5(t,e)}function Pb(t){return Pb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pb(t)}function r5(t,e){return r5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},r5(t,e)}function S_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function KB(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function R_e(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KB(t)}function hv(t){var e=S_e();return function(){var n=Pb(t),i;if(e){var o=Pb(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return R_e(this,i)}}function E_e(t){return C_e(t)||O_e(t)||T_e(t)||__e()}function C_e(t){if(Array.isArray(t))return n5(t)}function O_e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function T_e(t,e){if(t){if(typeof t=="string")return n5(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n5(t,e)}}function n5(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function __e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function A_e(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function XB(t){var e=A_e(t,"string");return typeof e=="symbol"?e:String(e)}var A6=null,I_e="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",N_e="The Handsontable instance bound to this component was destroyed and cannot be used properly.",Mb="global",P_e="hot-wrapper-editor-container";function M_e(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function i5(t,e){var r=kr.Children.toArray(t),n=kr.Children.count(t),i=null;return n!==0&&(n===1&&r[0].props[e]?i=r[0]:i=r.find(function(o){return o.props[e]!==void 0})),i||null}function qB(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function QB(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=arguments.length>1?arguments[1]:void 0;if(e===null)return null;var r=JB(e.props,!1);return r.className="".concat(P_e," ").concat(r.className),AL.createPortal(kr.createElement("div",Object.assign({},r),e),t.body)}function ZB(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Mb,n=i5(t,"hot-editor"),i=qB(n);return n?kr.cloneElement(n,{emitEditorInstance:function(a,s){e.get(i)||e.set(i,new Map);var l=e.get(i);l.set(s??Mb,a)},editorColumnScope:r,isEditor:!0}):null}function k_e(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;r||(r=document),A6||(A6=r.createDocumentFragment());var n=r.createElement("DIV");A6.appendChild(n);var i=kr.cloneElement(t,b_e({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:AL.createPortal(i,n,"".concat(e.row,"-").concat(e.col,"-").concat(Math.random())),portalContainer:n}}function JB(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}var eV=function(){function t(){Uf(this,t)}return Bf(t,null,[{key:"getSettings",value:function(r){var n={};if(r.settings){var i=r.settings;for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])}for(var a in r)a!=="settings"&&a!=="children"&&r.hasOwnProperty(a)&&(n[a]=r[a]);return n}}]),t}(),x_e=function(t){fv(r,t);var e=hv(r);function r(){return Uf(this,r),e.apply(this,arguments)}return Bf(r,[{key:"getSettingsProps",value:function(){var i=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(o){return!i.internalProps.includes(o)}).reduce(function(o,a){return o[a]=i.props[a],o},{})}},{key:"getLocalEditorElement",value:function(){return ZB(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var i=this.props._getChildElementByType(this.props.children,"hot-renderer"),o=this.getLocalEditorElement();this.columnSettings=eV.getSettings(this.getSettingsProps()),i!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(i),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),o!==null&&(this.columnSettings.editor=this.props._getEditorClass(o,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var i=this.props._getOwnerDocument(),o=QB(i,this.getLocalEditorElement());return kr.createElement(kr.Fragment,null,o)}}]),r}(kr.Component),$_e=function(t){fv(r,t);var e=hv(r);function r(){var n;return Uf(this,r),n=e.apply(this,arguments),n.state={portals:[]},n}return Bf(r,[{key:"render",value:function(){return kr.createElement(kr.Fragment,null,this.state.portals)}}]),r}(kr.Component),L_e="12.4.0";function j7(t,e){return e={exports:{}},t(e,e.exports),e.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var en=typeof Symbol=="function"&&Symbol.for,W7=en?Symbol.for("react.element"):60103,G7=en?Symbol.for("react.portal"):60106,mw=en?Symbol.for("react.fragment"):60107,vw=en?Symbol.for("react.strict_mode"):60108,gw=en?Symbol.for("react.profiler"):60114,yw=en?Symbol.for("react.provider"):60109,bw=en?Symbol.for("react.context"):60110,z7=en?Symbol.for("react.async_mode"):60111,ww=en?Symbol.for("react.concurrent_mode"):60111,Sw=en?Symbol.for("react.forward_ref"):60112,Rw=en?Symbol.for("react.suspense"):60113,D_e=en?Symbol.for("react.suspense_list"):60120,Ew=en?Symbol.for("react.memo"):60115,Cw=en?Symbol.for("react.lazy"):60116,F_e=en?Symbol.for("react.block"):60121,H_e=en?Symbol.for("react.fundamental"):60117,U_e=en?Symbol.for("react.responder"):60118,B_e=en?Symbol.for("react.scope"):60119;function mi(t){if(cv(t)==="object"&&t!==null){var e=t.$$typeof;switch(e){case W7:switch(t=t.type,t){case z7:case ww:case mw:case gw:case vw:case Rw:return t;default:switch(t=t&&t.$$typeof,t){case bw:case Sw:case Cw:case Ew:case yw:return t;default:return e}}case G7:return e}}}function tV(t){return mi(t)===ww}var V_e=z7,j_e=ww,W_e=bw,G_e=yw,z_e=W7,Y_e=Sw,K_e=mw,X_e=Cw,q_e=Ew,Q_e=G7,Z_e=gw,J_e=vw,eAe=Rw,tAe=function(e){return tV(e)||mi(e)===z7},rAe=tV,nAe=function(e){return mi(e)===bw},iAe=function(e){return mi(e)===yw},oAe=function(e){return cv(e)==="object"&&e!==null&&e.$$typeof===W7},aAe=function(e){return mi(e)===Sw},sAe=function(e){return mi(e)===mw},lAe=function(e){return mi(e)===Cw},uAe=function(e){return mi(e)===Ew},cAe=function(e){return mi(e)===G7},fAe=function(e){return mi(e)===gw},hAe=function(e){return mi(e)===vw},dAe=function(e){return mi(e)===Rw},pAe=function(e){return typeof e=="string"||typeof e=="function"||e===mw||e===ww||e===gw||e===vw||e===Rw||e===D_e||cv(e)==="object"&&e!==null&&(e.$$typeof===Cw||e.$$typeof===Ew||e.$$typeof===yw||e.$$typeof===bw||e.$$typeof===Sw||e.$$typeof===H_e||e.$$typeof===U_e||e.$$typeof===B_e||e.$$typeof===F_e)},mAe=mi,vAe={AsyncMode:V_e,ConcurrentMode:j_e,ContextConsumer:W_e,ContextProvider:G_e,Element:z_e,ForwardRef:Y_e,Fragment:K_e,Lazy:X_e,Memo:q_e,Portal:Q_e,Profiler:Z_e,StrictMode:J_e,Suspense:eAe,isAsyncMode:tAe,isConcurrentMode:rAe,isContextConsumer:nAe,isContextProvider:iAe,isElement:oAe,isForwardRef:aAe,isFragment:sAe,isLazy:lAe,isMemo:uAe,isPortal:cAe,isProfiler:fAe,isStrictMode:hAe,isSuspense:dAe,isValidElementType:pAe,typeOf:mAe},Wt=j7(function(t,e){});Wt.AsyncMode;Wt.ConcurrentMode;Wt.ContextConsumer;Wt.ContextProvider;Wt.Element;Wt.ForwardRef;Wt.Fragment;Wt.Lazy;Wt.Memo;Wt.Portal;Wt.Profiler;Wt.StrictMode;Wt.Suspense;Wt.isAsyncMode;Wt.isConcurrentMode;Wt.isContextConsumer;Wt.isContextProvider;Wt.isElement;Wt.isForwardRef;Wt.isFragment;Wt.isLazy;Wt.isMemo;Wt.isPortal;Wt.isProfiler;Wt.isStrictMode;Wt.isSuspense;Wt.isValidElementType;Wt.typeOf;j7(function(t){t.exports=vAe});/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var hM=Object.getOwnPropertySymbols,gAe=Object.prototype.hasOwnProperty,yAe=Object.prototype.propertyIsEnumerable;function bAe(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function wAe(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;var n=Object.getOwnPropertyNames(e).map(function(o){return e[o]});if(n.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(o){i[o]=o}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}wAe();var SAe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",RAe=SAe;Function.call.bind(Object.prototype.hasOwnProperty);function rV(){}function nV(){}nV.resetWarningCache=rV;var EAe=function(){function e(i,o,a,s,l,u){if(u!==RAe){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function r(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:r,element:e,elementType:e,instanceOf:r,node:e,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:nV,resetWarningCache:rV};return n.PropTypes=n,n},CAe=j7(function(t){t.exports=EAe()}),I6=CAe,iV=function(t){fv(r,t);var e=hv(r);function r(){var n;return Uf(this,r),n=e.apply(this,arguments),n.id=null,n.__hotInstance=null,n.hotElementRef=null,n.columnSettings=[],n.renderersPortalManager=null,n.portalCacheArray=[],n.renderedCellCache=new Map,n.editorCache=new Map,n.componentRendererColumns=new Map,n}return Bf(r,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(N_e),null)},set:function(i){this.__hotInstance=i}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return this.hotElementRef?this.hotElementRef.ownerDocument:document}},{key:"setHotElementRef",value:function(i){this.hotElementRef=i}},{key:"getRendererWrapper",value:function(i){var o=this;return function(a,s,l,u,c,f,h){var d=o.getRenderedCellCache();if(d.has("".concat(l,"-").concat(u))&&(s.innerHTML=d.get("".concat(l,"-").concat(u)).innerHTML),s&&!s.getAttribute("ghost-table")){for(var p=k_e(i,{TD:s,row:l,col:u,prop:c,value:f,cellProperties:h,isRenderer:!0},s.ownerDocument),m=p.portal,y=p.portalContainer;s.firstChild;)s.removeChild(s.firstChild);s.appendChild(y),o.portalCacheArray.push(m)}return d.set("".concat(l,"-").concat(u),s),s}}},{key:"getEditorClass",value:function(i){var o,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mb,s=qB(i),l=(o=this.getEditorCache().get(s))===null||o===void 0?void 0:o.get(a);return this.makeEditorClass(l)}},{key:"makeEditorClass",value:function(i){var o=function(a){fv(l,a);var s=hv(l);function l(u){var c;return Uf(this,l),c=s.call(this,u),i.hotCustomEditorInstance=KB(c),c.editorComponent=i,c}return Bf(l,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),l}(mt.editors.BaseEditor);return Object.getOwnPropertyNames(mt.editors.BaseEditor.prototype).forEach(function(a){a!=="constructor"&&(o.prototype[a]=function(){for(var s,l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];return(s=i[a]).call.apply(s,[i].concat(u))})}),o}},{key:"getGlobalRendererElement",value:function(){return i5(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return ZB(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var i=eV.getSettings(this.props),o=this.getGlobalRendererElement(),a=this.getGlobalEditorElement();return i.columns=this.columnSettings.length?this.columnSettings:i.columns,a?i.editor=this.getEditorClass(a,Mb):i.editor=this.props.editor||(this.props.settings?this.props.settings.editor:void 0),o?(i.renderer=this.getRendererWrapper(o),this.componentRendererColumns.set("global",!0)):i.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),i}},{key:"displayAutoSizeWarning",value:function(i){var o,a;this.hotInstance&&((o=this.hotInstance.getPlugin("autoRowSize"))!==null&&o!==void 0&&o.enabled||(a=this.hotInstance.getPlugin("autoColumnSize"))!==null&&a!==void 0&&a.enabled)&&this.componentRendererColumns.size>0&&M_e(I_e)}},{key:"setHotColumnSettings",value:function(i,o){this.columnSettings[o]=i}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var i=this;this.renderersPortalManager.setState({portals:E_e(this.portalCacheArray)},function(){i.portalCacheArray=[]})}},{key:"updateHot",value:function(i){this.hotInstance&&this.hotInstance.updateSettings(i,!1)}},{key:"setRenderersPortalManagerRef",value:function(i){this.renderersPortalManager=i}},{key:"componentDidMount",value:function(){var i=this,o=this.createNewGlobalSettings();this.hotInstance=new mt.Core(this.hotElementRef,o),this.hotInstance.addHook("beforeViewRender",function(){return i.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return i.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(o)}},{key:"componentDidUpdate",value:function(){this.clearCache();var i=this.createNewGlobalSettings();this.updateHot(i),this.displayAutoSizeWarning(i)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var i=this,o=JB(this.props),a=function(f){return f.type===x_e},s=kr.Children.toArray(this.props.children),l=s.filter(function(c){return a(c)}).map(function(c,f){return kr.cloneElement(c,{_componentRendererColumns:i.componentRendererColumns,_emitColumnSettings:i.setHotColumnSettings.bind(i),_columnIndex:f,_getChildElementByType:i5.bind(i),_getRendererWrapper:i.getRendererWrapper.bind(i),_getEditorClass:i.getEditorClass.bind(i),_getOwnerDocument:i.getOwnerDocument.bind(i),_getEditorCache:i.getEditorCache.bind(i),children:c.props.children})}),u=QB(this.getOwnerDocument(),this.getGlobalEditorElement());return kr.createElement(kr.Fragment,null,kr.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},o),l),kr.createElement($_e,{ref:this.setRenderersPortalManagerRef.bind(this)}),u)}}],[{key:"version",get:function(){return L_e}}]),r}(kr.Component);iV.propTypes={style:I6.object,id:I6.string,className:I6.string};kr.Component;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var br;(function(t){t.RELATIVE="RELATIVE",t.ABSOLUTE="ABSOLUTE"})(br||(br={}));class Tn{constructor(e,r,n){this.type=e,this.col=r,this.sheet=n}static absolute(e,r){return new Tn(br.ABSOLUTE,e,r)}static relative(e,r){return new Tn(br.RELATIVE,e,r)}static compareByAbsoluteAddress(e){return(r,n)=>r.toSimpleColumnAddress(e).col-n.toSimpleColumnAddress(e).col}isColumnAbsolute(){return this.type===br.ABSOLUTE}isColumnRelative(){return this.type===br.RELATIVE}isAbsolute(){return this.type===br.ABSOLUTE&&this.sheet!==void 0}moved(e,r,n){const i=this.sheet===void 0?void 0:e;return new Tn(this.type,this.col+r,i)}shiftedByColumns(e){return new Tn(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){const r=Zi(this,e);let n=this.col;return this.isColumnRelative()&&(n=e.col+this.col),kj(r,n)}shiftRelativeDimensions(e,r){const n=this.isColumnRelative()?this.col+e:this.col;return new Tn(this.type,n,this.sheet)}shiftAbsoluteDimensions(e,r){const n=this.isColumnAbsolute()?this.col+e:this.col;return new Tn(this.type,n,this.sheet)}withSheet(e){return new Tn(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){const r=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case br.RELATIVE:return`${r}#COLR${this.col}`;case br.ABSOLUTE:return`${r}#COLA${this.col}`}}unparse(e){const r=this.toSimpleColumnAddress(e);if(tNe(r))return;const n=Tw(r.col);return`${this.type===br.ABSOLUTE?"$":""}${n}`}exceedsSheetSizeLimits(e){return this.col>=e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class dn{constructor(e,r,n){this.type=e,this.row=r,this.sheet=n}static absolute(e,r){return new dn(br.ABSOLUTE,e,r)}static relative(e,r){return new dn(br.RELATIVE,e,r)}static compareByAbsoluteAddress(e){return(r,n)=>r.toSimpleRowAddress(e).row-n.toSimpleRowAddress(e).row}isRowAbsolute(){return this.type===br.ABSOLUTE}isRowRelative(){return this.type===br.RELATIVE}isAbsolute(){return this.type===br.ABSOLUTE&&this.sheet!==void 0}moved(e,r,n){const i=this.sheet===void 0?void 0:e;return new dn(this.type,this.row+n,i)}shiftedByRows(e){return new dn(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){const r=Zi(this,e);let n=this.row;return this.isRowRelative()&&(n=e.row+this.row),Mj(r,n)}shiftRelativeDimensions(e,r){const n=this.isRowRelative()?this.row+r:this.row;return new dn(this.type,n,this.sheet)}shiftAbsoluteDimensions(e,r){const n=this.isRowAbsolute()?this.row+r:this.row;return new dn(this.type,n,this.sheet)}withSheet(e){return new dn(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){const r=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case br.RELATIVE:return`${r}#ROWR${this.row}`;case br.ABSOLUTE:return`${r}#ROWA${this.row}`}}unparse(e){const r=this.toSimpleRowAddress(e);return eNe(r)?void 0:`${this.type===br.ABSOLUTE?"$":""}${r.row+1}`}exceedsSheetSizeLimits(e){return this.row>=e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var $t;(function(t){t.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",t.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",t.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",t.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"})($t||($t={}));class Ht{constructor(e,r,n,i){this.col=e,this.row=r,this.type=n,this.sheet=i}static fromColAndRow(e,r,n){return(e.isColumnAbsolute()&&r.isRowAbsolute()?Ht.absolute.bind(this):e.isColumnAbsolute()?Ht.absoluteCol.bind(this):r.isRowAbsolute()?Ht.absoluteRow.bind(this):Ht.relative.bind(this))(e.col,r.row,n)}static relative(e,r,n){return new Ht(e,r,$t.CELL_REFERENCE_RELATIVE,n)}static absolute(e,r,n){return new Ht(e,r,$t.CELL_REFERENCE_ABSOLUTE,n)}static absoluteCol(e,r,n){return new Ht(e,r,$t.CELL_REFERENCE_ABSOLUTE_COL,n)}static absoluteRow(e,r,n){return new Ht(e,r,$t.CELL_REFERENCE_ABSOLUTE_ROW,n)}toSimpleCellAddress(e){const r=Zi(this,e);return this.type===$t.CELL_REFERENCE_ABSOLUTE?Se(r,this.col,this.row):this.type===$t.CELL_REFERENCE_ABSOLUTE_ROW?Se(r,e.col+this.col,this.row):this.type===$t.CELL_REFERENCE_ABSOLUTE_COL?Se(r,this.col,e.row+this.row):Se(r,e.col+this.col,e.row+this.row)}toColumnAddress(){const e=this.isColumnRelative()?br.RELATIVE:br.ABSOLUTE;return new Tn(e,this.col,this.sheet)}toRowAddress(){const e=this.isRowRelative()?br.RELATIVE:br.ABSOLUTE;return new dn(e,this.row,this.sheet)}toSimpleColumnAddress(e){const r=Zi(this,e);let n=this.col;return this.isColumnRelative()&&(n+=e.col),kj(r,n)}toSimpleRowAddress(e){const r=Zi(this,e);let n=this.row;return this.isRowRelative()&&(n+=e.row),Mj(r,n)}isRowAbsolute(){return this.type===$t.CELL_REFERENCE_ABSOLUTE||this.type===$t.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===$t.CELL_REFERENCE_ABSOLUTE||this.type===$t.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===$t.CELL_REFERENCE_RELATIVE||this.type===$t.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===$t.CELL_REFERENCE_RELATIVE||this.type===$t.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===$t.CELL_REFERENCE_ABSOLUTE&&this.sheet!==void 0}shiftedByRows(e){return new Ht(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new Ht(this.col+e,this.row,this.type,this.sheet)}moved(e,r,n){const i=this.sheet===void 0?void 0:e;return new Ht(this.col+r,this.row+n,this.type,i)}withSheet(e){return new Ht(this.col,this.row,this.type,e)}isInvalid(e){return Un(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,r){const n=this.isColumnAbsolute()?this.col:this.col+e,i=this.isRowAbsolute()?this.row:this.row+r;return new Ht(n,i,this.type,this.sheet)}shiftAbsoluteDimensions(e,r){const n=this.isColumnRelative()?this.col:this.col+e,i=this.isRowRelative()?this.row:this.row+r;return new Ht(n,i,this.type,this.sheet)}hash(e){const r=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case $t.CELL_REFERENCE_RELATIVE:return`${r}#${this.row}R${this.col}`;case $t.CELL_REFERENCE_ABSOLUTE:return`${r}#${this.row}A${this.col}`;case $t.CELL_REFERENCE_ABSOLUTE_COL:return`${r}#${this.row}AC${this.col}`;case $t.CELL_REFERENCE_ABSOLUTE_ROW:return`${r}#${this.row}AR${this.col}`}}unparse(e){const r=this.toSimpleCellAddress(e);if(Un(r))return;const n=Tw(r.col),i=this.type===$t.CELL_REFERENCE_ABSOLUTE||this.type===$t.CELL_REFERENCE_ABSOLUTE_ROW?"$":"";return`${this.type===$t.CELL_REFERENCE_ABSOLUTE||this.type===$t.CELL_REFERENCE_ABSOLUTE_COL?"$":""}${n}${i}${r.row+1}`}exceedsSheetSizeLimits(e,r){return this.row>=r||this.col>=e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Yg=":",_n="$",OAe="\\s+",TAe="[ \\t\\n\\r]+",Ow="A-Za-zÀ-ʯ",Y7=`${Ow}0-9_.`,oV=`[${Ow}0-9_]+`,_Ae="'(((?!').|'')*)'",Ad=`(${oV}|${_Ae})!`,aV=`(${Ad})?\\${_n}?[A-Za-z]+\\${_n}?[0-9]+`,dM=`(${Ad})?\\${_n}?[A-Za-z]+`,pM=`(${Ad})?\\${_n}?[0-9]+`,sV="[rR][0-9]*[cC][0-9]*",AAe=`(${aV})[^${Y7}]`,lV=`[${Ow}_][${Y7}]*`,IAe=["0","1","2","3","4","5","6","7","8","9"],uV=[...Array.from(Array(26)).map((t,e)=>e+65),...Array.from(Array(26)).map((t,e)=>e+97),...Array.from(Array(496)).map((t,e)=>e+192)].map(t=>String.fromCharCode(t));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const cV=new RegExp(`^(${Ad})?(\\${_n}?)([A-Za-z]+)(\\${_n}?)([0-9]+)$`),NAe=new RegExp(`^(${Ad})?(\\${_n}?)([A-Za-z]+)$`),PAe=new RegExp(`^(${Ad})?(\\${_n}?)([0-9]+)$`),MAe=new RegExp(`^${oV}$`),Ac=(t,e,r)=>{const n=cV.exec(e),i=K7(n[6]);let o=_w(n,t);if(o===void 0)return;o===null&&(o=void 0);const a=Number(n[8])-1;return n[5]===_n&&n[7]===_n?Ht.absolute(i,a,o):n[5]===_n?Ht.absoluteCol(i,a-r.row,o):n[7]===_n?Ht.absoluteRow(i-r.col,a,o):Ht.relative(i-r.col,a-r.row,o)},kb=(t,e,r)=>{const n=NAe.exec(e);let i=_w(n,t);if(i===void 0)return;i===null&&(i=void 0);const o=K7(n[6]);return n[5]===_n?Tn.absolute(o,i):Tn.relative(o-r.col,i)},xb=(t,e,r)=>{const n=PAe.exec(e);let i=_w(n,t);if(i===void 0)return;i===null&&(i=void 0);const o=Number(n[6])-1;return n[5]===_n?dn.absolute(o,i):dn.relative(o-r.row,i)},o5=(t,e,r)=>{const n=cV.exec(e),i=K7(n[6]);let o=_w(n,t);if(o===void 0)return;o===null&&(o=r);const a=Number(n[8])-1;return Se(o,i,a)},kAe=(t,e,r)=>{const n=e.split(Yg);if(n.length!==2)return;const[i,o]=n,a=o5(t,i,r);if(a===void 0)return;const s=o5(t,o,a.sheet);if(s!==void 0&&a.sheet===s.sheet)return S5(a,s)},$b=(t,e,r)=>{const n=Tw(e.col),i=fV(e.sheet,t);if(i!==void 0)return r!==e.sheet?`${i}!${n}${e.row+1}`:`${n}${e.row+1}`},xAe=(t,e,r)=>{const n=$b(t,e.start,r),i=$b(t,e.end,e.start.sheet);if(!(n===void 0||i===void 0))return`${n}${Yg}${i}`};function K7(t){return t.length===1?t.toUpperCase().charCodeAt(0)-65:t.split("").reduce((e,r)=>e*26+(r.toUpperCase().charCodeAt(0)-64),0)-1}function Tw(t){let e="";for(;t>=0;)e=String.fromCharCode(t%26+97)+e,t=Math.floor(t/26)-1;return e.toUpperCase()}function fV(t,e){let r=e(t);if(r!==void 0)return MAe.test(r)?r:(r=r.replace(/'/g,"''"),`'${r}'`)}function _w(t,e){var r;let n=(r=t[3])!==null&&r!==void 0?r:t[2];return n?(n=n.replace(/''/g,"'"),e(n)):null}function Bt(t){return t&&t.length===0}function Qa(t){return t==null?[]:Object.keys(t)}function mn(t){for(var e=[],r=Object.keys(t),n=0;n<r.length;n++)e.push(t[r[n]]);return e}function $Ae(t,e){for(var r=[],n=Qa(t),i=0;i<n.length;i++){var o=n[i];r.push(e.call(null,t[o],o))}return r}function _e(t,e){for(var r=[],n=0;n<t.length;n++)r.push(e.call(null,t[n],n));return r}function Wn(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];Array.isArray(n)?e=e.concat(Wn(n)):e.push(n)}return e}function Ai(t){return Bt(t)?void 0:t[0]}function hV(t){var e=t&&t.length;return e?t[e-1]:void 0}function Be(t,e){if(Array.isArray(t))for(var r=0;r<t.length;r++)e.call(null,t[r],r);else if(q7(t))for(var n=Qa(t),r=0;r<n.length;r++){var i=n[r],o=t[i];e.call(null,o,i)}else throw Error("non exhaustive match")}function Do(t){return typeof t=="string"}function Ii(t){return t===void 0}function Zs(t){return t instanceof Function}function nn(t,e){return e===void 0&&(e=1),t.slice(e,t.length)}function dv(t,e){return e===void 0&&(e=1),t.slice(0,t.length-e)}function io(t,e){var r=[];if(Array.isArray(t))for(var n=0;n<t.length;n++){var i=t[n];e.call(null,i)&&r.push(i)}return r}function Su(t,e){return io(t,function(r){return!e(r)})}function Li(t,e){for(var r=Object.keys(t),n={},i=0;i<r.length;i++){var o=r[i],a=t[o];e(a)&&(n[o]=a)}return n}function Ue(t,e){return q7(t)?t.hasOwnProperty(e):!1}function Vr(t,e){return Vf(t,function(r){return r===e})!==void 0}function Gn(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r]);return e}function Kg(t){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}function Vf(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(e.call(null,n))return n}}function LAe(t,e){for(var r=[],n=0;n<t.length;n++){var i=t[n];e.call(null,i)&&r.push(i)}return r}function sn(t,e,r){for(var n=Array.isArray(t),i=n?t:mn(t),o=n?[]:Qa(t),a=r,s=0;s<i.length;s++)a=e.call(null,a,i[s],n?s:o[s]);return a}function Xg(t){return Su(t,function(e){return e==null})}function X7(t,e){e===void 0&&(e=function(n){return n});var r=[];return sn(t,function(n,i){var o=e(i);return Vr(r,o)?n:(r.push(o),n.concat(i))},[])}function qi(t){return Array.isArray(t)}function Wa(t){return t instanceof RegExp}function q7(t){return t instanceof Object}function Ti(t,e){for(var r=0;r<t.length;r++)if(!e(t[r],r))return!1;return!0}function Aw(t,e){return Su(t,function(r){return Vr(e,r)})}function dV(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return!0;return!1}function DAe(t,e){for(var r=0;r<t.length;r++)if(t[r]===e)return r;return-1}function oo(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=0;n<e.length;n++)for(var i=e[n],o=Qa(i),a=0;a<o.length;a++){var s=o[a];t[s]=i[s]}return t}function FAe(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=0;n<e.length;n++){var i=e[n];if(!Ii(i))for(var o=Qa(i),a=0;a<o.length;a++){var s=o[a];Ue(t,s)||(t[s]=i[s])}}return t}function Iw(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return FAe.apply(null,[{}].concat(t))}function pV(t,e){var r={};return Be(t,function(n){var i=e(n),o=r[i];o?o.push(n):r[i]=[n]}),r}function mM(t,e){for(var r=Kg(t),n=Qa(e),i=0;i<n.length;i++){var o=n[i],a=e[o];r[o]=a}return r}function jr(){}function vM(t){return t}function HAe(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];e.push(n!==void 0?n:void 0)}return e}function a5(t){console&&console.error&&console.error("Error: "+t)}function Q7(t){console&&console.warn&&console.warn("Warning: "+t)}function gM(){return typeof Map=="function"}function UAe(t,e){e.forEach(function(r){var n=r.prototype;Object.getOwnPropertyNames(n).forEach(function(i){if(i!=="constructor"){var o=Object.getOwnPropertyDescriptor(n,i);o&&(o.get||o.set)?Object.defineProperty(t.prototype,i,o):t.prototype[i]=r.prototype[i]}})})}function mV(t){function e(){}e.prototype=t;var r=new e;function n(){return typeof r.bar}return n(),n(),t}function Lb(t){return t[t.length-1]}function vV(t){var e=new Date().getTime(),r=t(),n=new Date().getTime(),i=n-e;return{time:i,value:r}}var gV={exports:{}};(function(t){(function(e,r){t.exports?t.exports=r():e.regexpToAst=r()})(typeof self<"u"?self:M0,function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(m){this.idx=m.idx,this.input=m.input,this.groupIdx=m.groupIdx},e.prototype.pattern=function(m){this.idx=0,this.input=m,this.groupIdx=0,this.consumeChar("/");var y=this.disjunction();this.consumeChar("/");for(var S={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":s(S,"global");break;case"i":s(S,"ignoreCase");break;case"m":s(S,"multiLine");break;case"u":s(S,"unicode");break;case"y":s(S,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:S,value:y}},e.prototype.disjunction=function(){var m=[];for(m.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),m.push(this.alternative());return{type:"Disjunction",value:m}},e.prototype.alternative=function(){for(var m=[];this.isTerm();)m.push(this.term());return{type:"Alternative",value:m}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var m;switch(this.popChar()){case"=":m="Lookahead";break;case"!":m="NegativeLookahead";break}l(m);var y=this.disjunction();return this.consumeChar(")"),{type:m,value:y}}u()},e.prototype.quantifier=function(m){var y;switch(this.popChar()){case"*":y={atLeast:0,atMost:1/0};break;case"+":y={atLeast:1,atMost:1/0};break;case"?":y={atLeast:0,atMost:1};break;case"{":var S=this.integerIncludingZero();switch(this.popChar()){case"}":y={atLeast:S,atMost:S};break;case",":var R;this.isDigit()?(R=this.integerIncludingZero(),y={atLeast:S,atMost:R}):y={atLeast:S,atMost:1/0},this.consumeChar("}");break}if(m===!0&&y===void 0)return;l(y);break}if(!(m===!0&&y===void 0))return l(y),this.peekChar(0)==="?"?(this.consumeChar("?"),y.greedy=!1):y.greedy=!0,y.type="Quantifier",y},e.prototype.atom=function(){var m;switch(this.peekChar()){case".":m=this.dotAll();break;case"\\":m=this.atomEscape();break;case"[":m=this.characterClass();break;case"(":m=this.group();break}return m===void 0&&this.isPatternCharacter()&&(m=this.patternCharacter()),l(m),this.isQuantifier()&&(m.quantifier=this.quantifier()),m},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[o(`
`),o("\r"),o("\u2028"),o("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){var m=this.positiveInteger();return{type:"GroupBackReference",value:m}},e.prototype.characterClassEscape=function(){var m,y=!1;switch(this.popChar()){case"d":m=f;break;case"D":m=f,y=!0;break;case"s":m=d;break;case"S":m=d,y=!0;break;case"w":m=h;break;case"W":m=h,y=!0;break}return l(m),{type:"Set",value:m,complement:y}},e.prototype.controlEscapeAtom=function(){var m;switch(this.popChar()){case"f":m=o("\f");break;case"n":m=o(`
`);break;case"r":m=o("\r");break;case"t":m=o("	");break;case"v":m=o("\v");break}return l(m),{type:"Character",value:m}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var m=this.popChar();if(/[a-zA-Z]/.test(m)===!1)throw Error("Invalid ");var y=m.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:y}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:o("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){var m=this.popChar();return{type:"Character",value:o(m)}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var m=this.popChar();return{type:"Character",value:o(m)}}},e.prototype.characterClass=function(){var m=[],y=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),y=!0);this.isClassAtom();){var S=this.classAtom(),R=S.type==="Character";if(R&&this.isRangeDash()){this.consumeChar("-");var E=this.classAtom(),O=E.type==="Character";if(O){if(E.value<S.value)throw Error("Range out of order in character class");m.push({from:S.value,to:E.value})}else a(S.value,m),m.push(o("-")),a(E.value,m)}else a(S.value,m)}return this.consumeChar("]"),{type:"Set",complement:y,value:m}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:o("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var m=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),m=!1;break;default:this.groupIdx++;break}var y=this.disjunction();this.consumeChar(")");var S={type:"Group",capturing:m,value:y};return m&&(S.idx=this.groupIdx),S},e.prototype.positiveInteger=function(){var m=this.popChar();if(i.test(m)===!1)throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)m+=this.popChar();return parseInt(m,10)},e.prototype.integerIncludingZero=function(){var m=this.popChar();if(n.test(m)===!1)throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)m+=this.popChar();return parseInt(m,10)},e.prototype.patternCharacter=function(){var m=this.popChar();switch(m){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:o(m)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},e.prototype.isDigit=function(){return n.test(this.peekChar(0))},e.prototype.isClassAtom=function(m){switch(m===void 0&&(m=0),this.peekChar(m)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},e.prototype.isQuantifier=function(){var m=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(m)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(m){for(var y="",S=0;S<m;S++){var R=this.popChar();if(r.test(R)===!1)throw Error("Expecting a HexDecimal digits");y+=R}var E=parseInt(y,16);return{type:"Character",value:E}},e.prototype.peekChar=function(m){return m===void 0&&(m=0),this.input[this.idx+m]},e.prototype.popChar=function(){var m=this.peekChar(0);return this.consumeChar(),m},e.prototype.consumeChar=function(m){if(m!==void 0&&this.input[this.idx]!==m)throw Error("Expected: '"+m+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var r=/[0-9a-fA-F]/,n=/[0-9]/,i=/[1-9]/;function o(m){return m.charCodeAt(0)}function a(m,y){m.length!==void 0?m.forEach(function(S){y.push(S)}):y.push(m)}function s(m,y){if(m[y]===!0)throw"duplicate flag "+y;m[y]=!0}function l(m){if(m===void 0)throw Error("Internal Error - Should never get here!")}function u(){throw Error("Internal Error - Should never get here!")}var c,f=[];for(c=o("0");c<=o("9");c++)f.push(c);var h=[o("_")].concat(f);for(c=o("a");c<=o("z");c++)h.push(c);for(c=o("A");c<=o("Z");c++)h.push(c);var d=[o(" "),o("\f"),o(`
`),o("\r"),o("	"),o("\v"),o("	"),o(" "),o(" "),o(" "),o(" "),o(" "),o(" "),o(" "),o(" "),o(" "),o(" "),o(" "),o(" "),o(" "),o("\u2028"),o("\u2029"),o(" "),o(" "),o("　"),o("\uFEFF")];function p(){}return p.prototype.visitChildren=function(m){for(var y in m){var S=m[y];m.hasOwnProperty(y)&&(S.type!==void 0?this.visit(S):Array.isArray(S)&&S.forEach(function(R){this.visit(R)},this))}},p.prototype.visit=function(m){switch(m.type){case"Pattern":this.visitPattern(m);break;case"Flags":this.visitFlags(m);break;case"Disjunction":this.visitDisjunction(m);break;case"Alternative":this.visitAlternative(m);break;case"StartAnchor":this.visitStartAnchor(m);break;case"EndAnchor":this.visitEndAnchor(m);break;case"WordBoundary":this.visitWordBoundary(m);break;case"NonWordBoundary":this.visitNonWordBoundary(m);break;case"Lookahead":this.visitLookahead(m);break;case"NegativeLookahead":this.visitNegativeLookahead(m);break;case"Character":this.visitCharacter(m);break;case"Set":this.visitSet(m);break;case"Group":this.visitGroup(m);break;case"GroupBackReference":this.visitGroupBackReference(m);break;case"Quantifier":this.visitQuantifier(m);break}this.visitChildren(m)},p.prototype.visitPattern=function(m){},p.prototype.visitFlags=function(m){},p.prototype.visitDisjunction=function(m){},p.prototype.visitAlternative=function(m){},p.prototype.visitStartAnchor=function(m){},p.prototype.visitEndAnchor=function(m){},p.prototype.visitWordBoundary=function(m){},p.prototype.visitNonWordBoundary=function(m){},p.prototype.visitLookahead=function(m){},p.prototype.visitNegativeLookahead=function(m){},p.prototype.visitCharacter=function(m){},p.prototype.visitSet=function(m){},p.prototype.visitGroup=function(m){},p.prototype.visitGroupBackReference=function(m){},p.prototype.visitQuantifier=function(m){},{RegExpParser:e,BaseRegExpVisitor:p,VERSION:"0.4.0"}})})(gV);var qg=gV.exports,t0={},BAe=new qg.RegExpParser;function Nw(t){var e=t.toString();if(t0.hasOwnProperty(e))return t0[e];var r=BAe.pattern(e);return t0[e]=r,r}function VAe(){t0={}}var jAe=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),yV="Complement Sets are not supported for first char optimization",Db=`Unable to use "first char" lexer optimizations:
`;function WAe(t,e){e===void 0&&(e=!1);try{var r=Nw(t),n=s5(r.value,{},r.flags.ignoreCase);return n}catch(o){if(o.message===yV)e&&Q7(""+Db+("	Unable to optimize: < "+t.toString()+` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var i="";e&&(i=`
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),a5(Db+`
`+("	Failed parsing: < "+t.toString()+` >
`)+("	Using the regexp-to-ast library version: "+qg.VERSION+`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+i)}}return[]}function s5(t,e,r){switch(t.type){case"Disjunction":for(var n=0;n<t.value.length;n++)s5(t.value[n],e,r);break;case"Alternative":for(var i=t.value,n=0;n<i.length;n++){var o=i[n];switch(o.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var a=o;switch(a.type){case"Character":Vy(a.value,e,r);break;case"Set":if(a.complement===!0)throw Error(yV);Be(a.value,function(u){if(typeof u=="number")Vy(u,e,r);else{var c=u;if(r===!0)for(var f=c.from;f<=c.to;f++)Vy(f,e,r);else{for(var f=c.from;f<=c.to&&f<vp;f++)Vy(f,e,r);if(c.to>=vp)for(var h=c.from>=vp?c.from:vp,d=c.to,p=Ws(h),m=Ws(d),y=p;y<=m;y++)e[y]=y}}});break;case"Group":s5(a.value,e,r);break;default:throw Error("Non Exhaustive Match")}var s=a.quantifier!==void 0&&a.quantifier.atLeast===0;if(a.type==="Group"&&l5(a)===!1||a.type!=="Group"&&s===!1)break}break;default:throw Error("non exhaustive match!")}return mn(e)}function Vy(t,e,r){var n=Ws(t);e[n]=n,r===!0&&GAe(t,e)}function GAe(t,e){var r=String.fromCharCode(t),n=r.toUpperCase();if(n!==r){var i=Ws(n.charCodeAt(0));e[i]=i}else{var o=r.toLowerCase();if(o!==r){var i=Ws(o.charCodeAt(0));e[i]=i}}}function yM(t,e){return Vf(t.value,function(r){if(typeof r=="number")return Vr(e,r);var n=r;return Vf(e,function(i){return n.from<=i&&i<=n.to})!==void 0})}function l5(t){return t.quantifier&&t.quantifier.atLeast===0?!0:t.value?qi(t.value)?Ti(t.value,l5):l5(t.value):!1}var zAe=function(t){jAe(e,t);function e(r){var n=t.call(this)||this;return n.targetCharCodes=r,n.found=!1,n}return e.prototype.visitChildren=function(r){if(this.found!==!0){switch(r.type){case"Lookahead":this.visitLookahead(r);return;case"NegativeLookahead":this.visitNegativeLookahead(r);return}t.prototype.visitChildren.call(this,r)}},e.prototype.visitCharacter=function(r){Vr(this.targetCharCodes,r.value)&&(this.found=!0)},e.prototype.visitSet=function(r){r.complement?yM(r,this.targetCharCodes)===void 0&&(this.found=!0):yM(r,this.targetCharCodes)!==void 0&&(this.found=!0)},e}(qg.BaseRegExpVisitor);function Z7(t,e){if(e instanceof RegExp){var r=Nw(e),n=new zAe(t);return n.visit(r),n.found}else return Vf(e,function(i){return Vr(t,i.charCodeAt(0))})!==void 0}var bV=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Fo="PATTERN",Nl="defaultMode",jy="modes",wV=typeof new RegExp("(?:)").sticky=="boolean";function YAe(t,e){e=Iw(e,{useSticky:wV,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(R,E){return E()}});var r=e.tracer;r("initCharCodeToOptimizedIndexMap",function(){v7e()});var n;r("Reject Lexer.NA",function(){n=Su(t,function(R){return R[Fo]===jn.NA})});var i=!1,o;r("Transform Patterns",function(){i=!1,o=_e(n,function(R){var E=R[Fo];if(Wa(E)){var O=E.source;return O.length===1&&O!=="^"&&O!=="$"&&O!=="."?O:O.length===2&&O[0]==="\\"&&!Vr(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],O[1])?O[1]:e.useSticky?wM(E):bM(E)}else{if(Zs(E))return i=!0,{exec:E};if(Ue(E,"exec"))return i=!0,E;if(typeof E=="string"){if(E.length===1)return E;var A=E.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),B=new RegExp(A);return e.useSticky?wM(B):bM(B)}else throw Error("non exhaustive match")}})});var a,s,l,u,c;r("misc mapping",function(){a=_e(n,function(R){return R.tokenTypeIdx}),s=_e(n,function(R){var E=R.GROUP;if(E!==jn.SKIPPED){if(Do(E))return E;if(Ii(E))return!1;throw Error("non exhaustive match")}}),l=_e(n,function(R){var E=R.LONGER_ALT;if(E){var O=DAe(n,E);return O}}),u=_e(n,function(R){return R.PUSH_MODE}),c=_e(n,function(R){return Ue(R,"POP_MODE")})});var f;r("Line Terminator Handling",function(){var R=EV(e.lineTerminatorCharacters);f=_e(n,function(E){return!1}),e.positionTracking!=="onlyOffset"&&(f=_e(n,function(E){if(Ue(E,"LINE_BREAKS"))return E.LINE_BREAKS;if(RV(E,R)===!1)return Z7(R,E.PATTERN)}))});var h,d,p,m;r("Misc Mapping #2",function(){h=_e(n,SV),d=_e(o,d7e),p=sn(n,function(R,E){var O=E.GROUP;return Do(O)&&O!==jn.SKIPPED&&(R[O]=[]),R},{}),m=_e(o,function(R,E){return{pattern:o[E],longerAlt:l[E],canLineTerminator:f[E],isCustom:h[E],short:d[E],group:s[E],push:u[E],pop:c[E],tokenTypeIdx:a[E],tokenType:n[E]}})});var y=!0,S=[];return e.safeMode||r("First Char Optimization",function(){S=sn(n,function(R,E,O){if(typeof E.PATTERN=="string"){var A=E.PATTERN.charCodeAt(0),B=Ws(A);N6(R,B,m[O])}else if(qi(E.START_CHARS_HINT)){var j;Be(E.START_CHARS_HINT,function(Y){var q=typeof Y=="string"?Y.charCodeAt(0):Y,ee=Ws(q);j!==ee&&(j=ee,N6(R,ee,m[O]))})}else if(Wa(E.PATTERN))if(E.PATTERN.unicode)y=!1,e.ensureOptimizations&&a5(""+Db+("	Unable to analyze < "+E.PATTERN.toString()+` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var J=WAe(E.PATTERN,e.ensureOptimizations);Bt(J)&&(y=!1),Be(J,function(Y){N6(R,Y,m[O])})}else e.ensureOptimizations&&a5(""+Db+("	TokenType: <"+E.name+`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),y=!1;return R},[])}),r("ArrayPacking",function(){S=HAe(S)}),{emptyGroups:p,patternIdxToConfig:m,charCodeToPatternIdxToConfig:S,hasCustom:i,canBeOptimized:y}}function KAe(t,e){var r=[],n=qAe(t);r=r.concat(n.errors);var i=QAe(n.valid),o=i.valid;return r=r.concat(i.errors),r=r.concat(XAe(o)),r=r.concat(o7e(o)),r=r.concat(a7e(o,e)),r=r.concat(s7e(o)),r}function XAe(t){var e=[],r=io(t,function(n){return Wa(n[Fo])});return e=e.concat(JAe(r)),e=e.concat(r7e(r)),e=e.concat(n7e(r)),e=e.concat(i7e(r)),e=e.concat(e7e(r)),e}function qAe(t){var e=io(t,function(i){return!Ue(i,Fo)}),r=_e(e,function(i){return{message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:Ir.MISSING_PATTERN,tokenTypes:[i]}}),n=Aw(t,e);return{errors:r,valid:n}}function QAe(t){var e=io(t,function(i){var o=i[Fo];return!Wa(o)&&!Zs(o)&&!Ue(o,"exec")&&!Do(o)}),r=_e(e,function(i){return{message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:Ir.INVALID_PATTERN,tokenTypes:[i]}}),n=Aw(t,e);return{errors:r,valid:n}}var ZAe=/[^\\][\$]/;function JAe(t){var e=function(i){bV(o,i);function o(){var a=i!==null&&i.apply(this,arguments)||this;return a.found=!1,a}return o.prototype.visitEndAnchor=function(a){this.found=!0},o}(qg.BaseRegExpVisitor),r=io(t,function(i){var o=i[Fo];try{var a=Nw(o),s=new e;return s.visit(a),s.found}catch{return ZAe.test(o.source)}}),n=_e(r,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Ir.EOI_ANCHOR_FOUND,tokenTypes:[i]}});return n}function e7e(t){var e=io(t,function(n){var i=n[Fo];return i.test("")}),r=_e(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' must not match an empty string",type:Ir.EMPTY_MATCH_PATTERN,tokenTypes:[n]}});return r}var t7e=/[^\\[][\^]|^\^/;function r7e(t){var e=function(i){bV(o,i);function o(){var a=i!==null&&i.apply(this,arguments)||this;return a.found=!1,a}return o.prototype.visitStartAnchor=function(a){this.found=!0},o}(qg.BaseRegExpVisitor),r=io(t,function(i){var o=i[Fo];try{var a=Nw(o),s=new e;return s.visit(a),s.found}catch{return t7e.test(o.source)}}),n=_e(r,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Ir.SOI_ANCHOR_FOUND,tokenTypes:[i]}});return n}function n7e(t){var e=io(t,function(n){var i=n[Fo];return i instanceof RegExp&&(i.multiline||i.global)}),r=_e(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:Ir.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[n]}});return r}function i7e(t){var e=[],r=_e(t,function(o){return sn(t,function(a,s){return o.PATTERN.source===s.PATTERN.source&&!Vr(e,s)&&s.PATTERN!==jn.NA&&(e.push(s),a.push(s)),a},[])});r=Xg(r);var n=io(r,function(o){return o.length>1}),i=_e(n,function(o){var a=_e(o,function(l){return l.name}),s=Ai(o).PATTERN;return{message:"The same RegExp pattern ->"+s+"<-"+("has been used in all of the following Token Types: "+a.join(", ")+" <-"),type:Ir.DUPLICATE_PATTERNS_FOUND,tokenTypes:o}});return i}function o7e(t){var e=io(t,function(n){if(!Ue(n,"GROUP"))return!1;var i=n.GROUP;return i!==jn.SKIPPED&&i!==jn.NA&&!Do(i)}),r=_e(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:Ir.INVALID_GROUP_TYPE_FOUND,tokenTypes:[n]}});return r}function a7e(t,e){var r=io(t,function(i){return i.PUSH_MODE!==void 0&&!Vr(e,i.PUSH_MODE)}),n=_e(r,function(i){var o="Token Type: ->"+i.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+i.PUSH_MODE+"<-which does not exist";return{message:o,type:Ir.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}});return n}function s7e(t){var e=[],r=sn(t,function(n,i,o){var a=i.PATTERN;return a===jn.NA||(Do(a)?n.push({str:a,idx:o,tokenType:i}):Wa(a)&&u7e(a)&&n.push({str:a.source,idx:o,tokenType:i})),n},[]);return Be(t,function(n,i){Be(r,function(o){var a=o.str,s=o.idx,l=o.tokenType;if(i<s&&l7e(a,n.PATTERN)){var u="Token: ->"+l.name+`<- can never be matched.
`+("Because it appears AFTER the Token Type ->"+n.name+"<-")+`in the lexer's definition.
See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:u,type:Ir.UNREACHABLE_PATTERN,tokenTypes:[n,l]})}})}),e}function l7e(t,e){if(Wa(e)){var r=e.exec(t);return r!==null&&r.index===0}else{if(Zs(e))return e(t,0,[],{});if(Ue(e,"exec"))return e.exec(t,0,[],{});if(typeof e=="string")return e===t;throw Error("non exhaustive match")}}function u7e(t){var e=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return Vf(e,function(r){return t.source.indexOf(r)!==-1})===void 0}function bM(t){var e=t.ignoreCase?"i":"";return new RegExp("^(?:"+t.source+")",e)}function wM(t){var e=t.ignoreCase?"iy":"y";return new RegExp(""+t.source,e)}function c7e(t,e,r){var n=[];return Ue(t,Nl)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+Nl+`> property in its definition
`,type:Ir.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Ue(t,jy)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+jy+`> property in its definition
`,type:Ir.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Ue(t,jy)&&Ue(t,Nl)&&!Ue(t.modes,t.defaultMode)&&n.push({message:"A MultiMode Lexer cannot be initialized with a "+Nl+": <"+t.defaultMode+`>which does not exist
`,type:Ir.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Ue(t,jy)&&Be(t.modes,function(i,o){Be(i,function(a,s){Ii(a)&&n.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+("<"+o+"> at index: <"+s+`>
`),type:Ir.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),n}function f7e(t,e,r){var n=[],i=!1,o=Xg(Wn($Ae(t.modes,function(l){return l}))),a=Su(o,function(l){return l[Fo]===jn.NA}),s=EV(r);return e&&Be(a,function(l){var u=RV(l,s);if(u!==!1){var c=m7e(l,u),f={message:c,type:u.issue,tokenType:l};n.push(f)}else Ue(l,"LINE_BREAKS")?l.LINE_BREAKS===!0&&(i=!0):Z7(s,l.PATTERN)&&(i=!0)}),e&&!i&&n.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:Ir.NO_LINE_BREAKS_FLAGS}),n}function h7e(t){var e={},r=Qa(t);return Be(r,function(n){var i=t[n];if(qi(i))e[n]=[];else throw Error("non exhaustive match")}),e}function SV(t){var e=t.PATTERN;if(Wa(e))return!1;if(Zs(e))return!0;if(Ue(e,"exec"))return!0;if(Do(e))return!1;throw Error("non exhaustive match")}function d7e(t){return Do(t)&&t.length===1?t.charCodeAt(0):!1}var p7e={test:function(t){for(var e=t.length,r=this.lastIndex;r<e;r++){var n=t.charCodeAt(r);if(n===10)return this.lastIndex=r+1,!0;if(n===13)return t.charCodeAt(r+1)===10?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0};function RV(t,e){if(Ue(t,"LINE_BREAKS"))return!1;if(Wa(t.PATTERN)){try{Z7(e,t.PATTERN)}catch(r){return{issue:Ir.IDENTIFY_TERMINATOR,errMsg:r.message}}return!1}else{if(Do(t.PATTERN))return!1;if(SV(t))return{issue:Ir.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function m7e(t,e){if(e.issue===Ir.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+("	The problem is in the <"+t.name+`> Token Type
`)+("	 Root cause: "+e.errMsg+`.
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(e.issue===Ir.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+("	The problem is in the <"+t.name+`> Token Type
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function EV(t){var e=_e(t,function(r){return Do(r)&&r.length>0?r.charCodeAt(0):r});return e}function N6(t,e,r){t[e]===void 0?t[e]=[r]:t[e].push(r)}var vp=256;function Ws(t){return t<vp?t:r0[t]}var r0=[];function v7e(){if(Bt(r0)){r0=new Array(65536);for(var t=0;t<65536;t++)r0[t]=t>255?255+~~(t/255):t}}function Pw(t,e){var r=t.tokenTypeIdx;return r===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[r]===!0}function Fb(t,e){return t.tokenTypeIdx===e.tokenTypeIdx}var SM=1,CV={};function Qg(t){var e=g7e(t);y7e(e),w7e(e),b7e(e),Be(e,function(r){r.isParent=r.categoryMatches.length>0})}function g7e(t){for(var e=Gn(t),r=t,n=!0;n;){r=Xg(Wn(_e(r,function(o){return o.CATEGORIES})));var i=Aw(r,e);e=e.concat(i),Bt(i)?n=!1:r=i}return e}function y7e(t){Be(t,function(e){TV(e)||(CV[SM]=e,e.tokenTypeIdx=SM++),RM(e)&&!qi(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),RM(e)||(e.CATEGORIES=[]),S7e(e)||(e.categoryMatches=[]),R7e(e)||(e.categoryMatchesMap={})})}function b7e(t){Be(t,function(e){e.categoryMatches=[],Be(e.categoryMatchesMap,function(r,n){e.categoryMatches.push(CV[n].tokenTypeIdx)})})}function w7e(t){Be(t,function(e){OV([],e)})}function OV(t,e){Be(t,function(r){e.categoryMatchesMap[r.tokenTypeIdx]=!0}),Be(e.CATEGORIES,function(r){var n=t.concat(e);Vr(n,r)||OV(n,r)})}function TV(t){return Ue(t,"tokenTypeIdx")}function RM(t){return Ue(t,"CATEGORIES")}function S7e(t){return Ue(t,"categoryMatches")}function R7e(t){return Ue(t,"categoryMatchesMap")}function E7e(t){return Ue(t,"tokenTypeIdx")}var C7e={buildUnableToPopLexerModeMessage:function(t){return"Unable to pop Lexer Mode after encountering Token ->"+t.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(t,e,r,n,i){return"unexpected character: ->"+t.charAt(e)+"<- at offset: "+e+","+(" skipped "+r+" characters.")}},Ir;(function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",t[t.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",t[t.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",t[t.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",t[t.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",t[t.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",t[t.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",t[t.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(Ir||(Ir={}));var gp={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:C7e,traceInitPerf:!1,skipValidations:!1};Object.freeze(gp);var jn=function(){function t(e,r){var n=this;if(r===void 0&&(r=gp),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},typeof r=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=mM(gp,r);var i=this.config.traceInitPerf;i===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof i=="number"&&(this.traceInitMaxIdent=i,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var o,a=!0;n.TRACE_INIT("Lexer Config handling",function(){if(n.config.lineTerminatorsPattern===gp.lineTerminatorsPattern)n.config.lineTerminatorsPattern=p7e;else if(n.config.lineTerminatorCharacters===gp.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(r.safeMode&&r.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');n.trackStartLines=/full|onlyStart/i.test(n.config.positionTracking),n.trackEndLines=/full/i.test(n.config.positionTracking),qi(e)?(o={modes:{}},o.modes[Nl]=Gn(e),o[Nl]=Nl):(a=!1,o=Kg(e))}),n.config.skipValidations===!1&&(n.TRACE_INIT("performRuntimeChecks",function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(c7e(o,n.trackStartLines,n.config.lineTerminatorCharacters))}),n.TRACE_INIT("performWarningRuntimeChecks",function(){n.lexerDefinitionWarning=n.lexerDefinitionWarning.concat(f7e(o,n.trackStartLines,n.config.lineTerminatorCharacters))})),o.modes=o.modes?o.modes:{},Be(o.modes,function(c,f){o.modes[f]=Su(c,function(h){return Ii(h)})});var s=Qa(o.modes);if(Be(o.modes,function(c,f){n.TRACE_INIT("Mode: <"+f+"> processing",function(){if(n.modes.push(f),n.config.skipValidations===!1&&n.TRACE_INIT("validatePatterns",function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(KAe(c,s))}),Bt(n.lexerDefinitionErrors)){Qg(c);var h;n.TRACE_INIT("analyzeTokenTypes",function(){h=YAe(c,{lineTerminatorCharacters:n.config.lineTerminatorCharacters,positionTracking:r.positionTracking,ensureOptimizations:r.ensureOptimizations,safeMode:r.safeMode,tracer:n.TRACE_INIT.bind(n)})}),n.patternIdxToConfig[f]=h.patternIdxToConfig,n.charCodeToPatternIdxToConfig[f]=h.charCodeToPatternIdxToConfig,n.emptyGroups=mM(n.emptyGroups,h.emptyGroups),n.hasCustom=h.hasCustom||n.hasCustom,n.canModeBeOptimized[f]=h.canBeOptimized}})}),n.defaultMode=o.defaultMode,!Bt(n.lexerDefinitionErrors)&&!n.config.deferDefinitionErrorsHandling){var l=_e(n.lexerDefinitionErrors,function(c){return c.message}),u=l.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+u)}Be(n.lexerDefinitionWarning,function(c){Q7(c.message)}),n.TRACE_INIT("Choosing sub-methods implementations",function(){if(wV?(n.chopInput=vM,n.match=n.matchWithTest):(n.updateLastIndex=jr,n.match=n.matchWithExec),a&&(n.handleModes=jr),n.trackStartLines===!1&&(n.computeNewColumn=vM),n.trackEndLines===!1&&(n.updateTokenEndLineColumnLocation=jr),/full/i.test(n.config.positionTracking))n.createTokenInstance=n.createFullToken;else if(/onlyStart/i.test(n.config.positionTracking))n.createTokenInstance=n.createStartOnlyToken;else if(/onlyOffset/i.test(n.config.positionTracking))n.createTokenInstance=n.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+n.config.positionTracking+'"');n.hasCustom?(n.addToken=n.addTokenUsingPush,n.handlePayload=n.handlePayloadWithCustom):(n.addToken=n.addTokenUsingMemberAccess,n.handlePayload=n.handlePayloadNoCustom)}),n.TRACE_INIT("Failed Optimization Warnings",function(){var c=sn(n.canModeBeOptimized,function(f,h,d){return h===!1&&f.push(d),f},[]);if(r.ensureOptimizations&&!Bt(c))throw Error("Lexer Modes: < "+c.join(", ")+` > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),n.TRACE_INIT("clearRegExpParserCache",function(){VAe()}),n.TRACE_INIT("toFastProperties",function(){mV(n)})})}return t.prototype.tokenize=function(e,r){if(r===void 0&&(r=this.defaultMode),!Bt(this.lexerDefinitionErrors)){var n=_e(this.lexerDefinitionErrors,function(a){return a.message}),i=n.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}var o=this.tokenizeInternal(e,r);return o},t.prototype.tokenizeInternal=function(e,r){var n=this,i,o,a,s,l,u,c,f,h,d,p,m,y,S,R=e,E=R.length,O=0,A=0,B=this.hasCustom?0:Math.floor(e.length/10),j=new Array(B),J=[],Y=this.trackStartLines?1:void 0,q=this.trackStartLines?1:void 0,ee=h7e(this.emptyGroups),ae=this.trackStartLines,ne=this.config.lineTerminatorsPattern,ue=0,me=[],Re=[],ge=[],I=[];Object.freeze(I);var v=void 0;function b(){return me}function w(T){var k=Ws(T),$=Re[k];return $===void 0?I:$}var _=function(T){if(ge.length===1&&T.tokenType.PUSH_MODE===void 0){var k=n.config.errorMessageProvider.buildUnableToPopLexerModeMessage(T);J.push({offset:T.startOffset,line:T.startLine!==void 0?T.startLine:void 0,column:T.startColumn!==void 0?T.startColumn:void 0,length:T.image.length,message:k})}else{ge.pop();var $=hV(ge);me=n.patternIdxToConfig[$],Re=n.charCodeToPatternIdxToConfig[$],ue=me.length;var W=n.canModeBeOptimized[$]&&n.config.safeMode===!1;Re&&W?v=w:v=b}};function M(T){ge.push(T),Re=this.charCodeToPatternIdxToConfig[T],me=this.patternIdxToConfig[T],ue=me.length,ue=me.length;var k=this.canModeBeOptimized[T]&&this.config.safeMode===!1;Re&&k?v=w:v=b}M.call(this,r);for(var L;O<E;){l=null;var H=R.charCodeAt(O),Z=v(H),te=Z.length;for(i=0;i<te;i++){L=Z[i];var ie=L.pattern;u=null;var oe=L.short;if(oe!==!1?H===oe&&(l=ie):L.isCustom===!0?(S=ie.exec(R,O,j,ee),S!==null?(l=S[0],S.payload!==void 0&&(u=S.payload)):l=null):(this.updateLastIndex(ie,O),l=this.match(ie,e,O)),l!==null){if(s=L.longerAlt,s!==void 0){var ve=me[s],ke=ve.pattern;c=null,ve.isCustom===!0?(S=ke.exec(R,O,j,ee),S!==null?(a=S[0],S.payload!==void 0&&(c=S.payload)):a=null):(this.updateLastIndex(ke,O),a=this.match(ke,e,O)),a&&a.length>l.length&&(l=a,u=c,L=ve)}break}}if(l!==null){if(f=l.length,h=L.group,h!==void 0&&(d=L.tokenTypeIdx,p=this.createTokenInstance(l,O,d,L.tokenType,Y,q,f),this.handlePayload(p,u),h===!1?A=this.addToken(j,A,p):ee[h].push(p)),e=this.chopInput(e,f),O=O+f,q=this.computeNewColumn(q,f),ae===!0&&L.canLineTerminator===!0){var pe=0,Ce=void 0,re=void 0;ne.lastIndex=0;do Ce=ne.test(l),Ce===!0&&(re=ne.lastIndex-1,pe++);while(Ce===!0);pe!==0&&(Y=Y+pe,q=f-re,this.updateTokenEndLineColumnLocation(p,h,re,pe,Y,q,f))}this.handleModes(L,_,M,p)}else{for(var Ve=O,Ze=Y,Ge=q,je=!1;!je&&O<E;)for(R.charCodeAt(O),e=this.chopInput(e,1),O++,o=0;o<ue;o++){var ze=me[o],ie=ze.pattern,oe=ze.short;if(oe!==!1?R.charCodeAt(O)===oe&&(je=!0):ze.isCustom===!0?je=ie.exec(R,O,j,ee)!==null:(this.updateLastIndex(ie,O),je=ie.exec(e)!==null),je===!0)break}m=O-Ve,y=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(R,Ve,m,Ze,Ge),J.push({offset:Ve,line:Ze,column:Ge,length:m,message:y})}}return this.hasCustom||(j.length=A),{tokens:j,groups:ee,errors:J}},t.prototype.handleModes=function(e,r,n,i){if(e.pop===!0){var o=e.push;r(i),o!==void 0&&n.call(this,o)}else e.push!==void 0&&n.call(this,e.push)},t.prototype.chopInput=function(e,r){return e.substring(r)},t.prototype.updateLastIndex=function(e,r){e.lastIndex=r},t.prototype.updateTokenEndLineColumnLocation=function(e,r,n,i,o,a,s){var l,u;r!==void 0&&(l=n===s-1,u=l?-1:0,i===1&&l===!0||(e.endLine=o+u,e.endColumn=a-1+-u))},t.prototype.computeNewColumn=function(e,r){return e+r},t.prototype.createTokenInstance=function(){return null},t.prototype.createOffsetOnlyToken=function(e,r,n,i){return{image:e,startOffset:r,tokenTypeIdx:n,tokenType:i}},t.prototype.createStartOnlyToken=function(e,r,n,i,o,a){return{image:e,startOffset:r,startLine:o,startColumn:a,tokenTypeIdx:n,tokenType:i}},t.prototype.createFullToken=function(e,r,n,i,o,a,s){return{image:e,startOffset:r,endOffset:r+s-1,startLine:o,endLine:o,startColumn:a,endColumn:a+s-1,tokenTypeIdx:n,tokenType:i}},t.prototype.addToken=function(e,r,n){return 666},t.prototype.addTokenUsingPush=function(e,r,n){return e.push(n),r},t.prototype.addTokenUsingMemberAccess=function(e,r,n){return e[r]=n,r++,r},t.prototype.handlePayload=function(e,r){},t.prototype.handlePayloadNoCustom=function(e,r){},t.prototype.handlePayloadWithCustom=function(e,r){r!==null&&(e.payload=r)},t.prototype.match=function(e,r,n){return null},t.prototype.matchWithTest=function(e,r,n){var i=e.test(r);return i===!0?r.substring(n,e.lastIndex):null},t.prototype.matchWithExec=function(e,r){var n=e.exec(r);return n!==null?n[0]:n},t.prototype.TRACE_INIT=function(e,r){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--> <"+e+">");var i=vV(r),o=i.time,a=i.value,s=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(n+"<-- <"+e+"> time: "+o+"ms"),this.traceInitIndent--,a}else return r()},t.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",t.NA=/NOT_APPLICABLE/,t}();function zc(t){return _V(t)?t.LABEL:t.name}function _V(t){return Do(t.LABEL)&&t.LABEL!==""}var O7e="parent",EM="categories",CM="label",OM="group",TM="push_mode",_M="pop_mode",AM="longer_alt",IM="line_breaks",NM="start_chars_hint";function gt(t){return T7e(t)}function T7e(t){var e=t.pattern,r={};if(r.name=t.name,Ii(e)||(r.PATTERN=e),Ue(t,O7e))throw`The parent property is no longer supported.
See: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.`;return Ue(t,EM)&&(r.CATEGORIES=t[EM]),Qg([r]),Ue(t,CM)&&(r.LABEL=t[CM]),Ue(t,OM)&&(r.GROUP=t[OM]),Ue(t,_M)&&(r.POP_MODE=t[_M]),Ue(t,TM)&&(r.PUSH_MODE=t[TM]),Ue(t,AM)&&(r.LONGER_ALT=t[AM]),Ue(t,IM)&&(r.LINE_BREAKS=t[IM]),Ue(t,NM)&&(r.START_CHARS_HINT=t[NM]),r}var Ru=gt({name:"EOF",pattern:jn.NA});Qg([Ru]);function J7(t,e,r,n,i,o,a,s){return{image:e,startOffset:r,endOffset:n,startLine:i,endLine:o,startColumn:a,endColumn:s,tokenTypeIdx:t.tokenTypeIdx,tokenType:t}}function Lt(t,e){return Pw(t,e)}var Za=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Wo=function(){function t(e){this.definition=e}return t.prototype.accept=function(e){e.visit(this),Be(this.definition,function(r){r.accept(e)})},t}(),ui=function(t){Za(e,t);function e(r){var n=t.call(this,[])||this;return n.idx=1,oo(n,Li(r,function(i){return i!==void 0})),n}return Object.defineProperty(e.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(r){},enumerable:!0,configurable:!0}),e.prototype.accept=function(r){r.visit(this)},e}(Wo),Id=function(t){Za(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.orgText="",oo(n,Li(r,function(i){return i!==void 0})),n}return e}(Wo),zn=function(t){Za(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.ignoreAmbiguities=!1,oo(n,Li(r,function(i){return i!==void 0})),n}return e}(Wo),an=function(t){Za(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,oo(n,Li(r,function(i){return i!==void 0})),n}return e}(Wo),Ni=function(t){Za(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,oo(n,Li(r,function(i){return i!==void 0})),n}return e}(Wo),Pi=function(t){Za(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,oo(n,Li(r,function(i){return i!==void 0})),n}return e}(Wo),_r=function(t){Za(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,oo(n,Li(r,function(i){return i!==void 0})),n}return e}(Wo),ci=function(t){Za(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,oo(n,Li(r,function(i){return i!==void 0})),n}return e}(Wo),fi=function(t){Za(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,n.ignoreAmbiguities=!1,n.hasPredicates=!1,oo(n,Li(r,function(i){return i!==void 0})),n}return e}(Wo),cr=function(){function t(e){this.idx=1,oo(this,Li(e,function(r){return r!==void 0}))}return t.prototype.accept=function(e){e.visit(this)},t}();function _7e(t){return _e(t,n0)}function n0(t){function e(i){return _e(i,n0)}if(t instanceof ui)return{type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};if(t instanceof zn)return{type:"Flat",definition:e(t.definition)};if(t instanceof an)return{type:"Option",idx:t.idx,definition:e(t.definition)};if(t instanceof Ni)return{type:"RepetitionMandatory",name:t.name,idx:t.idx,definition:e(t.definition)};if(t instanceof Pi)return{type:"RepetitionMandatoryWithSeparator",name:t.name,idx:t.idx,separator:n0(new cr({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof ci)return{type:"RepetitionWithSeparator",name:t.name,idx:t.idx,separator:n0(new cr({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof _r)return{type:"Repetition",name:t.name,idx:t.idx,definition:e(t.definition)};if(t instanceof fi)return{type:"Alternation",name:t.name,idx:t.idx,definition:e(t.definition)};if(t instanceof cr){var r={type:"Terminal",name:t.terminalType.name,label:zc(t.terminalType),idx:t.idx},n=t.terminalType.PATTERN;return t.terminalType.PATTERN&&(r.pattern=Wa(n)?n.source:n),r}else{if(t instanceof Id)return{type:"Rule",name:t.name,orgText:t.orgText,definition:e(t.definition)};throw Error("non exhaustive match")}}var Mw=function(){function t(){}return t.prototype.walk=function(e,r){var n=this;r===void 0&&(r=[]),Be(e.definition,function(i,o){var a=nn(e.definition,o+1);if(i instanceof ui)n.walkProdRef(i,a,r);else if(i instanceof cr)n.walkTerminal(i,a,r);else if(i instanceof zn)n.walkFlat(i,a,r);else if(i instanceof an)n.walkOption(i,a,r);else if(i instanceof Ni)n.walkAtLeastOne(i,a,r);else if(i instanceof Pi)n.walkAtLeastOneSep(i,a,r);else if(i instanceof ci)n.walkManySep(i,a,r);else if(i instanceof _r)n.walkMany(i,a,r);else if(i instanceof fi)n.walkOr(i,a,r);else throw Error("non exhaustive match")})},t.prototype.walkTerminal=function(e,r,n){},t.prototype.walkProdRef=function(e,r,n){},t.prototype.walkFlat=function(e,r,n){var i=r.concat(n);this.walk(e,i)},t.prototype.walkOption=function(e,r,n){var i=r.concat(n);this.walk(e,i)},t.prototype.walkAtLeastOne=function(e,r,n){var i=[new an({definition:e.definition})].concat(r,n);this.walk(e,i)},t.prototype.walkAtLeastOneSep=function(e,r,n){var i=PM(e,r,n);this.walk(e,i)},t.prototype.walkMany=function(e,r,n){var i=[new an({definition:e.definition})].concat(r,n);this.walk(e,i)},t.prototype.walkManySep=function(e,r,n){var i=PM(e,r,n);this.walk(e,i)},t.prototype.walkOr=function(e,r,n){var i=this,o=r.concat(n);Be(e.definition,function(a){var s=new zn({definition:[a]});i.walk(s,o)})},t}();function PM(t,e,r){var n=[new an({definition:[new cr({terminalType:t.separator})].concat(t.definition)})],i=n.concat(e,r);return i}var Hu=function(){function t(){}return t.prototype.visit=function(e){var r=e;switch(r.constructor){case ui:return this.visitNonTerminal(r);case zn:return this.visitFlat(r);case an:return this.visitOption(r);case Ni:return this.visitRepetitionMandatory(r);case Pi:return this.visitRepetitionMandatoryWithSeparator(r);case ci:return this.visitRepetitionWithSeparator(r);case _r:return this.visitRepetition(r);case fi:return this.visitAlternation(r);case cr:return this.visitTerminal(r);case Id:return this.visitRule(r);default:throw Error("non exhaustive match")}},t.prototype.visitNonTerminal=function(e){},t.prototype.visitFlat=function(e){},t.prototype.visitOption=function(e){},t.prototype.visitRepetition=function(e){},t.prototype.visitRepetitionMandatory=function(e){},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){},t.prototype.visitRepetitionWithSeparator=function(e){},t.prototype.visitAlternation=function(e){},t.prototype.visitTerminal=function(e){},t.prototype.visitRule=function(e){},t}(),A7e=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();function I7e(t){return t instanceof zn||t instanceof an||t instanceof _r||t instanceof Ni||t instanceof Pi||t instanceof ci||t instanceof cr||t instanceof Id}function Hb(t,e){e===void 0&&(e=[]);var r=t instanceof an||t instanceof _r||t instanceof ci;return r?!0:t instanceof fi?dV(t.definition,function(n){return Hb(n,e)}):t instanceof ui&&Vr(e,t)?!1:t instanceof Wo?(t instanceof ui&&e.push(t),Ti(t.definition,function(n){return Hb(n,e)})):!1}function N7e(t){return t instanceof fi}function Gi(t){if(t instanceof ui)return"SUBRULE";if(t instanceof an)return"OPTION";if(t instanceof fi)return"OR";if(t instanceof Ni)return"AT_LEAST_ONE";if(t instanceof Pi)return"AT_LEAST_ONE_SEP";if(t instanceof ci)return"MANY_SEP";if(t instanceof _r)return"MANY";if(t instanceof cr)return"CONSUME";throw Error("non exhaustive match")}var P7e=function(t){A7e(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.separator="-",r.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},r}return e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitTerminal=function(r){var n=r.terminalType.name+this.separator+"Terminal";Ue(this.dslMethods,n)||(this.dslMethods[n]=[]),this.dslMethods[n].push(r)},e.prototype.visitNonTerminal=function(r){var n=r.nonTerminalName+this.separator+"Terminal";Ue(this.dslMethods,n)||(this.dslMethods[n]=[]),this.dslMethods[n].push(r)},e.prototype.visitOption=function(r){this.dslMethods.option.push(r)},e.prototype.visitRepetitionWithSeparator=function(r){this.dslMethods.repetitionWithSeparator.push(r)},e.prototype.visitRepetitionMandatory=function(r){this.dslMethods.repetitionMandatory.push(r)},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.dslMethods.repetitionMandatoryWithSeparator.push(r)},e.prototype.visitRepetition=function(r){this.dslMethods.repetition.push(r)},e.prototype.visitAlternation=function(r){this.dslMethods.alternation.push(r)},e}(Hu),Wy=new P7e;function M7e(t){Wy.reset(),t.accept(Wy);var e=Wy.dslMethods;return Wy.reset(),e}function Zg(t){if(t instanceof ui)return Zg(t.referencedRule);if(t instanceof cr)return $7e(t);if(I7e(t))return k7e(t);if(N7e(t))return x7e(t);throw Error("non exhaustive match")}function k7e(t){for(var e=[],r=t.definition,n=0,i=r.length>n,o,a=!0;i&&a;)o=r[n],a=Hb(o),e=e.concat(Zg(o)),n=n+1,i=r.length>n;return X7(e)}function x7e(t){var e=_e(t.definition,function(r){return Zg(r)});return X7(Wn(e))}function $7e(t){return[t.terminalType]}var AV="_~IN~_",L7e=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),D7e=function(t){L7e(e,t);function e(r){var n=t.call(this)||this;return n.topProd=r,n.follows={},n}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(r,n,i){},e.prototype.walkProdRef=function(r,n,i){var o=H7e(r.referencedRule,r.idx)+this.topProd.name,a=n.concat(i),s=new zn({definition:a}),l=Zg(s);this.follows[o]=l},e}(Mw);function F7e(t){var e={};return Be(t,function(r){var n=new D7e(r).startWalking();oo(e,n)}),e}function H7e(t,e){return t.name+e+AV}var U7e=4,Js=8,B7e=8,Yc=1<<Js,Ub=2<<Js,xp=3<<Js,$p=4<<Js,Lp=5<<Js,Dc=6<<Js;function Dp(t,e,r){return r|e|t}var V7e=32-B7e;function IV(t,e,r,n){var i=n+1<<V7e;return Dp(t,e,r)|i}var j7e=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();function MM(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.endOffset=e.endOffset):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset)}function kM(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.startColumn=e.startColumn,t.startLine=e.startLine,t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine)}function W7e(t,e,r){t.children[r]===void 0?t.children[r]=[e]:t.children[r].push(e)}function xM(t,e,r){t.children[e]===void 0?t.children[e]=[r]:t.children[e].push(r)}var eI=function(t){j7e(e,t);function e(r){var n=t.call(this)||this;return n.result=[],n.ruleIdx=r,n}return e.prototype.collectNamedDSLMethod=function(r,n,i){if(!Ii(r.name)){var o=void 0;if(r instanceof an||r instanceof _r||r instanceof Ni||r instanceof fi)o=new n({definition:r.definition,idx:r.idx});else if(r instanceof Pi||r instanceof ci)o=new n({definition:r.definition,idx:r.idx,separator:r.separator});else throw Error("non exhaustive match");var a=[o],s=Dp(this.ruleIdx,i,r.idx);this.result.push({def:a,key:s,name:r.name,orgProd:r})}},e.prototype.visitOption=function(r){this.collectNamedDSLMethod(r,an,Ub)},e.prototype.visitRepetition=function(r){this.collectNamedDSLMethod(r,_r,xp)},e.prototype.visitRepetitionMandatory=function(r){this.collectNamedDSLMethod(r,Ni,$p)},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.collectNamedDSLMethod(r,Pi,Dc)},e.prototype.visitRepetitionWithSeparator=function(r){this.collectNamedDSLMethod(r,ci,Lp)},e.prototype.visitAlternation=function(r){var n=this;this.collectNamedDSLMethod(r,fi,Yc);var i=r.definition.length>1;Be(r.definition,function(o,a){if(!Ii(o.name)){var s=o.definition;i?s=[new an({definition:o.definition})]:s=o.definition;var l=IV(n.ruleIdx,Yc,r.idx,a);n.result.push({def:s,key:l,name:o.name,orgProd:o})}})},e}(Hu);function G7e(t,e){var r={allRuleNames:[]};return Be(t,function(n){var i=e[n.name];r.allRuleNames.push(n.name);var o=new eI(i);n.accept(o),Be(o.result,function(a){a.def,a.key;var s=a.name;r.allRuleNames.push(n.name+s)})}),r}var Uu=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),z7e=function(t){Uu(e,t);function e(r,n){var i=t.call(this)||this;return i.topProd=r,i.path=n,i.possibleTokTypes=[],i.nextProductionName="",i.nextProductionOccurrence=0,i.found=!1,i.isAtEndOfPath=!1,i}return e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Gn(this.path.ruleStack).reverse(),this.occurrenceStack=Gn(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(r,n){n===void 0&&(n=[]),this.found||t.prototype.walk.call(this,r,n)},e.prototype.walkProdRef=function(r,n,i){if(r.referencedRule.name===this.nextProductionName&&r.idx===this.nextProductionOccurrence){var o=n.concat(i);this.updateExpectedNext(),this.walk(r.referencedRule,o)}},e.prototype.updateExpectedNext=function(){Bt(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e}(Mw),Y7e=function(t){Uu(e,t);function e(r,n){var i=t.call(this,r,n)||this;return i.path=n,i.nextTerminalName="",i.nextTerminalOccurrence=0,i.nextTerminalName=i.path.lastTok.name,i.nextTerminalOccurrence=i.path.lastTokOccurrence,i}return e.prototype.walkTerminal=function(r,n,i){if(this.isAtEndOfPath&&r.terminalType.name===this.nextTerminalName&&r.idx===this.nextTerminalOccurrence&&!this.found){var o=n.concat(i),a=new zn({definition:o});this.possibleTokTypes=Zg(a),this.found=!0}},e}(z7e),kw=function(t){Uu(e,t);function e(r,n){var i=t.call(this)||this;return i.topRule=r,i.occurrence=n,i.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},i}return e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e}(Mw),K7e=function(t){Uu(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.walkMany=function(r,n,i){if(r.idx===this.occurrence){var o=Ai(n.concat(i));this.result.isEndOfRule=o===void 0,o instanceof cr&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkMany.call(this,r,n,i)},e}(kw),$M=function(t){Uu(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.walkManySep=function(r,n,i){if(r.idx===this.occurrence){var o=Ai(n.concat(i));this.result.isEndOfRule=o===void 0,o instanceof cr&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkManySep.call(this,r,n,i)},e}(kw),X7e=function(t){Uu(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.walkAtLeastOne=function(r,n,i){if(r.idx===this.occurrence){var o=Ai(n.concat(i));this.result.isEndOfRule=o===void 0,o instanceof cr&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkAtLeastOne.call(this,r,n,i)},e}(kw),LM=function(t){Uu(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.walkAtLeastOneSep=function(r,n,i){if(r.idx===this.occurrence){var o=Ai(n.concat(i));this.result.isEndOfRule=o===void 0,o instanceof cr&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkAtLeastOneSep.call(this,r,n,i)},e}(kw);function u5(t,e,r){r===void 0&&(r=[]),r=Gn(r);var n=[],i=0;function o(u){return u.concat(nn(t,i+1))}function a(u){var c=u5(o(u),e,r);return n.concat(c)}for(;r.length<e&&i<t.length;){var s=t[i];if(s instanceof zn)return a(s.definition);if(s instanceof ui)return a(s.definition);if(s instanceof an)n=a(s.definition);else if(s instanceof Ni){var l=s.definition.concat([new _r({definition:s.definition})]);return a(l)}else if(s instanceof Pi){var l=[new zn({definition:s.definition}),new _r({definition:[new cr({terminalType:s.separator})].concat(s.definition)})];return a(l)}else if(s instanceof ci){var l=s.definition.concat([new _r({definition:[new cr({terminalType:s.separator})].concat(s.definition)})]);n=a(l)}else if(s instanceof _r){var l=s.definition.concat([new _r({definition:s.definition})]);n=a(l)}else{if(s instanceof fi)return Be(s.definition,function(u){n=a(u.definition)}),n;if(s instanceof cr)r.push(s.terminalType);else throw Error("non exhaustive match")}i++}return n.push({partialPath:r,suffixDef:nn(t,i)}),n}function NV(t,e,r,n){var i="EXIT_NONE_TERMINAL",o=[i],a="EXIT_ALTERNATIVE",s=!1,l=e.length,u=l-n-1,c=[],f=[];for(f.push({idx:-1,def:t,ruleStack:[],occurrenceStack:[]});!Bt(f);){var h=f.pop();if(h===a){s&&hV(f).idx<=u&&f.pop();continue}var d=h.def,p=h.idx,m=h.ruleStack,y=h.occurrenceStack;if(!Bt(d)){var S=d[0];if(S===i){var R={idx:p,def:nn(d),ruleStack:dv(m),occurrenceStack:dv(y)};f.push(R)}else if(S instanceof cr)if(p<l-1){var E=p+1,O=e[E];if(r(O,S.terminalType)){var R={idx:E,def:nn(d),ruleStack:m,occurrenceStack:y};f.push(R)}}else if(p===l-1)c.push({nextTokenType:S.terminalType,nextTokenOccurrence:S.idx,ruleStack:m,occurrenceStack:y}),s=!0;else throw Error("non exhaustive match");else if(S instanceof ui){var A=Gn(m);A.push(S.nonTerminalName);var B=Gn(y);B.push(S.idx);var R={idx:p,def:S.definition.concat(o,nn(d)),ruleStack:A,occurrenceStack:B};f.push(R)}else if(S instanceof an){var j={idx:p,def:nn(d),ruleStack:m,occurrenceStack:y};f.push(j),f.push(a);var J={idx:p,def:S.definition.concat(nn(d)),ruleStack:m,occurrenceStack:y};f.push(J)}else if(S instanceof Ni){var Y=new _r({definition:S.definition,idx:S.idx}),q=S.definition.concat([Y],nn(d)),R={idx:p,def:q,ruleStack:m,occurrenceStack:y};f.push(R)}else if(S instanceof Pi){var ee=new cr({terminalType:S.separator}),Y=new _r({definition:[ee].concat(S.definition),idx:S.idx}),q=S.definition.concat([Y],nn(d)),R={idx:p,def:q,ruleStack:m,occurrenceStack:y};f.push(R)}else if(S instanceof ci){var j={idx:p,def:nn(d),ruleStack:m,occurrenceStack:y};f.push(j),f.push(a);var ee=new cr({terminalType:S.separator}),ae=new _r({definition:[ee].concat(S.definition),idx:S.idx}),q=S.definition.concat([ae],nn(d)),J={idx:p,def:q,ruleStack:m,occurrenceStack:y};f.push(J)}else if(S instanceof _r){var j={idx:p,def:nn(d),ruleStack:m,occurrenceStack:y};f.push(j),f.push(a);var ae=new _r({definition:S.definition,idx:S.idx}),q=S.definition.concat([ae],nn(d)),J={idx:p,def:q,ruleStack:m,occurrenceStack:y};f.push(J)}else if(S instanceof fi)for(var ne=S.definition.length-1;ne>=0;ne--){var ue=S.definition[ne],me={idx:p,def:ue.definition.concat(nn(d)),ruleStack:m,occurrenceStack:y};f.push(me),f.push(a)}else if(S instanceof zn)f.push({idx:p,def:S.definition.concat(nn(d)),ruleStack:m,occurrenceStack:y});else if(S instanceof Id)f.push(q7e(S,p,m,y));else throw Error("non exhaustive match")}}return c}function q7e(t,e,r,n){var i=Gn(r);i.push(t.name);var o=Gn(n);return o.push(1),{idx:e,def:t.definition,ruleStack:i,occurrenceStack:o}}var PV=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Yt;(function(t){t[t.OPTION=0]="OPTION",t[t.REPETITION=1]="REPETITION",t[t.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",t[t.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",t[t.ALTERNATION=5]="ALTERNATION"})(Yt||(Yt={}));function Q7e(t){if(t instanceof an)return Yt.OPTION;if(t instanceof _r)return Yt.REPETITION;if(t instanceof Ni)return Yt.REPETITION_MANDATORY;if(t instanceof Pi)return Yt.REPETITION_MANDATORY_WITH_SEPARATOR;if(t instanceof ci)return Yt.REPETITION_WITH_SEPARATOR;if(t instanceof fi)return Yt.ALTERNATION;throw Error("non exhaustive match")}function Z7e(t,e,r,n,i,o){var a=tI(t,e,r),s=xV(a)?Fb:Pw;return o(a,n,s,i)}function J7e(t,e,r,n,i,o){var a=rI(t,e,i,r),s=xV(a)?Fb:Pw;return o(a[0],s,n)}function eIe(t,e,r,n){var i=t.length,o=Ti(t,function(l){return Ti(l,function(u){return u.length===1})});if(e)return function(l){for(var u=_e(l,function(E){return E.GATE}),c=0;c<i;c++){var f=t[c],h=f.length,d=u[c];if(!(d!==void 0&&d.call(this)===!1))e:for(var p=0;p<h;p++){for(var m=f[p],y=m.length,S=0;S<y;S++){var R=this.LA(S+1);if(r(R,m[S])===!1)continue e}return c}}};if(o&&!n){var a=_e(t,function(l){return Wn(l)}),s=sn(a,function(l,u,c){return Be(u,function(f){Ue(l,f.tokenTypeIdx)||(l[f.tokenTypeIdx]=c),Be(f.categoryMatches,function(h){Ue(l,h)||(l[h]=c)})}),l},[]);return function(){var l=this.LA(1);return s[l.tokenTypeIdx]}}else return function(){for(var l=0;l<i;l++){var u=t[l],c=u.length;e:for(var f=0;f<c;f++){for(var h=u[f],d=h.length,p=0;p<d;p++){var m=this.LA(p+1);if(r(m,h[p])===!1)continue e}return l}}}}function tIe(t,e,r){var n=Ti(t,function(u){return u.length===1}),i=t.length;if(n&&!r){var o=Wn(t);if(o.length===1&&Bt(o[0].categoryMatches)){var a=o[0],s=a.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===s}}else{var l=sn(o,function(u,c,f){return u[c.tokenTypeIdx]=!0,Be(c.categoryMatches,function(h){u[h]=!0}),u},[]);return function(){var u=this.LA(1);return l[u.tokenTypeIdx]===!0}}}else return function(){e:for(var u=0;u<i;u++){for(var c=t[u],f=c.length,h=0;h<f;h++){var d=this.LA(h+1);if(e(d,c[h])===!1)continue e}return!0}return!1}}var rIe=function(t){PV(e,t);function e(r,n,i){var o=t.call(this)||this;return o.topProd=r,o.targetOccurrence=n,o.targetProdType=i,o}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(r,n,i,o){return r.idx===this.targetOccurrence&&this.targetProdType===n?(this.restDef=i.concat(o),!0):!1},e.prototype.walkOption=function(r,n,i){this.checkIsTarget(r,Yt.OPTION,n,i)||t.prototype.walkOption.call(this,r,n,i)},e.prototype.walkAtLeastOne=function(r,n,i){this.checkIsTarget(r,Yt.REPETITION_MANDATORY,n,i)||t.prototype.walkOption.call(this,r,n,i)},e.prototype.walkAtLeastOneSep=function(r,n,i){this.checkIsTarget(r,Yt.REPETITION_MANDATORY_WITH_SEPARATOR,n,i)||t.prototype.walkOption.call(this,r,n,i)},e.prototype.walkMany=function(r,n,i){this.checkIsTarget(r,Yt.REPETITION,n,i)||t.prototype.walkOption.call(this,r,n,i)},e.prototype.walkManySep=function(r,n,i){this.checkIsTarget(r,Yt.REPETITION_WITH_SEPARATOR,n,i)||t.prototype.walkOption.call(this,r,n,i)},e}(Mw),MV=function(t){PV(e,t);function e(r,n,i){var o=t.call(this)||this;return o.targetOccurrence=r,o.targetProdType=n,o.targetRef=i,o.result=[],o}return e.prototype.checkIsTarget=function(r,n){r.idx===this.targetOccurrence&&this.targetProdType===n&&(this.targetRef===void 0||r===this.targetRef)&&(this.result=r.definition)},e.prototype.visitOption=function(r){this.checkIsTarget(r,Yt.OPTION)},e.prototype.visitRepetition=function(r){this.checkIsTarget(r,Yt.REPETITION)},e.prototype.visitRepetitionMandatory=function(r){this.checkIsTarget(r,Yt.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.checkIsTarget(r,Yt.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(r){this.checkIsTarget(r,Yt.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(r){this.checkIsTarget(r,Yt.ALTERNATION)},e}(Hu);function DM(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=[];return e}function P6(t){for(var e=[""],r=0;r<t.length;r++){for(var n=t[r],i=[],o=0;o<e.length;o++){var a=e[o];i.push(a+"_"+n.tokenTypeIdx);for(var s=0;s<n.categoryMatches.length;s++){var l="_"+n.categoryMatches[s];i.push(a+l)}}e=i}return e}function nIe(t,e,r){for(var n=0;n<t.length;n++)if(n!==r)for(var i=t[n],o=0;o<e.length;o++){var a=e[o];if(i[a]===!0)return!1}return!0}function kV(t,e){for(var r=_e(t,function(c){return u5([c],1)}),n=DM(r.length),i=_e(r,function(c){var f={};return Be(c,function(h){var d=P6(h.partialPath);Be(d,function(p){f[p]=!0})}),f}),o=r,a=1;a<=e;a++){var s=o;o=DM(s.length);for(var l=function(c){for(var f=s[c],h=0;h<f.length;h++){var d=f[h].partialPath,p=f[h].suffixDef,m=P6(d),y=nIe(i,m,c);if(y||Bt(p)||d.length===e){var S=n[c];if(c5(S,d)===!1){S.push(d);for(var R=0;R<m.length;R++){var E=m[R];i[c][E]=!0}}}else{var O=u5(p,a+1,d);o[c]=o[c].concat(O),Be(O,function(A){var B=P6(A.partialPath);Be(B,function(j){i[c][j]=!0})})}}},u=0;u<s.length;u++)l(u)}return n}function tI(t,e,r,n){var i=new MV(t,Yt.ALTERNATION,n);return e.accept(i),kV(i.result,r)}function rI(t,e,r,n){var i=new MV(t,r);e.accept(i);var o=i.result,a=new rIe(e,t,r),s=a.startWalking(),l=new zn({definition:o}),u=new zn({definition:s});return kV([l,u],n)}function c5(t,e){e:for(var r=0;r<t.length;r++){var n=t[r];if(n.length===e.length){for(var i=0;i<n.length;i++){var o=e[i],a=n[i],s=o===a||a.categoryMatchesMap[o.tokenTypeIdx]!==void 0;if(s===!1)continue e}return!0}}return!1}function iIe(t,e){return t.length<e.length&&Ti(t,function(r,n){var i=e[n];return r===i||i.categoryMatchesMap[r.tokenTypeIdx]})}function xV(t){return Ti(t,function(e){return Ti(e,function(r){return Ti(r,function(n){return Bt(n.categoryMatches)})})})}var nI=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();function oIe(t,e,r,n,i,o){var a=_e(t,function(R){return sIe(R,i)}),s=_e(t,function(R){return DV(R,R,i)}),l=[],u=[],c=[];Ti(s,Bt)&&(l=_e(t,function(R){return mIe(R,i)}),u=_e(t,function(R){return vIe(R,e,n,i)}),c=bIe(t,e,i));var f=RIe(t,r,i),h=_e(r,function(R){return hIe(R,i)}),d=aIe(t,i),p=EIe(t,i),m=_e(t,function(R){return yIe(R,i)}),y=_e(t,function(R){return cIe(R,i)}),S=_e(t,function(R){return dIe(R,t,o,i)});return Wn(a.concat(h,d,p,c,s,l,u,f,m,y,S))}function aIe(t,e){var r=[];return Be(t,function(n){var i=new eI("");n.accept(i);var o=_e(i.result,function(a){return a.orgProd});r.push(_e(o,function(a){return fIe(n,a,e)}))}),Wn(r)}function sIe(t,e){var r=new uIe;t.accept(r);var n=r.allProductions,i=pV(n,lIe),o=Li(i,function(s){return s.length>1}),a=_e(mn(o),function(s){var l=Ai(s),u=e.buildDuplicateFoundError(t,s),c=Gi(l),f={message:u,type:Qr.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:c,occurrence:l.idx},h=$V(l);return h&&(f.parameter=h),f});return a}function lIe(t){return Gi(t)+"_#_"+t.idx+"_#_"+$V(t)}function $V(t){return t instanceof cr?t.terminalType.name:t instanceof ui?t.nonTerminalName:""}var uIe=function(t){nI(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.allProductions=[],r}return e.prototype.visitNonTerminal=function(r){this.allProductions.push(r)},e.prototype.visitOption=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionWithSeparator=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionMandatory=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.allProductions.push(r)},e.prototype.visitRepetition=function(r){this.allProductions.push(r)},e.prototype.visitAlternation=function(r){this.allProductions.push(r)},e.prototype.visitTerminal=function(r){this.allProductions.push(r)},e}(Hu),Eu=/^[a-zA-Z_]\w*$/,LV=new RegExp(Eu.source.replace("^","^\\$"));function cIe(t,e){var r=[],n=t.name;return n.match(Eu)||r.push({message:e.buildInvalidRuleNameError({topLevelRule:t,expectedPattern:Eu}),type:Qr.INVALID_RULE_NAME,ruleName:n}),r}function fIe(t,e,r){var n=[],i;return e.name.match(LV)||(i=r.buildInvalidNestedRuleNameError(t,e),n.push({message:i,type:Qr.INVALID_NESTED_RULE_NAME,ruleName:t.name})),n}function hIe(t,e){var r=[],n=t.name;return n.match(Eu)||r.push({message:e.buildTokenNameError({tokenType:t,expectedPattern:Eu}),type:Qr.INVALID_TOKEN_NAME}),r}function dIe(t,e,r,n){var i=[],o=sn(e,function(s,l){return l.name===t.name?s+1:s},0);if(o>1){var a=n.buildDuplicateRuleNameError({topLevelRule:t,grammarName:r});i.push({message:a,type:Qr.DUPLICATE_RULE_NAME,ruleName:t.name})}return i}function pIe(t,e,r){var n=[],i;return Vr(e,t)||(i="Invalid rule override, rule: ->"+t+"<- cannot be overridden in the grammar: ->"+r+"<-as it is not defined in any of the super grammars ",n.push({message:i,type:Qr.INVALID_RULE_OVERRIDE,ruleName:t})),n}function DV(t,e,r,n){n===void 0&&(n=[]);var i=[],o=i0(e.definition);if(Bt(o))return[];var a=t.name,s=Vr(o,t);s&&i.push({message:r.buildLeftRecursionError({topLevelRule:t,leftRecursionPath:n}),type:Qr.LEFT_RECURSION,ruleName:a});var l=Aw(o,n.concat([t])),u=_e(l,function(c){var f=Gn(n);return f.push(c),DV(t,c,r,f)});return i.concat(Wn(u))}function i0(t){var e=[];if(Bt(t))return e;var r=Ai(t);if(r instanceof ui)e.push(r.referencedRule);else if(r instanceof zn||r instanceof an||r instanceof Ni||r instanceof Pi||r instanceof ci||r instanceof _r)e=e.concat(i0(r.definition));else if(r instanceof fi)e=Wn(_e(r.definition,function(a){return i0(a.definition)}));else if(!(r instanceof cr))throw Error("non exhaustive match");var n=Hb(r),i=t.length>1;if(n&&i){var o=nn(t);return e.concat(i0(o))}else return e}var iI=function(t){nI(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.alternations=[],r}return e.prototype.visitAlternation=function(r){this.alternations.push(r)},e}(Hu);function mIe(t,e){var r=new iI;t.accept(r);var n=r.alternations,i=sn(n,function(o,a){var s=dv(a.definition),l=_e(s,function(u,c){var f=NV([u],[],null,1);return Bt(f)?{message:e.buildEmptyAlternationError({topLevelRule:t,alternation:a,emptyChoiceIdx:c}),type:Qr.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:a.idx,alternative:c+1}:null});return o.concat(Xg(l))},[]);return i}function vIe(t,e,r,n){var i=new iI;t.accept(i);var o=i.alternations,a=r[t.name];a&&(o=Su(o,function(l){return a[Gi(l)+(l.idx===0?"":l.idx)]})),o=Su(o,function(l){return l.ignoreAmbiguities===!0});var s=sn(o,function(l,u){var c=u.idx,f=u.maxLookahead||e,h=tI(c,t,f,u),d=wIe(h,u,t,n),p=SIe(h,u,t,n);return l.concat(d,p)},[]);return s}var gIe=function(t){nI(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.allProductions=[],r}return e.prototype.visitRepetitionWithSeparator=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionMandatory=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.allProductions.push(r)},e.prototype.visitRepetition=function(r){this.allProductions.push(r)},e}(Hu);function yIe(t,e){var r=new iI;t.accept(r);var n=r.alternations,i=sn(n,function(o,a){return a.definition.length>255&&o.push({message:e.buildTooManyAlternativesError({topLevelRule:t,alternation:a}),type:Qr.TOO_MANY_ALTS,ruleName:t.name,occurrence:a.idx}),o},[]);return i}function bIe(t,e,r){var n=[];return Be(t,function(i){var o=new gIe;i.accept(o);var a=o.allProductions;Be(a,function(s){var l=Q7e(s),u=s.maxLookahead||e,c=s.idx,f=rI(c,i,l,u),h=f[0];if(Bt(Wn(h))){var d=r.buildEmptyRepetitionError({topLevelRule:i,repetition:s});n.push({message:d,type:Qr.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),n}function wIe(t,e,r,n){var i=[],o=sn(t,function(s,l,u){return e.definition[u].ignoreAmbiguities===!0||Be(l,function(c){var f=[u];Be(t,function(h,d){u!==d&&c5(h,c)&&e.definition[d].ignoreAmbiguities!==!0&&f.push(d)}),f.length>1&&!c5(i,c)&&(i.push(c),s.push({alts:f,path:c}))}),s},[]),a=_e(o,function(s){var l=_e(s.alts,function(c){return c+1}),u=n.buildAlternationAmbiguityError({topLevelRule:r,alternation:e,ambiguityIndices:l,prefixPath:s.path});return{message:u,type:Qr.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:e.idx,alternatives:[s.alts]}});return a}function SIe(t,e,r,n){var i=[],o=sn(t,function(a,s,l){var u=_e(s,function(c){return{idx:l,path:c}});return a.concat(u)},[]);return Be(o,function(a){var s=e.definition[a.idx];if(s.ignoreAmbiguities!==!0){var l=a.idx,u=a.path,c=LAe(o,function(h){return e.definition[h.idx].ignoreAmbiguities!==!0&&h.idx<l&&iIe(h.path,u)}),f=_e(c,function(h){var d=[h.idx+1,l+1],p=e.idx===0?"":e.idx,m=n.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:e,ambiguityIndices:d,prefixPath:h.path});return{message:m,type:Qr.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:p,alternatives:d}});i=i.concat(f)}}),i}function RIe(t,e,r){var n=[],i=_e(e,function(o){return o.name});return Be(t,function(o){var a=o.name;if(Vr(i,a)){var s=r.buildNamespaceConflictError(o);n.push({message:s,type:Qr.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:a})}}),n}function EIe(t,e){var r=[];return Be(t,function(n){var i=new eI("");n.accept(i);var o=pV(i.result,function(s){return s.name}),a=Li(o,function(s){return s.length>1});Be(mn(a),function(s){var l=_e(s,function(c){return c.orgProd}),u=e.buildDuplicateNestedRuleNameError(n,l);r.push({message:u,type:Qr.DUPLICATE_NESTED_NAME,ruleName:n.name})})}),r}var FV={buildMismatchTokenMessage:function(t){var e=t.expected,r=t.actual;t.previous,t.ruleName;var n=_V(e),i=n?"--> "+zc(e)+" <--":"token of type --> "+e.name+" <--",o="Expecting "+i+" but found --> '"+r.image+"' <--";return o},buildNotAllInputParsedMessage:function(t){var e=t.firstRedundant;return t.ruleName,"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage:function(t){var e=t.expectedPathsPerAlt,r=t.actual;t.previous;var n=t.customUserDescription;t.ruleName;var i="Expecting: ",o=Ai(r).image,a=`
but found: '`+o+"'";if(n)return i+n+a;var s=sn(e,function(f,h){return f.concat(h)},[]),l=_e(s,function(f){return"["+_e(f,function(h){return zc(h)}).join(", ")+"]"}),u=_e(l,function(f,h){return"  "+(h+1)+". "+f}),c=`one of these possible Token sequences:
`+u.join(`
`);return i+c+a},buildEarlyExitMessage:function(t){var e=t.expectedIterationPaths,r=t.actual,n=t.customUserDescription;t.ruleName;var i="Expecting: ",o=Ai(r).image,a=`
but found: '`+o+"'";if(n)return i+n+a;var s=_e(e,function(u){return"["+_e(u,function(c){return zc(c)}).join(",")+"]"}),l=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+("<"+s.join(" ,")+">");return i+l+a}};Object.freeze(FV);var CIe={buildRuleNotFoundError:function(t,e){var r="Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+t.name+"<-";return r}},oI={buildDuplicateFoundError:function(t,e){function r(c){return c instanceof cr?c.terminalType.name:c instanceof ui?c.nonTerminalName:""}var n=t.name,i=Ai(e),o=i.idx,a=Gi(i),s=r(i),l=o>0,u="->"+a+(l?o:"")+"<- "+(s?"with argument: ->"+s+"<-":"")+`
                  appears more than once (`+e.length+" times) in the top level rule: ->"+n+`<-.                  
                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return u=u.replace(/[ \t]+/g," "),u=u.replace(/\s\s+/g,`
`),u},buildInvalidNestedRuleNameError:function(t,e){var r="Invalid nested rule name: ->"+e.name+"<- inside rule: ->"+t.name+`<-
`+("it must match the pattern: ->"+LV.toString()+`<-.
`)+"Note that this means a nested rule name must start with the '$'(dollar) sign.";return r},buildDuplicateNestedRuleNameError:function(t,e){var r=Ai(e).name,n="Duplicate nested rule name: ->"+r+"<- inside rule: ->"+t.name+`<-
A nested name must be unique in the scope of a top level grammar rule.`;return n},buildNamespaceConflictError:function(t){var e=`Namespace conflict found in grammar.
`+("The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+t.name+`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return e},buildAlternationPrefixAmbiguityError:function(t){var e=_e(t.prefixPath,function(i){return zc(i)}).join(", "),r=t.alternation.idx===0?"":t.alternation.idx,n="Ambiguous alternatives: <"+t.ambiguityIndices.join(" ,")+`> due to common lookahead prefix
`+("in <OR"+r+"> inside <"+t.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`)+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return n},buildAlternationAmbiguityError:function(t){var e=_e(t.prefixPath,function(i){return zc(i)}).join(", "),r=t.alternation.idx===0?"":t.alternation.idx,n="Ambiguous Alternatives Detected: <"+t.ambiguityIndices.join(" ,")+"> in <OR"+r+">"+(" inside <"+t.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`);return n=n+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,n},buildEmptyRepetitionError:function(t){var e=Gi(t.repetition);t.repetition.idx!==0&&(e+=t.repetition.idx);var r="The repetition <"+e+"> within Rule <"+t.topLevelRule.name+`> can never consume any tokens.
This could lead to an infinite loop.`;return r},buildTokenNameError:function(t){var e=t.tokenType.name,r="Invalid Grammar Token name: ->"+e+"<- it must match the pattern: ->"+t.expectedPattern.toString()+"<-";return r},buildEmptyAlternationError:function(t){var e="Ambiguous empty alternative: <"+(t.emptyChoiceIdx+1)+">"+(" in <OR"+t.alternation.idx+"> inside <"+t.topLevelRule.name+`> Rule.
`)+"Only the last alternative may be an empty alternative.";return e},buildTooManyAlternativesError:function(t){var e=`An Alternation cannot have more than 256 alternatives:
`+("<OR"+t.alternation.idx+"> inside <"+t.topLevelRule.name+`> Rule.
 has `+(t.alternation.definition.length+1)+" alternatives.");return e},buildLeftRecursionError:function(t){var e=t.topLevelRule.name,r=_e(t.leftRecursionPath,function(o){return o.name}),n=e+" --> "+r.concat([e]).join(" --> "),i=`Left Recursion found in grammar.
`+("rule: <"+e+`> can be invoked from itself (directly or indirectly)
`)+(`without consuming any Tokens. The grammar path that causes this is: 
 `+n+`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.`;return i},buildInvalidRuleNameError:function(t){var e=t.topLevelRule.name,r=t.expectedPattern.toString(),n="Invalid grammar rule name: ->"+e+"<- it must match the pattern: ->"+r+"<-";return n},buildDuplicateRuleNameError:function(t){var e;t.topLevelRule instanceof Id?e=t.topLevelRule.name:e=t.topLevelRule;var r="Duplicate definition, rule: ->"+e+"<- is already defined in the grammar: ->"+t.grammarName+"<-";return r}},OIe=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();function TIe(t,e){var r=new _Ie(t,e);return r.resolveRefs(),r.errors}var _Ie=function(t){OIe(e,t);function e(r,n){var i=t.call(this)||this;return i.nameToTopRule=r,i.errMsgProvider=n,i.errors=[],i}return e.prototype.resolveRefs=function(){var r=this;Be(mn(this.nameToTopRule),function(n){r.currTopLevel=n,n.accept(r)})},e.prototype.visitNonTerminal=function(r){var n=this.nameToTopRule[r.nonTerminalName];if(n)r.referencedRule=n;else{var i=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,r);this.errors.push({message:i,type:Qr.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:r.nonTerminalName})}},e}(Hu);function AIe(t){t=Iw(t,{errMsgProvider:CIe});var e={};return Be(t.rules,function(r){e[r.name]=r}),TIe(e,t.errMsgProvider)}function IIe(t){return t=Iw(t,{errMsgProvider:oI,ignoredIssues:{}}),oIe(t.rules,t.maxLookahead,t.tokenTypes,t.ignoredIssues,t.errMsgProvider,t.grammarName)}var HV="MismatchedTokenException",UV="NoViableAltException",BV="EarlyExitException",VV="NotAllInputParsedException",jV=[HV,UV,BV,VV];Object.freeze(jV);function Bb(t){return Vr(jV,t.name)}function aI(t,e,r){this.name=HV,this.message=t,this.token=e,this.previousToken=r,this.resyncedTokens=[]}aI.prototype=Error.prototype;function WV(t,e,r){this.name=UV,this.message=t,this.token=e,this.previousToken=r,this.resyncedTokens=[]}WV.prototype=Error.prototype;function GV(t,e){this.name=VV,this.message=t,this.token=e,this.resyncedTokens=[]}GV.prototype=Error.prototype;function zV(t,e,r){this.name=BV,this.message=t,this.token=e,this.previousToken=r,this.resyncedTokens=[]}zV.prototype=Error.prototype;var M6={},YV="InRuleRecoveryException";function KV(t){this.name=YV,this.message=t}KV.prototype=Error.prototype;var NIe=function(){function t(){}return t.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Ue(e,"recoveryEnabled")?e.recoveryEnabled:Hn.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=PIe)},t.prototype.getTokenToInsert=function(e){var r=J7(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return r.isInsertedInRecovery=!0,r},t.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},t.prototype.tryInRepetitionRecovery=function(e,r,n,i){for(var o=this,a=this.findReSyncTokenType(),s=this.exportLexerState(),l=[],u=!1,c=this.LA(1),f=this.LA(1),h=function(){var d=o.LA(0),p=o.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:c,previous:d,ruleName:o.getCurrRuleFullName()}),m=new aI(p,c,o.LA(0));m.resyncedTokens=dv(l),o.SAVE_ERROR(m)};!u;)if(this.tokenMatcher(f,i)){h();return}else if(n.call(this)){h(),e.apply(this,r);return}else this.tokenMatcher(f,a)?u=!0:(f=this.SKIP_TOKEN(),this.addToResyncTokens(f,l));this.importLexerState(s)},t.prototype.shouldInRepetitionRecoveryBeTried=function(e,r,n){return!(n===!1||e===void 0||r===void 0||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,r)))},t.prototype.getFollowsForInRuleRecovery=function(e,r){var n=this.getCurrentGrammarPath(e,r),i=this.getNextPossibleTokenTypes(n);return i},t.prototype.tryInRuleRecovery=function(e,r){if(this.canRecoverWithSingleTokenInsertion(e,r)){var n=this.getTokenToInsert(e);return n}if(this.canRecoverWithSingleTokenDeletion(e)){var i=this.SKIP_TOKEN();return this.consumeToken(),i}throw new KV("sad sad panda")},t.prototype.canPerformInRuleRecovery=function(e,r){return this.canRecoverWithSingleTokenInsertion(e,r)||this.canRecoverWithSingleTokenDeletion(e)},t.prototype.canRecoverWithSingleTokenInsertion=function(e,r){var n=this;if(!this.canTokenTypeBeInsertedInRecovery(e)||Bt(r))return!1;var i=this.LA(1),o=Vf(r,function(a){return n.tokenMatcher(i,a)})!==void 0;return o},t.prototype.canRecoverWithSingleTokenDeletion=function(e){var r=this.tokenMatcher(this.LA(2),e);return r},t.prototype.isInCurrentRuleReSyncSet=function(e){var r=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(r);return Vr(n,e)},t.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),r=this.LA(1),n=2;;){var i=r.tokenType;if(Vr(e,i))return i;r=this.LA(n),n++}},t.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return M6;var e=this.getLastExplicitRuleShortName(),r=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:r,inRule:this.shortRuleNameToFullName(n)}},t.prototype.buildFullFollowKeyStack=function(){var e=this,r=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return Bt(this.LAST_EXPLICIT_RULE_STACK)||(r=_e(this.LAST_EXPLICIT_RULE_STACK,function(i){return e.RULE_STACK[i]}),n=_e(this.LAST_EXPLICIT_RULE_STACK,function(i){return e.RULE_OCCURRENCE_STACK[i]})),_e(r,function(i,o){return o===0?M6:{ruleName:e.shortRuleNameToFullName(i),idxInCallingRule:n[o],inRule:e.shortRuleNameToFullName(r[o-1])}})},t.prototype.flattenFollowSet=function(){var e=this,r=_e(this.buildFullFollowKeyStack(),function(n){return e.getFollowSetFromFollowKey(n)});return Wn(r)},t.prototype.getFollowSetFromFollowKey=function(e){if(e===M6)return[Ru];var r=e.ruleName+e.idxInCallingRule+AV+e.inRule;return this.resyncFollows[r]},t.prototype.addToResyncTokens=function(e,r){return this.tokenMatcher(e,Ru)||r.push(e),r},t.prototype.reSyncTo=function(e){for(var r=[],n=this.LA(1);this.tokenMatcher(n,e)===!1;)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,r);return dv(r)},t.prototype.attemptInRepetitionRecovery=function(e,r,n,i,o,a,s){},t.prototype.getCurrentGrammarPath=function(e,r){var n=this.getHumanReadableRuleStack(),i=Gn(this.RULE_OCCURRENCE_STACK),o={ruleStack:n,occurrenceStack:i,lastTok:e,lastTokOccurrence:r};return o},t.prototype.getHumanReadableRuleStack=function(){var e=this;return Bt(this.LAST_EXPLICIT_RULE_STACK)?_e(this.RULE_STACK,function(r){return e.shortRuleNameToFullName(r)}):_e(this.LAST_EXPLICIT_RULE_STACK,function(r){return e.shortRuleNameToFullName(e.RULE_STACK[r])})},t}();function PIe(t,e,r,n,i,o,a){var s=this.getKeyForAutomaticLookahead(n,i),l=this.firstAfterRepMap[s];if(l===void 0){var u=this.getCurrRuleFullName(),c=this.getGAstProductions()[u],f=new o(c,i);l=f.startWalking(),this.firstAfterRepMap[s]=l}var h=l.token,d=l.occurrence,p=l.isEndOfRule;this.RULE_STACK.length===1&&p&&h===void 0&&(h=Ru,d=1),this.shouldInRepetitionRecoveryBeTried(h,d,a)&&this.tryInRepetitionRecovery(t,e,r,h)}var MIe=function(){function t(){}return t.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=Ue(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:Hn.dynamicTokensEnabled,this.maxLookahead=Ue(e,"maxLookahead")?e.maxLookahead:Hn.maxLookahead,this.lookAheadFuncsCache=gM()?new Map:[],gM()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},t.prototype.preComputeLookaheadFunctions=function(e){var r=this;Be(e,function(n){r.TRACE_INIT(n.name+" Rule Lookahead",function(){var i=M7e(n),o=i.alternation,a=i.repetition,s=i.option,l=i.repetitionMandatory,u=i.repetitionMandatoryWithSeparator,c=i.repetitionWithSeparator;Be(o,function(f){var h=f.idx===0?"":f.idx;r.TRACE_INIT(""+Gi(f)+h,function(){var d=Z7e(f.idx,n,f.maxLookahead||r.maxLookahead,f.hasPredicates,r.dynamicTokensEnabled,r.lookAheadBuilderForAlternatives),p=Dp(r.fullRuleNameToShort[n.name],Yc,f.idx);r.setLaFuncCache(p,d)})}),Be(a,function(f){r.computeLookaheadFunc(n,f.idx,xp,Yt.REPETITION,f.maxLookahead,Gi(f))}),Be(s,function(f){r.computeLookaheadFunc(n,f.idx,Ub,Yt.OPTION,f.maxLookahead,Gi(f))}),Be(l,function(f){r.computeLookaheadFunc(n,f.idx,$p,Yt.REPETITION_MANDATORY,f.maxLookahead,Gi(f))}),Be(u,function(f){r.computeLookaheadFunc(n,f.idx,Dc,Yt.REPETITION_MANDATORY_WITH_SEPARATOR,f.maxLookahead,Gi(f))}),Be(c,function(f){r.computeLookaheadFunc(n,f.idx,Lp,Yt.REPETITION_WITH_SEPARATOR,f.maxLookahead,Gi(f))})})})},t.prototype.computeLookaheadFunc=function(e,r,n,i,o,a){var s=this;this.TRACE_INIT(""+a+(r===0?"":r),function(){var l=J7e(r,e,o||s.maxLookahead,s.dynamicTokensEnabled,i,s.lookAheadBuilderForOptional),u=Dp(s.fullRuleNameToShort[e.name],n,r);s.setLaFuncCache(u,l)})},t.prototype.lookAheadBuilderForOptional=function(e,r,n){return tIe(e,r,n)},t.prototype.lookAheadBuilderForAlternatives=function(e,r,n,i){return eIe(e,r,n,i)},t.prototype.getKeyForAutomaticLookahead=function(e,r){var n=this.getLastExplicitRuleShortName();return Dp(n,e,r)},t.prototype.getLaFuncFromCache=function(e){},t.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},t.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},t.prototype.setLaFuncCache=function(e,r){},t.prototype.setLaFuncCacheUsingMap=function(e,r){this.lookAheadFuncsCache.set(e,r)},t.prototype.setLaFuncUsingObj=function(e,r){this.lookAheadFuncsCache[e]=r},t}();function kIe(t){return xw(t.constructor)}var xIe=/^\s*function\s*(\S*)\s*\(/,FM="name";function xw(t){var e=t.name;if(e)return e;var r=t.toString().match(xIe)[1];return r}function XV(t,e){var r=Object.getOwnPropertyDescriptor(t,FM);return Ii(r)||r.configurable?(Object.defineProperty(t,FM,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0):!1}function $Ie(t,e){for(var r=Qa(t),n=r.length,i=0;i<n;i++)for(var o=r[i],a=t[o],s=a.length,l=0;l<s;l++){var u=a[l];u.tokenTypeIdx===void 0&&(u.fullName!==void 0?this[u.fullName](u.children,e):this[u.name](u.children,e))}}function LIe(t,e){var r=function(){};XV(r,t+"BaseSemantics");var n={visit:function(i,o){if(qi(i)&&(i=i[0]),!Ii(i))return i.fullName!==void 0?this[i.fullName](i.children,o):this[i.name](i.children,o)},validateVisitor:function(){var i=FIe(this,e);if(!Bt(i)){var o=_e(i,function(a){return a.msg});throw Error("Errors Detected in CST Visitor <"+xw(this.constructor)+`>:
	`+(""+o.join(`

`).replace(/\n/g,`
	`)))}}};return r.prototype=n,r.prototype.constructor=r,r._RULE_NAMES=e,r}function DIe(t,e,r){var n=function(){};XV(n,t+"BaseSemanticsWithDefaults");var i=Object.create(r.prototype);return Be(e,function(o){i[o]=$Ie}),n.prototype=i,n.prototype.constructor=n,n}var Vb;(function(t){t[t.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",t[t.MISSING_METHOD=1]="MISSING_METHOD"})(Vb||(Vb={}));function FIe(t,e){var r=HIe(t,e),n=BIe(t,e);return r.concat(n)}function HIe(t,e){var r=_e(e,function(n){if(!Zs(t[n]))return{msg:"Missing visitor method: <"+n+"> on "+xw(t.constructor)+" CST Visitor.",type:Vb.MISSING_METHOD,methodName:n}});return Xg(r)}var UIe=["constructor","visit","validateVisitor"];function BIe(t,e){var r=[];for(var n in t)Eu.test(n)&&Zs(t[n])&&!Vr(UIe,n)&&!Vr(e,n)&&r.push({msg:"Redundant visitor method: <"+n+"> on "+xw(t.constructor)+` CST Visitor
There is no Grammar Rule corresponding to this method's name.
`+("For utility methods on visitor classes use methods names that do not match /"+Eu.source+"/."),type:Vb.REDUNDANT_METHOD,methodName:n});return r}var VIe=function(){function t(){}return t.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=Ue(e,"outputCst")?e.outputCst:Hn.outputCst,this.nodeLocationTracking=Ue(e,"nodeLocationTracking")?e.nodeLocationTracking:Hn.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=jr,this.cstFinallyStateUpdate=jr,this.cstPostTerminal=jr,this.cstPostNonTerminal=jr,this.cstPostRule=jr,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=kM,this.setNodeLocationFromNode=kM,this.cstPostRule=jr,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=jr,this.setNodeLocationFromNode=jr,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=MM,this.setNodeLocationFromNode=MM,this.cstPostRule=jr,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=jr,this.setNodeLocationFromNode=jr,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=jr,this.setNodeLocationFromNode=jr,this.cstPostRule=jr,this.setInitialNodeLocation=jr;else throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"')},t.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},t.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},t.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},t.prototype.setInitialNodeLocationFullRegular=function(e){var r=this.LA(1);e.location={startOffset:r.startOffset,startLine:r.startLine,startColumn:r.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},t.prototype.cstNestedInvocationStateUpdate=function(e,r){var n={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},t.prototype.cstInvocationStateUpdate=function(e,r){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var n={name:e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},t.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},t.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},t.prototype.cstPostRuleFull=function(e){var r=this.LA(0),n=e.location;n.startOffset<=r.startOffset?(n.endOffset=r.endOffset,n.endLine=r.endLine,n.endColumn=r.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)},t.prototype.cstPostRuleOnlyOffset=function(e){var r=this.LA(0),n=e.location;n.startOffset<=r.startOffset?n.endOffset=r.endOffset:n.startOffset=NaN},t.prototype.cstPostTerminal=function(e,r){var n=this.CST_STACK[this.CST_STACK.length-1];W7e(n,r,e),this.setNodeLocationFromToken(n.location,r)},t.prototype.cstPostNonTerminal=function(e,r){if(this.isBackTracking()!==!0){var n=this.CST_STACK[this.CST_STACK.length-1];xM(n,r,e),this.setNodeLocationFromNode(n.location,e.location)}},t.prototype.getBaseCstVisitorConstructor=function(){if(Ii(this.baseCstVisitorConstructor)){var e=LIe(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},t.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(Ii(this.baseCstVisitorWithDefaultsConstructor)){var e=DIe(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},t.prototype.nestedRuleBeforeClause=function(e,r){var n;if(e.NAME!==void 0)return n=e.NAME,this.nestedRuleInvocationStateUpdate(n,r),n},t.prototype.nestedAltBeforeClause=function(e,r,n,i){var o=this.getLastExplicitRuleShortName(),a=IV(o,n,r,i),s;if(e.NAME!==void 0)return s=e.NAME,this.nestedRuleInvocationStateUpdate(s,a),{shortName:a,nestedName:s}},t.prototype.nestedRuleFinallyClause=function(e,r){var n=this.CST_STACK,i=n[n.length-1];this.nestedRuleFinallyStateUpdate();var o=n[n.length-1];xM(o,r,i),this.setNodeLocationFromNode(o.location,i.location)},t.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},t.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},t.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},t.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},t.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},t.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},t.prototype.nestedRuleInvocationStateUpdate=function(e,r){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(r),this.cstNestedInvocationStateUpdate(e,r)},t.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},t}(),jIe=function(){function t(){}return t.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(t.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),t.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):Wb},t.prototype.LA=function(e){var r=this.currIdx+e;return r<0||this.tokVectorLength<=r?Wb:this.tokVector[r]},t.prototype.consumeToken=function(){this.currIdx++},t.prototype.exportLexerState=function(){return this.currIdx},t.prototype.importLexerState=function(e){this.currIdx=e},t.prototype.resetLexerState=function(){this.currIdx=-1},t.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},t.prototype.getLexerPosition=function(){return this.exportLexerState()},t}(),WIe=function(){function t(){}return t.prototype.ACTION=function(e){return e.call(this)},t.prototype.consume=function(e,r,n){return this.consumeInternal(r,e,n)},t.prototype.subrule=function(e,r,n){return this.subruleInternal(r,e,n)},t.prototype.option=function(e,r){return this.optionInternal(r,e)},t.prototype.or=function(e,r){return this.orInternal(r,e)},t.prototype.many=function(e,r){return this.manyInternal(e,r)},t.prototype.atLeastOne=function(e,r){return this.atLeastOneInternal(e,r)},t.prototype.CONSUME=function(e,r){return this.consumeInternal(e,0,r)},t.prototype.CONSUME1=function(e,r){return this.consumeInternal(e,1,r)},t.prototype.CONSUME2=function(e,r){return this.consumeInternal(e,2,r)},t.prototype.CONSUME3=function(e,r){return this.consumeInternal(e,3,r)},t.prototype.CONSUME4=function(e,r){return this.consumeInternal(e,4,r)},t.prototype.CONSUME5=function(e,r){return this.consumeInternal(e,5,r)},t.prototype.CONSUME6=function(e,r){return this.consumeInternal(e,6,r)},t.prototype.CONSUME7=function(e,r){return this.consumeInternal(e,7,r)},t.prototype.CONSUME8=function(e,r){return this.consumeInternal(e,8,r)},t.prototype.CONSUME9=function(e,r){return this.consumeInternal(e,9,r)},t.prototype.SUBRULE=function(e,r){return this.subruleInternal(e,0,r)},t.prototype.SUBRULE1=function(e,r){return this.subruleInternal(e,1,r)},t.prototype.SUBRULE2=function(e,r){return this.subruleInternal(e,2,r)},t.prototype.SUBRULE3=function(e,r){return this.subruleInternal(e,3,r)},t.prototype.SUBRULE4=function(e,r){return this.subruleInternal(e,4,r)},t.prototype.SUBRULE5=function(e,r){return this.subruleInternal(e,5,r)},t.prototype.SUBRULE6=function(e,r){return this.subruleInternal(e,6,r)},t.prototype.SUBRULE7=function(e,r){return this.subruleInternal(e,7,r)},t.prototype.SUBRULE8=function(e,r){return this.subruleInternal(e,8,r)},t.prototype.SUBRULE9=function(e,r){return this.subruleInternal(e,9,r)},t.prototype.OPTION=function(e){return this.optionInternal(e,0)},t.prototype.OPTION1=function(e){return this.optionInternal(e,1)},t.prototype.OPTION2=function(e){return this.optionInternal(e,2)},t.prototype.OPTION3=function(e){return this.optionInternal(e,3)},t.prototype.OPTION4=function(e){return this.optionInternal(e,4)},t.prototype.OPTION5=function(e){return this.optionInternal(e,5)},t.prototype.OPTION6=function(e){return this.optionInternal(e,6)},t.prototype.OPTION7=function(e){return this.optionInternal(e,7)},t.prototype.OPTION8=function(e){return this.optionInternal(e,8)},t.prototype.OPTION9=function(e){return this.optionInternal(e,9)},t.prototype.OR=function(e){return this.orInternal(e,0)},t.prototype.OR1=function(e){return this.orInternal(e,1)},t.prototype.OR2=function(e){return this.orInternal(e,2)},t.prototype.OR3=function(e){return this.orInternal(e,3)},t.prototype.OR4=function(e){return this.orInternal(e,4)},t.prototype.OR5=function(e){return this.orInternal(e,5)},t.prototype.OR6=function(e){return this.orInternal(e,6)},t.prototype.OR7=function(e){return this.orInternal(e,7)},t.prototype.OR8=function(e){return this.orInternal(e,8)},t.prototype.OR9=function(e){return this.orInternal(e,9)},t.prototype.MANY=function(e){this.manyInternal(0,e)},t.prototype.MANY1=function(e){this.manyInternal(1,e)},t.prototype.MANY2=function(e){this.manyInternal(2,e)},t.prototype.MANY3=function(e){this.manyInternal(3,e)},t.prototype.MANY4=function(e){this.manyInternal(4,e)},t.prototype.MANY5=function(e){this.manyInternal(5,e)},t.prototype.MANY6=function(e){this.manyInternal(6,e)},t.prototype.MANY7=function(e){this.manyInternal(7,e)},t.prototype.MANY8=function(e){this.manyInternal(8,e)},t.prototype.MANY9=function(e){this.manyInternal(9,e)},t.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},t.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},t.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},t.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},t.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},t.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},t.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},t.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},t.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},t.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},t.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},t.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},t.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},t.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},t.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},t.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},t.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},t.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},t.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},t.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},t.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},t.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},t.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},t.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},t.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},t.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},t.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},t.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},t.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},t.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},t.prototype.RULE=function(e,r,n){if(n===void 0&&(n=Gb),Vr(this.definedRulesNames,e)){var i=oI.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),o={message:i,type:Qr.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(o)}this.definedRulesNames.push(e);var a=this.defineRule(e,r,n);return this[e]=a,a},t.prototype.OVERRIDE_RULE=function(e,r,n){n===void 0&&(n=Gb);var i=[];i=i.concat(pIe(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,i);var o=this.defineRule(e,r,n);return this[e]=o,o},t.prototype.BACKTRACK=function(e,r){return function(){this.isBackTrackingStack.push(1);var n=this.saveRecogState();try{return e.apply(this,r),!0}catch(i){if(Bb(i))return!1;throw i}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}},t.prototype.getGAstProductions=function(){return this.gastProductionsCache},t.prototype.getSerializedGastProductions=function(){return _7e(mn(this.gastProductionsCache))},t}(),GIe=function(){function t(){}return t.prototype.initRecognizerEngine=function(e,r){if(this.className=kIe(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=Fb,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Ue(r,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(qi(e)){if(Bt(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(qi(e))this.tokensMap=sn(e,function(a,s){return a[s.name]=s,a},{});else if(Ue(e,"modes")&&Ti(Wn(mn(e.modes)),E7e)){var n=Wn(mn(e.modes)),i=X7(n);this.tokensMap=sn(i,function(a,s){return a[s.name]=s,a},{})}else if(q7(e))this.tokensMap=Kg(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=Ru;var o=Ti(mn(e),function(a){return Bt(a.categoryMatches)});this.tokenMatcher=o?Fb:Pw,Qg(mn(this.tokensMap))},t.prototype.defineRule=function(e,r,n){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+`> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);var i=Ue(n,"resyncEnabled")?n.resyncEnabled:Gb.resyncEnabled,o=Ue(n,"recoveryValueFunc")?n.recoveryValueFunc:Gb.recoveryValueFunc,a=this.ruleShortNameIdx<<U7e+Js;this.ruleShortNameIdx++,this.shortRuleNameToFull[a]=e,this.fullRuleNameToShort[e]=a;function s(c){try{if(this.outputCst===!0){r.apply(this,c);var f=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(f),f}else return r.apply(this,c)}catch(h){return this.invokeRuleCatch(h,i,o)}finally{this.ruleFinallyStateUpdate()}}var l;l=function(c,f){return c===void 0&&(c=0),this.ruleInvocationStateUpdate(a,e,c),s.call(this,f)};var u="ruleName";return l[u]=e,l.originalGrammarAction=r,l},t.prototype.invokeRuleCatch=function(e,r,n){var i=this.RULE_STACK.length===1,o=r&&!this.isBackTracking()&&this.recoveryEnabled;if(Bb(e)){var a=e;if(o){var s=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(s))if(a.resyncedTokens=this.reSyncTo(s),this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];return l.recoveredNode=!0,l}else return n();else{if(this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];l.recoveredNode=!0,a.partialCstResult=l}throw a}}else{if(i)return this.moveToTerminatedState(),n();throw a}}else throw e},t.prototype.optionInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(Ub,r),i=this.nestedRuleBeforeClause(e,n);try{return this.optionInternalLogic(e,r,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},t.prototype.optionInternalNoCst=function(e,r){var n=this.getKeyForAutomaticLookahead(Ub,r);return this.optionInternalLogic(e,r,n)},t.prototype.optionInternalLogic=function(e,r,n){var i=this,o=this.getLaFuncFromCache(n),a,s;if(e.DEF!==void 0){if(a=e.DEF,s=e.GATE,s!==void 0){var l=o;o=function(){return s.call(i)&&l.call(i)}}}else a=e;if(o.call(this)===!0)return a.call(this)},t.prototype.atLeastOneInternal=function(e,r){var n=this.getKeyForAutomaticLookahead($p,e),i=this.nestedRuleBeforeClause(r,n);try{return this.atLeastOneInternalLogic(e,r,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},t.prototype.atLeastOneInternalNoCst=function(e,r){var n=this.getKeyForAutomaticLookahead($p,e);this.atLeastOneInternalLogic(e,r,n)},t.prototype.atLeastOneInternalLogic=function(e,r,n){var i=this,o=this.getLaFuncFromCache(n),a,s;if(r.DEF!==void 0){if(a=r.DEF,s=r.GATE,s!==void 0){var l=o;o=function(){return s.call(i)&&l.call(i)}}}else a=r;if(o.call(this)===!0)for(var u=this.doSingleRepetition(a);o.call(this)===!0&&u===!0;)u=this.doSingleRepetition(a);else throw this.raiseEarlyExitException(e,Yt.REPETITION_MANDATORY,r.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,r],o,$p,e,X7e)},t.prototype.atLeastOneSepFirstInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(Dc,e),i=this.nestedRuleBeforeClause(r,n);try{this.atLeastOneSepFirstInternalLogic(e,r,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},t.prototype.atLeastOneSepFirstInternalNoCst=function(e,r){var n=this.getKeyForAutomaticLookahead(Dc,e);this.atLeastOneSepFirstInternalLogic(e,r,n)},t.prototype.atLeastOneSepFirstInternalLogic=function(e,r,n){var i=this,o=r.DEF,a=r.SEP,s=this.getLaFuncFromCache(n);if(s.call(this)===!0){o.call(this);for(var l=function(){return i.tokenMatcher(i.LA(1),a)};this.tokenMatcher(this.LA(1),a)===!0;)this.CONSUME(a),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,a,l,o,LM],l,Dc,e,LM)}else throw this.raiseEarlyExitException(e,Yt.REPETITION_MANDATORY_WITH_SEPARATOR,r.ERR_MSG)},t.prototype.manyInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(xp,e),i=this.nestedRuleBeforeClause(r,n);try{return this.manyInternalLogic(e,r,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},t.prototype.manyInternalNoCst=function(e,r){var n=this.getKeyForAutomaticLookahead(xp,e);return this.manyInternalLogic(e,r,n)},t.prototype.manyInternalLogic=function(e,r,n){var i=this,o=this.getLaFuncFromCache(n),a,s;if(r.DEF!==void 0){if(a=r.DEF,s=r.GATE,s!==void 0){var l=o;o=function(){return s.call(i)&&l.call(i)}}}else a=r;for(var u=!0;o.call(this)===!0&&u===!0;)u=this.doSingleRepetition(a);this.attemptInRepetitionRecovery(this.manyInternal,[e,r],o,xp,e,K7e,u)},t.prototype.manySepFirstInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(Lp,e),i=this.nestedRuleBeforeClause(r,n);try{this.manySepFirstInternalLogic(e,r,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},t.prototype.manySepFirstInternalNoCst=function(e,r){var n=this.getKeyForAutomaticLookahead(Lp,e);this.manySepFirstInternalLogic(e,r,n)},t.prototype.manySepFirstInternalLogic=function(e,r,n){var i=this,o=r.DEF,a=r.SEP,s=this.getLaFuncFromCache(n);if(s.call(this)===!0){o.call(this);for(var l=function(){return i.tokenMatcher(i.LA(1),a)};this.tokenMatcher(this.LA(1),a)===!0;)this.CONSUME(a),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,a,l,o,$M],l,Lp,e,$M)}},t.prototype.repetitionSepSecondInternal=function(e,r,n,i,o){for(;n();)this.CONSUME(r),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,r,n,i,o],n,Dc,e,o)},t.prototype.doSingleRepetition=function(e){var r=this.getLexerPosition();e.call(this);var n=this.getLexerPosition();return n>r},t.prototype.orInternalNoCst=function(e,r){var n=qi(e)?e:e.DEF,i=this.getKeyForAutomaticLookahead(Yc,r),o=this.getLaFuncFromCache(i),a=o.call(this,n);if(a!==void 0){var s=n[a];return s.ALT.call(this)}this.raiseNoAltException(r,e.ERR_MSG)},t.prototype.orInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(Yc,r),i=this.nestedRuleBeforeClause(e,n);try{var o=qi(e)?e:e.DEF,a=this.getLaFuncFromCache(n),s=a.call(this,o);if(s!==void 0){var l=o[s],u=this.nestedAltBeforeClause(l,r,Yc,s);try{return l.ALT.call(this)}finally{u!==void 0&&this.nestedRuleFinallyClause(u.shortName,u.nestedName)}}this.raiseNoAltException(r,e.ERR_MSG)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},t.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var e=this.LA(1),r=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new GV(r,e))}},t.prototype.subruleInternal=function(e,r,n){var i;try{var o=n!==void 0?n.ARGS:void 0;return i=e.call(this,r,o),this.cstPostNonTerminal(i,n!==void 0&&n.LABEL!==void 0?n.LABEL:e.ruleName),i}catch(a){this.subruleInternalError(a,n,e.ruleName)}},t.prototype.subruleInternalError=function(e,r,n){throw Bb(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,r!==void 0&&r.LABEL!==void 0?r.LABEL:n),delete e.partialCstResult),e},t.prototype.consumeInternal=function(e,r,n){var i;try{var o=this.LA(1);this.tokenMatcher(o,e)===!0?(this.consumeToken(),i=o):this.consumeInternalError(e,o,n)}catch(a){i=this.consumeInternalRecovery(e,r,a)}return this.cstPostTerminal(n!==void 0&&n.LABEL!==void 0?n.LABEL:e.name,i),i},t.prototype.consumeInternalError=function(e,r,n){var i,o=this.LA(0);throw n!==void 0&&n.ERR_MSG?i=n.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:r,previous:o,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new aI(i,r,o))},t.prototype.consumeInternalRecovery=function(e,r,n){if(this.recoveryEnabled&&n.name==="MismatchedTokenException"&&!this.isBackTracking()){var i=this.getFollowsForInRuleRecovery(e,r);try{return this.tryInRuleRecovery(e,i)}catch(o){throw o.name===YV?n:o}}else throw n},t.prototype.saveRecogState=function(){var e=this.errors,r=Gn(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:r,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},t.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},t.prototype.ruleInvocationStateUpdate=function(e,r,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(r,e)},t.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},t.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},t.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},t.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),Ru)},t.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},t}(),zIe=function(){function t(){}return t.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=Iw(e.errorMessageProvider,Hn.errorMessageProvider)},t.prototype.SAVE_ERROR=function(e){if(Bb(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Gn(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(t.prototype,"errors",{get:function(){return Gn(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),t.prototype.raiseEarlyExitException=function(e,r,n){for(var i=this.getCurrRuleFullName(),o=this.getGAstProductions()[i],a=rI(e,o,r,this.maxLookahead),s=a[0],l=[],u=1;u<=this.maxLookahead;u++)l.push(this.LA(u));var c=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:s,actual:l,previous:this.LA(0),customUserDescription:n,ruleName:i});throw this.SAVE_ERROR(new zV(c,this.LA(1),this.LA(0)))},t.prototype.raiseNoAltException=function(e,r){for(var n=this.getCurrRuleFullName(),i=this.getGAstProductions()[n],o=tI(e,i,this.maxLookahead),a=[],s=1;s<=this.maxLookahead;s++)a.push(this.LA(s));var l=this.LA(0),u=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:o,actual:a,previous:l,customUserDescription:r,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new WV(u,this.LA(1),l))},t}(),YIe=function(){function t(){}return t.prototype.initContentAssist=function(){},t.prototype.computeContentAssist=function(e,r){var n=this.gastProductionsCache[e];if(Ii(n))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return NV([n],r,this.tokenMatcher,this.maxLookahead)},t.prototype.getNextPossibleTokenTypes=function(e){var r=Ai(e.ruleStack),n=this.getGAstProductions(),i=n[r],o=new Y7e(i,e).startWalking();return o},t}(),$w={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze($w);var HM=!0,UM=Math.pow(2,Js)-1,qV=gt({name:"RECORDING_PHASE_TOKEN",pattern:jn.NA});Qg([qV]);var QV=J7(qV,`This IToken indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(QV);var KIe={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,children:{}},XIe=function(){function t(){}return t.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},t.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var r=function(i){var o=i>0?i:"";e["CONSUME"+o]=function(a,s){return this.consumeInternalRecord(a,i,s)},e["SUBRULE"+o]=function(a,s){return this.subruleInternalRecord(a,i,s)},e["OPTION"+o]=function(a){return this.optionInternalRecord(a,i)},e["OR"+o]=function(a){return this.orInternalRecord(a,i)},e["MANY"+o]=function(a){this.manyInternalRecord(i,a)},e["MANY_SEP"+o]=function(a){this.manySepFirstInternalRecord(i,a)},e["AT_LEAST_ONE"+o]=function(a){this.atLeastOneInternalRecord(i,a)},e["AT_LEAST_ONE_SEP"+o]=function(a){this.atLeastOneSepFirstInternalRecord(i,a)}},n=0;n<10;n++)r(n);e.consume=function(i,o,a){return this.consumeInternalRecord(o,i,a)},e.subrule=function(i,o,a){return this.subruleInternalRecord(o,i,a)},e.option=function(i,o){return this.optionInternalRecord(o,i)},e.or=function(i,o){return this.orInternalRecord(o,i)},e.many=function(i,o){this.manyInternalRecord(i,o)},e.atLeastOne=function(i,o){this.atLeastOneInternalRecord(i,o)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD})},t.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var r=0;r<10;r++){var n=r>0?r:"";delete e["CONSUME"+n],delete e["SUBRULE"+n],delete e["OPTION"+n],delete e["OR"+n],delete e["MANY"+n],delete e["MANY_SEP"+n],delete e["AT_LEAST_ONE"+n],delete e["AT_LEAST_ONE_SEP"+n]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})},t.prototype.ACTION_RECORD=function(e){},t.prototype.BACKTRACK_RECORD=function(e,r){return function(){return!0}},t.prototype.LA_RECORD=function(e){return Wb},t.prototype.topLevelRuleRecord=function(e,r){try{var n=new Id({definition:[],name:e});return n.name=e,this.recordingProdStack.push(n),r.call(this),this.recordingProdStack.pop(),n}catch(i){if(i.KNOWN_RECORDER_ERROR!==!0)try{i.message=i.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording`}catch{throw i}throw i}},t.prototype.optionInternalRecord=function(e,r){return Qd.call(this,an,e,r)},t.prototype.atLeastOneInternalRecord=function(e,r){Qd.call(this,Ni,r,e)},t.prototype.atLeastOneSepFirstInternalRecord=function(e,r){Qd.call(this,Pi,r,e,HM)},t.prototype.manyInternalRecord=function(e,r){Qd.call(this,_r,r,e)},t.prototype.manySepFirstInternalRecord=function(e,r){Qd.call(this,ci,r,e,HM)},t.prototype.orInternalRecord=function(e,r){return qIe.call(this,e,r)},t.prototype.subruleInternalRecord=function(e,r,n){if(jb(r),!e||Ue(e,"ruleName")===!1){var i=new Error("<SUBRULE"+BM(r)+"> argument is invalid"+(" expecting a Parser method reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var o=Lb(this.recordingProdStack),a=e.ruleName,s=new ui({idx:r,nonTerminalName:a,referencedRule:void 0});return o.definition.push(s),this.outputCst?KIe:$w},t.prototype.consumeInternalRecord=function(e,r,n){if(jb(r),!TV(e)){var i=new Error("<CONSUME"+BM(r)+"> argument is invalid"+(" expecting a TokenType reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var o=Lb(this.recordingProdStack),a=new cr({idx:r,terminalType:e});return o.definition.push(a),QV},t}();function Qd(t,e,r,n){n===void 0&&(n=!1),jb(r);var i=Lb(this.recordingProdStack),o=Zs(e)?e:e.DEF,a=new t({definition:[],idx:r});return Ue(e,"NAME")&&(a.name=e.NAME),n&&(a.separator=e.SEP),Ue(e,"MAX_LOOKAHEAD")&&(a.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(a),o.call(this),i.definition.push(a),this.recordingProdStack.pop(),$w}function qIe(t,e){var r=this;jb(e);var n=Lb(this.recordingProdStack),i=qi(t)===!1,o=i===!1?t:t.DEF,a=new fi({definition:[],idx:e,ignoreAmbiguities:i&&t.IGNORE_AMBIGUITIES===!0});Ue(t,"NAME")&&(a.name=t.NAME),Ue(t,"MAX_LOOKAHEAD")&&(a.maxLookahead=t.MAX_LOOKAHEAD);var s=dV(o,function(l){return Zs(l.GATE)});return a.hasPredicates=s,n.definition.push(a),Be(o,function(l){var u=new zn({definition:[]});a.definition.push(u),Ue(l,"NAME")&&(u.name=l.NAME),Ue(l,"IGNORE_AMBIGUITIES")?u.ignoreAmbiguities=l.IGNORE_AMBIGUITIES:Ue(l,"GATE")&&(u.ignoreAmbiguities=!0),r.recordingProdStack.push(u),l.ALT.call(r),r.recordingProdStack.pop()}),$w}function BM(t){return t===0?"":""+t}function jb(t){if(t<0||t>UM){var e=new Error("Invalid DSL Method idx value: <"+t+`>
	`+("Idx value must be a none negative value smaller than "+(UM+1)));throw e.KNOWN_RECORDER_ERROR=!0,e}}var QIe=function(){function t(){}return t.prototype.initPerformanceTracer=function(e){if(Ue(e,"traceInitPerf")){var r=e.traceInitPerf,n=typeof r=="number";this.traceInitMaxIdent=n?r:1/0,this.traceInitPerf=n?r>0:r}else this.traceInitMaxIdent=0,this.traceInitPerf=Hn.traceInitPerf;this.traceInitIndent=-1},t.prototype.TRACE_INIT=function(e,r){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--> <"+e+">");var i=vV(r),o=i.time,a=i.value,s=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(n+"<-- <"+e+"> time: "+o+"ms"),this.traceInitIndent--,a}else return r()},t}(),ZV=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Wb=J7(Ru,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(Wb);var Hn=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:FV,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),Gb=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),Qr;(function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",t[t.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",t[t.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",t[t.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",t[t.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",t[t.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",t[t.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"})(Qr||(Qr={}));function ZIe(t){return t===void 0&&(t=void 0),function(){return t}}var sI=function(){function t(e,r){r===void 0&&(r=Hn),this.ignoredIssues=Hn.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var n=this;n.initErrorHandler(r),n.initLexerAdapter(),n.initLooksAhead(r),n.initRecognizerEngine(e,r),n.initRecoverable(r),n.initTreeBuilder(r),n.initContentAssist(),n.initGastRecorder(r),n.initPerformanceTracer(r),Ue(r,"ignoredIssues")&&r.ignoredIssues!==Hn.ignoredIssues&&Q7(`The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.`),this.ignoredIssues=Ue(r,"ignoredIssues")?r.ignoredIssues:Hn.ignoredIssues,this.skipValidations=Ue(r,"skipValidations")?r.skipValidations:Hn.skipValidations}return t.performSelfAnalysis=function(e){e.performSelfAnalysis()},t.prototype.performSelfAnalysis=function(){var e=this;this.TRACE_INIT("performSelfAnalysis",function(){var r;e.selfAnalysisDone=!0;var n=e.className;e.TRACE_INIT("toFastProps",function(){mV(e)}),e.TRACE_INIT("Grammar Recording",function(){try{e.enableRecording(),Be(e.definedRulesNames,function(o){var a=e[o],s=a.originalGrammarAction,l=void 0;e.TRACE_INIT(o+" Rule",function(){l=e.topLevelRuleRecord(o,s)}),e.gastProductionsCache[o]=l})}finally{e.disableRecording()}});var i=[];if(e.TRACE_INIT("Grammar Resolving",function(){i=AIe({rules:mn(e.gastProductionsCache)}),e.definitionErrors.push.apply(e.definitionErrors,i)}),e.TRACE_INIT("Grammar Validations",function(){if(Bt(i)&&e.skipValidations===!1){var o=IIe({rules:mn(e.gastProductionsCache),maxLookahead:e.maxLookahead,tokenTypes:mn(e.tokensMap),ignoredIssues:e.ignoredIssues,errMsgProvider:oI,grammarName:n});e.definitionErrors.push.apply(e.definitionErrors,o)}}),Bt(e.definitionErrors)&&(e.recoveryEnabled&&e.TRACE_INIT("computeAllProdsFollows",function(){var o=F7e(mn(e.gastProductionsCache));e.resyncFollows=o}),e.TRACE_INIT("ComputeLookaheadFunctions",function(){e.preComputeLookaheadFunctions(mn(e.gastProductionsCache))})),e.TRACE_INIT("expandAllNestedRuleNames",function(){var o=G7e(mn(e.gastProductionsCache),e.fullRuleNameToShort);e.allRuleNames=o.allRuleNames}),!t.DEFER_DEFINITION_ERRORS_HANDLING&&!Bt(e.definitionErrors))throw r=_e(e.definitionErrors,function(o){return o.message}),new Error(`Parser Definition Errors detected:
 `+r.join(`
-------------------------------
`))})},t.DEFER_DEFINITION_ERRORS_HANDLING=!1,t}();UAe(sI,[NIe,MIe,VIe,jIe,GIe,WIe,zIe,YIe,XIe,QIe]);(function(t){ZV(e,t);function e(r,n){n===void 0&&(n=Hn);var i=this,o=Kg(n);return o.outputCst=!0,i=t.call(this,r,o)||this,i}return e})(sI);var JIe=function(t){ZV(e,t);function e(r,n){n===void 0&&(n=Hn);var i=this,o=Kg(n);return o.outputCst=!1,i=t.call(this,r,o)||this,i}return e}(sI);/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const VM=(t,e)=>({type:t,message:e});var Or;(function(t){t.LexingError="LexingError",t.ParserError="ParsingError",t.StaticOffsetError="StaticOffsetError",t.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",t.RangeOffsetNotAllowed="RangeOffsetNotAllowed"})(Or||(Or={}));var P;(function(t){t.EMPTY="EMPTY",t.NUMBER="NUMBER",t.STRING="STRING",t.MINUS_UNARY_OP="MINUS_UNARY_OP",t.PLUS_UNARY_OP="PLUS_UNARY_OP",t.PERCENT_OP="PERCENT_OP",t.CONCATENATE_OP="CONCATENATE_OP",t.EQUALS_OP="EQUALS_OP",t.NOT_EQUAL_OP="NOT_EQUAL_OP",t.GREATER_THAN_OP="GREATER_THAN_OP",t.LESS_THAN_OP="LESS_THAN_OP",t.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",t.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",t.PLUS_OP="PLUS_OP",t.MINUS_OP="MINUS_OP",t.TIMES_OP="TIMES_OP",t.DIV_OP="DIV_OP",t.POWER_OP="POWER_OP",t.FUNCTION_CALL="FUNCTION_CALL",t.NAMED_EXPRESSION="NAMED_EXPRESSION",t.PARENTHESIS="PARENTHESES",t.CELL_REFERENCE="CELL_REFERENCE",t.CELL_RANGE="CELL_RANGE",t.COLUMN_RANGE="COLUMN_RANGE",t.ROW_RANGE="ROW_RANGE",t.ERROR="ERROR",t.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",t.ARRAY="ARRAY"})(P||(P={}));var Oi;(function(t){t[t.RELATIVE=0]="RELATIVE",t[t.START_ABSOLUTE=1]="START_ABSOLUTE",t[t.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"})(Oi||(Oi={}));const e4e=t=>({type:P.EMPTY,leadingWhitespace:t==null?void 0:t.image}),t4e=(t,e)=>({type:P.NUMBER,value:t,leadingWhitespace:e==null?void 0:e.image}),r4e=t=>{var e;return{type:P.STRING,value:t.image.slice(1,-1),leadingWhitespace:(e=t.leadingWhitespace)===null||e===void 0?void 0:e.image}},jM=(t,e)=>({type:P.CELL_REFERENCE,reference:t,leadingWhitespace:e==null?void 0:e.image}),WM=(t,e,r,n)=>(lI(t,e,r),{type:P.CELL_RANGE,start:t,end:e,sheetReferenceType:r,leadingWhitespace:n}),n4e=(t,e,r,n)=>(lI(t,e,r),{type:P.COLUMN_RANGE,start:t,end:e,sheetReferenceType:r,leadingWhitespace:n==null?void 0:n.image}),i4e=(t,e,r,n)=>(lI(t,e,r),{type:P.ROW_RANGE,start:t,end:e,sheetReferenceType:r,leadingWhitespace:n==null?void 0:n.image}),o4e=(t,e,r)=>({type:P.CONCATENATE_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),a4e=(t,e,r)=>({type:P.EQUALS_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),s4e=(t,e,r)=>({type:P.NOT_EQUAL_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),l4e=(t,e,r)=>({type:P.GREATER_THAN_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),u4e=(t,e,r)=>({type:P.LESS_THAN_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),c4e=(t,e,r)=>({type:P.GREATER_THAN_OR_EQUAL_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),f4e=(t,e,r)=>({type:P.LESS_THAN_OR_EQUAL_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),h4e=(t,e,r)=>({type:P.PLUS_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),d4e=(t,e,r)=>({type:P.MINUS_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),p4e=(t,e,r)=>({type:P.TIMES_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),m4e=(t,e,r)=>({type:P.DIV_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),v4e=(t,e,r)=>({type:P.POWER_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),g4e=(t,e)=>({type:P.MINUS_UNARY_OP,value:t,leadingWhitespace:e==null?void 0:e.image}),y4e=(t,e)=>({type:P.PLUS_UNARY_OP,value:t,leadingWhitespace:e==null?void 0:e.image}),b4e=(t,e)=>({type:P.PERCENT_OP,value:t,leadingWhitespace:e==null?void 0:e.image}),w4e=(t,e,r,n,i)=>({type:P.FUNCTION_CALL,procedureName:t,args:e,leadingWhitespace:r==null?void 0:r.image,internalWhitespace:n==null?void 0:n.image,hyperlink:i}),GM=(t,e,r)=>({type:P.ARRAY,args:t,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:r==null?void 0:r.image}),S4e=(t,e)=>({type:P.NAMED_EXPRESSION,expressionName:t,leadingWhitespace:e==null?void 0:e.image}),R4e=(t,e,r)=>({type:P.PARENTHESIS,expression:t,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:r==null?void 0:r.image}),Co=(t,e)=>({type:P.ERROR,error:t,leadingWhitespace:e==null?void 0:e.image}),nc=(t,e,r)=>({type:P.ERROR_WITH_RAW_INPUT,error:e,rawInput:t,leadingWhitespace:r==null?void 0:r.image}),f5=()=>({type:P.ERROR,error:C.parsingError()});function lI(t,e,r){if(t.sheet!==void 0&&e.sheet===void 0||t.sheet===void 0&&e.sheet!==void 0)throw new Error("Start address inconsistent with end address");if(t.sheet===void 0&&r!==Oi.RELATIVE||t.sheet!==void 0&&r===Oi.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function bt(t,e){return(e??"")+t}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const JV={[P.PLUS_OP]:"+",[P.MINUS_OP]:"-",[P.TIMES_OP]:"*",[P.DIV_OP]:"/",[P.CONCATENATE_OP]:"&",[P.POWER_OP]:"^",[P.EQUALS_OP]:"=",[P.NOT_EQUAL_OP]:"<>",[P.GREATER_THAN_OP]:">",[P.GREATER_THAN_OR_EQUAL_OP]:">=",[P.LESS_THAN_OP]:"<",[P.LESS_THAN_OR_EQUAL_OP]:"<="};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const E4e=(t,e,r,n)=>({ast:t,relativeDependencies:e,hasVolatileFunction:r,hasStructuralChangeFunction:n});class C4e{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,r){const n=Dw(r,this.functionRegistry),i=E4e(r,n,ds(r,this.functionRegistry.isFunctionVolatile),ds(r,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,i),i}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,r){const n=this.cache.get(e);return n!==void 0?n.ast:(this.set(e,r),r)}}const ds=(t,e)=>{switch(t.type){case P.EMPTY:case P.NUMBER:case P.STRING:case P.ERROR:case P.ERROR_WITH_RAW_INPUT:case P.CELL_REFERENCE:case P.CELL_RANGE:case P.COLUMN_RANGE:case P.ROW_RANGE:case P.NAMED_EXPRESSION:return!1;case P.PERCENT_OP:case P.PLUS_UNARY_OP:case P.MINUS_UNARY_OP:return ds(t.value,e);case P.CONCATENATE_OP:case P.EQUALS_OP:case P.NOT_EQUAL_OP:case P.LESS_THAN_OP:case P.GREATER_THAN_OP:case P.LESS_THAN_OR_EQUAL_OP:case P.GREATER_THAN_OR_EQUAL_OP:case P.MINUS_OP:case P.PLUS_OP:case P.TIMES_OP:case P.DIV_OP:case P.POWER_OP:return ds(t.left,e)||ds(t.right,e);case P.PARENTHESIS:return ds(t.expression,e);case P.FUNCTION_CALL:return e(t.procedureName)?!0:t.args.some(r=>ds(r,e));case P.ARRAY:return t.args.some(r=>r.some(n=>ds(n,e)))}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class x{}x.DistinctSigns="Distinct signs.";x.WrongArgNumber="Wrong number of arguments.";x.EmptyArg="Empty function argument.";x.EmptyArray="Empty array not allowed.";x.ArrayDimensions="Array dimensions are not compatible.";x.NoSpaceForArrayResult="No space for array result.";x.ValueSmall="Value too small.";x.ValueLarge="Value too large.";x.BadCriterion="Incorrect criterion.";x.RangeManySheets="Range spans more than one sheet.";x.CellRangeExpected="Cell range expected.";x.WrongDimension="Wrong range dimension.";x.ScalarExpected="Cell range not allowed.";x.NumberCoercion="Value cannot be coerced to number.";x.NumberExpected="Number argument expected.";x.IntegerExpected="Value needs to be an integer.";x.BadMode="Mode not recognized.";x.DateBounds="Date outside of bounds.";x.OutOfSheet="Resulting reference is out of the sheet.";x.WrongType="Wrong type of argument.";x.NaN="NaN or infinite value encountered.";x.EqualLength="Ranges need to be of equal length.";x.Negative="Value cannot be negative.";x.NotBinary="String does not represent a binary number.";x.NotOctal="String does not represent an octal number.";x.NotHex="String does not represent a hexadecimal number.";x.EndStartPeriod="End period needs to be at least start period.";x.CellRefExpected="Cell reference expected.";x.EmptyRange="Empty range not allowed.";x.BadRef="Address is not correct.";x.NumberRange="Number-only range expected.";x.ValueNotFound="Value not found.";x.ValueBaseLarge="Value in base too large.";x.ValueBaseSmall="Value in base too small.";x.ValueBaseLong="Value in base too long.";x.NegativeLength="Length cannot be negative.";x.PatternNotFound="Pattern not found.";x.OneValue="Needs at least one value.";x.TwoValues="Range needs to contain at least two elements.";x.ThreeValues="Range needs to contain at least three elements.";x.IndexBounds="Index out of bounds.";x.IndexLarge="Index too large.";x.Formula="Expected formula.";x.NegativeCount="Count cannot be negative.";x.ParseError="Parsing error.";x.SheetRef="Sheet does not exist.";x.PeriodLong="Period number cannot exceed life length.";x.InvalidDate="Invalid date.";x.BitshiftLong="Result of bitshift is too long.";x.EmptyString="Empty-string argument not allowed.";x.LengthBounds="Length out of bounds.";x.NegativeTime="Time cannot be negative.";x.NoDefault="No default option.";x.NoConditionMet="None of the conditions were met.";x.Selector="Selector cannot exceed the number of arguments.";x.StartEndDate="Start date needs to be earlier than end date.";x.IncorrectDateTime="String does not represent correct DateTime.";x.CharacterCodeBounds="Character code out of bounds.";x.NonZero="Argument cannot be 0.";x.LessThanOne="Argument cannot be less than 1.";x.WeekendString="Incorrect weekend bitmask string.";x.InvalidRoman="Invalid roman numeral.";x.WrongOrder="Wrong order of values.";x.ComplexNumberExpected="Complex number expected.";x.ShouldBeIorJ="Should be 'i' or 'j'.";x.SizeMismatch="Array dimensions mismatched.";x.FunctionName=t=>`Function name ${t} not recognized.`;x.NamedExpressionName=t=>`Named expression ${t} not recognized.`;x.LicenseKey=t=>`License key is ${t}.`;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class O4e{constructor(){this.POSSIBLE_START_CHARACTERS=[...uV,...IAe,_n,"'","_"],this.cellReferenceRegexp=new RegExp(AAe,"y")}match(e,r){this.cellReferenceRegexp.lastIndex=r;const n=this.cellReferenceRegexp.exec(e+"@");return n==null||n[1]==null?null:(n[0]=n[1],n)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class T4e{constructor(){this.POSSIBLE_START_CHARACTERS=[...uV,"_"],this.namedExpressionRegexp=new RegExp(lV,"y"),this.r1c1CellRefRegexp=new RegExp(`^${sV}$`)}match(e,r){this.namedExpressionRegexp.lastIndex=r;const n=this.namedExpressionRegexp.exec(e);return n==null||n[0]==null||this.r1c1CellRefRegexp.test(n[0])?null:n}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const pv=gt({name:"AdditionOp",pattern:jn.NA}),h5=gt({name:"PlusOp",pattern:/\+/,categories:pv}),d5=gt({name:"MinusOp",pattern:/-/,categories:pv}),Lw=gt({name:"MultiplicationOp",pattern:jn.NA}),ej=gt({name:"TimesOp",pattern:/\*/,categories:Lw}),tj=gt({name:"DivOp",pattern:/\//,categories:Lw}),p5=gt({name:"PowerOp",pattern:/\^/}),rj=gt({name:"PercentOp",pattern:/%/}),el=gt({name:"BooleanOp",pattern:jn.NA}),m5=gt({name:"EqualsOp",pattern:/=/,categories:el}),nj=gt({name:"NotEqualOp",pattern:/<>/,categories:el}),ij=gt({name:"GreaterThanOp",pattern:/>/,categories:el}),oj=gt({name:"LessThanOp",pattern:/</,categories:el}),aj=gt({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:el}),sj=gt({name:"LessThanOrEqualOp",pattern:/<=/,categories:el}),lj=gt({name:"ConcatenateOp",pattern:/&/}),v5=gt({name:"LParen",pattern:/\(/}),o0=gt({name:"RParen",pattern:/\)/}),uj=gt({name:"ArrayLParen",pattern:/{/}),cj=gt({name:"ArrayRParen",pattern:/}/}),fj=gt({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),hj=gt({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),mv=gt({name:"RangeSeparator",pattern:new RegExp(Yg)}),uI=gt({name:"ColumnRange",pattern:new RegExp(`${dM}${Yg}${dM}`)}),cI=gt({name:"RowRange",pattern:new RegExp(`${pM}${Yg}${pM}`)}),fI=gt({name:"ProcedureName",pattern:new RegExp(`([${Ow}][${Y7}]*)\\(`)}),k6=new O4e,Cs=gt({name:"CellReference",pattern:k6.match.bind(k6),start_chars_hint:k6.POSSIBLE_START_CHARACTERS,line_breaks:!1}),x6=new T4e,dj=gt({name:"NamedExpression",pattern:x6.match.bind(x6),start_chars_hint:x6.POSSIBLE_START_CHARACTERS,line_breaks:!1}),hI=t=>{const e=t.translationPackage.getFunctionTranslation("OFFSET"),r=t.errorMapping,n=t.translationPackage.buildFunctionMapping(),i=new RegExp(t.ignoreWhiteSpace==="standard"?TAe:OAe),o=gt({name:"WhiteSpace",pattern:i}),a=gt({name:"ArrayRowSep",pattern:t.arrayRowSeparator}),s=gt({name:"ArrayColSep",pattern:t.arrayColumnSeparator}),l=gt({name:"NumberLiteral",pattern:new RegExp(`(([${t.decimalSeparator}]\\d+)|(\\d+([${t.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),u=gt({name:"OffsetProcedureName",pattern:new RegExp(e,"i")});let c,f;t.functionArgSeparator===t.arrayColumnSeparator?(c=s,f=[]):t.functionArgSeparator===t.arrayRowSeparator?(c=a,f=[]):(c=gt({name:"ArgSeparator",pattern:t.functionArgSeparator}),f=[c]);const h=[o,h5,d5,ej,tj,p5,m5,nj,rj,aj,sj,ij,oj,v5,o0,uj,cj,u,fI,mv,...f,uI,cI,l,fj,hj,lj,el,pv,Lw,Cs,dj,a,s];return{ArgSeparator:c,NumberLiteral:l,OffsetProcedureName:u,ArrayRowSeparator:a,ArrayColSeparator:s,WhiteSpace:o,allTokens:h,errorMapping:r,functionMapping:n,decimalSeparator:t.decimalSeparator,maxColumns:t.maxColumns,maxRows:t.maxRows}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Fc extends JIe{constructor(e,r){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",()=>this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:ZIe(e4e())}])),this.procedureExpression=this.RULE("procedureExpression",()=>{var n;const i=this.CONSUME(fI),o=i.image.toUpperCase().slice(0,-1),a=(n=this.lexerConfig.functionMapping[o])!==null&&n!==void 0?n:o,s=[];let l=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY(()=>{var c;const f=this.CONSUME(this.lexerConfig.ArgSeparator);l.type===P.EMPTY&&(l.leadingWhitespace=(c=f.leadingWhitespace)===null||c===void 0?void 0:c.image),s.push(l),l=this.SUBRULE2(this.booleanExpressionOrEmpty)}),s.push(l),s.length===1&&s[0].type===P.EMPTY&&(s.length=0);const u=this.CONSUME(o0);return w4e(a,s,i.leadingWhitespace,u.leadingWhitespace)}),this.namedExpressionExpression=this.RULE("namedExpressionExpression",()=>{const n=this.CONSUME(dj);return S4e(n.image,n.leadingWhitespace)}),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",()=>{const n=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(v5),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{n.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(o0),this.handleOffsetHeuristic(n)}),this.columnRangeExpression=this.RULE("columnRangeExpression",()=>{const n=this.CONSUME(uI),[i,o]=n.image.split(":"),a=this.ACTION(()=>kb(this.sheetMapping,i,this.formulaAddress)),s=this.ACTION(()=>kb(this.sheetMapping,o,this.formulaAddress));if(a===void 0||s===void 0)return Co(new C(N.REF));if(a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||s.exceedsSheetSizeLimits(this.lexerConfig.maxColumns))return nc(n.image,new C(N.NAME),n.leadingWhitespace);if(a.sheet===void 0&&s.sheet!==void 0)return this.parsingError(Or.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:c}=Fc.fixSheetIdsForRangeEnds(a,s);return n4e(l,u,c,n.leadingWhitespace)}),this.rowRangeExpression=this.RULE("rowRangeExpression",()=>{const n=this.CONSUME(cI),[i,o]=n.image.split(":"),a=this.ACTION(()=>xb(this.sheetMapping,i,this.formulaAddress)),s=this.ACTION(()=>xb(this.sheetMapping,o,this.formulaAddress));if(a===void 0||s===void 0)return Co(new C(N.REF));if(a.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||s.exceedsSheetSizeLimits(this.lexerConfig.maxRows))return nc(n.image,new C(N.NAME),n.leadingWhitespace);if(a.sheet===void 0&&s.sheet!==void 0)return this.parsingError(Or.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:c}=Fc.fixSheetIdsForRangeEnds(a,s);return i4e(l,u,c,n.leadingWhitespace)}),this.cellReference=this.RULE("cellReference",()=>{const n=this.CONSUME(Cs),i=this.ACTION(()=>Ac(this.sheetMapping,n.image,this.formulaAddress));return i===void 0?nc(n.image,new C(N.REF),n.leadingWhitespace):i.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?nc(n.image,new C(N.NAME),n.leadingWhitespace):jM(i,n.leadingWhitespace)}),this.endRangeReference=this.RULE("endRangeReference",n=>{var i;const o=this.CONSUME(Cs),a=this.ACTION(()=>Ac(this.sheetMapping,n.image,this.formulaAddress)),s=this.ACTION(()=>Ac(this.sheetMapping,o.image,this.formulaAddress));return a===void 0||s===void 0?this.ACTION(()=>nc(`${n.image}:${o.image}`,new C(N.REF),n.leadingWhitespace)):a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||s.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION(()=>nc(`${n.image}:${o.image}`,new C(N.NAME),n.leadingWhitespace)):this.buildCellRange(a,s,(i=n.leadingWhitespace)===null||i===void 0?void 0:i.image)}),this.endOfRangeExpression=this.RULE("endOfRangeExpression",n=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[n]})},{ALT:()=>{var i;const o=this.SUBRULE(this.offsetProcedureExpression),a=this.ACTION(()=>Ac(this.sheetMapping,n.image,this.formulaAddress));return a===void 0?Co(new C(N.REF)):o.type===P.CELL_REFERENCE?this.buildCellRange(a,o.reference,(i=n.leadingWhitespace)===null||i===void 0?void 0:i.image):this.parsingError(Or.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.cellRangeExpression=this.RULE("cellRangeExpression",()=>{const n=this.CONSUME(Cs);return this.CONSUME2(mv),this.SUBRULE(this.endOfRangeExpression,{ARGS:[n]})}),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",n=>{const i=this.CONSUME(Cs),o=this.ACTION(()=>Ac(this.sheetMapping,i.image,this.formulaAddress));return o===void 0?this.ACTION(()=>Co(new C(N.REF))):this.buildCellRange(n.reference,o,n.leadingWhitespace)}),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",n=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[n]})},{ALT:()=>{const i=this.SUBRULE(this.offsetProcedureExpression);return i.type===P.CELL_REFERENCE?this.buildCellRange(n.reference,i.reference,n.leadingWhitespace):this.parsingError(Or.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.offsetExpression=this.RULE("offsetExpression",()=>{const n=this.SUBRULE(this.offsetProcedureExpression);let i;return this.OPTION(()=>{this.CONSUME(mv),n.type===P.CELL_RANGE?i=this.parsingError(Or.RangeOffsetNotAllowed,"Range offset not allowed here"):i=this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[n]})}),i!==void 0?i:n}),this.insideArrayExpression=this.RULE("insideArrayExpression",()=>{const n=[[]];return n[n.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY(()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),n[n.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),n.push([]),n[n.length-1].push(this.SUBRULE3(this.booleanExpression))}}])}),GM(n)}),this.parenthesisExpression=this.RULE("parenthesisExpression",()=>{const n=this.CONSUME(v5),i=this.SUBRULE(this.booleanExpression),o=this.CONSUME(o0);return R4e(i,n.leadingWhitespace,o.leadingWhitespace)}),this.arrayExpression=this.RULE("arrayExpression",()=>this.OR([{ALT:()=>{const n=this.CONSUME(uj),i=this.SUBRULE(this.insideArrayExpression),o=this.CONSUME(cj);return GM(i.args,n.leadingWhitespace,o.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}])),this.numericStringToNumber=n=>{const i=n.replace(this.lexerConfig.decimalSeparator,".");return Number(i)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",()=>{var n;return this.OR((n=this.atomicExpCache)!==null&&n!==void 0?n:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{const i=this.CONSUME(this.lexerConfig.NumberLiteral);return t4e(this.numericStringToNumber(i.image),i.leadingWhitespace)}},{ALT:()=>{const i=this.CONSUME(fj);return r4e(i)}},{ALT:()=>{const i=this.CONSUME(hj),o=i.image.toUpperCase(),a=this.lexerConfig.errorMapping[o];return a?Co(new C(a),i.leadingWhitespace):this.parsingError(Or.ParserError,"Unknown error literal")}}])}),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",()=>{const n=this.SUBRULE(this.positiveAtomicExpression),i=this.OPTION(()=>this.CONSUME(rj));return i?b4e(n,i.leadingWhitespace):n}),this.atomicExpression=this.RULE("atomicExpression",()=>this.OR([{ALT:()=>{const n=this.CONSUME(pv),i=this.SUBRULE(this.atomicExpression);return Lt(n,h5)?y4e(i,n.leadingWhitespace):Lt(n,d5)?g4e(i,n.leadingWhitespace):(this.customParsingError=VM(Or.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}])),this.powerExpression=this.RULE("powerExpression",()=>{let n=this.SUBRULE(this.atomicExpression);return this.MANY(()=>{const i=this.CONSUME(p5),o=this.SUBRULE2(this.atomicExpression);Lt(i,p5)?n=v4e(n,o,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.multiplicationExpression=this.RULE("multiplicationExpression",()=>{let n=this.SUBRULE(this.powerExpression);return this.MANY(()=>{const i=this.CONSUME(Lw),o=this.SUBRULE2(this.powerExpression);Lt(i,ej)?n=p4e(n,o,i.leadingWhitespace):Lt(i,tj)?n=m4e(n,o,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.additionExpression=this.RULE("additionExpression",()=>{let n=this.SUBRULE(this.multiplicationExpression);return this.MANY(()=>{const i=this.CONSUME(pv),o=this.SUBRULE2(this.multiplicationExpression);Lt(i,h5)?n=h4e(n,o,i.leadingWhitespace):Lt(i,d5)?n=d4e(n,o,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.concatenateExpression=this.RULE("concatenateExpression",()=>{let n=this.SUBRULE(this.additionExpression);return this.MANY(()=>{const i=this.CONSUME(lj),o=this.SUBRULE2(this.additionExpression);n=o4e(n,o,i.leadingWhitespace)}),n}),this.booleanExpression=this.RULE("booleanExpression",()=>{let n=this.SUBRULE(this.concatenateExpression);return this.MANY(()=>{const i=this.CONSUME(el),o=this.SUBRULE2(this.concatenateExpression);Lt(i,m5)?n=a4e(n,o,i.leadingWhitespace):Lt(i,nj)?n=s4e(n,o,i.leadingWhitespace):Lt(i,ij)?n=l4e(n,o,i.leadingWhitespace):Lt(i,oj)?n=u4e(n,o,i.leadingWhitespace):Lt(i,aj)?n=c4e(n,o,i.leadingWhitespace):Lt(i,sj)?n=f4e(n,o,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.formula=this.RULE("formula",()=>(this.CONSUME(m5),this.SUBRULE(this.booleanExpression))),this.lexerConfig=e,this.sheetMapping=r,this.formulaAddress=Se(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,r){this.input=e;let n=this.formulaWithContext(r),i=[];return this.customParsingError&&i.push(this.customParsingError),i=i.concat(this.errors.map(o=>({type:Or.ParserError,message:o.message}))),i.length>0&&(n=f5()),{ast:n,errors:i}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,r,n){if(e.sheet===void 0&&r.sheet!==void 0)return this.parsingError(Or.ParserError,"Malformed range expression");const{firstEnd:i,secondEnd:o,sheetRefType:a}=Fc.fixSheetIdsForRangeEnds(e,r);return WM(i,o,a,n)}static fixSheetIdsForRangeEnds(e,r){const n=Fc.rangeSheetReferenceType(e.sheet,r.sheet),i=e.sheet!==void 0&&r.sheet===void 0?r.withSheet(e.sheet):r;return{firstEnd:e,secondEnd:i,sheetRefType:n}}handleOffsetHeuristic(e){const r=e[0];if(r.type!==P.CELL_REFERENCE)return this.parsingError(Or.StaticOffsetError,"First argument to OFFSET is not a reference");const n=e[1];let i;if(n.type===P.NUMBER&&Number.isInteger(n.value))i=n.value;else if(n.type===P.PLUS_UNARY_OP&&n.value.type===P.NUMBER&&Number.isInteger(n.value.value))i=n.value.value;else if(n.type===P.MINUS_UNARY_OP&&n.value.type===P.NUMBER&&Number.isInteger(n.value.value))i=-n.value.value;else return this.parsingError(Or.StaticOffsetError,"Second argument to OFFSET is not a static number");const o=e[2];let a;if(o.type===P.NUMBER&&Number.isInteger(o.value))a=o.value;else if(o.type===P.PLUS_UNARY_OP&&o.value.type===P.NUMBER&&Number.isInteger(o.value.value))a=o.value.value;else if(o.type===P.MINUS_UNARY_OP&&o.value.type===P.NUMBER&&Number.isInteger(o.value.value))a=-o.value.value;else return this.parsingError(Or.StaticOffsetError,"Third argument to OFFSET is not a static number");const s=e[3];let l;if(s===void 0)l=1;else if(s.type===P.NUMBER){if(l=s.value,l<1)return this.parsingError(Or.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(l))return this.parsingError(Or.StaticOffsetError,"Fourth argument to OFFSET is not integer")}else return this.parsingError(Or.StaticOffsetError,"Fourth argument to OFFSET is not a static number");const u=e[4];let c;if(u===void 0)c=1;else if(u.type===P.NUMBER){if(c=u.value,c<1)return this.parsingError(Or.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(c))return this.parsingError(Or.StaticOffsetError,"Fifth argument to OFFSET is not integer")}else return this.parsingError(Or.StaticOffsetError,"Fifth argument to OFFSET is not a static number");const f=new Ht(r.reference.col+a,r.reference.row+i,r.reference.type);let h=f.col,d=f.row;if((r.reference.type===$t.CELL_REFERENCE_RELATIVE||r.reference.type===$t.CELL_REFERENCE_ABSOLUTE_COL)&&(d=d+this.formulaAddress.row),(r.reference.type===$t.CELL_REFERENCE_RELATIVE||r.reference.type===$t.CELL_REFERENCE_ABSOLUTE_ROW)&&(h=h+this.formulaAddress.col),h<0||d<0)return Co(new C(N.REF,x.OutOfSheet));if(c===1&&l===1)return jM(f);{const p=new Ht(f.col+c-1,f.row+l-1,f.type);return WM(f,p,Oi.RELATIVE)}}parsingError(e,r){return this.customParsingError=VM(e,r),f5()}static rangeSheetReferenceType(e,r){return e===void 0?Oi.RELATIVE:r===void 0?Oi.START_ABSOLUTE:Oi.BOTH_ABSOLUTE}}class zb{constructor(e){this.lexerConfig=e,this.lexer=new jn(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){const r=this.lexer.tokenize(e);let n=r.tokens;return n=this.trimTrailingWhitespaces(n),n=this.skipWhitespacesInsideRanges(n),n=this.skipWhitespacesBeforeArgSeparators(n),r.tokens=n,r}skipWhitespacesInsideRanges(e){return zb.filterTokensByNeighbors(e,(r,n,i)=>(Lt(r,Cs)||Lt(r,mv))&&Lt(n,this.lexerConfig.WhiteSpace)&&(Lt(i,Cs)||Lt(i,mv)))}skipWhitespacesBeforeArgSeparators(e){return zb.filterTokensByNeighbors(e,(r,n,i)=>!Lt(r,this.lexerConfig.ArgSeparator)&&Lt(n,this.lexerConfig.WhiteSpace)&&Lt(i,this.lexerConfig.ArgSeparator))}static filterTokensByNeighbors(e,r){if(e.length<3)return e;let n=0;const i=[e[n++]];for(;n<e.length-1;)r(e[n-1],e[n],e[n+1])||i.push(e[n]),++n;return i.push(e[n]),i}trimTrailingWhitespaces(e){return e.length>0&&Lt(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class pj{constructor(e,r,n,i){this.config=e,this.lexerConfig=r,this.sheetMappingFn=n,this.namedExpressions=i}unparse(e,r){return"="+this.unparseAst(e,r)}unparseAst(e,r){var n,i;switch(e.type){case P.EMPTY:return bt("",e.leadingWhitespace);case P.NUMBER:return bt(mj(e.value,this.config.decimalSeparator),e.leadingWhitespace);case P.STRING:return bt('"'+e.value+'"',e.leadingWhitespace);case P.FUNCTION_CALL:{const o=e.args.map(l=>l!==void 0?this.unparseAst(l,r):"").join(this.config.functionArgSeparator),s=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+o+bt(")",e.internalWhitespace);return bt(s,e.leadingWhitespace)}case P.NAMED_EXPRESSION:{const o=(n=this.namedExpressions.nearestNamedExpression(e.expressionName,r.sheet))===null||n===void 0?void 0:n.displayName;return bt(o||e.expressionName,e.leadingWhitespace)}case P.CELL_REFERENCE:{let o;return e.reference.sheet!==void 0?o=this.unparseSheetName(e.reference.sheet)+"!":o="",o+=(i=e.reference.unparse(r))!==null&&i!==void 0?i:this.config.translationPackage.getErrorTranslation(N.REF),bt(o,e.leadingWhitespace)}case P.COLUMN_RANGE:case P.ROW_RANGE:case P.CELL_RANGE:return bt(this.formatRange(e,r),e.leadingWhitespace);case P.PLUS_UNARY_OP:{const o=this.unparseAst(e.value,r);return bt("+",e.leadingWhitespace)+o}case P.MINUS_UNARY_OP:{const o=this.unparseAst(e.value,r);return bt("-",e.leadingWhitespace)+o}case P.PERCENT_OP:return this.unparseAst(e.value,r)+bt("%",e.leadingWhitespace);case P.ERROR:{const o=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:N.ERROR);return bt(o,e.leadingWhitespace)}case P.ERROR_WITH_RAW_INPUT:return bt(e.rawInput,e.leadingWhitespace);case P.PARENTHESIS:{const a="("+this.unparseAst(e.expression,r)+bt(")",e.internalWhitespace);return bt(a,e.leadingWhitespace)}case P.ARRAY:{const o="{"+e.args.map(a=>a.map(s=>this.unparseAst(s,r)).join(this.config.arrayColumnSeparator)).join(this.config.arrayRowSeparator)+bt("}",e.internalWhitespace);return bt(o,e.leadingWhitespace)}default:{const o=this.unparseAst(e.left,r),a=this.unparseAst(e.right,r);return o+bt(JV[e.type],e.leadingWhitespace)+a}}}unparseSheetName(e){const r=fV(e,this.sheetMappingFn);if(r===void 0)throw new ar(e);return r}formatRange(e,r){let n="",i="";e.start.sheet!==void 0&&e.sheetReferenceType!==Oi.RELATIVE&&(n=this.unparseSheetName(e.start.sheet)+"!"),e.end.sheet!==void 0&&e.sheetReferenceType===Oi.BOTH_ABSOLUTE&&(i=this.unparseSheetName(e.end.sheet)+"!");const o=e.start.unparse(r),a=e.end.unparse(r);return o===void 0||a===void 0?this.config.translationPackage.getErrorTranslation(N.REF):`${n}${o}:${i}${a}`}}function mj(t,e){return t.toString().replace(".",e)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Fp{constructor(e,r,n){this.config=e,this.functionRegistry=r,this.sheetMapping=n,this.statsCacheUsed=0,this.lexerConfig=hI(e),this.lexer=new zb(this.lexerConfig),this.formulaParser=new Fc(this.lexerConfig,this.sheetMapping),this.cache=new C4e(this.functionRegistry)}parse(e,r){this.formulaAddress=r;const n=this.tokenizeFormula(e);if(n.errors.length>0){const f=n.errors.map(h=>({type:Or.LexingError,message:h.message}));return{ast:f5(),errors:f,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}const i=this.computeHashFromTokens(n.tokens,r);let o=this.cache.get(i);if(o!==void 0)++this.statsCacheUsed;else{const f=this.bindWhitespacesToTokens(n.tokens),h=this.formulaParser.parseFromTokens(f,r);if(h.errors.length>0)return Object.assign(Object.assign({},h),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});o=this.cache.set(i,h.ast)}const{ast:a,hasVolatileFunction:s,hasStructuralChangeFunction:l}=o,u=this.convertReversedRangesToRegularRanges(a),c=Dw(u,this.functionRegistry);return{ast:u,errors:[],hasVolatileFunction:s,hasStructuralChangeFunction:l,dependencies:c}}convertReversedRangesToRegularRanges(e){switch(e.type){case P.EMPTY:case P.NUMBER:case P.STRING:case P.ERROR:case P.ERROR_WITH_RAW_INPUT:case P.CELL_REFERENCE:case P.NAMED_EXPRESSION:return e;case P.CELL_RANGE:{const{start:r,end:n}=e,i=this.orderCellRangeEnds(r,n);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case P.COLUMN_RANGE:{const{start:r,end:n}=e,i=this.orderColumnRangeEnds(r,n);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case P.ROW_RANGE:{const{start:r,end:n}=e,i=this.orderRowRangeEnds(r,n);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case P.PERCENT_OP:case P.PLUS_UNARY_OP:case P.MINUS_UNARY_OP:{const r=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:r})}case P.CONCATENATE_OP:case P.EQUALS_OP:case P.NOT_EQUAL_OP:case P.LESS_THAN_OP:case P.GREATER_THAN_OP:case P.LESS_THAN_OR_EQUAL_OP:case P.GREATER_THAN_OR_EQUAL_OP:case P.MINUS_OP:case P.PLUS_OP:case P.TIMES_OP:case P.DIV_OP:case P.POWER_OP:{const r=this.convertReversedRangesToRegularRanges(e.left),n=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:r,right:n})}case P.PARENTHESIS:{const r=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:r})}case P.FUNCTION_CALL:{const r=e.args.map(n=>this.convertReversedRangesToRegularRanges(n));return Object.assign(Object.assign({},e),{args:r})}case P.ARRAY:{const r=e.args.map(n=>n.map(i=>this.convertReversedRangesToRegularRanges(i)));return Object.assign(Object.assign({},e),{args:r})}}}orderCellRangeEnds(e,r){const n=[e,r],[i,o]=n.map(c=>c.toColumnAddress()).sort(Tn.compareByAbsoluteAddress(this.formulaAddress)),[a,s]=n.map(c=>c.toRowAddress()).sort(dn.compareByAbsoluteAddress(this.formulaAddress)),[l,u]=n.map(c=>c.sheet).sort(Fp.compareSheetIds.bind(this));return{start:Ht.fromColAndRow(i,a,l),end:Ht.fromColAndRow(o,s,u)}}orderColumnRangeEnds(e,r){const n=[e,r],[i,o]=n.sort(Tn.compareByAbsoluteAddress(this.formulaAddress)),[a,s]=n.map(l=>l.sheet).sort(Fp.compareSheetIds.bind(this));return{start:new Tn(i.type,i.col,a),end:new Tn(o.type,o.col,s)}}orderRowRangeEnds(e,r){const n=[e,r],[i,o]=n.sort(dn.compareByAbsoluteAddress(this.formulaAddress)),[a,s]=n.map(l=>l.sheet).sort(Fp.compareSheetIds.bind(this));return{start:new dn(i.type,i.row,a),end:new dn(o.type,o.row,s)}}static compareSheetIds(e,r){return e=e??1/0,r=r??1/0,e-r}fetchCachedResultForAst(e){const r=this.computeHashFromAst(e);return this.fetchCachedResult(r)}fetchCachedResult(e){const r=this.cache.get(e);if(r===void 0)throw new Error("There is no AST with such key in the cache");{const{ast:n,hasVolatileFunction:i,hasStructuralChangeFunction:o,relativeDependencies:a}=r;return{ast:n,errors:[],hasVolatileFunction:i,hasStructuralChangeFunction:o,dependencies:a}}}computeHashFromTokens(e,r){var n;let i="",o=0;for(;o<e.length;){const a=e[o];if(Lt(a,Cs)){const s=Ac(this.sheetMapping,a.image,r);s===void 0?i=i.concat(a.image):i=i.concat(s.hash(!0))}else if(Lt(a,fI)){const s=a.image.toUpperCase().slice(0,-1),l=(n=this.lexerConfig.functionMapping[s])!==null&&n!==void 0?n:s;i=i.concat(l,"(")}else if(Lt(a,uI)){const[s,l]=a.image.split(":"),u=kb(this.sheetMapping,s,r),c=kb(this.sheetMapping,l,r);u===void 0||c===void 0?i=i.concat("!REF"):i=i.concat(u.hash(!0),":",c.hash(!0))}else if(Lt(a,cI)){const[s,l]=a.image.split(":"),u=xb(this.sheetMapping,s,r),c=xb(this.sheetMapping,l,r);u===void 0||c===void 0?i=i.concat("!REF"):i=i.concat(u.hash(!0),":",c.hash(!0))}else i=i.concat(a.image);o++}return i}rememberNewAst(e){const r=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(r,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case P.EMPTY:return e.leadingWhitespace||"";case P.NUMBER:return bt(mj(e.value,this.config.decimalSeparator),e.leadingWhitespace);case P.STRING:return bt('"'+e.value+'"',e.leadingWhitespace);case P.NAMED_EXPRESSION:return bt(e.expressionName,e.leadingWhitespace);case P.FUNCTION_CALL:{const r=e.args.map(i=>this.computeHashOfAstNode(i)).join(this.config.functionArgSeparator),n=e.procedureName+"("+r+bt(")",e.internalWhitespace);return bt(n,e.leadingWhitespace)}case P.CELL_REFERENCE:return bt(e.reference.hash(!0),e.leadingWhitespace);case P.COLUMN_RANGE:case P.ROW_RANGE:case P.CELL_RANGE:{const r=e.start.hash(e.sheetReferenceType!==Oi.RELATIVE),n=e.end.hash(e.sheetReferenceType===Oi.BOTH_ABSOLUTE);return bt(r+":"+n,e.leadingWhitespace)}case P.MINUS_UNARY_OP:return bt("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case P.PLUS_UNARY_OP:return bt("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case P.PERCENT_OP:return this.computeHashOfAstNode(e.value)+bt("%",e.leadingWhitespace);case P.ERROR:{const r=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:N.ERROR);return bt(r,e.leadingWhitespace)}case P.ERROR_WITH_RAW_INPUT:return bt(e.rawInput,e.leadingWhitespace);case P.ARRAY:{const r=e.args.map(n=>n.map(i=>this.computeHashOfAstNode(i)).join(",")).join(";");return bt("{"+r+bt("}",e.internalWhitespace),e.leadingWhitespace)}case P.PARENTHESIS:{const n="("+this.computeHashOfAstNode(e.expression)+bt(")",e.internalWhitespace);return bt(n,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+bt(JV[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(e){const r=[],n=e[0];Lt(n,this.lexerConfig.WhiteSpace)||r.push(n);for(let i=1;i<e.length;++i){const o=e[i];if(Lt(o,this.lexerConfig.WhiteSpace))continue;const a=e[i-1];Lt(a,this.lexerConfig.WhiteSpace)&&(o.leadingWhitespace=a),r.push(o)}return r}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Ic=(t,e,r,n)=>{switch(t.type){case P.EMPTY:case P.NUMBER:case P.STRING:case P.ERROR:return;case P.NAMED_EXPRESSION:{n&&r.push(new Os(t.expressionName));return}case P.CELL_REFERENCE:{n&&r.push(new vj(t.reference));return}case P.CELL_RANGE:{n&&t.start.sheet===t.end.sheet&&r.push(new _4e(t.start,t.end));return}case P.COLUMN_RANGE:{n&&t.start.sheet===t.end.sheet&&r.push(new A4e(t.start,t.end));return}case P.ROW_RANGE:{n&&t.start.sheet===t.end.sheet&&r.push(new I4e(t.start,t.end));return}case P.PERCENT_OP:case P.PLUS_UNARY_OP:case P.MINUS_UNARY_OP:{Ic(t.value,e,r,!0);return}case P.CONCATENATE_OP:case P.EQUALS_OP:case P.NOT_EQUAL_OP:case P.LESS_THAN_OP:case P.GREATER_THAN_OP:case P.LESS_THAN_OR_EQUAL_OP:case P.GREATER_THAN_OR_EQUAL_OP:case P.MINUS_OP:case P.PLUS_OP:case P.TIMES_OP:case P.DIV_OP:case P.POWER_OP:Ic(t.left,e,r,!0),Ic(t.right,e,r,!0);return;case P.PARENTHESIS:Ic(t.expression,e,r,n);return;case P.FUNCTION_CALL:{const i=!e.doesFunctionNeedArgumentToBeComputed(t.procedureName);t.args.forEach(o=>Ic(o,e,r,i));return}}},Dw=(t,e)=>{const r=new Array;return Ic(t,e,r,!0),r};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class vj{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}}class _4e{constructor(e,r){this.start=e,this.end=r}absolutize(e){return new $e(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}class A4e{constructor(e,r){this.start=e,this.end=r}absolutize(e){const r=this.start.toSimpleColumnAddress(e),n=this.end.toSimpleColumnAddress(e);return new Fa(r.sheet,r.col,n.col)}}class I4e{constructor(e,r){this.start=e,this.end=r}absolutize(e){const r=this.start.toSimpleRowAddress(e),n=this.end.toSimpleRowAddress(e);return new Ha(r.sheet,r.row,n.row)}}class Os{constructor(e){this.name=e}absolutize(e){return this}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Oo=(t,e)=>t.map(r=>r.absolutize(e)),N4e=t=>t.filter(e=>e instanceof Os?!0:e instanceof $e?!(Un(e.start)||Un(e.end)):!Un(e));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const ft=Symbol("Empty value");function ye(t){return t instanceof Go?t.val:t}class Go{constructor(e,r){this.val=e,this.format=r}fromNumber(e){return new this.constructor(e)}}function dI(t,e){if(typeof t=="number")return e;{const r=t.fromNumber(e);return r.format=t.format,r}}class pI extends Go{getDetailedType(){return Ie.NUMBER_DATE}}class g5 extends Go{getDetailedType(){return Ie.NUMBER_CURRENCY}}class mI extends Go{getDetailedType(){return Ie.NUMBER_TIME}}class vI extends Go{getDetailedType(){return Ie.NUMBER_DATETIME}}class a0 extends Go{getDetailedType(){return Ie.NUMBER_PERCENT}}function Rt(t){return typeof t=="number"||t instanceof Go}var Ie;(function(t){t.NUMBER_RAW="NUMBER_RAW",t.NUMBER_DATE="NUMBER_DATE",t.NUMBER_TIME="NUMBER_TIME",t.NUMBER_DATETIME="NUMBER_DATETIME",t.NUMBER_CURRENCY="NUMBER_CURRENCY",t.NUMBER_PERCENT="NUMBER_PERCENT"})(Ie||(Ie={}));function P4e(t){return t instanceof Go?t.getDetailedType():Ie.NUMBER_RAW}function M4e(t){if(t instanceof Go)return t.format}function Yb(t){return t instanceof Go?{type:t.getDetailedType(),format:t.format}:{type:Ie.NUMBER_RAW}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Pe{constructor(e,r,n,i){this._data=e,this.range=r,this.dependencyGraph=n,this._hasOnlyNumbers=i,this.size=e===void 0?new it(r.effectiveWidth(n),r.effectiveHeight(n)):new it(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,r,n){return new Pe(e,r,n,!0)}static onlyNumbers(e){return new Pe(e,void 0,void 0,!0)}static onlyValues(e){return new Pe(e,void 0,void 0,void 0)}static onlyRange(e,r){return new Pe(void 0,e,r,void 0)}static fromScalar(e){return new Pe([[e]],void 0,void 0,void 0)}isAdHoc(){return this.range===void 0}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();const e=[];for(let r=0;r<this._data.length;r++)for(let n=0;n<this._data[0].length;n++)e.push(this._data[r][n]);return e}*effectiveAddressesFromData(e){for(let r=0;r<this.data.length;++r){const n=this.data[r];for(let i=0;i<n.length;++i)yield Se(e.sheet,e.col+i,e.row+r)}}*entriesFromTopLeftCorner(e){this.ensureThatComputed();for(let r=0;r<this.size.height;++r)for(let n=0;n<this.size.width;++n)yield[this._data[r][n],Se(e.sheet,e.col+n,e.row+r)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(this._hasOnlyNumbers===void 0){this._hasOnlyNumbers=!0;for(const e of this.data)for(const r of e)if(typeof r!="number")return this._hasOnlyNumbers=!1,!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),(e=this._data)!==null&&e!==void 0?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){this._data===void 0&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,e=>{const r=this.dependencyGraph.getCellValue(e);return r instanceof Pe?(this._hasOnlyNumbers=!1,new C(N.VALUE,x.ScalarExpected)):(Rt(r)||(this._hasOnlyNumbers=!1),r)}))}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ps{constructor(){this.changes=new Map}static empty(){return new Ps}addAll(e){for(const r of e.changes.values())this.add(r.address,r);return this}addChange(e,r,n){this.addInterpreterValue(e,r,n)}exportChanges(e){let r=[];return this.changes.forEach(n=>{const i=e.exportChange(n);Array.isArray(i)?r=r.concat(i):r.push(i)}),r}getChanges(){return Array.from(this.changes.values())}isEmpty(){return this.changes.size===0}add(e,r){const n=r.value;if(n instanceof Pe)for(const i of n.effectiveAddressesFromData(e))this.changes.delete(`${i.sheet},${i.col},${i.row}`);this.changes.set(l0(e),r)}addInterpreterValue(e,r,n){this.add(r,{address:r,value:e,oldValue:n})}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Vn{constructor(e,r,n){if(this.sheet=e,this.rowStart=r,this.rowEnd=n,r<0)throw Error("Starting row cant be less than 0");if(n<r)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,r,n){return new Vn(e,r,r+n-1)}static fromRowStartAndEnd(e,r,n){return new Vn(e,r,n)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const r=Math.max(this.rowStart,e.rowStart),n=Math.min(this.rowEnd,e.rowEnd);return r>n?null:new Vn(this.sheet,r,n)}firstRow(){return new Vn(this.sheet,this.rowStart,this.rowStart)}}class si{constructor(e,r,n){if(this.sheet=e,this.columnStart=r,this.columnEnd=n,r<0)throw Error("Starting column cant be less than 0");if(n<r)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,r,n){return new si(e,r,r+n-1)}static fromColumnStartAndEnd(e,r,n){return new si(e,r,n)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const r=Math.max(this.columnStart,e.columnStart),n=Math.min(this.columnEnd,e.columnEnd);return r>n?null:new si(this.sheet,r,n)}firstColumn(){return new si(this.sheet,this.columnStart,this.columnStart)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var Ke;(function(t){t.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",t.PARSER="PARSER",t.GRAPH_BUILD="GRAPH_BUILD",t.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",t.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",t.TOP_SORT="TOP_SORT",t.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",t.EVALUATION="EVALUATION",t.VLOOKUP="VLOOKUP",t.TRANSFORM_ASTS="TRANSFORM_ASTS",t.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",t.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",t.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",t.ADJUSTING_RANGES="ADJUSTING_RANGES",t.ADJUSTING_GRAPH="ADJUSTING_GRAPH",t.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",t.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"})(Ke||(Ke={}));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class gj{constructor(){this.stats=new Map([[Ke.CRITERION_FUNCTION_FULL_CACHE_USED,0],[Ke.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e;const r=((e=this.stats.get(Ke.CRITERION_FUNCTION_FULL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(Ke.CRITERION_FUNCTION_FULL_CACHE_USED,r)}incrementCriterionFunctionPartialCacheUsed(){var e;const r=((e=this.stats.get(Ke.CRITERION_FUNCTION_PARTIAL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(Ke.CRITERION_FUNCTION_PARTIAL_CACHE_USED,r)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(Ke.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(Ke.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var r;const n=Date.now(),i=this.startTimes.get(e);if(i){let o=(r=this.stats.get(e))!==null&&r!==void 0?r:0;o+=n-i,this.stats.set(e,o),this.startTimes.delete(e)}else throw Error(`Statistics ${e} not started`)}measure(e,r){this.start(e);const n=r();return this.end(e),n}snapshot(){return new Map(this.stats)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class k4e extends gj{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class ar extends Error{constructor(e){super(`There's no sheet with id = ${e}`)}}class yj extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}class vv extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}class uu extends Error{constructor(){super("Sheet size limit exceeded")}}class y5 extends Error{constructor(){super("This is not a formula")}}class bj extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}class Mr extends Error{constructor(e){super(`Invalid arguments, expected ${e}`)}}class gv extends Error{constructor(e,r){super(`Sheets ${e} and ${r} are not equal.`)}}class wj extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}class Sj extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}class yv extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}class Rj extends Error{constructor(){super("There is no operation to undo")}}class Ej extends Error{constructor(){super("There is no operation to redo")}}class Cj extends Error{constructor(){super("There is nothing to paste")}}function x4e(t,e){switch(typeof e){case"function":case"symbol":return e.toString();case"bigint":return"BigInt("+e.toString()+")";default:return e instanceof RegExp?"RegExp("+e.toString()+")":e}}class Oj extends Error{constructor(e){super(`Unable to parse value: ${JSON.stringify(e,x4e,4)}`)}}class St extends Error{constructor(e,r){super(`Expected value of type: ${e} for config parameter: ${r}`)}}class $4e extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}class Tj extends Error{constructor(e,r){super(`Config parameter ${e} should be at least ${r}`)}}class _j extends Error{constructor(e,r){super(`Config parameter ${e} should be at most ${r}`)}}class Aj extends Error{constructor(e,r){super(`Expected one of ${e} for config parameter: ${r}`)}}class Ij extends Error{constructor(){super("Computations are suspended")}}class Nc extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}class Nj extends Error{constructor(e){super(`Cannot register translation for function with id: ${e}`)}}class b5 extends Error{constructor(){super("Language not registered.")}}class Pj extends Error{constructor(){super("Language already registered.")}}class jf extends Error{static functionNotDeclaredInPlugin(e,r){return new jf(`Function with id ${e} not declared in plugin ${r}`)}static functionMethodNotFound(e,r){return new jf(`Function method ${e} not found in plugin ${r}`)}}class cu extends Error{static cannotRegisterFunctionWithId(e){return new cu(`Cannot register function with id ${e}`)}static cannotUnregisterFunctionWithId(e){return new cu(`Cannot unregister function with id ${e}`)}static cannotUnregisterProtectedPlugin(){return new cu("Cannot unregister protected plugin")}}class Hc extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}class Kb extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}class gI extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}class L4e extends Error{constructor(e,r){super(`Alias id ${e} in plugin ${r} already defined as a function or alias.`)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class D4e{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){const r=this.mapping.get(e.sheet);if(r===void 0)throw new ar(e.sheet);return r.getCell(e)}fetchCell(e){const r=this.mapping.get(e.sheet);if(r===void 0)throw new ar(e.sheet);const n=r.getCell(e);if(!n)throw Error("Vertex for address missing in AddressMapping");return n}strategyFor(e){const r=this.mapping.get(e);if(r===void 0)throw new ar(e);return r}addSheet(e,r){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,r)}autoAddSheet(e,r,n){const{height:i,width:o,fill:a}=n,s=this.policy.call(a);this.addSheet(e,new s(o,i))}getCellValue(e){const r=this.getCell(e);return r===void 0?ft:r instanceof yr?r.getArrayCellValue(e):r.getCellValue()}getRawValue(e){const r=this.getCell(e);return r instanceof Ms?r.getValues().rawValue:r instanceof yr?r.getArrayCellRawValue(e):null}setCell(e,r){const n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized");n.setCell(e,r)}moveCell(e,r){const n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized.");if(e.sheet!==r.sheet)throw Error("Cannot move cells between sheets.");if(n.has(r))throw new Error("Cannot move cell. Destination already occupied.");const i=n.getCell(e);if(i===void 0)throw new Error("Cannot move cell. No cell with such address.");this.setCell(r,i),this.removeCell(e)}removeCell(e){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized");r.removeCell(e)}has(e){const r=this.mapping.get(e.sheet);return r===void 0?!1:r.has(e)}getHeight(e){const r=this.mapping.get(e);if(r===void 0)throw new ar(e);return r.getHeight()}getWidth(e){const r=this.mapping.get(e);if(!r)throw new ar(e);return r.getWidth()}addRows(e,r,n){const i=this.mapping.get(e);if(i===void 0)throw new ar(e);i.addRows(r,n)}removeRows(e){const r=this.mapping.get(e.sheet);if(r===void 0)throw new ar(e.sheet);r.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,r,n){const i=this.mapping.get(e);if(i===void 0)throw new ar(e);i.addColumns(r,n)}removeColumns(e){const r=this.mapping.get(e.sheet);if(r===void 0)throw new ar(e.sheet);r.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(const[e,r]of this.mapping.entries())yield*r.getEntries(e)}*sheetEntries(e){const r=this.mapping.get(e);if(r!==void 0)yield*r.getEntries(e);else throw new ar(e)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class F4e{constructor(){this.arrayMapping=new Map}getArray(e){const r=this.getArrayByCorner(e.start);if(r!=null&&r.getRange().sameAs(e))return r}getArrayByCorner(e){return this.arrayMapping.get(l0(e))}setArray(e,r){this.arrayMapping.set(l0(e.start),r)}removeArray(e){typeof e=="string"?this.arrayMapping.delete(e):this.arrayMapping.delete(l0(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(const[r,n]of this.arrayMapping.entries())n.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[r,n])}*arraysInCols(e){for(const[r,n]of this.arrayMapping.entries())n.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[r,n])}isFormulaArrayInRow(e,r){for(const n of this.arrayMapping.values())if(n.spansThroughSheetRows(e,r))return!0;return!1}isFormulaArrayInAllRows(e){let r=!0;for(const n of e.rows())this.isFormulaArrayInRow(e.sheet,n)||(r=!1);return r}isFormulaArrayInColumn(e,r){for(const n of this.arrayMapping.values())if(n.spansThroughSheetColumn(e,r))return!0;return!1}isFormulaArrayInAllColumns(e){let r=!0;for(const n of e.columns())this.isFormulaArrayInColumn(e.sheet,n)||(r=!1);return r}isFormulaArrayInRange(e){for(const r of this.arrayMapping.values())if(r.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const r of this.arrayMapping.values())if(r.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,r,n){this.updateArrayVerticesInSheet(e,(i,o)=>{const a=o.getRange();return r<=a.start.row?[a.shifted(0,n),o]:void 0})}moveArrayVerticesAfterColumnByColumns(e,r,n){this.updateArrayVerticesInSheet(e,(i,o)=>{const a=o.getRange();return r<=a.start.col?[a.shifted(n,0),o]:void 0})}updateArrayVerticesInSheet(e,r){const n=Array();for(const[i,o]of this.arrayMapping.entries()){if(o.sheet!==e)continue;const a=r(i,o);a!==void 0&&(this.removeArray(i),n.push(a))}n.forEach(([i,o])=>{this.setArray(i,o)})}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class yp{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,r){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}}class Wf{constructor(e){this.size=new it(e.length>0?e[0].length:0,e.length),this.array=e}static fromInterpreterValue(e){return e instanceof Pe?new Wf(e.data):new Wf([[e]])}simpleRangeValue(){return Pe.onlyValues(this.array)}addRows(e,r){this.array.splice(e,0,...this.nullArrays(r,this.width())),this.size.height+=r}addColumns(e,r){for(let n=0;n<this.height();n++)this.array[n].splice(e,0,...new Array(r).fill(ft));this.size.width+=r}removeRows(e,r){if(this.outOfBound(0,e)||this.outOfBound(0,r))throw Error("Array index out of bound");const n=r-e+1;this.array.splice(e,n),this.size.height-=n}removeColumns(e,r){if(this.outOfBound(e,0)||this.outOfBound(r,0))throw Error("Array index out of bound");const n=r-e+1;for(const i of this.array)i.splice(e,n);this.size.width-=n}nullArrays(e,r){const n=[];for(let i=0;i<e;++i)n.push(new Array(r).fill(ft));return n}get(e,r){if(this.outOfBound(e,r))throw Error("Array index out of bound");return this.array[r][e]}set(e,r,n){if(this.outOfBound(e,r))throw Error("Array index out of bound");this.array[r][e]=n}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height||(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width))throw Error("Resizing to smaller array")}outOfBound(e,r){return e<0||r<0||r>this.size.height-1||e>this.size.width-1}}class $6{constructor(e,r){this.error=e,this.size=r}get(e,r){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class li{constructor(e,r,n){this.formula=e,this.cellAddress=r,this.version=n}get width(){return 1}get height(){return 1}static fromAst(e,r,n,i){return n.isScalar()?new Io(e,r,i):new yr(e,r,n,i)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){if(this.version!=e.version()){const[r,n,i]=e.applyTransformations(this.formula,this.cellAddress,this.version);this.formula=r,this.cellAddress=n,this.version=i}}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}class yr extends li{constructor(e,r,n,i=0){super(e,r,i),n.isRef?this.array=new $6(new C(N.REF,x.NoSpaceForArrayResult),it.error()):this.array=new yp(n)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){if(e instanceof C)return this.setErrorValue(e),e;const r=Wf.fromInterpreterValue(e);return r.resize(this.array.size),this.array=r,e}getCellValue(){if(this.array instanceof yp)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof yp))return this.array.simpleRangeValue()}getArrayCellValue(e){const r=e.col-this.cellAddress.col,n=e.row-this.cellAddress.row;try{return this.array.get(r,n)}catch{return new C(N.REF)}}getArrayCellRawValue(e){const r=this.getArrayCellValue(e);if(!(r instanceof C||r===ft))return ye(r)}setArrayCellValue(e,r){const n=e.col-this.cellAddress.col,i=e.row-this.cellAddress.row;this.array instanceof Wf&&this.array.set(n,i,r)}setNoSpace(){return this.array=new $6(new C(N.SPILL,x.NoSpaceForArrayResult),it.error()),this.getCellValue()}getRange(){return $e.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return $e.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,r,n=r){return this.cellAddress.sheet===e&&this.cellAddress.row<=n&&r<this.cellAddress.row+this.height}spansThroughSheetColumn(e,r,n=r){return this.cellAddress.sheet===e&&this.cellAddress.col<=n&&r<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof yp)}columnsFromArray(){return si.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return Vn.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return wv(this.cellAddress,e)}setErrorValue(e){this.array=new $6(e,this.array.size)}}class Io extends li{constructor(e,r,n){super(e,r,n)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(this.cachedCellValue!==void 0)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return this.cachedCellValue!==void 0}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class fn{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,r){this.functionCache.set(e,r)}getCriterionFunctionValue(e,r){var n;return(n=this.getCriterionFunctionValues(e).get(r))===null||n===void 0?void 0:n[0]}getCriterionFunctionValues(e){var r;return(r=this.criterionFunctionCache.get(e))!==null&&r!==void 0?r:new Map}setCriterionFunctionValues(e,r){this.criterionFunctionCache.set(e,r)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach(e=>e.criterionFunctionCache.clear()),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const H4e=(t,e,r,n,i)=>{if(e instanceof fn){const s=e.range.intersectionWith(r);return s!==void 0?Array.from(s.addresses(i)):[]}let o,a;if(e instanceof li)o=e.getFormula(n),a=e.getAddress(n);else return[];return Dw(o,t).filter(s=>s instanceof vj).map(s=>s.dependency.toSimpleCellAddress(a)).filter(s=>r.addressInRange(s))};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var aa;(function(t){t[t.ON_STACK=0]="ON_STACK",t[t.PROCESSED=1]="PROCESSED",t[t.POPPED=2]="POPPED"})(aa||(aa={}));class U4e{constructor(e){this.dependencyQuery=e,this.nodes=new Set,this.specialNodes=new Set,this.specialNodesStructuralChanges=new Set,this.specialNodesRecentlyChanged=new Set,this.infiniteRanges=new Set,this.edges=new Map}addNode(e){this.nodes.add(e),this.edges.has(e)||this.edges.set(e,new Set)}addEdge(e,r){if(!this.nodes.has(e))throw new Error(`Unknown node ${e}`);if(!this.nodes.has(r))throw new Error(`Unknown node ${r}`);this.edges.get(e).add(r)}removeEdge(e,r){if(this.existsEdge(e,r))this.edges.get(e).delete(r);else throw new Error("Edge does not exist")}softRemoveEdge(e,r){var n;(n=this.edges.get(e))===null||n===void 0||n.delete(r)}removeIncomingEdges(e){this.edges.forEach(r=>{r.delete(e)})}adjacentNodes(e){return this.edges.get(e)}adjacentNodesCount(e){return this.adjacentNodes(e).size}hasNode(e){return this.nodes.has(e)}nodesCount(){return this.nodes.size}edgesCount(){let e=0;return this.edges.forEach(r=>e+=r.size),e}removeNode(e){for(const r of this.adjacentNodes(e).values())this.markNodeAsSpecialRecentlyChanged(r);return this.edges.delete(e),this.nodes.delete(e),this.specialNodes.delete(e),this.specialNodesRecentlyChanged.delete(e),this.specialNodesStructuralChanges.delete(e),this.infiniteRanges.delete(e),this.removeDependencies(e)}markNodeAsSpecial(e){this.specialNodes.add(e)}markNodeAsSpecialRecentlyChanged(e){this.nodes.has(e)&&this.specialNodesRecentlyChanged.add(e)}markNodeAsChangingWithStructure(e){this.specialNodesStructuralChanges.add(e)}clearSpecialNodesRecentlyChanged(){this.specialNodesRecentlyChanged.clear()}markNodeAsInfiniteRange(e){this.infiniteRanges.add(e)}existsEdge(e,r){var n,i;return(i=(n=this.edges.get(e))===null||n===void 0?void 0:n.has(r))!==null&&i!==void 0?i:!1}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(Array.from(this.nodes),()=>!0,()=>{})}getTopSortedWithSccSubgraphFrom(e,r,n){const i=new Map,o=new Map,a=new Map,s=new Set,l=new Map,u=[];let c=0;const f=new Set;e.reverse(),e.forEach(m=>{if(l.get(m)!==void 0)return;const y=[m],S=[];for(l.set(m,aa.ON_STACK);y.length>0;){const R=y[y.length-1];switch(l.get(R)){case aa.ON_STACK:{i.set(R,c),o.set(R,c),S.push(R),c++,this.adjacentNodes(R).forEach(E=>{i.get(E)===void 0&&(y.push(E),a.set(E,R),l.set(E,aa.ON_STACK))}),l.set(R,aa.PROCESSED);break}case aa.PROCESSED:{let E;if(E=i.get(R),this.adjacentNodes(R).forEach(O=>{s.has(O)||(a.get(O)===R?E=Math.min(E,o.get(O)):E=Math.min(E,i.get(O)))}),o.set(R,E),E===i.get(R)){const O=[];do O.push(S[S.length-1]),S.pop();while(O[O.length-1]!==R);O.forEach(A=>{s.add(A)}),u.push(...O),O.length>1&&O.forEach(A=>{f.add(A)})}y.pop(),l.set(R,aa.POPPED);break}case aa.POPPED:{y.pop();break}}}});const h=new Set(e),d=[],p=[];return u.reverse(),u.forEach(m=>{f.has(m)||this.adjacentNodes(m).has(m)?(p.push(m),n(m),this.adjacentNodes(m).forEach(y=>h.add(y))):(d.push(m),h.has(m)&&r(m)&&this.adjacentNodes(m).forEach(y=>h.add(y)))}),{sorted:d,cycled:p}}getDependencies(e){const r=[];return this.edges.forEach((n,i)=>{n.has(e)&&r.push(i)}),r}removeDependencies(e){const r=this.dependencyQuery(e);for(const[n,i]of r)this.softRemoveEdge(i,e);return r}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class B4e{constructor(){this.rangeMapping=new Map}getMappingSize(e){var r,n;return(n=(r=this.rangeMapping.get(e))===null||r===void 0?void 0:r.size)!==null&&n!==void 0?n:0}setRange(e){let r=this.rangeMapping.get(e.getStart().sheet);r===void 0&&(r=new Map,this.rangeMapping.set(e.getStart().sheet,r));const n=s0(e.getStart(),e.getEnd());r.set(n,e)}removeRange(e){const r=e.getStart().sheet,n=this.rangeMapping.get(r);if(n===void 0)return;const i=s0(e.getStart(),e.getEnd());n.delete(i),n.size===0&&this.rangeMapping.delete(r)}getRange(e,r){const n=this.rangeMapping.get(e.sheet),i=s0(e,r);return n==null?void 0:n.get(i)}fetchRange(e,r){const n=this.getRange(e,r);if(!n)throw Error("Range does not exist");return n}truncateRanges(e,r){const n=Array(),i=Array(),o=Array(),a=e.sheet;for(const[l,u]of this.entriesFromSheet(e.sheet)){const c=u.range;e.start<=r(u.range.end)&&(c.removeSpan(e),c.shouldBeRemoved()?(this.removeByKey(a,l),n.push(u)):i.push([l,u]),o.push(u))}const s=[];i.sort((l,u)=>j4e(l[1],u[1],r));for(const[l,u]of i){const c=V4e(u.range);if(c===l)continue;const f=this.getByKey(a,c);this.removeByKey(a,l),f!==void 0&&u!=f?s.push([f,u]):this.setRange(u)}return{verticesToRemove:n,verticesToMerge:s,verticesWithChangedSize:o}}moveAllRangesInSheetAfterRowByRows(e,r,n){return this.updateVerticesFromSheet(e,(i,o)=>r<=o.start.row?(o.range.shiftByRows(n),{changedSize:!1,vertex:o}):r>o.start.row&&r<=o.end.row?(o.range.expandByRows(n),{changedSize:!0,vertex:o}):void 0)}moveAllRangesInSheetAfterColumnByColumns(e,r,n){return this.updateVerticesFromSheet(e,(i,o)=>r<=o.start.col?(o.range.shiftByColumns(n),{changedSize:!1,vertex:o}):r>o.start.col&&r<=o.end.col?(o.range.expandByColumns(n),{changedSize:!0,vertex:o}):void 0)}moveRangesInsideSourceRange(e,r,n,i){this.updateVerticesFromSheet(e.sheet,(o,a)=>{if(e.containsRange(a.range))return a.range.shiftByColumns(r),a.range.shiftByRows(n),a.range.moveToSheet(i),{changedSize:!1,vertex:a}})}removeRangesInSheet(e){if(this.rangeMapping.has(e)){const r=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),r}return[][Symbol.iterator]()}*rangesInSheet(e){const r=this.rangeMapping.get(e);r&&(yield*r.values())}*rangeVerticesContainedInRange(e){for(const r of this.rangesInSheet(e.sheet))e.containsRange(r.range)&&(yield r)}findSmallerRange(e){if(e.height()>1&&Number.isFinite(e.height())){const r=Se(e.end.sheet,e.end.col,e.end.row-1),n=this.getRange(e.start,r);if(n!==void 0){const i=$e.fromSimpleCellAddresses(Se(e.start.sheet,e.start.col,e.end.row),e.end);return{smallerRangeVertex:n,restRange:i}}}return{restRange:e}}*entriesFromSheet(e){const r=this.rangeMapping.get(e);r&&(yield*r.entries())}removeByKey(e,r){this.rangeMapping.get(e).delete(r)}getByKey(e,r){var n;return(n=this.rangeMapping.get(e))===null||n===void 0?void 0:n.get(r)}updateVerticesFromSheet(e,r){const n=Array();for(const[i,o]of this.entriesFromSheet(e)){const a=r(i,o);a!==void 0&&(this.removeByKey(e,i),n.push(a))}return n.forEach(i=>{this.setRange(i.vertex)}),{verticesWithChangedSize:n.filter(i=>i.changedSize).map(i=>i.vertex)}}}function s0(t,e){return`${t.col},${t.row},${e.col},${e.row}`}function V4e(t){return s0(t.start,t.end)}const j4e=(t,e,r)=>{const n=r(t.range.start),i=r(t.range.start);if(n===i){const o=r(t.range.end),a=r(e.range.end);return o-a}else return n-i};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class W4e{constructor(e,r,n){this.functions=e,this.errors=r,this.ui=n,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce((e,r)=>(e[this.functions[r]]=r,e),{})}buildErrorMapping(){return Object.keys(this.errors).reduce((e,r)=>(e[this.errors[r]]=r,e),{})}isFunctionTranslated(e){return this.functions[e]!==void 0}getFunctionTranslations(e){const r=[];for(const n of e)this.isFunctionTranslated(n)&&r.push(this.functions[n]);return r}getFunctionTranslation(e){const r=this.functions[e];if(r===void 0)throw new Nc(`functions.${e}`);return r}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===N.LIC)return`#${N.LIC}!`;const r=this.errors[e];if(r===void 0)throw new Nc(`errors.${e}`);return r}getUITranslation(e){const r=this.ui[e];if(r===void 0)throw new Nc(`ui.${e}`);return r}checkUI(){for(const e of Object.values(bv))if(!(e in this.ui))throw new Nc(`ui.${e}`)}checkErrors(){for(const e of Object.values(N))if(!(e in this.errors)&&e!==N.LIC)throw new Nc(`errors.${e}`)}checkFunctionTranslations(e){const r=new Set(Object.getOwnPropertyNames(e));for(const n of Object.getOwnPropertyNames(this._protectedTranslations))if(r.has(n))throw new Nj(n)}}function G4e(t){return new W4e(Object.assign({},t.functions),Object.assign({},t.errors),Object.assign({},t.ui))}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var bv;(function(t){t.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"})(bv||(bv={}));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function Pc(t){return t.toLowerCase()}class z4e{constructor(e,r){this.id=e,this.displayName=r}get canonicalName(){return Pc(this.displayName)}}class Y4e{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=r=>{const n=this.mappingFromCanonicalName.get(Pc(r));if(n===void 0)throw new yj(r);return n.id},this.get=r=>{var n;return(n=this.mappingFromCanonicalName.get(Pc(r)))===null||n===void 0?void 0:n.id},this.fetchDisplayName=r=>this.fetchSheetById(r).displayName,this.sheetNamePrefix=e.getUITranslation(bv.NEW_SHEET_PREFIX)}addSheet(e=`${this.sheetNamePrefix}${this.lastSheetId+2}`){const r=Pc(e);if(this.mappingFromCanonicalName.has(r))throw new vv(e);this.lastSheetId++;const n=new z4e(this.lastSheetId,e);return this.store(n),n.id}removeSheet(e){const r=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(r.canonicalName),this.mappingFromId.delete(r.id)}getDisplayName(e){var r;return(r=this.mappingFromId.get(e))===null||r===void 0?void 0:r.displayName}*displayNames(){for(const e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(Pc(e))}renameSheet(e,r){const n=this.fetchSheetById(e),i=n.displayName;if(i===r)return;const o=this.mappingFromCanonicalName.get(Pc(r));if(o!==void 0&&o.id!==n.id)throw new vv(r);const a=n.canonicalName;return this.mappingFromCanonicalName.delete(a),n.displayName=r,this.store(n),i}sheetNames(){return Array.from(this.mappingFromId.values()).map(e=>e.displayName)}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){const r=this.mappingFromId.get(e);if(r===void 0)throw new ar(e);return r}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class yI{constructor(e,r,n,i,o,a,s,l){this.addressMapping=e,this.rangeMapping=r,this.sheetMapping=n,this.arrayMapping=i,this.stats=o,this.lazilyTransformingAstService=a,this.functionRegistry=s,this.namedExpressions=l,this.changes=Ps.empty(),this.dependencyQueryAddresses=u=>{if(u instanceof fn)return this.rangeDependencyQuery(u).map(([c,f])=>c);{const c=this.formulaDependencyQuery(u);if(c!==void 0){const[f,h]=c;return h.map(d=>d instanceof Os?this.namedExpressions.namedExpressionOrPlaceholder(d.name,f.sheet).address:gr(d)?d:S5(d.start,d.end))}else return[]}},this.dependencyQueryVertices=u=>{if(u instanceof fn)return this.rangeDependencyQuery(u);{const c=this.formulaDependencyQuery(u);if(c!==void 0){const[f,h]=c;return h.map(d=>{if(d instanceof $e)return[d.start,this.rangeMapping.fetchRange(d.start,d.end)];if(d instanceof Os){const p=this.namedExpressions.namedExpressionOrPlaceholder(d.name,f.sheet);return[p.address,this.addressMapping.fetchCell(p.address)]}else return[d,this.addressMapping.fetchCell(d)]})}else return[]}},this.rangeDependencyQuery=u=>{const c=[],{smallerRangeVertex:f,restRange:h}=this.rangeMapping.findSmallerRange(u.range);let d;f!==void 0&&this.graph.adjacentNodes(f).has(u)?(d=h,c.push([new $e(f.start,f.end),f])):d=u.range;for(const p of d.addresses(this)){const m=this.addressMapping.getCell(p);m!==void 0&&c.push([p,m])}return c},this.formulaDependencyQuery=u=>{let c,f;if(u instanceof li)f=u.getAddress(this.lazilyTransformingAstService),c=u.getFormula(this.lazilyTransformingAstService);else return;const h=Dw(c,this.functionRegistry);return[f,Oo(h,f)]},this.graph=new U4e(this.dependencyQueryVertices)}static buildEmpty(e,r,n,i,o){return new yI(new D4e(r.chooseAddressMappingPolicy),new B4e,new Y4e(r.translationPackage),new F4e,o,e,n,i)}setFormulaToCell(e,r,n,i,o,a){const s=li.fromAst(r,e,i,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(s),this.processCellDependencies(n,s),this.graph.markNodeAsSpecialRecentlyChanged(s),o&&this.markAsVolatile(s),a&&this.markAsDependentOnStructureChange(s),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,r){const n=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(n,r),this.addressMapping.setCell(e,r),this.graph.markNodeAsSpecialRecentlyChanged(r),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,r){const n=this.shrinkPossibleArrayAndGetCell(e);if(n instanceof yr&&this.arrayMapping.removeArray(n.getRange()),n instanceof Ms)n.getValues().rawValue!==r.rawValue&&(n.setValues(r),this.graph.markNodeAsSpecialRecentlyChanged(n));else{const i=new Ms(r.parsedValue,r.rawValue);this.exchangeOrAddGraphNode(n,i),this.addressMapping.setCell(e,i),this.graph.markNodeAsSpecialRecentlyChanged(i)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){const r=this.shrinkPossibleArrayAndGetCell(e);if(r===void 0)return Ps.empty();if(this.graph.adjacentNodes(r).size>0){const n=new bs;this.exchangeGraphNode(r,n),this.graph.adjacentNodesCount(n)===0?(this.removeVertex(n),this.addressMapping.removeCell(e)):(this.graph.markNodeAsSpecialRecentlyChanged(n),this.addressMapping.setCell(e,n))}else this.removeVertex(r),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}ensureThatVertexIsNonArrayCellVertex(e){if(e instanceof yr)throw new Error("Illegal operation")}clearRecentlyChangedVertices(){this.graph.clearSpecialNodesRecentlyChanged()}verticesToRecompute(){return new Set([...this.graph.specialNodesRecentlyChanged,...this.volatileVertices()])}processCellDependencies(e,r){e.forEach(n=>{if(n instanceof $e){const i=n;let o=this.getRange(i.start,i.end);o===void 0&&(o=new fn(i),this.rangeMapping.setRange(o)),this.graph.addNode(o),i.isFinite()||this.graph.markNodeAsInfiniteRange(o);const{smallerRangeVertex:a,restRange:s}=this.rangeMapping.findSmallerRange(i);if(a!==void 0){if(this.graph.addEdge(a,o),o.bruteForce){o.bruteForce=!1;for(const u of i.addresses(this))this.graph.removeEdge(this.fetchCell(u),o)}}else o.bruteForce=!0;const l=this.arrayMapping.getArray(s);if(l!==void 0)this.graph.addEdge(l,o);else for(const u of s.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(u),o);this.graph.addEdge(o,r),i.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(o)}else if(n instanceof Os){const i=r.getAddress(this.lazilyTransformingAstService).sheet,o=this.fetchNamedExpressionVertex(n.name,i);this.graph.addEdge(o,r)}else this.graph.addEdge(this.fetchCellOrCreateEmpty(n),r)})}fetchNamedExpressionVertex(e,r){const n=this.namedExpressions.namedExpressionOrPlaceholder(e,r);return this.fetchCellOrCreateEmpty(n.address)}exchangeNode(e,r){const n=this.fetchCellOrCreateEmpty(e),i=this.fetchCellOrCreateEmpty(r);this.addressMapping.removeCell(e),this.exchangeGraphNode(n,i)}correctInfiniteRangesDependency(e){let r;for(const n of this.graph.infiniteRanges){const i=n;i.range.addressInRange(e)&&(r=r??this.fetchCellOrCreateEmpty(e),this.graph.addEdge(r,i))}}fetchCellOrCreateEmpty(e){let r=this.addressMapping.getCell(e);return r===void 0&&(r=new bs,this.graph.addNode(r),this.addressMapping.setCell(e,r)),r}removeRows(e){this.stats.measure(Ke.ADJUSTING_GRAPH,()=>{for(const[n,i]of this.addressMapping.entriesFromRowsSpan(e)){for(const o of this.graph.adjacentNodes(i))this.graph.markNodeAsSpecialRecentlyChanged(o);if(i instanceof yr)if(i.isLeftCorner(n))this.shrinkArrayToCorner(i),this.arrayMapping.removeArray(i.getRange());else continue;this.removeVertex(i)}}),this.stats.measure(Ke.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeRows(e)});const r=this.stats.measure(Ke.ADJUSTING_RANGES,()=>{const n=this.truncateRanges(e,i=>i.row);return this.getArrayVerticesRelatedToRanges(n)});return this.stats.measure(Ke.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)}),this.addStructuralNodesToChangeSet(),{affectedArrays:r,contentChanges:this.getAndClearContentChanges()}}removeSheet(e){this.clearSheet(e);for(const[r,n]of this.addressMapping.sheetEntries(e)){for(const i of this.graph.adjacentNodes(n))this.graph.markNodeAsSpecialRecentlyChanged(i);this.removeVertex(n),this.addressMapping.removeCell(r)}this.stats.measure(Ke.ADJUSTING_RANGES,()=>{const r=this.rangeMapping.removeRangesInSheet(e);for(const n of r)this.removeVertex(n);this.stats.measure(Ke.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeSheet(e)})})}clearSheet(e){const r=new Set;for(const[n,i]of this.addressMapping.sheetEntries(e))i instanceof yr?r.add(i):this.setCellEmpty(n);for(const n of r.values())this.setArrayEmpty(n);this.addStructuralNodesToChangeSet()}removeColumns(e){this.stats.measure(Ke.ADJUSTING_GRAPH,()=>{for(const[n,i]of this.addressMapping.entriesFromColumnsSpan(e)){for(const o of this.graph.adjacentNodes(i))this.graph.markNodeAsSpecialRecentlyChanged(o);if(i instanceof yr)if(i.isLeftCorner(n))this.shrinkArrayToCorner(i),this.arrayMapping.removeArray(i.getRange());else continue;this.removeVertex(i)}}),this.stats.measure(Ke.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeColumns(e)});const r=this.stats.measure(Ke.ADJUSTING_RANGES,()=>{const n=this.truncateRanges(e,i=>i.col);return this.getArrayVerticesRelatedToRanges(n)});return this.stats.measure(Ke.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns)),this.addStructuralNodesToChangeSet(),{affectedArrays:r,contentChanges:this.getAndClearContentChanges()}}addRows(e){this.stats.measure(Ke.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)});const r=this.stats.measure(Ke.ADJUSTING_RANGES,()=>{const n=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return this.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),this.getArrayVerticesRelatedToRanges(n.verticesWithChangedSize)});this.stats.measure(Ke.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)});for(const n of this.addressMapping.verticesFromRowsSpan(e))this.graph.markNodeAsSpecialRecentlyChanged(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:r}}addColumns(e){this.stats.measure(Ke.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)});const r=this.stats.measure(Ke.ADJUSTING_RANGES,()=>{const n=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return this.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),this.getArrayVerticesRelatedToRanges(n.verticesWithChangedSize)});this.stats.measure(Ke.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns));for(const n of this.addressMapping.verticesFromColumnsSpan(e))this.graph.markNodeAsSpecialRecentlyChanged(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:r,contentChanges:this.getAndClearContentChanges()}}ensureNoArrayInRange(e){if(this.arrayMapping.isFormulaArrayInRange(e))throw Error("It is not possible to move / replace cells with array")}isThereSpaceForArray(e){const r=e.getRangeOrUndef();if(r===void 0)return!1;for(const n of r.addresses(this)){const i=this.addressMapping.getCell(n);if(i!==void 0&&!(i instanceof bs)&&i!==e)return!1}return!0}moveCells(e,r,n,i){for(const o of e.addressesWithDirection(r,n,this)){const a=Se(i,o.col+r,o.row+n);let s=this.addressMapping.getCell(o);const l=this.addressMapping.getCell(a);if(this.addressMapping.removeCell(o),s!==void 0){this.graph.markNodeAsSpecialRecentlyChanged(s),this.addressMapping.setCell(a,s);let u;for(const c of this.graph.adjacentNodes(s))c instanceof fn&&!e.containsRange(c.range)&&(u=u??this.fetchCellOrCreateEmpty(o),this.graph.addEdge(u,c),this.graph.removeEdge(s,c));u&&(this.graph.markNodeAsSpecialRecentlyChanged(u),this.addressMapping.setCell(o,u))}if(l!==void 0){s===void 0&&this.addressMapping.removeCell(a);for(const u of this.graph.adjacentNodes(l))s=s??this.fetchCellOrCreateEmpty(a),this.graph.addEdge(s,u),this.graph.markNodeAsSpecialRecentlyChanged(s);this.removeVertex(l)}}for(const o of this.rangeMapping.rangeVerticesContainedInRange(e))for(const a of this.graph.adjacentNodes(o))if(a instanceof fn&&!e.containsRange(a.range)){this.graph.removeEdge(o,a);for(const s of o.range.addresses(this)){const l=this.fetchCellOrCreateEmpty(s);this.graph.addEdge(l,a),this.addressMapping.setCell(s,l),this.graph.markNodeAsSpecialRecentlyChanged(l)}}this.rangeMapping.moveRangesInsideSourceRange(e,r,n,i)}setArrayEmpty(e){const r=$e.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),n=this.graph.adjacentNodes(e);for(const i of r.addresses(this))this.addressMapping.removeCell(i);for(const i of n.values()){const o=H4e(this.functionRegistry,i,e.getRange(),this.lazilyTransformingAstService,this);for(const a of o){const s=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(s,i)}o.length>0&&this.graph.markNodeAsSpecialRecentlyChanged(i)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,r){this.graph.addNode(r),this.addressMapping.setCell(e,r)}addArrayVertex(e,r){this.graph.addNode(r),this.setAddressMappingForArrayVertex(r,e)}*arrayFormulaNodes(){for(const e of this.graph.nodes)e instanceof yr&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}existsVertex(e){return this.addressMapping.has(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){const r=this.addressMapping.getCellValue(e);return r instanceof Pe?new C(N.VALUE,x.ScalarExpected):r}existsEdge(e,r){return this.graph.existsEdge(e,r)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}setArray(e,r){this.arrayMapping.setArray(e,r)}getRange(e,r){return this.rangeMapping.getRange(e,r)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsSpecial(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.nodes.values())e instanceof Io&&e.ensureRecentData(this.lazilyTransformingAstService)}volatileVertices(){return this.graph.specialNodes}getArrayVerticesRelatedToRanges(e){const r=e.map(n=>this.graph.hasNode(n)?Array.from(this.graph.adjacentNodes(n)).filter(i=>i instanceof yr):[]);return new Set(...r)}*rawValuesFromRange(e){for(const r of e.addresses(this)){const n=this.getScalarValue(r);n!==ft&&(yield[ye(n),r])}}*entriesFromRange(e){for(const r of e.addresses(this))yield[r,this.getCell(r)]}exchangeGraphNode(e,r){this.graph.addNode(r);const n=this.graph.adjacentNodes(e);this.removeVertex(e),n.forEach(i=>{this.graph.hasNode(i)&&this.graph.addEdge(r,i)})}exchangeOrAddGraphNode(e,r){e?this.exchangeGraphNode(e,r):this.graph.addNode(r)}computeListOfValuesInRange(e){const r=[];for(const n of e.addresses(this)){const i=this.getScalarValue(n);r.push(i)}return r}shrinkArrayToCorner(e){this.cleanAddressMappingUnderArray(e);for(const r of this.adjacentArrayVertices(e)){let n;r instanceof li?n=this.formulaDirectDependenciesToArray(r,e):n=this.rangeDirectDependenciesToArray(r,e);let i=!1;for(const[o,a]of n)e.isLeftCorner(o)&&(i=!0),this.graph.addEdge(a,r),this.graph.markNodeAsSpecialRecentlyChanged(a);i||this.graph.removeEdge(e,r)}this.graph.markNodeAsSpecialRecentlyChanged(e)}isArrayInternalCell(e){const r=this.getCell(e);return r instanceof yr&&!r.isLeftCorner(e)}getAndClearContentChanges(){const e=this.changes;return this.changes=Ps.empty(),e}getAdjacentNodesAddresses(e){const r=this.graph.adjacentNodes(e),n=[];return r.forEach(i=>{const o=i;o instanceof fn?n.push(S5(o.start,o.end)):n.push(o.getAddress(this.lazilyTransformingAstService))}),n}correctInfiniteRangesDependenciesByRangeVertex(e){for(const r of this.graph.infiniteRanges){const n=r,i=e.range.intersectionWith(n.range);if(i!==void 0)for(const o of i.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(o),r)}}cleanAddressMappingUnderArray(e){const r=e.getRange();for(const n of r.addresses(this)){const i=e.getArrayCellValue(n);this.getCell(n)===e?e.isLeftCorner(n)?this.changes.addChange(new C(N.REF),n,i):(this.addressMapping.removeCell(n),this.changes.addChange(ft,n,i)):this.changes.addChange(ft,n,i)}}*formulaDirectDependenciesToArray(e,r){var n;const[,i]=(n=this.formulaDependencyQuery(e))!==null&&n!==void 0?n:[];if(i!==void 0){for(const o of i)if(!(o instanceof Os||o instanceof $e)&&r.getRange().addressInRange(o)){const a=this.fetchCellOrCreateEmpty(o);yield[o,a]}}}*rangeDirectDependenciesToArray(e,r){const{restRange:n}=this.rangeMapping.findSmallerRange(e.range);for(const i of n.addresses(this))if(r.getRange().addressInRange(i)){const o=this.fetchCellOrCreateEmpty(i);yield[i,o]}}*adjacentArrayVertices(e){const r=this.graph.adjacentNodes(e);for(const n of r)(n instanceof li||n instanceof fn)&&(yield n)}addStructuralNodesToChangeSet(){for(const e of this.graph.specialNodesStructuralChanges)this.graph.markNodeAsSpecialRecentlyChanged(e)}fixRangesWhenAddingRows(e,r,n){const i=Array.from(this.rangeMapping.rangesInSheet(e));for(const o of i)if(o.range.includesRow(r+n))if(o.bruteForce){const a=o.range.rangeWithSameWidth(r,n);for(const s of a.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(s),o)}else{let a=o,s=this.rangeMapping.findSmallerRange(a.range);if(s.smallerRangeVertex!==void 0)continue;for(;s.smallerRangeVertex===void 0;){const l=new fn($e.spanFrom(a.range.start,a.range.width(),a.range.height()-1));this.rangeMapping.setRange(l),this.graph.addNode(l);const u=new $e(Se(a.range.start.sheet,a.range.start.col,a.range.end.row),a.range.end);this.addAllFromRange(u,a),this.graph.addEdge(l,a),a=l,s=this.rangeMapping.findSmallerRange(a.range)}this.graph.addEdge(s.smallerRangeVertex,a),this.addAllFromRange(s.restRange,a),this.graph.removeEdge(s.smallerRangeVertex,o)}}addAllFromRange(e,r){for(const n of e.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(n),r)}fixRangesWhenAddingColumns(e,r,n){for(const i of this.rangeMapping.rangesInSheet(e))if(i.range.includesColumn(r+n)){let o;i.bruteForce?o=i.range.rangeWithSameHeight(r,n):o=$e.spanFrom(Se(e,r,i.range.end.row),n,1);for(const a of o.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(a),i)}}exchangeOrAddFormulaVertex(e){const r=e.getAddress(this.lazilyTransformingAstService),n=$e.spanFrom(r,e.width,e.height),i=this.shrinkPossibleArrayAndGetCell(r);if(e instanceof yr&&this.setArray(n,e),this.exchangeOrAddGraphNode(i,e),this.addressMapping.setCell(r,e),e instanceof yr){if(!this.isThereSpaceForArray(e))return;for(const o of n.addresses(this)){if(e.isLeftCorner(o))continue;const a=this.getCell(o);this.exchangeOrAddGraphNode(a,e)}}for(const o of n.addresses(this))this.addressMapping.setCell(o,e)}setAddressMappingForArrayVertex(e,r){if(this.addressMapping.setCell(r,e),!(e instanceof yr))return;const n=$e.spanFromOrUndef(r,e.width,e.height);if(n!==void 0&&(this.setArray(n,e),!!this.isThereSpaceForArray(e)))for(const i of n.addresses(this))this.addressMapping.setCell(i,e)}truncateRanges(e,r){const{verticesToRemove:n,verticesToMerge:i,verticesWithChangedSize:o}=this.rangeMapping.truncateRanges(e,r);for(const[a,s]of i)this.mergeRangeVertices(a,s);for(const a of n)this.removeVertexAndCleanupDependencies(a);return o}fixArraysAfterAddingRow(e,r,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,r,n),!(r<=0))for(const[,i]of this.arrayMapping.arraysInRows(Vn.fromRowStartAndEnd(e,r-1,r-1))){const o=i.getRange();for(let a=o.start.col;a<=o.end.col;++a)for(let s=r;s<=o.end.row;++s){const l=Se(e,a,s),u=Se(e,a,s+n),c=i.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(ft,u,c)}}}fixArraysAfterRemovingRows(e,r,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,r,-n),!(r<=0))for(const[,i]of this.arrayMapping.arraysInRows(Vn.fromRowStartAndEnd(e,r-1,r-1)))if(this.isThereSpaceForArray(i))for(const o of i.getRange().addresses(this))this.addressMapping.setCell(o,i);else this.setNoSpaceIfArray(i)}fixArraysAfterAddingColumn(e,r,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,r,n),!(r<=0))for(const[,i]of this.arrayMapping.arraysInCols(si.fromColumnStartAndEnd(e,r-1,r-1))){const o=i.getRange();for(let a=o.start.row;a<=o.end.row;++a)for(let s=r;s<=o.end.col;++s){const l=Se(e,s,a),u=Se(e,s+n,a),c=i.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(ft,u,c)}}}fixArraysAfterRemovingColumns(e,r,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,r,-n),!(r<=0))for(const[,i]of this.arrayMapping.arraysInCols(si.fromColumnStartAndEnd(e,r-1,r-1)))if(this.isThereSpaceForArray(i))for(const o of i.getRange().addresses(this))this.addressMapping.setCell(o,i);else this.setNoSpaceIfArray(i)}shrinkPossibleArrayAndGetCell(e){const r=this.getCell(e);return r instanceof yr?(this.setNoSpaceIfArray(r),this.getCell(e)):r}setNoSpaceIfArray(e){e instanceof yr&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof fn&&this.rangeMapping.removeRange(e)}mergeRangeVertices(e,r){const n=this.graph.adjacentNodes(r);this.removeVertexAndCleanupDependencies(r),this.graph.softRemoveEdge(e,r),n.forEach(i=>{this.graph.hasNode(i)&&this.graph.addEdge(e,i)})}removeVertexAndCleanupDependencies(e){const r=new Set(this.graph.removeNode(e));for(;r.size>0;){const n=r.values().next().value;r.delete(n);const[i,o]=n;this.graph.hasNode(o)&&this.graph.adjacentNodesCount(o)===0&&((o instanceof fn||o instanceof bs)&&this.graph.removeNode(o).forEach(a=>r.add(a)),o instanceof fn?this.rangeMapping.removeRange(o):o instanceof bs&&this.addressMapping.removeCell(i))}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class bs{constructor(){}getCellValue(){return ft}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ms{constructor(e,r){this.parsedValue=e,this.rawValue=r}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}setCellValue(e){throw Error("SetCellValue is deprecated for ValueCellVertex")}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Kc{constructor(e,r){this.errors=e,this.rawInput=r}getCellValue(){return C.parsingError()}getFormula(){return this.rawInput}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class K4e{constructor(e,r){this.width=e,this.height=r,this.mapping=new Map}getCell(e){var r;return(r=this.mapping.get(e.col))===null||r===void 0?void 0:r.get(e.row)}setCell(e,r){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let n=this.mapping.get(e.col);n||(n=new Map,this.mapping.set(e.col,n)),n.set(e.row,r)}has(e){var r;return!!(!((r=this.mapping.get(e.col))===null||r===void 0)&&r.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var r;(r=this.mapping.get(e.col))===null||r===void 0||r.delete(e.row)}addRows(e,r){this.mapping.forEach(n=>{const i=new Map;n.forEach((o,a)=>{a>=e&&(i.set(a+r,o),n.delete(a))}),i.forEach((o,a)=>{n.set(a,o)})}),this.height+=r}addColumns(e,r){const n=new Map;this.mapping.forEach((i,o)=>{o>=e&&(n.set(o+r,i),this.mapping.delete(o))}),n.forEach((i,o)=>{this.mapping.set(o,i)}),this.width+=r}removeRows(e){this.mapping.forEach(i=>{const o=new Map;i.forEach((a,s)=>{s>=e.rowStart&&(i.delete(s),s>e.rowEnd&&o.set(s-e.numberOfRows,a))}),o.forEach((a,s)=>{i.set(s,a)})});const r=Math.min(this.height-1,e.rowEnd),n=Math.max(0,r-e.rowStart+1);this.height=Math.max(0,this.height-n)}removeColumns(e){const r=new Map;this.mapping.forEach((o,a)=>{a>=e.columnStart&&(this.mapping.delete(a),a>e.columnEnd&&r.set(a-e.numberOfColumns,o))}),r.forEach((o,a)=>{this.mapping.set(a,o)});const n=Math.min(this.width-1,e.columnEnd),i=Math.max(0,n-e.columnStart+1);this.width=Math.max(0,this.width-i)}*getEntries(e){for(const[r,n]of this.mapping)for(const[i,o]of n)yield[Se(e,r,i),o]}*verticesFromColumn(e){const r=this.mapping.get(e);if(r!==void 0)for(const[n,i]of r)yield i}*verticesFromRow(e){for(const r of this.mapping.values()){const n=r.get(e);n!==void 0&&(yield n)}}*verticesFromColumnsSpan(e){for(const r of e.columns()){const n=this.mapping.get(r);if(n!==void 0)for(const[i,o]of n)yield o}}*verticesFromRowsSpan(e){for(const r of this.mapping.values())for(const n of e.rows()){const i=r.get(n);i!==void 0&&(yield i)}}*entriesFromRowsSpan(e){for(const[r,n]of this.mapping.entries())for(const i of e.rows()){const o=n.get(i);o!==void 0&&(yield[Se(e.sheet,r,i),o])}}*entriesFromColumnsSpan(e){for(const r of e.columns()){const n=this.mapping.get(r);if(n!==void 0)for(const[i,o]of n.entries())yield[Se(e.sheet,r,i),o]}}*vertices(){for(const[e,r]of this.mapping)for(const[n,i]of r)i!==void 0&&(yield i)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class X4e{constructor(e,r){this.width=e,this.height=r,this.mapping=new Array(r);for(let n=0;n<r;n++)this.mapping[n]=new Array(e)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,r){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=r}has(e){const r=this.mapping[e.row];return r?!!r[e.col]:!1}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){this.mapping[e.row]!==void 0&&delete this.mapping[e.row][e.col]}addRows(e,r){const n=[];for(let i=0;i<r;i++)n.push(new Array(this.width));this.mapping.splice(e,0,...n),this.height+=r}addColumns(e,r){for(let n=0;n<this.height;n++)this.mapping[n].splice(e,0,...new Array(r));this.width+=r}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);const r=Math.min(this.height-1,e.rowEnd),n=Math.max(0,r-e.rowStart+1);this.height=Math.max(0,this.height-n)}removeColumns(e){for(let i=0;i<this.height;i++)this.mapping[i].splice(e.columnStart,e.numberOfColumns);const r=Math.min(this.width-1,e.columnEnd),n=Math.max(0,r-e.columnStart+1);this.width=Math.max(0,this.width-n)}*getEntries(e){for(let r=0;r<this.height;++r)for(let n=0;n<this.width;++n){const i=this.getCellVertex(n,r);i&&(yield[Se(e,n,r),i])}}*verticesFromColumn(e){for(let r=0;r<this.height;++r){const n=this.getCellVertex(e,r);n&&(yield n)}}*verticesFromRow(e){for(let r=0;r<this.width;++r){const n=this.getCellVertex(r,e);n&&(yield n)}}*verticesFromColumnsSpan(e){for(let r=e.columnStart;r<=e.columnEnd;++r)for(let n=0;n<this.height;++n){const i=this.getCellVertex(r,n);i&&(yield i)}}*verticesFromRowsSpan(e){for(let r=0;r<this.width;++r)for(let n=e.rowStart;n<=e.rowEnd;++n){const i=this.getCellVertex(r,n);i&&(yield i)}}*entriesFromRowsSpan(e){for(let r=0;r<this.width;++r)for(let n=e.rowStart;n<=e.rowEnd;++n){const i=this.getCellVertex(r,n);i&&(yield[Se(e.sheet,r,n),i])}}*entriesFromColumnsSpan(e){for(let r=e.columnStart;r<=e.columnEnd;++r)for(let n=0;n<this.height;++n){const i=this.getCellVertex(r,n);i&&(yield[Se(e.sheet,r,n),i])}}*vertices(){for(let e=0;e<this.height;++e)for(let r=0;r<this.width;++r){const n=this.getCellVertex(r,e);n&&(yield n)}}getCellVertex(e,r){var n;return(n=this.mapping[r])===null||n===void 0?void 0:n[e]}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var N;(function(t){t.DIV_BY_ZERO="DIV_BY_ZERO",t.NAME="NAME",t.VALUE="VALUE",t.NUM="NUM",t.NA="NA",t.CYCLE="CYCLE",t.REF="REF",t.SPILL="SPILL",t.LIC="LIC",t.ERROR="ERROR"})(N||(N={}));var Dn;(function(t){t.FORMULA="FORMULA",t.VALUE="VALUE",t.ARRAY="ARRAY",t.EMPTY="EMPTY",t.ARRAYFORMULA="ARRAYFORMULA"})(Dn||(Dn={}));const q4e=(t,e)=>t instanceof yr?t.isLeftCorner(e)?Dn.ARRAYFORMULA:Dn.ARRAY:t instanceof Io||t instanceof Kc?Dn.FORMULA:t instanceof Ms?Dn.VALUE:Dn.EMPTY;var Xb;(function(t){t.EMPTY="EMPTY",t.NUMBER="NUMBER",t.STRING="STRING",t.BOOLEAN="BOOLEAN",t.ERROR="ERROR"})(Xb||(Xb={}));var w5;(function(t){t.NUMBER="NUMBER"})(w5||(w5={}));const Ki=Object.assign(Object.assign({},Xb),w5),Q4e=Object.assign(Object.assign({},Xb),Ie),zM=t=>{switch(t){case Ki.EMPTY:return 0;case Ki.NUMBER:return 1;case Ki.STRING:return 2;case Ki.BOOLEAN:return 3;case Ki.ERROR:return 4}throw new Error("Cell value not computed")},qb=t=>{if(t===ft)return Ki.EMPTY;if(t instanceof C||t instanceof Pe)return Ki.ERROR;if(typeof t=="string")return Ki.STRING;if(Rt(t))return Ki.NUMBER;if(typeof t=="boolean")return Ki.BOOLEAN;throw new Error("Cell value not computed")},Z4e=t=>Rt(t)?P4e(t):qb(t),J4e=t=>{if(Rt(t))return M4e(t)};class C{constructor(e,r,n){this.type=e,this.message=r,this.root=n}static parsingError(){return new C(N.ERROR,x.ParseError)}attachRootVertex(e){return this.root===void 0?new C(this.type,this.message,e):this}}const Mj=(t,e)=>({sheet:t,row:e}),eNe=t=>t.row<0,kj=(t,e)=>({sheet:t,col:e}),tNe=t=>t.col<0,Se=(t,e,r)=>({sheet:t,col:e,row:r}),Un=t=>t.col<0||t.row<0,rNe=(t,e,r,n)=>Se(e,t.col+r,t.row+n),l0=t=>`${t.sheet},${t.row},${t.col}`;function gr(t){return t&&(typeof t=="object"||typeof t=="function")?"col"in t&&typeof t.col=="number"&&"row"in t&&typeof t.row=="number"&&"sheet"in t&&typeof t.sheet=="number":!1}const Zi=(t,e)=>{var r;return(r=t.sheet)!==null&&r!==void 0?r:e.sheet},wv=(t,e)=>t.sheet===e.sheet&&t.col===e.col&&t.row===e.row;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const nNe="AbsoluteCellRange: Wrong range size";function qn(t){return t&&(typeof t=="object"||typeof t=="function")?"start"in t&&gr(t.start)&&"end"in t&&gr(t.end):!1}const S5=(t,e)=>({start:t,end:e});class $e{constructor(e,r){if(e.sheet!==r.sheet)throw new gv(e.sheet,r.sheet);this.start=Se(e.sheet,e.col,e.row),this.end=Se(r.sheet,r.col,r.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,r){if(e.sheet!==r.sheet)throw new gv(e.sheet,r.sheet);const n=r.col-e.col,i=r.row-e.row;return Number.isFinite(i)&&Number.isFinite(n)?new $e(e,r):Number.isFinite(i)?new Ha(e.sheet,e.row,r.row):new Fa(e.sheet,e.col,r.col)}static fromAst(e,r){return e.type===P.CELL_RANGE?$e.fromCellRange(e,r):e.type===P.COLUMN_RANGE?Fa.fromColumnRange(e,r):Ha.fromRowRangeAst(e,r)}static fromAstOrUndef(e,r){try{return $e.fromAst(e,r)}catch{return}}static fromCellRange(e,r){return new $e(e.start.toSimpleCellAddress(r),e.end.toSimpleCellAddress(r))}static spanFrom(e,r,n){const i=$e.spanFromOrUndef(e,r,n);if(i===void 0)throw new Error(nNe);return i}static spanFromOrUndef(e,r,n){if(!Number.isFinite(r)&&Number.isFinite(n))return e.col!==0?void 0:new Ha(e.sheet,e.row,e.row+n-1);if(!Number.isFinite(n)&&Number.isFinite(r))return e.row!==0?void 0:new Fa(e.sheet,e.col,e.col+r-1);if(Number.isFinite(n)&&Number.isFinite(r))return new $e(e,Se(e.sheet,e.col+r-1,e.row+n-1))}static fromCoordinates(e,r,n,i,o){return new $e(Se(e,r,n),Se(e,i,o))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return!(this.start.sheet!=e.start.sheet||this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}addressInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}columnInRange(e){return this.sheet!==e.sheet?!1:this.start.col<=e.col&&this.end.col>=e.col}rowInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet!==e.start.sheet)return;const r=Math.max(this.start.row,e.start.row),n=Math.min(this.end.row,e.end.row),i=Math.max(this.start.col,e.start.col),o=Math.min(this.end.col,e.end.col);if(!(r>n||i>o))return new $e(Se(this.sheet,i,r),Se(this.sheet,o,n))}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,r){return $e.spanFrom(Se(this.sheet,this.start.col+e,this.start.row+r),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof Vn?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,r){return $e.spanFrom(Se(this.sheet,this.start.col,e),this.width(),r)}rangeWithSameHeight(e,r){return $e.spanFrom(Se(this.sheet,e,this.start.row),r,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},${this.end.row}`}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){const e=[];for(let r=0;r<this.height();++r){e[r]=[];for(let n=0;n<this.width();++n){const i=Se(this.sheet,this.start.col+n,this.start.row+r);e[r].push(i)}}return e}withStart(e){return new $e(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return wv(this.start,e.start)&&wv(this.end,e.end)}addressesArrayMap(e,r){const n=[];let i=this.start.row;for(;i<=this.effectiveEndRow(e);){let o=this.start.col;const a=[];for(;o<=this.effectiveEndColumn(e);)a.push(r(Se(this.start.sheet,o,i))),o++;n.push(a),i++}return n}addresses(e){const r=[];let n=this.start.row;const i=this.effectiveEndRow(e),o=this.effectiveEndColumn(e);for(;n<=i;){let a=this.start.col;for(;a<=o;)r.push(Se(this.start.sheet,a,n)),a++;n++}return r}*addressesWithDirection(e,r,n){if(e>0)if(r>0){let i=this.effectiveEndRow(n);for(;i>=this.start.row;){let o=this.effectiveEndColumn(n);for(;o>=this.start.col;)yield Se(this.start.sheet,o,i),o-=1;i-=1}}else{let i=this.start.row;for(;i<=this.effectiveEndRow(n);){let o=this.effectiveEndColumn(n);for(;o>=this.start.col;)yield Se(this.start.sheet,o,i),o-=1;i+=1}}else if(r>0){let i=this.effectiveEndRow(n);for(;i>=this.start.row;){let o=this.start.col;for(;o<=this.effectiveEndColumn(n);)yield Se(this.start.sheet,o,i),o+=1;i-=1}}else{let i=this.start.row;for(;i<=this.effectiveEndRow(n);){let o=this.start.col;for(;o<=this.effectiveEndColumn(n);)yield Se(this.start.sheet,o,i),o+=1;i+=1}}}getAddress(e,r){if(e<0||r<0||r>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return Se(this.start.sheet,this.start.col+e,this.start.row+r)}exceedsSheetSizeLimits(e,r){return this.end.col>=e||this.end.row>=r}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,r){if(!(e>this.end.row)){if(r<this.start.row){const n=r-e+1;return this.shiftByRows(-n)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(r,this.end.row)-e+1}}removeColumns(e,r){if(!(e>this.end.col)){if(r<this.start.col){const n=r-e+1;return this.shiftByColumns(-n)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(r,this.end.col)-e+1}}}class Fa extends $e{constructor(e,r,n){super(Se(e,r,0),Se(e,n,Number.POSITIVE_INFINITY))}static fromColumnRange(e,r){const n=e.start.toSimpleColumnAddress(r),i=e.end.toSimpleColumnAddress(r);if(n.sheet!==i.sheet)throw new gv(n.sheet,i.sheet);return new Fa(n.sheet,n.col,i.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,r){return new Fa(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,r){return new Fa(this.sheet,e,e+r-1)}exceedsSheetSizeLimits(e,r){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,r){}}class Ha extends $e{constructor(e,r,n){super(Se(e,0,r),Se(e,Number.POSITIVE_INFINITY,n))}static fromRowRangeAst(e,r){const n=e.start.toSimpleRowAddress(r),i=e.end.toSimpleRowAddress(r);if(n.sheet!==i.sheet)throw new gv(n.sheet,i.sheet);return new Ha(n.sheet,n.row,i.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,r){return new Ha(this.sheet,this.start.row+r,this.end.row+r)}rangeWithSameWidth(e,r){return new Ha(this.sheet,e,e+r-1)}exceedsSheetSizeLimits(e,r){return this.end.row>=r}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,r){}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Po{constructor(e,r,n){this.formulaAddress=e,this.arraysFlag=r,this.formulaVertex=n}}var xj={exports:{}};(function(t){(function(e){for(var r=[null,0,{}],n=10,i=44032,o=4352,a=4449,s=4519,l=19,u=21,c=28,f=u*c,h=l*f,d=function(I,v){this.codepoint=I,this.feature=v},p={},m=[],y=0;y<=255;++y)m[y]=0;function S(I,v,b){var w=p[v];return w||(w=I(v,b),w.feature&&++m[v>>8&255]>n&&(p[v]=w)),w}function R(I,v,b){var w=v&65280,_=d.udata[w]||{},M=_[v];return M?new d(v,M):new d(v,r)}function E(I,v,b){return b?I(v,b):new d(v,null)}function O(I,v,b){var w;if(v<o||o+l<=v&&v<i||i+h<v)return I(v,b);if(o<=v&&v<o+l){var _={},M=(v-o)*u;for(w=0;w<u;++w)_[a+w]=i+c*(w+M);return new d(v,[,,_])}var L=v-i,H=L%c,Z=[];if(H!==0)Z[0]=[i+L-H,s+H];else for(Z[0]=[o+Math.floor(L/f),a+Math.floor(L%f/c)],Z[2]={},w=1;w<c;++w)Z[2][s+w]=v+w;return new d(v,Z)}function A(I,v,b){return v<60||13311<v&&v<42607?new d(v,r):I(v,b)}var B=[A,S,E,O,R];d.fromCharCode=B.reduceRight(function(I,v){return function(b,w){return v(I,b,w)}},null),d.isHighSurrogate=function(I){return I>=55296&&I<=56319},d.isLowSurrogate=function(I){return I>=56320&&I<=57343},d.prototype.prepFeature=function(){this.feature||(this.feature=d.fromCharCode(this.codepoint,!0).feature)},d.prototype.toString=function(){if(this.codepoint<65536)return String.fromCharCode(this.codepoint);var I=this.codepoint-65536;return String.fromCharCode(Math.floor(I/1024)+55296,I%1024+56320)},d.prototype.getDecomp=function(){return this.prepFeature(),this.feature[0]||null},d.prototype.isCompatibility=function(){return this.prepFeature(),!!this.feature[1]&&this.feature[1]&256},d.prototype.isExclude=function(){return this.prepFeature(),!!this.feature[1]&&this.feature[1]&512},d.prototype.getCanonicalClass=function(){return this.prepFeature(),this.feature[1]?this.feature[1]&255:0},d.prototype.getComposite=function(I){if(this.prepFeature(),!this.feature[2])return null;var v=this.feature[2][I.codepoint];return v?d.fromCharCode(v):null};var j=function(I){this.str=I,this.cursor=0};j.prototype.next=function(){if(this.str&&this.cursor<this.str.length){var I=this.str.charCodeAt(this.cursor++),v;return d.isHighSurrogate(I)&&this.cursor<this.str.length&&d.isLowSurrogate(v=this.str.charCodeAt(this.cursor))&&(I=(I-55296)*1024+(v-56320)+65536,++this.cursor),d.fromCharCode(I)}else return this.str=null,null};var J=function(I,v){this.it=I,this.canonical=v,this.resBuf=[]};J.prototype.next=function(){function I(b,w){var _=w.getDecomp();if(_&&!(b&&w.isCompatibility())){for(var M=[],L=0;L<_.length;++L){var H=I(b,d.fromCharCode(_[L]));M=M.concat(H)}return M}else return[w]}if(this.resBuf.length===0){var v=this.it.next();if(!v)return null;this.resBuf=I(this.canonical,v)}return this.resBuf.shift()};var Y=function(I){this.it=I,this.resBuf=[]};Y.prototype.next=function(){var I;if(this.resBuf.length===0)do{var v=this.it.next();if(!v)break;I=v.getCanonicalClass();var b=this.resBuf.length;if(I!==0)for(;b>0;--b){var w=this.resBuf[b-1],_=w.getCanonicalClass();if(_<=I)break}this.resBuf.splice(b,0,v)}while(I!==0);return this.resBuf.shift()};var q=function(I){this.it=I,this.procBuf=[],this.resBuf=[],this.lastClass=null};q.prototype.next=function(){for(;this.resBuf.length===0;){var I=this.it.next();if(!I){this.resBuf=this.procBuf,this.procBuf=[];break}if(this.procBuf.length===0)this.lastClass=I.getCanonicalClass(),this.procBuf.push(I);else{var v=this.procBuf[0],b=v.getComposite(I),w=I.getCanonicalClass();b&&(this.lastClass<w||this.lastClass===0)?this.procBuf[0]=b:(w===0&&(this.resBuf=this.procBuf,this.procBuf=[]),this.lastClass=w,this.procBuf.push(I))}}return this.resBuf.shift()};var ee=function(I,v){switch(I){case"NFD":return new Y(new J(new j(v),!0));case"NFKD":return new Y(new J(new j(v),!1));case"NFC":return new q(new Y(new J(new j(v),!0)));case"NFKC":return new q(new Y(new J(new j(v),!1)))}throw I+" is invalid"},ae=function(I,v){for(var b=ee(I,v),w="",_;_=b.next();)w+=_.toString();return w};function ne(I){return ae("NFD",I)}function ue(I){return ae("NFKD",I)}function me(I){return ae("NFC",I)}function Re(I){return ae("NFKC",I)}d.udata={0:{60:[,,{824:8814}],61:[,,{824:8800}],62:[,,{824:8815}],65:[,,{768:192,769:193,770:194,771:195,772:256,774:258,775:550,776:196,777:7842,778:197,780:461,783:512,785:514,803:7840,805:7680,808:260}],66:[,,{775:7682,803:7684,817:7686}],67:[,,{769:262,770:264,775:266,780:268,807:199}],68:[,,{775:7690,780:270,803:7692,807:7696,813:7698,817:7694}],69:[,,{768:200,769:201,770:202,771:7868,772:274,774:276,775:278,776:203,777:7866,780:282,783:516,785:518,803:7864,807:552,808:280,813:7704,816:7706}],70:[,,{775:7710}],71:[,,{769:500,770:284,772:7712,774:286,775:288,780:486,807:290}],72:[,,{770:292,775:7714,776:7718,780:542,803:7716,807:7720,814:7722}],73:[,,{768:204,769:205,770:206,771:296,772:298,774:300,775:304,776:207,777:7880,780:463,783:520,785:522,803:7882,808:302,816:7724}],74:[,,{770:308}],75:[,,{769:7728,780:488,803:7730,807:310,817:7732}],76:[,,{769:313,780:317,803:7734,807:315,813:7740,817:7738}],77:[,,{769:7742,775:7744,803:7746}],78:[,,{768:504,769:323,771:209,775:7748,780:327,803:7750,807:325,813:7754,817:7752}],79:[,,{768:210,769:211,770:212,771:213,772:332,774:334,775:558,776:214,777:7886,779:336,780:465,783:524,785:526,795:416,803:7884,808:490}],80:[,,{769:7764,775:7766}],82:[,,{769:340,775:7768,780:344,783:528,785:530,803:7770,807:342,817:7774}],83:[,,{769:346,770:348,775:7776,780:352,803:7778,806:536,807:350}],84:[,,{775:7786,780:356,803:7788,806:538,807:354,813:7792,817:7790}],85:[,,{768:217,769:218,770:219,771:360,772:362,774:364,776:220,777:7910,778:366,779:368,780:467,783:532,785:534,795:431,803:7908,804:7794,808:370,813:7798,816:7796}],86:[,,{771:7804,803:7806}],87:[,,{768:7808,769:7810,770:372,775:7814,776:7812,803:7816}],88:[,,{775:7818,776:7820}],89:[,,{768:7922,769:221,770:374,771:7928,772:562,775:7822,776:376,777:7926,803:7924}],90:[,,{769:377,770:7824,775:379,780:381,803:7826,817:7828}],97:[,,{768:224,769:225,770:226,771:227,772:257,774:259,775:551,776:228,777:7843,778:229,780:462,783:513,785:515,803:7841,805:7681,808:261}],98:[,,{775:7683,803:7685,817:7687}],99:[,,{769:263,770:265,775:267,780:269,807:231}],100:[,,{775:7691,780:271,803:7693,807:7697,813:7699,817:7695}],101:[,,{768:232,769:233,770:234,771:7869,772:275,774:277,775:279,776:235,777:7867,780:283,783:517,785:519,803:7865,807:553,808:281,813:7705,816:7707}],102:[,,{775:7711}],103:[,,{769:501,770:285,772:7713,774:287,775:289,780:487,807:291}],104:[,,{770:293,775:7715,776:7719,780:543,803:7717,807:7721,814:7723,817:7830}],105:[,,{768:236,769:237,770:238,771:297,772:299,774:301,776:239,777:7881,780:464,783:521,785:523,803:7883,808:303,816:7725}],106:[,,{770:309,780:496}],107:[,,{769:7729,780:489,803:7731,807:311,817:7733}],108:[,,{769:314,780:318,803:7735,807:316,813:7741,817:7739}],109:[,,{769:7743,775:7745,803:7747}],110:[,,{768:505,769:324,771:241,775:7749,780:328,803:7751,807:326,813:7755,817:7753}],111:[,,{768:242,769:243,770:244,771:245,772:333,774:335,775:559,776:246,777:7887,779:337,780:466,783:525,785:527,795:417,803:7885,808:491}],112:[,,{769:7765,775:7767}],114:[,,{769:341,775:7769,780:345,783:529,785:531,803:7771,807:343,817:7775}],115:[,,{769:347,770:349,775:7777,780:353,803:7779,806:537,807:351}],116:[,,{775:7787,776:7831,780:357,803:7789,806:539,807:355,813:7793,817:7791}],117:[,,{768:249,769:250,770:251,771:361,772:363,774:365,776:252,777:7911,778:367,779:369,780:468,783:533,785:535,795:432,803:7909,804:7795,808:371,813:7799,816:7797}],118:[,,{771:7805,803:7807}],119:[,,{768:7809,769:7811,770:373,775:7815,776:7813,778:7832,803:7817}],120:[,,{775:7819,776:7821}],121:[,,{768:7923,769:253,770:375,771:7929,772:563,775:7823,776:255,777:7927,778:7833,803:7925}],122:[,,{769:378,770:7825,775:380,780:382,803:7827,817:7829}],160:[[32],256],168:[[32,776],256,{768:8173,769:901,834:8129}],170:[[97],256],175:[[32,772],256],178:[[50],256],179:[[51],256],180:[[32,769],256],181:[[956],256],184:[[32,807],256],185:[[49],256],186:[[111],256],188:[[49,8260,52],256],189:[[49,8260,50],256],190:[[51,8260,52],256],192:[[65,768]],193:[[65,769]],194:[[65,770],,{768:7846,769:7844,771:7850,777:7848}],195:[[65,771]],196:[[65,776],,{772:478}],197:[[65,778],,{769:506}],198:[,,{769:508,772:482}],199:[[67,807],,{769:7688}],200:[[69,768]],201:[[69,769]],202:[[69,770],,{768:7872,769:7870,771:7876,777:7874}],203:[[69,776]],204:[[73,768]],205:[[73,769]],206:[[73,770]],207:[[73,776],,{769:7726}],209:[[78,771]],210:[[79,768]],211:[[79,769]],212:[[79,770],,{768:7890,769:7888,771:7894,777:7892}],213:[[79,771],,{769:7756,772:556,776:7758}],214:[[79,776],,{772:554}],216:[,,{769:510}],217:[[85,768]],218:[[85,769]],219:[[85,770]],220:[[85,776],,{768:475,769:471,772:469,780:473}],221:[[89,769]],224:[[97,768]],225:[[97,769]],226:[[97,770],,{768:7847,769:7845,771:7851,777:7849}],227:[[97,771]],228:[[97,776],,{772:479}],229:[[97,778],,{769:507}],230:[,,{769:509,772:483}],231:[[99,807],,{769:7689}],232:[[101,768]],233:[[101,769]],234:[[101,770],,{768:7873,769:7871,771:7877,777:7875}],235:[[101,776]],236:[[105,768]],237:[[105,769]],238:[[105,770]],239:[[105,776],,{769:7727}],241:[[110,771]],242:[[111,768]],243:[[111,769]],244:[[111,770],,{768:7891,769:7889,771:7895,777:7893}],245:[[111,771],,{769:7757,772:557,776:7759}],246:[[111,776],,{772:555}],248:[,,{769:511}],249:[[117,768]],250:[[117,769]],251:[[117,770]],252:[[117,776],,{768:476,769:472,772:470,780:474}],253:[[121,769]],255:[[121,776]]},256:{256:[[65,772]],257:[[97,772]],258:[[65,774],,{768:7856,769:7854,771:7860,777:7858}],259:[[97,774],,{768:7857,769:7855,771:7861,777:7859}],260:[[65,808]],261:[[97,808]],262:[[67,769]],263:[[99,769]],264:[[67,770]],265:[[99,770]],266:[[67,775]],267:[[99,775]],268:[[67,780]],269:[[99,780]],270:[[68,780]],271:[[100,780]],274:[[69,772],,{768:7700,769:7702}],275:[[101,772],,{768:7701,769:7703}],276:[[69,774]],277:[[101,774]],278:[[69,775]],279:[[101,775]],280:[[69,808]],281:[[101,808]],282:[[69,780]],283:[[101,780]],284:[[71,770]],285:[[103,770]],286:[[71,774]],287:[[103,774]],288:[[71,775]],289:[[103,775]],290:[[71,807]],291:[[103,807]],292:[[72,770]],293:[[104,770]],296:[[73,771]],297:[[105,771]],298:[[73,772]],299:[[105,772]],300:[[73,774]],301:[[105,774]],302:[[73,808]],303:[[105,808]],304:[[73,775]],306:[[73,74],256],307:[[105,106],256],308:[[74,770]],309:[[106,770]],310:[[75,807]],311:[[107,807]],313:[[76,769]],314:[[108,769]],315:[[76,807]],316:[[108,807]],317:[[76,780]],318:[[108,780]],319:[[76,183],256],320:[[108,183],256],323:[[78,769]],324:[[110,769]],325:[[78,807]],326:[[110,807]],327:[[78,780]],328:[[110,780]],329:[[700,110],256],332:[[79,772],,{768:7760,769:7762}],333:[[111,772],,{768:7761,769:7763}],334:[[79,774]],335:[[111,774]],336:[[79,779]],337:[[111,779]],340:[[82,769]],341:[[114,769]],342:[[82,807]],343:[[114,807]],344:[[82,780]],345:[[114,780]],346:[[83,769],,{775:7780}],347:[[115,769],,{775:7781}],348:[[83,770]],349:[[115,770]],350:[[83,807]],351:[[115,807]],352:[[83,780],,{775:7782}],353:[[115,780],,{775:7783}],354:[[84,807]],355:[[116,807]],356:[[84,780]],357:[[116,780]],360:[[85,771],,{769:7800}],361:[[117,771],,{769:7801}],362:[[85,772],,{776:7802}],363:[[117,772],,{776:7803}],364:[[85,774]],365:[[117,774]],366:[[85,778]],367:[[117,778]],368:[[85,779]],369:[[117,779]],370:[[85,808]],371:[[117,808]],372:[[87,770]],373:[[119,770]],374:[[89,770]],375:[[121,770]],376:[[89,776]],377:[[90,769]],378:[[122,769]],379:[[90,775]],380:[[122,775]],381:[[90,780]],382:[[122,780]],383:[[115],256,{775:7835}],416:[[79,795],,{768:7900,769:7898,771:7904,777:7902,803:7906}],417:[[111,795],,{768:7901,769:7899,771:7905,777:7903,803:7907}],431:[[85,795],,{768:7914,769:7912,771:7918,777:7916,803:7920}],432:[[117,795],,{768:7915,769:7913,771:7919,777:7917,803:7921}],439:[,,{780:494}],452:[[68,381],256],453:[[68,382],256],454:[[100,382],256],455:[[76,74],256],456:[[76,106],256],457:[[108,106],256],458:[[78,74],256],459:[[78,106],256],460:[[110,106],256],461:[[65,780]],462:[[97,780]],463:[[73,780]],464:[[105,780]],465:[[79,780]],466:[[111,780]],467:[[85,780]],468:[[117,780]],469:[[220,772]],470:[[252,772]],471:[[220,769]],472:[[252,769]],473:[[220,780]],474:[[252,780]],475:[[220,768]],476:[[252,768]],478:[[196,772]],479:[[228,772]],480:[[550,772]],481:[[551,772]],482:[[198,772]],483:[[230,772]],486:[[71,780]],487:[[103,780]],488:[[75,780]],489:[[107,780]],490:[[79,808],,{772:492}],491:[[111,808],,{772:493}],492:[[490,772]],493:[[491,772]],494:[[439,780]],495:[[658,780]],496:[[106,780]],497:[[68,90],256],498:[[68,122],256],499:[[100,122],256],500:[[71,769]],501:[[103,769]],504:[[78,768]],505:[[110,768]],506:[[197,769]],507:[[229,769]],508:[[198,769]],509:[[230,769]],510:[[216,769]],511:[[248,769]],66045:[,220]},512:{512:[[65,783]],513:[[97,783]],514:[[65,785]],515:[[97,785]],516:[[69,783]],517:[[101,783]],518:[[69,785]],519:[[101,785]],520:[[73,783]],521:[[105,783]],522:[[73,785]],523:[[105,785]],524:[[79,783]],525:[[111,783]],526:[[79,785]],527:[[111,785]],528:[[82,783]],529:[[114,783]],530:[[82,785]],531:[[114,785]],532:[[85,783]],533:[[117,783]],534:[[85,785]],535:[[117,785]],536:[[83,806]],537:[[115,806]],538:[[84,806]],539:[[116,806]],542:[[72,780]],543:[[104,780]],550:[[65,775],,{772:480}],551:[[97,775],,{772:481}],552:[[69,807],,{774:7708}],553:[[101,807],,{774:7709}],554:[[214,772]],555:[[246,772]],556:[[213,772]],557:[[245,772]],558:[[79,775],,{772:560}],559:[[111,775],,{772:561}],560:[[558,772]],561:[[559,772]],562:[[89,772]],563:[[121,772]],658:[,,{780:495}],688:[[104],256],689:[[614],256],690:[[106],256],691:[[114],256],692:[[633],256],693:[[635],256],694:[[641],256],695:[[119],256],696:[[121],256],728:[[32,774],256],729:[[32,775],256],730:[[32,778],256],731:[[32,808],256],732:[[32,771],256],733:[[32,779],256],736:[[611],256],737:[[108],256],738:[[115],256],739:[[120],256],740:[[661],256],66272:[,220]},768:{768:[,230],769:[,230],770:[,230],771:[,230],772:[,230],773:[,230],774:[,230],775:[,230],776:[,230,{769:836}],777:[,230],778:[,230],779:[,230],780:[,230],781:[,230],782:[,230],783:[,230],784:[,230],785:[,230],786:[,230],787:[,230],788:[,230],789:[,232],790:[,220],791:[,220],792:[,220],793:[,220],794:[,232],795:[,216],796:[,220],797:[,220],798:[,220],799:[,220],800:[,220],801:[,202],802:[,202],803:[,220],804:[,220],805:[,220],806:[,220],807:[,202],808:[,202],809:[,220],810:[,220],811:[,220],812:[,220],813:[,220],814:[,220],815:[,220],816:[,220],817:[,220],818:[,220],819:[,220],820:[,1],821:[,1],822:[,1],823:[,1],824:[,1],825:[,220],826:[,220],827:[,220],828:[,220],829:[,230],830:[,230],831:[,230],832:[[768],230],833:[[769],230],834:[,230],835:[[787],230],836:[[776,769],230],837:[,240],838:[,230],839:[,220],840:[,220],841:[,220],842:[,230],843:[,230],844:[,230],845:[,220],846:[,220],848:[,230],849:[,230],850:[,230],851:[,220],852:[,220],853:[,220],854:[,220],855:[,230],856:[,232],857:[,220],858:[,220],859:[,230],860:[,233],861:[,234],862:[,234],863:[,233],864:[,234],865:[,234],866:[,233],867:[,230],868:[,230],869:[,230],870:[,230],871:[,230],872:[,230],873:[,230],874:[,230],875:[,230],876:[,230],877:[,230],878:[,230],879:[,230],884:[[697]],890:[[32,837],256],894:[[59]],900:[[32,769],256],901:[[168,769]],902:[[913,769]],903:[[183]],904:[[917,769]],905:[[919,769]],906:[[921,769]],908:[[927,769]],910:[[933,769]],911:[[937,769]],912:[[970,769]],913:[,,{768:8122,769:902,772:8121,774:8120,787:7944,788:7945,837:8124}],917:[,,{768:8136,769:904,787:7960,788:7961}],919:[,,{768:8138,769:905,787:7976,788:7977,837:8140}],921:[,,{768:8154,769:906,772:8153,774:8152,776:938,787:7992,788:7993}],927:[,,{768:8184,769:908,787:8008,788:8009}],929:[,,{788:8172}],933:[,,{768:8170,769:910,772:8169,774:8168,776:939,788:8025}],937:[,,{768:8186,769:911,787:8040,788:8041,837:8188}],938:[[921,776]],939:[[933,776]],940:[[945,769],,{837:8116}],941:[[949,769]],942:[[951,769],,{837:8132}],943:[[953,769]],944:[[971,769]],945:[,,{768:8048,769:940,772:8113,774:8112,787:7936,788:7937,834:8118,837:8115}],949:[,,{768:8050,769:941,787:7952,788:7953}],951:[,,{768:8052,769:942,787:7968,788:7969,834:8134,837:8131}],953:[,,{768:8054,769:943,772:8145,774:8144,776:970,787:7984,788:7985,834:8150}],959:[,,{768:8056,769:972,787:8e3,788:8001}],961:[,,{787:8164,788:8165}],965:[,,{768:8058,769:973,772:8161,774:8160,776:971,787:8016,788:8017,834:8166}],969:[,,{768:8060,769:974,787:8032,788:8033,834:8182,837:8179}],970:[[953,776],,{768:8146,769:912,834:8151}],971:[[965,776],,{768:8162,769:944,834:8167}],972:[[959,769]],973:[[965,769]],974:[[969,769],,{837:8180}],976:[[946],256],977:[[952],256],978:[[933],256,{769:979,776:980}],979:[[978,769]],980:[[978,776]],981:[[966],256],982:[[960],256],1008:[[954],256],1009:[[961],256],1010:[[962],256],1012:[[920],256],1013:[[949],256],1017:[[931],256],66422:[,230],66423:[,230],66424:[,230],66425:[,230],66426:[,230]},1024:{1024:[[1045,768]],1025:[[1045,776]],1027:[[1043,769]],1030:[,,{776:1031}],1031:[[1030,776]],1036:[[1050,769]],1037:[[1048,768]],1038:[[1059,774]],1040:[,,{774:1232,776:1234}],1043:[,,{769:1027}],1045:[,,{768:1024,774:1238,776:1025}],1046:[,,{774:1217,776:1244}],1047:[,,{776:1246}],1048:[,,{768:1037,772:1250,774:1049,776:1252}],1049:[[1048,774]],1050:[,,{769:1036}],1054:[,,{776:1254}],1059:[,,{772:1262,774:1038,776:1264,779:1266}],1063:[,,{776:1268}],1067:[,,{776:1272}],1069:[,,{776:1260}],1072:[,,{774:1233,776:1235}],1075:[,,{769:1107}],1077:[,,{768:1104,774:1239,776:1105}],1078:[,,{774:1218,776:1245}],1079:[,,{776:1247}],1080:[,,{768:1117,772:1251,774:1081,776:1253}],1081:[[1080,774]],1082:[,,{769:1116}],1086:[,,{776:1255}],1091:[,,{772:1263,774:1118,776:1265,779:1267}],1095:[,,{776:1269}],1099:[,,{776:1273}],1101:[,,{776:1261}],1104:[[1077,768]],1105:[[1077,776]],1107:[[1075,769]],1110:[,,{776:1111}],1111:[[1110,776]],1116:[[1082,769]],1117:[[1080,768]],1118:[[1091,774]],1140:[,,{783:1142}],1141:[,,{783:1143}],1142:[[1140,783]],1143:[[1141,783]],1155:[,230],1156:[,230],1157:[,230],1158:[,230],1159:[,230],1217:[[1046,774]],1218:[[1078,774]],1232:[[1040,774]],1233:[[1072,774]],1234:[[1040,776]],1235:[[1072,776]],1238:[[1045,774]],1239:[[1077,774]],1240:[,,{776:1242}],1241:[,,{776:1243}],1242:[[1240,776]],1243:[[1241,776]],1244:[[1046,776]],1245:[[1078,776]],1246:[[1047,776]],1247:[[1079,776]],1250:[[1048,772]],1251:[[1080,772]],1252:[[1048,776]],1253:[[1080,776]],1254:[[1054,776]],1255:[[1086,776]],1256:[,,{776:1258}],1257:[,,{776:1259}],1258:[[1256,776]],1259:[[1257,776]],1260:[[1069,776]],1261:[[1101,776]],1262:[[1059,772]],1263:[[1091,772]],1264:[[1059,776]],1265:[[1091,776]],1266:[[1059,779]],1267:[[1091,779]],1268:[[1063,776]],1269:[[1095,776]],1272:[[1067,776]],1273:[[1099,776]]},1280:{1415:[[1381,1410],256],1425:[,220],1426:[,230],1427:[,230],1428:[,230],1429:[,230],1430:[,220],1431:[,230],1432:[,230],1433:[,230],1434:[,222],1435:[,220],1436:[,230],1437:[,230],1438:[,230],1439:[,230],1440:[,230],1441:[,230],1442:[,220],1443:[,220],1444:[,220],1445:[,220],1446:[,220],1447:[,220],1448:[,230],1449:[,230],1450:[,220],1451:[,230],1452:[,230],1453:[,222],1454:[,228],1455:[,230],1456:[,10],1457:[,11],1458:[,12],1459:[,13],1460:[,14],1461:[,15],1462:[,16],1463:[,17],1464:[,18],1465:[,19],1466:[,19],1467:[,20],1468:[,21],1469:[,22],1471:[,23],1473:[,24],1474:[,25],1476:[,230],1477:[,220],1479:[,18]},1536:{1552:[,230],1553:[,230],1554:[,230],1555:[,230],1556:[,230],1557:[,230],1558:[,230],1559:[,230],1560:[,30],1561:[,31],1562:[,32],1570:[[1575,1619]],1571:[[1575,1620]],1572:[[1608,1620]],1573:[[1575,1621]],1574:[[1610,1620]],1575:[,,{1619:1570,1620:1571,1621:1573}],1608:[,,{1620:1572}],1610:[,,{1620:1574}],1611:[,27],1612:[,28],1613:[,29],1614:[,30],1615:[,31],1616:[,32],1617:[,33],1618:[,34],1619:[,230],1620:[,230],1621:[,220],1622:[,220],1623:[,230],1624:[,230],1625:[,230],1626:[,230],1627:[,230],1628:[,220],1629:[,230],1630:[,230],1631:[,220],1648:[,35],1653:[[1575,1652],256],1654:[[1608,1652],256],1655:[[1735,1652],256],1656:[[1610,1652],256],1728:[[1749,1620]],1729:[,,{1620:1730}],1730:[[1729,1620]],1746:[,,{1620:1747}],1747:[[1746,1620]],1749:[,,{1620:1728}],1750:[,230],1751:[,230],1752:[,230],1753:[,230],1754:[,230],1755:[,230],1756:[,230],1759:[,230],1760:[,230],1761:[,230],1762:[,230],1763:[,220],1764:[,230],1767:[,230],1768:[,230],1770:[,220],1771:[,230],1772:[,230],1773:[,220]},1792:{1809:[,36],1840:[,230],1841:[,220],1842:[,230],1843:[,230],1844:[,220],1845:[,230],1846:[,230],1847:[,220],1848:[,220],1849:[,220],1850:[,230],1851:[,220],1852:[,220],1853:[,230],1854:[,220],1855:[,230],1856:[,230],1857:[,230],1858:[,220],1859:[,230],1860:[,220],1861:[,230],1862:[,220],1863:[,230],1864:[,220],1865:[,230],1866:[,230],2027:[,230],2028:[,230],2029:[,230],2030:[,230],2031:[,230],2032:[,230],2033:[,230],2034:[,220],2035:[,230]},2048:{2070:[,230],2071:[,230],2072:[,230],2073:[,230],2075:[,230],2076:[,230],2077:[,230],2078:[,230],2079:[,230],2080:[,230],2081:[,230],2082:[,230],2083:[,230],2085:[,230],2086:[,230],2087:[,230],2089:[,230],2090:[,230],2091:[,230],2092:[,230],2093:[,230],2137:[,220],2138:[,220],2139:[,220],2276:[,230],2277:[,230],2278:[,220],2279:[,230],2280:[,230],2281:[,220],2282:[,230],2283:[,230],2284:[,230],2285:[,220],2286:[,220],2287:[,220],2288:[,27],2289:[,28],2290:[,29],2291:[,230],2292:[,230],2293:[,230],2294:[,220],2295:[,230],2296:[,230],2297:[,220],2298:[,220],2299:[,230],2300:[,230],2301:[,230],2302:[,230],2303:[,230]},2304:{2344:[,,{2364:2345}],2345:[[2344,2364]],2352:[,,{2364:2353}],2353:[[2352,2364]],2355:[,,{2364:2356}],2356:[[2355,2364]],2364:[,7],2381:[,9],2385:[,230],2386:[,220],2387:[,230],2388:[,230],2392:[[2325,2364],512],2393:[[2326,2364],512],2394:[[2327,2364],512],2395:[[2332,2364],512],2396:[[2337,2364],512],2397:[[2338,2364],512],2398:[[2347,2364],512],2399:[[2351,2364],512],2492:[,7],2503:[,,{2494:2507,2519:2508}],2507:[[2503,2494]],2508:[[2503,2519]],2509:[,9],2524:[[2465,2492],512],2525:[[2466,2492],512],2527:[[2479,2492],512]},2560:{2611:[[2610,2620],512],2614:[[2616,2620],512],2620:[,7],2637:[,9],2649:[[2582,2620],512],2650:[[2583,2620],512],2651:[[2588,2620],512],2654:[[2603,2620],512],2748:[,7],2765:[,9],68109:[,220],68111:[,230],68152:[,230],68153:[,1],68154:[,220],68159:[,9],68325:[,230],68326:[,220]},2816:{2876:[,7],2887:[,,{2878:2891,2902:2888,2903:2892}],2888:[[2887,2902]],2891:[[2887,2878]],2892:[[2887,2903]],2893:[,9],2908:[[2849,2876],512],2909:[[2850,2876],512],2962:[,,{3031:2964}],2964:[[2962,3031]],3014:[,,{3006:3018,3031:3020}],3015:[,,{3006:3019}],3018:[[3014,3006]],3019:[[3015,3006]],3020:[[3014,3031]],3021:[,9]},3072:{3142:[,,{3158:3144}],3144:[[3142,3158]],3149:[,9],3157:[,84],3158:[,91],3260:[,7],3263:[,,{3285:3264}],3264:[[3263,3285]],3270:[,,{3266:3274,3285:3271,3286:3272}],3271:[[3270,3285]],3272:[[3270,3286]],3274:[[3270,3266],,{3285:3275}],3275:[[3274,3285]],3277:[,9]},3328:{3398:[,,{3390:3402,3415:3404}],3399:[,,{3390:3403}],3402:[[3398,3390]],3403:[[3399,3390]],3404:[[3398,3415]],3405:[,9],3530:[,9],3545:[,,{3530:3546,3535:3548,3551:3550}],3546:[[3545,3530]],3548:[[3545,3535],,{3530:3549}],3549:[[3548,3530]],3550:[[3545,3551]]},3584:{3635:[[3661,3634],256],3640:[,103],3641:[,103],3642:[,9],3656:[,107],3657:[,107],3658:[,107],3659:[,107],3763:[[3789,3762],256],3768:[,118],3769:[,118],3784:[,122],3785:[,122],3786:[,122],3787:[,122],3804:[[3755,3737],256],3805:[[3755,3745],256]},3840:{3852:[[3851],256],3864:[,220],3865:[,220],3893:[,220],3895:[,220],3897:[,216],3907:[[3906,4023],512],3917:[[3916,4023],512],3922:[[3921,4023],512],3927:[[3926,4023],512],3932:[[3931,4023],512],3945:[[3904,4021],512],3953:[,129],3954:[,130],3955:[[3953,3954],512],3956:[,132],3957:[[3953,3956],512],3958:[[4018,3968],512],3959:[[4018,3969],256],3960:[[4019,3968],512],3961:[[4019,3969],256],3962:[,130],3963:[,130],3964:[,130],3965:[,130],3968:[,130],3969:[[3953,3968],512],3970:[,230],3971:[,230],3972:[,9],3974:[,230],3975:[,230],3987:[[3986,4023],512],3997:[[3996,4023],512],4002:[[4001,4023],512],4007:[[4006,4023],512],4012:[[4011,4023],512],4025:[[3984,4021],512],4038:[,220]},4096:{4133:[,,{4142:4134}],4134:[[4133,4142]],4151:[,7],4153:[,9],4154:[,9],4237:[,220],4348:[[4316],256],69702:[,9],69759:[,9],69785:[,,{69818:69786}],69786:[[69785,69818]],69787:[,,{69818:69788}],69788:[[69787,69818]],69797:[,,{69818:69803}],69803:[[69797,69818]],69817:[,9],69818:[,7]},4352:{69888:[,230],69889:[,230],69890:[,230],69934:[[69937,69927]],69935:[[69938,69927]],69937:[,,{69927:69934}],69938:[,,{69927:69935}],69939:[,9],69940:[,9],70003:[,7],70080:[,9]},4608:{70197:[,9],70198:[,7],70377:[,7],70378:[,9]},4864:{4957:[,230],4958:[,230],4959:[,230],70460:[,7],70471:[,,{70462:70475,70487:70476}],70475:[[70471,70462]],70476:[[70471,70487]],70477:[,9],70502:[,230],70503:[,230],70504:[,230],70505:[,230],70506:[,230],70507:[,230],70508:[,230],70512:[,230],70513:[,230],70514:[,230],70515:[,230],70516:[,230]},5120:{70841:[,,{70832:70844,70842:70843,70845:70846}],70843:[[70841,70842]],70844:[[70841,70832]],70846:[[70841,70845]],70850:[,9],70851:[,7]},5376:{71096:[,,{71087:71098}],71097:[,,{71087:71099}],71098:[[71096,71087]],71099:[[71097,71087]],71103:[,9],71104:[,7]},5632:{71231:[,9],71350:[,9],71351:[,7]},5888:{5908:[,9],5940:[,9],6098:[,9],6109:[,230]},6144:{6313:[,228]},6400:{6457:[,222],6458:[,230],6459:[,220]},6656:{6679:[,230],6680:[,220],6752:[,9],6773:[,230],6774:[,230],6775:[,230],6776:[,230],6777:[,230],6778:[,230],6779:[,230],6780:[,230],6783:[,220],6832:[,230],6833:[,230],6834:[,230],6835:[,230],6836:[,230],6837:[,220],6838:[,220],6839:[,220],6840:[,220],6841:[,220],6842:[,220],6843:[,230],6844:[,230],6845:[,220]},6912:{6917:[,,{6965:6918}],6918:[[6917,6965]],6919:[,,{6965:6920}],6920:[[6919,6965]],6921:[,,{6965:6922}],6922:[[6921,6965]],6923:[,,{6965:6924}],6924:[[6923,6965]],6925:[,,{6965:6926}],6926:[[6925,6965]],6929:[,,{6965:6930}],6930:[[6929,6965]],6964:[,7],6970:[,,{6965:6971}],6971:[[6970,6965]],6972:[,,{6965:6973}],6973:[[6972,6965]],6974:[,,{6965:6976}],6975:[,,{6965:6977}],6976:[[6974,6965]],6977:[[6975,6965]],6978:[,,{6965:6979}],6979:[[6978,6965]],6980:[,9],7019:[,230],7020:[,220],7021:[,230],7022:[,230],7023:[,230],7024:[,230],7025:[,230],7026:[,230],7027:[,230],7082:[,9],7083:[,9],7142:[,7],7154:[,9],7155:[,9]},7168:{7223:[,7],7376:[,230],7377:[,230],7378:[,230],7380:[,1],7381:[,220],7382:[,220],7383:[,220],7384:[,220],7385:[,220],7386:[,230],7387:[,230],7388:[,220],7389:[,220],7390:[,220],7391:[,220],7392:[,230],7394:[,1],7395:[,1],7396:[,1],7397:[,1],7398:[,1],7399:[,1],7400:[,1],7405:[,220],7412:[,230],7416:[,230],7417:[,230]},7424:{7468:[[65],256],7469:[[198],256],7470:[[66],256],7472:[[68],256],7473:[[69],256],7474:[[398],256],7475:[[71],256],7476:[[72],256],7477:[[73],256],7478:[[74],256],7479:[[75],256],7480:[[76],256],7481:[[77],256],7482:[[78],256],7484:[[79],256],7485:[[546],256],7486:[[80],256],7487:[[82],256],7488:[[84],256],7489:[[85],256],7490:[[87],256],7491:[[97],256],7492:[[592],256],7493:[[593],256],7494:[[7426],256],7495:[[98],256],7496:[[100],256],7497:[[101],256],7498:[[601],256],7499:[[603],256],7500:[[604],256],7501:[[103],256],7503:[[107],256],7504:[[109],256],7505:[[331],256],7506:[[111],256],7507:[[596],256],7508:[[7446],256],7509:[[7447],256],7510:[[112],256],7511:[[116],256],7512:[[117],256],7513:[[7453],256],7514:[[623],256],7515:[[118],256],7516:[[7461],256],7517:[[946],256],7518:[[947],256],7519:[[948],256],7520:[[966],256],7521:[[967],256],7522:[[105],256],7523:[[114],256],7524:[[117],256],7525:[[118],256],7526:[[946],256],7527:[[947],256],7528:[[961],256],7529:[[966],256],7530:[[967],256],7544:[[1085],256],7579:[[594],256],7580:[[99],256],7581:[[597],256],7582:[[240],256],7583:[[604],256],7584:[[102],256],7585:[[607],256],7586:[[609],256],7587:[[613],256],7588:[[616],256],7589:[[617],256],7590:[[618],256],7591:[[7547],256],7592:[[669],256],7593:[[621],256],7594:[[7557],256],7595:[[671],256],7596:[[625],256],7597:[[624],256],7598:[[626],256],7599:[[627],256],7600:[[628],256],7601:[[629],256],7602:[[632],256],7603:[[642],256],7604:[[643],256],7605:[[427],256],7606:[[649],256],7607:[[650],256],7608:[[7452],256],7609:[[651],256],7610:[[652],256],7611:[[122],256],7612:[[656],256],7613:[[657],256],7614:[[658],256],7615:[[952],256],7616:[,230],7617:[,230],7618:[,220],7619:[,230],7620:[,230],7621:[,230],7622:[,230],7623:[,230],7624:[,230],7625:[,230],7626:[,220],7627:[,230],7628:[,230],7629:[,234],7630:[,214],7631:[,220],7632:[,202],7633:[,230],7634:[,230],7635:[,230],7636:[,230],7637:[,230],7638:[,230],7639:[,230],7640:[,230],7641:[,230],7642:[,230],7643:[,230],7644:[,230],7645:[,230],7646:[,230],7647:[,230],7648:[,230],7649:[,230],7650:[,230],7651:[,230],7652:[,230],7653:[,230],7654:[,230],7655:[,230],7656:[,230],7657:[,230],7658:[,230],7659:[,230],7660:[,230],7661:[,230],7662:[,230],7663:[,230],7664:[,230],7665:[,230],7666:[,230],7667:[,230],7668:[,230],7669:[,230],7676:[,233],7677:[,220],7678:[,230],7679:[,220]},7680:{7680:[[65,805]],7681:[[97,805]],7682:[[66,775]],7683:[[98,775]],7684:[[66,803]],7685:[[98,803]],7686:[[66,817]],7687:[[98,817]],7688:[[199,769]],7689:[[231,769]],7690:[[68,775]],7691:[[100,775]],7692:[[68,803]],7693:[[100,803]],7694:[[68,817]],7695:[[100,817]],7696:[[68,807]],7697:[[100,807]],7698:[[68,813]],7699:[[100,813]],7700:[[274,768]],7701:[[275,768]],7702:[[274,769]],7703:[[275,769]],7704:[[69,813]],7705:[[101,813]],7706:[[69,816]],7707:[[101,816]],7708:[[552,774]],7709:[[553,774]],7710:[[70,775]],7711:[[102,775]],7712:[[71,772]],7713:[[103,772]],7714:[[72,775]],7715:[[104,775]],7716:[[72,803]],7717:[[104,803]],7718:[[72,776]],7719:[[104,776]],7720:[[72,807]],7721:[[104,807]],7722:[[72,814]],7723:[[104,814]],7724:[[73,816]],7725:[[105,816]],7726:[[207,769]],7727:[[239,769]],7728:[[75,769]],7729:[[107,769]],7730:[[75,803]],7731:[[107,803]],7732:[[75,817]],7733:[[107,817]],7734:[[76,803],,{772:7736}],7735:[[108,803],,{772:7737}],7736:[[7734,772]],7737:[[7735,772]],7738:[[76,817]],7739:[[108,817]],7740:[[76,813]],7741:[[108,813]],7742:[[77,769]],7743:[[109,769]],7744:[[77,775]],7745:[[109,775]],7746:[[77,803]],7747:[[109,803]],7748:[[78,775]],7749:[[110,775]],7750:[[78,803]],7751:[[110,803]],7752:[[78,817]],7753:[[110,817]],7754:[[78,813]],7755:[[110,813]],7756:[[213,769]],7757:[[245,769]],7758:[[213,776]],7759:[[245,776]],7760:[[332,768]],7761:[[333,768]],7762:[[332,769]],7763:[[333,769]],7764:[[80,769]],7765:[[112,769]],7766:[[80,775]],7767:[[112,775]],7768:[[82,775]],7769:[[114,775]],7770:[[82,803],,{772:7772}],7771:[[114,803],,{772:7773}],7772:[[7770,772]],7773:[[7771,772]],7774:[[82,817]],7775:[[114,817]],7776:[[83,775]],7777:[[115,775]],7778:[[83,803],,{775:7784}],7779:[[115,803],,{775:7785}],7780:[[346,775]],7781:[[347,775]],7782:[[352,775]],7783:[[353,775]],7784:[[7778,775]],7785:[[7779,775]],7786:[[84,775]],7787:[[116,775]],7788:[[84,803]],7789:[[116,803]],7790:[[84,817]],7791:[[116,817]],7792:[[84,813]],7793:[[116,813]],7794:[[85,804]],7795:[[117,804]],7796:[[85,816]],7797:[[117,816]],7798:[[85,813]],7799:[[117,813]],7800:[[360,769]],7801:[[361,769]],7802:[[362,776]],7803:[[363,776]],7804:[[86,771]],7805:[[118,771]],7806:[[86,803]],7807:[[118,803]],7808:[[87,768]],7809:[[119,768]],7810:[[87,769]],7811:[[119,769]],7812:[[87,776]],7813:[[119,776]],7814:[[87,775]],7815:[[119,775]],7816:[[87,803]],7817:[[119,803]],7818:[[88,775]],7819:[[120,775]],7820:[[88,776]],7821:[[120,776]],7822:[[89,775]],7823:[[121,775]],7824:[[90,770]],7825:[[122,770]],7826:[[90,803]],7827:[[122,803]],7828:[[90,817]],7829:[[122,817]],7830:[[104,817]],7831:[[116,776]],7832:[[119,778]],7833:[[121,778]],7834:[[97,702],256],7835:[[383,775]],7840:[[65,803],,{770:7852,774:7862}],7841:[[97,803],,{770:7853,774:7863}],7842:[[65,777]],7843:[[97,777]],7844:[[194,769]],7845:[[226,769]],7846:[[194,768]],7847:[[226,768]],7848:[[194,777]],7849:[[226,777]],7850:[[194,771]],7851:[[226,771]],7852:[[7840,770]],7853:[[7841,770]],7854:[[258,769]],7855:[[259,769]],7856:[[258,768]],7857:[[259,768]],7858:[[258,777]],7859:[[259,777]],7860:[[258,771]],7861:[[259,771]],7862:[[7840,774]],7863:[[7841,774]],7864:[[69,803],,{770:7878}],7865:[[101,803],,{770:7879}],7866:[[69,777]],7867:[[101,777]],7868:[[69,771]],7869:[[101,771]],7870:[[202,769]],7871:[[234,769]],7872:[[202,768]],7873:[[234,768]],7874:[[202,777]],7875:[[234,777]],7876:[[202,771]],7877:[[234,771]],7878:[[7864,770]],7879:[[7865,770]],7880:[[73,777]],7881:[[105,777]],7882:[[73,803]],7883:[[105,803]],7884:[[79,803],,{770:7896}],7885:[[111,803],,{770:7897}],7886:[[79,777]],7887:[[111,777]],7888:[[212,769]],7889:[[244,769]],7890:[[212,768]],7891:[[244,768]],7892:[[212,777]],7893:[[244,777]],7894:[[212,771]],7895:[[244,771]],7896:[[7884,770]],7897:[[7885,770]],7898:[[416,769]],7899:[[417,769]],7900:[[416,768]],7901:[[417,768]],7902:[[416,777]],7903:[[417,777]],7904:[[416,771]],7905:[[417,771]],7906:[[416,803]],7907:[[417,803]],7908:[[85,803]],7909:[[117,803]],7910:[[85,777]],7911:[[117,777]],7912:[[431,769]],7913:[[432,769]],7914:[[431,768]],7915:[[432,768]],7916:[[431,777]],7917:[[432,777]],7918:[[431,771]],7919:[[432,771]],7920:[[431,803]],7921:[[432,803]],7922:[[89,768]],7923:[[121,768]],7924:[[89,803]],7925:[[121,803]],7926:[[89,777]],7927:[[121,777]],7928:[[89,771]],7929:[[121,771]]},7936:{7936:[[945,787],,{768:7938,769:7940,834:7942,837:8064}],7937:[[945,788],,{768:7939,769:7941,834:7943,837:8065}],7938:[[7936,768],,{837:8066}],7939:[[7937,768],,{837:8067}],7940:[[7936,769],,{837:8068}],7941:[[7937,769],,{837:8069}],7942:[[7936,834],,{837:8070}],7943:[[7937,834],,{837:8071}],7944:[[913,787],,{768:7946,769:7948,834:7950,837:8072}],7945:[[913,788],,{768:7947,769:7949,834:7951,837:8073}],7946:[[7944,768],,{837:8074}],7947:[[7945,768],,{837:8075}],7948:[[7944,769],,{837:8076}],7949:[[7945,769],,{837:8077}],7950:[[7944,834],,{837:8078}],7951:[[7945,834],,{837:8079}],7952:[[949,787],,{768:7954,769:7956}],7953:[[949,788],,{768:7955,769:7957}],7954:[[7952,768]],7955:[[7953,768]],7956:[[7952,769]],7957:[[7953,769]],7960:[[917,787],,{768:7962,769:7964}],7961:[[917,788],,{768:7963,769:7965}],7962:[[7960,768]],7963:[[7961,768]],7964:[[7960,769]],7965:[[7961,769]],7968:[[951,787],,{768:7970,769:7972,834:7974,837:8080}],7969:[[951,788],,{768:7971,769:7973,834:7975,837:8081}],7970:[[7968,768],,{837:8082}],7971:[[7969,768],,{837:8083}],7972:[[7968,769],,{837:8084}],7973:[[7969,769],,{837:8085}],7974:[[7968,834],,{837:8086}],7975:[[7969,834],,{837:8087}],7976:[[919,787],,{768:7978,769:7980,834:7982,837:8088}],7977:[[919,788],,{768:7979,769:7981,834:7983,837:8089}],7978:[[7976,768],,{837:8090}],7979:[[7977,768],,{837:8091}],7980:[[7976,769],,{837:8092}],7981:[[7977,769],,{837:8093}],7982:[[7976,834],,{837:8094}],7983:[[7977,834],,{837:8095}],7984:[[953,787],,{768:7986,769:7988,834:7990}],7985:[[953,788],,{768:7987,769:7989,834:7991}],7986:[[7984,768]],7987:[[7985,768]],7988:[[7984,769]],7989:[[7985,769]],7990:[[7984,834]],7991:[[7985,834]],7992:[[921,787],,{768:7994,769:7996,834:7998}],7993:[[921,788],,{768:7995,769:7997,834:7999}],7994:[[7992,768]],7995:[[7993,768]],7996:[[7992,769]],7997:[[7993,769]],7998:[[7992,834]],7999:[[7993,834]],8e3:[[959,787],,{768:8002,769:8004}],8001:[[959,788],,{768:8003,769:8005}],8002:[[8e3,768]],8003:[[8001,768]],8004:[[8e3,769]],8005:[[8001,769]],8008:[[927,787],,{768:8010,769:8012}],8009:[[927,788],,{768:8011,769:8013}],8010:[[8008,768]],8011:[[8009,768]],8012:[[8008,769]],8013:[[8009,769]],8016:[[965,787],,{768:8018,769:8020,834:8022}],8017:[[965,788],,{768:8019,769:8021,834:8023}],8018:[[8016,768]],8019:[[8017,768]],8020:[[8016,769]],8021:[[8017,769]],8022:[[8016,834]],8023:[[8017,834]],8025:[[933,788],,{768:8027,769:8029,834:8031}],8027:[[8025,768]],8029:[[8025,769]],8031:[[8025,834]],8032:[[969,787],,{768:8034,769:8036,834:8038,837:8096}],8033:[[969,788],,{768:8035,769:8037,834:8039,837:8097}],8034:[[8032,768],,{837:8098}],8035:[[8033,768],,{837:8099}],8036:[[8032,769],,{837:8100}],8037:[[8033,769],,{837:8101}],8038:[[8032,834],,{837:8102}],8039:[[8033,834],,{837:8103}],8040:[[937,787],,{768:8042,769:8044,834:8046,837:8104}],8041:[[937,788],,{768:8043,769:8045,834:8047,837:8105}],8042:[[8040,768],,{837:8106}],8043:[[8041,768],,{837:8107}],8044:[[8040,769],,{837:8108}],8045:[[8041,769],,{837:8109}],8046:[[8040,834],,{837:8110}],8047:[[8041,834],,{837:8111}],8048:[[945,768],,{837:8114}],8049:[[940]],8050:[[949,768]],8051:[[941]],8052:[[951,768],,{837:8130}],8053:[[942]],8054:[[953,768]],8055:[[943]],8056:[[959,768]],8057:[[972]],8058:[[965,768]],8059:[[973]],8060:[[969,768],,{837:8178}],8061:[[974]],8064:[[7936,837]],8065:[[7937,837]],8066:[[7938,837]],8067:[[7939,837]],8068:[[7940,837]],8069:[[7941,837]],8070:[[7942,837]],8071:[[7943,837]],8072:[[7944,837]],8073:[[7945,837]],8074:[[7946,837]],8075:[[7947,837]],8076:[[7948,837]],8077:[[7949,837]],8078:[[7950,837]],8079:[[7951,837]],8080:[[7968,837]],8081:[[7969,837]],8082:[[7970,837]],8083:[[7971,837]],8084:[[7972,837]],8085:[[7973,837]],8086:[[7974,837]],8087:[[7975,837]],8088:[[7976,837]],8089:[[7977,837]],8090:[[7978,837]],8091:[[7979,837]],8092:[[7980,837]],8093:[[7981,837]],8094:[[7982,837]],8095:[[7983,837]],8096:[[8032,837]],8097:[[8033,837]],8098:[[8034,837]],8099:[[8035,837]],8100:[[8036,837]],8101:[[8037,837]],8102:[[8038,837]],8103:[[8039,837]],8104:[[8040,837]],8105:[[8041,837]],8106:[[8042,837]],8107:[[8043,837]],8108:[[8044,837]],8109:[[8045,837]],8110:[[8046,837]],8111:[[8047,837]],8112:[[945,774]],8113:[[945,772]],8114:[[8048,837]],8115:[[945,837]],8116:[[940,837]],8118:[[945,834],,{837:8119}],8119:[[8118,837]],8120:[[913,774]],8121:[[913,772]],8122:[[913,768]],8123:[[902]],8124:[[913,837]],8125:[[32,787],256],8126:[[953]],8127:[[32,787],256,{768:8141,769:8142,834:8143}],8128:[[32,834],256],8129:[[168,834]],8130:[[8052,837]],8131:[[951,837]],8132:[[942,837]],8134:[[951,834],,{837:8135}],8135:[[8134,837]],8136:[[917,768]],8137:[[904]],8138:[[919,768]],8139:[[905]],8140:[[919,837]],8141:[[8127,768]],8142:[[8127,769]],8143:[[8127,834]],8144:[[953,774]],8145:[[953,772]],8146:[[970,768]],8147:[[912]],8150:[[953,834]],8151:[[970,834]],8152:[[921,774]],8153:[[921,772]],8154:[[921,768]],8155:[[906]],8157:[[8190,768]],8158:[[8190,769]],8159:[[8190,834]],8160:[[965,774]],8161:[[965,772]],8162:[[971,768]],8163:[[944]],8164:[[961,787]],8165:[[961,788]],8166:[[965,834]],8167:[[971,834]],8168:[[933,774]],8169:[[933,772]],8170:[[933,768]],8171:[[910]],8172:[[929,788]],8173:[[168,768]],8174:[[901]],8175:[[96]],8178:[[8060,837]],8179:[[969,837]],8180:[[974,837]],8182:[[969,834],,{837:8183}],8183:[[8182,837]],8184:[[927,768]],8185:[[908]],8186:[[937,768]],8187:[[911]],8188:[[937,837]],8189:[[180]],8190:[[32,788],256,{768:8157,769:8158,834:8159}]},8192:{8192:[[8194]],8193:[[8195]],8194:[[32],256],8195:[[32],256],8196:[[32],256],8197:[[32],256],8198:[[32],256],8199:[[32],256],8200:[[32],256],8201:[[32],256],8202:[[32],256],8209:[[8208],256],8215:[[32,819],256],8228:[[46],256],8229:[[46,46],256],8230:[[46,46,46],256],8239:[[32],256],8243:[[8242,8242],256],8244:[[8242,8242,8242],256],8246:[[8245,8245],256],8247:[[8245,8245,8245],256],8252:[[33,33],256],8254:[[32,773],256],8263:[[63,63],256],8264:[[63,33],256],8265:[[33,63],256],8279:[[8242,8242,8242,8242],256],8287:[[32],256],8304:[[48],256],8305:[[105],256],8308:[[52],256],8309:[[53],256],8310:[[54],256],8311:[[55],256],8312:[[56],256],8313:[[57],256],8314:[[43],256],8315:[[8722],256],8316:[[61],256],8317:[[40],256],8318:[[41],256],8319:[[110],256],8320:[[48],256],8321:[[49],256],8322:[[50],256],8323:[[51],256],8324:[[52],256],8325:[[53],256],8326:[[54],256],8327:[[55],256],8328:[[56],256],8329:[[57],256],8330:[[43],256],8331:[[8722],256],8332:[[61],256],8333:[[40],256],8334:[[41],256],8336:[[97],256],8337:[[101],256],8338:[[111],256],8339:[[120],256],8340:[[601],256],8341:[[104],256],8342:[[107],256],8343:[[108],256],8344:[[109],256],8345:[[110],256],8346:[[112],256],8347:[[115],256],8348:[[116],256],8360:[[82,115],256],8400:[,230],8401:[,230],8402:[,1],8403:[,1],8404:[,230],8405:[,230],8406:[,230],8407:[,230],8408:[,1],8409:[,1],8410:[,1],8411:[,230],8412:[,230],8417:[,230],8421:[,1],8422:[,1],8423:[,230],8424:[,220],8425:[,230],8426:[,1],8427:[,1],8428:[,220],8429:[,220],8430:[,220],8431:[,220],8432:[,230]},8448:{8448:[[97,47,99],256],8449:[[97,47,115],256],8450:[[67],256],8451:[[176,67],256],8453:[[99,47,111],256],8454:[[99,47,117],256],8455:[[400],256],8457:[[176,70],256],8458:[[103],256],8459:[[72],256],8460:[[72],256],8461:[[72],256],8462:[[104],256],8463:[[295],256],8464:[[73],256],8465:[[73],256],8466:[[76],256],8467:[[108],256],8469:[[78],256],8470:[[78,111],256],8473:[[80],256],8474:[[81],256],8475:[[82],256],8476:[[82],256],8477:[[82],256],8480:[[83,77],256],8481:[[84,69,76],256],8482:[[84,77],256],8484:[[90],256],8486:[[937]],8488:[[90],256],8490:[[75]],8491:[[197]],8492:[[66],256],8493:[[67],256],8495:[[101],256],8496:[[69],256],8497:[[70],256],8499:[[77],256],8500:[[111],256],8501:[[1488],256],8502:[[1489],256],8503:[[1490],256],8504:[[1491],256],8505:[[105],256],8507:[[70,65,88],256],8508:[[960],256],8509:[[947],256],8510:[[915],256],8511:[[928],256],8512:[[8721],256],8517:[[68],256],8518:[[100],256],8519:[[101],256],8520:[[105],256],8521:[[106],256],8528:[[49,8260,55],256],8529:[[49,8260,57],256],8530:[[49,8260,49,48],256],8531:[[49,8260,51],256],8532:[[50,8260,51],256],8533:[[49,8260,53],256],8534:[[50,8260,53],256],8535:[[51,8260,53],256],8536:[[52,8260,53],256],8537:[[49,8260,54],256],8538:[[53,8260,54],256],8539:[[49,8260,56],256],8540:[[51,8260,56],256],8541:[[53,8260,56],256],8542:[[55,8260,56],256],8543:[[49,8260],256],8544:[[73],256],8545:[[73,73],256],8546:[[73,73,73],256],8547:[[73,86],256],8548:[[86],256],8549:[[86,73],256],8550:[[86,73,73],256],8551:[[86,73,73,73],256],8552:[[73,88],256],8553:[[88],256],8554:[[88,73],256],8555:[[88,73,73],256],8556:[[76],256],8557:[[67],256],8558:[[68],256],8559:[[77],256],8560:[[105],256],8561:[[105,105],256],8562:[[105,105,105],256],8563:[[105,118],256],8564:[[118],256],8565:[[118,105],256],8566:[[118,105,105],256],8567:[[118,105,105,105],256],8568:[[105,120],256],8569:[[120],256],8570:[[120,105],256],8571:[[120,105,105],256],8572:[[108],256],8573:[[99],256],8574:[[100],256],8575:[[109],256],8585:[[48,8260,51],256],8592:[,,{824:8602}],8594:[,,{824:8603}],8596:[,,{824:8622}],8602:[[8592,824]],8603:[[8594,824]],8622:[[8596,824]],8653:[[8656,824]],8654:[[8660,824]],8655:[[8658,824]],8656:[,,{824:8653}],8658:[,,{824:8655}],8660:[,,{824:8654}]},8704:{8707:[,,{824:8708}],8708:[[8707,824]],8712:[,,{824:8713}],8713:[[8712,824]],8715:[,,{824:8716}],8716:[[8715,824]],8739:[,,{824:8740}],8740:[[8739,824]],8741:[,,{824:8742}],8742:[[8741,824]],8748:[[8747,8747],256],8749:[[8747,8747,8747],256],8751:[[8750,8750],256],8752:[[8750,8750,8750],256],8764:[,,{824:8769}],8769:[[8764,824]],8771:[,,{824:8772}],8772:[[8771,824]],8773:[,,{824:8775}],8775:[[8773,824]],8776:[,,{824:8777}],8777:[[8776,824]],8781:[,,{824:8813}],8800:[[61,824]],8801:[,,{824:8802}],8802:[[8801,824]],8804:[,,{824:8816}],8805:[,,{824:8817}],8813:[[8781,824]],8814:[[60,824]],8815:[[62,824]],8816:[[8804,824]],8817:[[8805,824]],8818:[,,{824:8820}],8819:[,,{824:8821}],8820:[[8818,824]],8821:[[8819,824]],8822:[,,{824:8824}],8823:[,,{824:8825}],8824:[[8822,824]],8825:[[8823,824]],8826:[,,{824:8832}],8827:[,,{824:8833}],8828:[,,{824:8928}],8829:[,,{824:8929}],8832:[[8826,824]],8833:[[8827,824]],8834:[,,{824:8836}],8835:[,,{824:8837}],8836:[[8834,824]],8837:[[8835,824]],8838:[,,{824:8840}],8839:[,,{824:8841}],8840:[[8838,824]],8841:[[8839,824]],8849:[,,{824:8930}],8850:[,,{824:8931}],8866:[,,{824:8876}],8872:[,,{824:8877}],8873:[,,{824:8878}],8875:[,,{824:8879}],8876:[[8866,824]],8877:[[8872,824]],8878:[[8873,824]],8879:[[8875,824]],8882:[,,{824:8938}],8883:[,,{824:8939}],8884:[,,{824:8940}],8885:[,,{824:8941}],8928:[[8828,824]],8929:[[8829,824]],8930:[[8849,824]],8931:[[8850,824]],8938:[[8882,824]],8939:[[8883,824]],8940:[[8884,824]],8941:[[8885,824]]},8960:{9001:[[12296]],9002:[[12297]]},9216:{9312:[[49],256],9313:[[50],256],9314:[[51],256],9315:[[52],256],9316:[[53],256],9317:[[54],256],9318:[[55],256],9319:[[56],256],9320:[[57],256],9321:[[49,48],256],9322:[[49,49],256],9323:[[49,50],256],9324:[[49,51],256],9325:[[49,52],256],9326:[[49,53],256],9327:[[49,54],256],9328:[[49,55],256],9329:[[49,56],256],9330:[[49,57],256],9331:[[50,48],256],9332:[[40,49,41],256],9333:[[40,50,41],256],9334:[[40,51,41],256],9335:[[40,52,41],256],9336:[[40,53,41],256],9337:[[40,54,41],256],9338:[[40,55,41],256],9339:[[40,56,41],256],9340:[[40,57,41],256],9341:[[40,49,48,41],256],9342:[[40,49,49,41],256],9343:[[40,49,50,41],256],9344:[[40,49,51,41],256],9345:[[40,49,52,41],256],9346:[[40,49,53,41],256],9347:[[40,49,54,41],256],9348:[[40,49,55,41],256],9349:[[40,49,56,41],256],9350:[[40,49,57,41],256],9351:[[40,50,48,41],256],9352:[[49,46],256],9353:[[50,46],256],9354:[[51,46],256],9355:[[52,46],256],9356:[[53,46],256],9357:[[54,46],256],9358:[[55,46],256],9359:[[56,46],256],9360:[[57,46],256],9361:[[49,48,46],256],9362:[[49,49,46],256],9363:[[49,50,46],256],9364:[[49,51,46],256],9365:[[49,52,46],256],9366:[[49,53,46],256],9367:[[49,54,46],256],9368:[[49,55,46],256],9369:[[49,56,46],256],9370:[[49,57,46],256],9371:[[50,48,46],256],9372:[[40,97,41],256],9373:[[40,98,41],256],9374:[[40,99,41],256],9375:[[40,100,41],256],9376:[[40,101,41],256],9377:[[40,102,41],256],9378:[[40,103,41],256],9379:[[40,104,41],256],9380:[[40,105,41],256],9381:[[40,106,41],256],9382:[[40,107,41],256],9383:[[40,108,41],256],9384:[[40,109,41],256],9385:[[40,110,41],256],9386:[[40,111,41],256],9387:[[40,112,41],256],9388:[[40,113,41],256],9389:[[40,114,41],256],9390:[[40,115,41],256],9391:[[40,116,41],256],9392:[[40,117,41],256],9393:[[40,118,41],256],9394:[[40,119,41],256],9395:[[40,120,41],256],9396:[[40,121,41],256],9397:[[40,122,41],256],9398:[[65],256],9399:[[66],256],9400:[[67],256],9401:[[68],256],9402:[[69],256],9403:[[70],256],9404:[[71],256],9405:[[72],256],9406:[[73],256],9407:[[74],256],9408:[[75],256],9409:[[76],256],9410:[[77],256],9411:[[78],256],9412:[[79],256],9413:[[80],256],9414:[[81],256],9415:[[82],256],9416:[[83],256],9417:[[84],256],9418:[[85],256],9419:[[86],256],9420:[[87],256],9421:[[88],256],9422:[[89],256],9423:[[90],256],9424:[[97],256],9425:[[98],256],9426:[[99],256],9427:[[100],256],9428:[[101],256],9429:[[102],256],9430:[[103],256],9431:[[104],256],9432:[[105],256],9433:[[106],256],9434:[[107],256],9435:[[108],256],9436:[[109],256],9437:[[110],256],9438:[[111],256],9439:[[112],256],9440:[[113],256],9441:[[114],256],9442:[[115],256],9443:[[116],256],9444:[[117],256],9445:[[118],256],9446:[[119],256],9447:[[120],256],9448:[[121],256],9449:[[122],256],9450:[[48],256]},10752:{10764:[[8747,8747,8747,8747],256],10868:[[58,58,61],256],10869:[[61,61],256],10870:[[61,61,61],256],10972:[[10973,824],512]},11264:{11388:[[106],256],11389:[[86],256],11503:[,230],11504:[,230],11505:[,230]},11520:{11631:[[11617],256],11647:[,9],11744:[,230],11745:[,230],11746:[,230],11747:[,230],11748:[,230],11749:[,230],11750:[,230],11751:[,230],11752:[,230],11753:[,230],11754:[,230],11755:[,230],11756:[,230],11757:[,230],11758:[,230],11759:[,230],11760:[,230],11761:[,230],11762:[,230],11763:[,230],11764:[,230],11765:[,230],11766:[,230],11767:[,230],11768:[,230],11769:[,230],11770:[,230],11771:[,230],11772:[,230],11773:[,230],11774:[,230],11775:[,230]},11776:{11935:[[27597],256],12019:[[40863],256]},12032:{12032:[[19968],256],12033:[[20008],256],12034:[[20022],256],12035:[[20031],256],12036:[[20057],256],12037:[[20101],256],12038:[[20108],256],12039:[[20128],256],12040:[[20154],256],12041:[[20799],256],12042:[[20837],256],12043:[[20843],256],12044:[[20866],256],12045:[[20886],256],12046:[[20907],256],12047:[[20960],256],12048:[[20981],256],12049:[[20992],256],12050:[[21147],256],12051:[[21241],256],12052:[[21269],256],12053:[[21274],256],12054:[[21304],256],12055:[[21313],256],12056:[[21340],256],12057:[[21353],256],12058:[[21378],256],12059:[[21430],256],12060:[[21448],256],12061:[[21475],256],12062:[[22231],256],12063:[[22303],256],12064:[[22763],256],12065:[[22786],256],12066:[[22794],256],12067:[[22805],256],12068:[[22823],256],12069:[[22899],256],12070:[[23376],256],12071:[[23424],256],12072:[[23544],256],12073:[[23567],256],12074:[[23586],256],12075:[[23608],256],12076:[[23662],256],12077:[[23665],256],12078:[[24027],256],12079:[[24037],256],12080:[[24049],256],12081:[[24062],256],12082:[[24178],256],12083:[[24186],256],12084:[[24191],256],12085:[[24308],256],12086:[[24318],256],12087:[[24331],256],12088:[[24339],256],12089:[[24400],256],12090:[[24417],256],12091:[[24435],256],12092:[[24515],256],12093:[[25096],256],12094:[[25142],256],12095:[[25163],256],12096:[[25903],256],12097:[[25908],256],12098:[[25991],256],12099:[[26007],256],12100:[[26020],256],12101:[[26041],256],12102:[[26080],256],12103:[[26085],256],12104:[[26352],256],12105:[[26376],256],12106:[[26408],256],12107:[[27424],256],12108:[[27490],256],12109:[[27513],256],12110:[[27571],256],12111:[[27595],256],12112:[[27604],256],12113:[[27611],256],12114:[[27663],256],12115:[[27668],256],12116:[[27700],256],12117:[[28779],256],12118:[[29226],256],12119:[[29238],256],12120:[[29243],256],12121:[[29247],256],12122:[[29255],256],12123:[[29273],256],12124:[[29275],256],12125:[[29356],256],12126:[[29572],256],12127:[[29577],256],12128:[[29916],256],12129:[[29926],256],12130:[[29976],256],12131:[[29983],256],12132:[[29992],256],12133:[[3e4],256],12134:[[30091],256],12135:[[30098],256],12136:[[30326],256],12137:[[30333],256],12138:[[30382],256],12139:[[30399],256],12140:[[30446],256],12141:[[30683],256],12142:[[30690],256],12143:[[30707],256],12144:[[31034],256],12145:[[31160],256],12146:[[31166],256],12147:[[31348],256],12148:[[31435],256],12149:[[31481],256],12150:[[31859],256],12151:[[31992],256],12152:[[32566],256],12153:[[32593],256],12154:[[32650],256],12155:[[32701],256],12156:[[32769],256],12157:[[32780],256],12158:[[32786],256],12159:[[32819],256],12160:[[32895],256],12161:[[32905],256],12162:[[33251],256],12163:[[33258],256],12164:[[33267],256],12165:[[33276],256],12166:[[33292],256],12167:[[33307],256],12168:[[33311],256],12169:[[33390],256],12170:[[33394],256],12171:[[33400],256],12172:[[34381],256],12173:[[34411],256],12174:[[34880],256],12175:[[34892],256],12176:[[34915],256],12177:[[35198],256],12178:[[35211],256],12179:[[35282],256],12180:[[35328],256],12181:[[35895],256],12182:[[35910],256],12183:[[35925],256],12184:[[35960],256],12185:[[35997],256],12186:[[36196],256],12187:[[36208],256],12188:[[36275],256],12189:[[36523],256],12190:[[36554],256],12191:[[36763],256],12192:[[36784],256],12193:[[36789],256],12194:[[37009],256],12195:[[37193],256],12196:[[37318],256],12197:[[37324],256],12198:[[37329],256],12199:[[38263],256],12200:[[38272],256],12201:[[38428],256],12202:[[38582],256],12203:[[38585],256],12204:[[38632],256],12205:[[38737],256],12206:[[38750],256],12207:[[38754],256],12208:[[38761],256],12209:[[38859],256],12210:[[38893],256],12211:[[38899],256],12212:[[38913],256],12213:[[39080],256],12214:[[39131],256],12215:[[39135],256],12216:[[39318],256],12217:[[39321],256],12218:[[39340],256],12219:[[39592],256],12220:[[39640],256],12221:[[39647],256],12222:[[39717],256],12223:[[39727],256],12224:[[39730],256],12225:[[39740],256],12226:[[39770],256],12227:[[40165],256],12228:[[40565],256],12229:[[40575],256],12230:[[40613],256],12231:[[40635],256],12232:[[40643],256],12233:[[40653],256],12234:[[40657],256],12235:[[40697],256],12236:[[40701],256],12237:[[40718],256],12238:[[40723],256],12239:[[40736],256],12240:[[40763],256],12241:[[40778],256],12242:[[40786],256],12243:[[40845],256],12244:[[40860],256],12245:[[40864],256]},12288:{12288:[[32],256],12330:[,218],12331:[,228],12332:[,232],12333:[,222],12334:[,224],12335:[,224],12342:[[12306],256],12344:[[21313],256],12345:[[21316],256],12346:[[21317],256],12358:[,,{12441:12436}],12363:[,,{12441:12364}],12364:[[12363,12441]],12365:[,,{12441:12366}],12366:[[12365,12441]],12367:[,,{12441:12368}],12368:[[12367,12441]],12369:[,,{12441:12370}],12370:[[12369,12441]],12371:[,,{12441:12372}],12372:[[12371,12441]],12373:[,,{12441:12374}],12374:[[12373,12441]],12375:[,,{12441:12376}],12376:[[12375,12441]],12377:[,,{12441:12378}],12378:[[12377,12441]],12379:[,,{12441:12380}],12380:[[12379,12441]],12381:[,,{12441:12382}],12382:[[12381,12441]],12383:[,,{12441:12384}],12384:[[12383,12441]],12385:[,,{12441:12386}],12386:[[12385,12441]],12388:[,,{12441:12389}],12389:[[12388,12441]],12390:[,,{12441:12391}],12391:[[12390,12441]],12392:[,,{12441:12393}],12393:[[12392,12441]],12399:[,,{12441:12400,12442:12401}],12400:[[12399,12441]],12401:[[12399,12442]],12402:[,,{12441:12403,12442:12404}],12403:[[12402,12441]],12404:[[12402,12442]],12405:[,,{12441:12406,12442:12407}],12406:[[12405,12441]],12407:[[12405,12442]],12408:[,,{12441:12409,12442:12410}],12409:[[12408,12441]],12410:[[12408,12442]],12411:[,,{12441:12412,12442:12413}],12412:[[12411,12441]],12413:[[12411,12442]],12436:[[12358,12441]],12441:[,8],12442:[,8],12443:[[32,12441],256],12444:[[32,12442],256],12445:[,,{12441:12446}],12446:[[12445,12441]],12447:[[12424,12426],256],12454:[,,{12441:12532}],12459:[,,{12441:12460}],12460:[[12459,12441]],12461:[,,{12441:12462}],12462:[[12461,12441]],12463:[,,{12441:12464}],12464:[[12463,12441]],12465:[,,{12441:12466}],12466:[[12465,12441]],12467:[,,{12441:12468}],12468:[[12467,12441]],12469:[,,{12441:12470}],12470:[[12469,12441]],12471:[,,{12441:12472}],12472:[[12471,12441]],12473:[,,{12441:12474}],12474:[[12473,12441]],12475:[,,{12441:12476}],12476:[[12475,12441]],12477:[,,{12441:12478}],12478:[[12477,12441]],12479:[,,{12441:12480}],12480:[[12479,12441]],12481:[,,{12441:12482}],12482:[[12481,12441]],12484:[,,{12441:12485}],12485:[[12484,12441]],12486:[,,{12441:12487}],12487:[[12486,12441]],12488:[,,{12441:12489}],12489:[[12488,12441]],12495:[,,{12441:12496,12442:12497}],12496:[[12495,12441]],12497:[[12495,12442]],12498:[,,{12441:12499,12442:12500}],12499:[[12498,12441]],12500:[[12498,12442]],12501:[,,{12441:12502,12442:12503}],12502:[[12501,12441]],12503:[[12501,12442]],12504:[,,{12441:12505,12442:12506}],12505:[[12504,12441]],12506:[[12504,12442]],12507:[,,{12441:12508,12442:12509}],12508:[[12507,12441]],12509:[[12507,12442]],12527:[,,{12441:12535}],12528:[,,{12441:12536}],12529:[,,{12441:12537}],12530:[,,{12441:12538}],12532:[[12454,12441]],12535:[[12527,12441]],12536:[[12528,12441]],12537:[[12529,12441]],12538:[[12530,12441]],12541:[,,{12441:12542}],12542:[[12541,12441]],12543:[[12467,12488],256]},12544:{12593:[[4352],256],12594:[[4353],256],12595:[[4522],256],12596:[[4354],256],12597:[[4524],256],12598:[[4525],256],12599:[[4355],256],12600:[[4356],256],12601:[[4357],256],12602:[[4528],256],12603:[[4529],256],12604:[[4530],256],12605:[[4531],256],12606:[[4532],256],12607:[[4533],256],12608:[[4378],256],12609:[[4358],256],12610:[[4359],256],12611:[[4360],256],12612:[[4385],256],12613:[[4361],256],12614:[[4362],256],12615:[[4363],256],12616:[[4364],256],12617:[[4365],256],12618:[[4366],256],12619:[[4367],256],12620:[[4368],256],12621:[[4369],256],12622:[[4370],256],12623:[[4449],256],12624:[[4450],256],12625:[[4451],256],12626:[[4452],256],12627:[[4453],256],12628:[[4454],256],12629:[[4455],256],12630:[[4456],256],12631:[[4457],256],12632:[[4458],256],12633:[[4459],256],12634:[[4460],256],12635:[[4461],256],12636:[[4462],256],12637:[[4463],256],12638:[[4464],256],12639:[[4465],256],12640:[[4466],256],12641:[[4467],256],12642:[[4468],256],12643:[[4469],256],12644:[[4448],256],12645:[[4372],256],12646:[[4373],256],12647:[[4551],256],12648:[[4552],256],12649:[[4556],256],12650:[[4558],256],12651:[[4563],256],12652:[[4567],256],12653:[[4569],256],12654:[[4380],256],12655:[[4573],256],12656:[[4575],256],12657:[[4381],256],12658:[[4382],256],12659:[[4384],256],12660:[[4386],256],12661:[[4387],256],12662:[[4391],256],12663:[[4393],256],12664:[[4395],256],12665:[[4396],256],12666:[[4397],256],12667:[[4398],256],12668:[[4399],256],12669:[[4402],256],12670:[[4406],256],12671:[[4416],256],12672:[[4423],256],12673:[[4428],256],12674:[[4593],256],12675:[[4594],256],12676:[[4439],256],12677:[[4440],256],12678:[[4441],256],12679:[[4484],256],12680:[[4485],256],12681:[[4488],256],12682:[[4497],256],12683:[[4498],256],12684:[[4500],256],12685:[[4510],256],12686:[[4513],256],12690:[[19968],256],12691:[[20108],256],12692:[[19977],256],12693:[[22235],256],12694:[[19978],256],12695:[[20013],256],12696:[[19979],256],12697:[[30002],256],12698:[[20057],256],12699:[[19993],256],12700:[[19969],256],12701:[[22825],256],12702:[[22320],256],12703:[[20154],256]},12800:{12800:[[40,4352,41],256],12801:[[40,4354,41],256],12802:[[40,4355,41],256],12803:[[40,4357,41],256],12804:[[40,4358,41],256],12805:[[40,4359,41],256],12806:[[40,4361,41],256],12807:[[40,4363,41],256],12808:[[40,4364,41],256],12809:[[40,4366,41],256],12810:[[40,4367,41],256],12811:[[40,4368,41],256],12812:[[40,4369,41],256],12813:[[40,4370,41],256],12814:[[40,4352,4449,41],256],12815:[[40,4354,4449,41],256],12816:[[40,4355,4449,41],256],12817:[[40,4357,4449,41],256],12818:[[40,4358,4449,41],256],12819:[[40,4359,4449,41],256],12820:[[40,4361,4449,41],256],12821:[[40,4363,4449,41],256],12822:[[40,4364,4449,41],256],12823:[[40,4366,4449,41],256],12824:[[40,4367,4449,41],256],12825:[[40,4368,4449,41],256],12826:[[40,4369,4449,41],256],12827:[[40,4370,4449,41],256],12828:[[40,4364,4462,41],256],12829:[[40,4363,4457,4364,4453,4523,41],256],12830:[[40,4363,4457,4370,4462,41],256],12832:[[40,19968,41],256],12833:[[40,20108,41],256],12834:[[40,19977,41],256],12835:[[40,22235,41],256],12836:[[40,20116,41],256],12837:[[40,20845,41],256],12838:[[40,19971,41],256],12839:[[40,20843,41],256],12840:[[40,20061,41],256],12841:[[40,21313,41],256],12842:[[40,26376,41],256],12843:[[40,28779,41],256],12844:[[40,27700,41],256],12845:[[40,26408,41],256],12846:[[40,37329,41],256],12847:[[40,22303,41],256],12848:[[40,26085,41],256],12849:[[40,26666,41],256],12850:[[40,26377,41],256],12851:[[40,31038,41],256],12852:[[40,21517,41],256],12853:[[40,29305,41],256],12854:[[40,36001,41],256],12855:[[40,31069,41],256],12856:[[40,21172,41],256],12857:[[40,20195,41],256],12858:[[40,21628,41],256],12859:[[40,23398,41],256],12860:[[40,30435,41],256],12861:[[40,20225,41],256],12862:[[40,36039,41],256],12863:[[40,21332,41],256],12864:[[40,31085,41],256],12865:[[40,20241,41],256],12866:[[40,33258,41],256],12867:[[40,33267,41],256],12868:[[21839],256],12869:[[24188],256],12870:[[25991],256],12871:[[31631],256],12880:[[80,84,69],256],12881:[[50,49],256],12882:[[50,50],256],12883:[[50,51],256],12884:[[50,52],256],12885:[[50,53],256],12886:[[50,54],256],12887:[[50,55],256],12888:[[50,56],256],12889:[[50,57],256],12890:[[51,48],256],12891:[[51,49],256],12892:[[51,50],256],12893:[[51,51],256],12894:[[51,52],256],12895:[[51,53],256],12896:[[4352],256],12897:[[4354],256],12898:[[4355],256],12899:[[4357],256],12900:[[4358],256],12901:[[4359],256],12902:[[4361],256],12903:[[4363],256],12904:[[4364],256],12905:[[4366],256],12906:[[4367],256],12907:[[4368],256],12908:[[4369],256],12909:[[4370],256],12910:[[4352,4449],256],12911:[[4354,4449],256],12912:[[4355,4449],256],12913:[[4357,4449],256],12914:[[4358,4449],256],12915:[[4359,4449],256],12916:[[4361,4449],256],12917:[[4363,4449],256],12918:[[4364,4449],256],12919:[[4366,4449],256],12920:[[4367,4449],256],12921:[[4368,4449],256],12922:[[4369,4449],256],12923:[[4370,4449],256],12924:[[4366,4449,4535,4352,4457],256],12925:[[4364,4462,4363,4468],256],12926:[[4363,4462],256],12928:[[19968],256],12929:[[20108],256],12930:[[19977],256],12931:[[22235],256],12932:[[20116],256],12933:[[20845],256],12934:[[19971],256],12935:[[20843],256],12936:[[20061],256],12937:[[21313],256],12938:[[26376],256],12939:[[28779],256],12940:[[27700],256],12941:[[26408],256],12942:[[37329],256],12943:[[22303],256],12944:[[26085],256],12945:[[26666],256],12946:[[26377],256],12947:[[31038],256],12948:[[21517],256],12949:[[29305],256],12950:[[36001],256],12951:[[31069],256],12952:[[21172],256],12953:[[31192],256],12954:[[30007],256],12955:[[22899],256],12956:[[36969],256],12957:[[20778],256],12958:[[21360],256],12959:[[27880],256],12960:[[38917],256],12961:[[20241],256],12962:[[20889],256],12963:[[27491],256],12964:[[19978],256],12965:[[20013],256],12966:[[19979],256],12967:[[24038],256],12968:[[21491],256],12969:[[21307],256],12970:[[23447],256],12971:[[23398],256],12972:[[30435],256],12973:[[20225],256],12974:[[36039],256],12975:[[21332],256],12976:[[22812],256],12977:[[51,54],256],12978:[[51,55],256],12979:[[51,56],256],12980:[[51,57],256],12981:[[52,48],256],12982:[[52,49],256],12983:[[52,50],256],12984:[[52,51],256],12985:[[52,52],256],12986:[[52,53],256],12987:[[52,54],256],12988:[[52,55],256],12989:[[52,56],256],12990:[[52,57],256],12991:[[53,48],256],12992:[[49,26376],256],12993:[[50,26376],256],12994:[[51,26376],256],12995:[[52,26376],256],12996:[[53,26376],256],12997:[[54,26376],256],12998:[[55,26376],256],12999:[[56,26376],256],13e3:[[57,26376],256],13001:[[49,48,26376],256],13002:[[49,49,26376],256],13003:[[49,50,26376],256],13004:[[72,103],256],13005:[[101,114,103],256],13006:[[101,86],256],13007:[[76,84,68],256],13008:[[12450],256],13009:[[12452],256],13010:[[12454],256],13011:[[12456],256],13012:[[12458],256],13013:[[12459],256],13014:[[12461],256],13015:[[12463],256],13016:[[12465],256],13017:[[12467],256],13018:[[12469],256],13019:[[12471],256],13020:[[12473],256],13021:[[12475],256],13022:[[12477],256],13023:[[12479],256],13024:[[12481],256],13025:[[12484],256],13026:[[12486],256],13027:[[12488],256],13028:[[12490],256],13029:[[12491],256],13030:[[12492],256],13031:[[12493],256],13032:[[12494],256],13033:[[12495],256],13034:[[12498],256],13035:[[12501],256],13036:[[12504],256],13037:[[12507],256],13038:[[12510],256],13039:[[12511],256],13040:[[12512],256],13041:[[12513],256],13042:[[12514],256],13043:[[12516],256],13044:[[12518],256],13045:[[12520],256],13046:[[12521],256],13047:[[12522],256],13048:[[12523],256],13049:[[12524],256],13050:[[12525],256],13051:[[12527],256],13052:[[12528],256],13053:[[12529],256],13054:[[12530],256]},13056:{13056:[[12450,12497,12540,12488],256],13057:[[12450,12523,12501,12449],256],13058:[[12450,12531,12506,12450],256],13059:[[12450,12540,12523],256],13060:[[12452,12491,12531,12464],256],13061:[[12452,12531,12481],256],13062:[[12454,12457,12531],256],13063:[[12456,12473,12463,12540,12489],256],13064:[[12456,12540,12459,12540],256],13065:[[12458,12531,12473],256],13066:[[12458,12540,12512],256],13067:[[12459,12452,12522],256],13068:[[12459,12521,12483,12488],256],13069:[[12459,12525,12522,12540],256],13070:[[12460,12525,12531],256],13071:[[12460,12531,12510],256],13072:[[12462,12460],256],13073:[[12462,12491,12540],256],13074:[[12461,12517,12522,12540],256],13075:[[12462,12523,12480,12540],256],13076:[[12461,12525],256],13077:[[12461,12525,12464,12521,12512],256],13078:[[12461,12525,12513,12540,12488,12523],256],13079:[[12461,12525,12527,12483,12488],256],13080:[[12464,12521,12512],256],13081:[[12464,12521,12512,12488,12531],256],13082:[[12463,12523,12476,12452,12525],256],13083:[[12463,12525,12540,12493],256],13084:[[12465,12540,12473],256],13085:[[12467,12523,12490],256],13086:[[12467,12540,12509],256],13087:[[12469,12452,12463,12523],256],13088:[[12469,12531,12481,12540,12512],256],13089:[[12471,12522,12531,12464],256],13090:[[12475,12531,12481],256],13091:[[12475,12531,12488],256],13092:[[12480,12540,12473],256],13093:[[12487,12471],256],13094:[[12489,12523],256],13095:[[12488,12531],256],13096:[[12490,12494],256],13097:[[12494,12483,12488],256],13098:[[12495,12452,12484],256],13099:[[12497,12540,12475,12531,12488],256],13100:[[12497,12540,12484],256],13101:[[12496,12540,12524,12523],256],13102:[[12500,12450,12473,12488,12523],256],13103:[[12500,12463,12523],256],13104:[[12500,12467],256],13105:[[12499,12523],256],13106:[[12501,12449,12521,12483,12489],256],13107:[[12501,12451,12540,12488],256],13108:[[12502,12483,12471,12455,12523],256],13109:[[12501,12521,12531],256],13110:[[12504,12463,12479,12540,12523],256],13111:[[12506,12477],256],13112:[[12506,12491,12498],256],13113:[[12504,12523,12484],256],13114:[[12506,12531,12473],256],13115:[[12506,12540,12472],256],13116:[[12505,12540,12479],256],13117:[[12509,12452,12531,12488],256],13118:[[12508,12523,12488],256],13119:[[12507,12531],256],13120:[[12509,12531,12489],256],13121:[[12507,12540,12523],256],13122:[[12507,12540,12531],256],13123:[[12510,12452,12463,12525],256],13124:[[12510,12452,12523],256],13125:[[12510,12483,12495],256],13126:[[12510,12523,12463],256],13127:[[12510,12531,12471,12519,12531],256],13128:[[12511,12463,12525,12531],256],13129:[[12511,12522],256],13130:[[12511,12522,12496,12540,12523],256],13131:[[12513,12460],256],13132:[[12513,12460,12488,12531],256],13133:[[12513,12540,12488,12523],256],13134:[[12516,12540,12489],256],13135:[[12516,12540,12523],256],13136:[[12518,12450,12531],256],13137:[[12522,12483,12488,12523],256],13138:[[12522,12521],256],13139:[[12523,12500,12540],256],13140:[[12523,12540,12502,12523],256],13141:[[12524,12512],256],13142:[[12524,12531,12488,12466,12531],256],13143:[[12527,12483,12488],256],13144:[[48,28857],256],13145:[[49,28857],256],13146:[[50,28857],256],13147:[[51,28857],256],13148:[[52,28857],256],13149:[[53,28857],256],13150:[[54,28857],256],13151:[[55,28857],256],13152:[[56,28857],256],13153:[[57,28857],256],13154:[[49,48,28857],256],13155:[[49,49,28857],256],13156:[[49,50,28857],256],13157:[[49,51,28857],256],13158:[[49,52,28857],256],13159:[[49,53,28857],256],13160:[[49,54,28857],256],13161:[[49,55,28857],256],13162:[[49,56,28857],256],13163:[[49,57,28857],256],13164:[[50,48,28857],256],13165:[[50,49,28857],256],13166:[[50,50,28857],256],13167:[[50,51,28857],256],13168:[[50,52,28857],256],13169:[[104,80,97],256],13170:[[100,97],256],13171:[[65,85],256],13172:[[98,97,114],256],13173:[[111,86],256],13174:[[112,99],256],13175:[[100,109],256],13176:[[100,109,178],256],13177:[[100,109,179],256],13178:[[73,85],256],13179:[[24179,25104],256],13180:[[26157,21644],256],13181:[[22823,27491],256],13182:[[26126,27835],256],13183:[[26666,24335,20250,31038],256],13184:[[112,65],256],13185:[[110,65],256],13186:[[956,65],256],13187:[[109,65],256],13188:[[107,65],256],13189:[[75,66],256],13190:[[77,66],256],13191:[[71,66],256],13192:[[99,97,108],256],13193:[[107,99,97,108],256],13194:[[112,70],256],13195:[[110,70],256],13196:[[956,70],256],13197:[[956,103],256],13198:[[109,103],256],13199:[[107,103],256],13200:[[72,122],256],13201:[[107,72,122],256],13202:[[77,72,122],256],13203:[[71,72,122],256],13204:[[84,72,122],256],13205:[[956,8467],256],13206:[[109,8467],256],13207:[[100,8467],256],13208:[[107,8467],256],13209:[[102,109],256],13210:[[110,109],256],13211:[[956,109],256],13212:[[109,109],256],13213:[[99,109],256],13214:[[107,109],256],13215:[[109,109,178],256],13216:[[99,109,178],256],13217:[[109,178],256],13218:[[107,109,178],256],13219:[[109,109,179],256],13220:[[99,109,179],256],13221:[[109,179],256],13222:[[107,109,179],256],13223:[[109,8725,115],256],13224:[[109,8725,115,178],256],13225:[[80,97],256],13226:[[107,80,97],256],13227:[[77,80,97],256],13228:[[71,80,97],256],13229:[[114,97,100],256],13230:[[114,97,100,8725,115],256],13231:[[114,97,100,8725,115,178],256],13232:[[112,115],256],13233:[[110,115],256],13234:[[956,115],256],13235:[[109,115],256],13236:[[112,86],256],13237:[[110,86],256],13238:[[956,86],256],13239:[[109,86],256],13240:[[107,86],256],13241:[[77,86],256],13242:[[112,87],256],13243:[[110,87],256],13244:[[956,87],256],13245:[[109,87],256],13246:[[107,87],256],13247:[[77,87],256],13248:[[107,937],256],13249:[[77,937],256],13250:[[97,46,109,46],256],13251:[[66,113],256],13252:[[99,99],256],13253:[[99,100],256],13254:[[67,8725,107,103],256],13255:[[67,111,46],256],13256:[[100,66],256],13257:[[71,121],256],13258:[[104,97],256],13259:[[72,80],256],13260:[[105,110],256],13261:[[75,75],256],13262:[[75,77],256],13263:[[107,116],256],13264:[[108,109],256],13265:[[108,110],256],13266:[[108,111,103],256],13267:[[108,120],256],13268:[[109,98],256],13269:[[109,105,108],256],13270:[[109,111,108],256],13271:[[80,72],256],13272:[[112,46,109,46],256],13273:[[80,80,77],256],13274:[[80,82],256],13275:[[115,114],256],13276:[[83,118],256],13277:[[87,98],256],13278:[[86,8725,109],256],13279:[[65,8725,109],256],13280:[[49,26085],256],13281:[[50,26085],256],13282:[[51,26085],256],13283:[[52,26085],256],13284:[[53,26085],256],13285:[[54,26085],256],13286:[[55,26085],256],13287:[[56,26085],256],13288:[[57,26085],256],13289:[[49,48,26085],256],13290:[[49,49,26085],256],13291:[[49,50,26085],256],13292:[[49,51,26085],256],13293:[[49,52,26085],256],13294:[[49,53,26085],256],13295:[[49,54,26085],256],13296:[[49,55,26085],256],13297:[[49,56,26085],256],13298:[[49,57,26085],256],13299:[[50,48,26085],256],13300:[[50,49,26085],256],13301:[[50,50,26085],256],13302:[[50,51,26085],256],13303:[[50,52,26085],256],13304:[[50,53,26085],256],13305:[[50,54,26085],256],13306:[[50,55,26085],256],13307:[[50,56,26085],256],13308:[[50,57,26085],256],13309:[[51,48,26085],256],13310:[[51,49,26085],256],13311:[[103,97,108],256]},27136:{92912:[,1],92913:[,1],92914:[,1],92915:[,1],92916:[,1]},27392:{92976:[,230],92977:[,230],92978:[,230],92979:[,230],92980:[,230],92981:[,230],92982:[,230]},42496:{42607:[,230],42612:[,230],42613:[,230],42614:[,230],42615:[,230],42616:[,230],42617:[,230],42618:[,230],42619:[,230],42620:[,230],42621:[,230],42652:[[1098],256],42653:[[1100],256],42655:[,230],42736:[,230],42737:[,230]},42752:{42864:[[42863],256],43e3:[[294],256],43001:[[339],256]},43008:{43014:[,9],43204:[,9],43232:[,230],43233:[,230],43234:[,230],43235:[,230],43236:[,230],43237:[,230],43238:[,230],43239:[,230],43240:[,230],43241:[,230],43242:[,230],43243:[,230],43244:[,230],43245:[,230],43246:[,230],43247:[,230],43248:[,230],43249:[,230]},43264:{43307:[,220],43308:[,220],43309:[,220],43347:[,9],43443:[,7],43456:[,9]},43520:{43696:[,230],43698:[,230],43699:[,230],43700:[,220],43703:[,230],43704:[,230],43710:[,230],43711:[,230],43713:[,230],43766:[,9]},43776:{43868:[[42791],256],43869:[[43831],256],43870:[[619],256],43871:[[43858],256],44013:[,9]},48128:{113822:[,1]},53504:{119134:[[119127,119141],512],119135:[[119128,119141],512],119136:[[119135,119150],512],119137:[[119135,119151],512],119138:[[119135,119152],512],119139:[[119135,119153],512],119140:[[119135,119154],512],119141:[,216],119142:[,216],119143:[,1],119144:[,1],119145:[,1],119149:[,226],119150:[,216],119151:[,216],119152:[,216],119153:[,216],119154:[,216],119163:[,220],119164:[,220],119165:[,220],119166:[,220],119167:[,220],119168:[,220],119169:[,220],119170:[,220],119173:[,230],119174:[,230],119175:[,230],119176:[,230],119177:[,230],119178:[,220],119179:[,220],119210:[,230],119211:[,230],119212:[,230],119213:[,230],119227:[[119225,119141],512],119228:[[119226,119141],512],119229:[[119227,119150],512],119230:[[119228,119150],512],119231:[[119227,119151],512],119232:[[119228,119151],512]},53760:{119362:[,230],119363:[,230],119364:[,230]},54272:{119808:[[65],256],119809:[[66],256],119810:[[67],256],119811:[[68],256],119812:[[69],256],119813:[[70],256],119814:[[71],256],119815:[[72],256],119816:[[73],256],119817:[[74],256],119818:[[75],256],119819:[[76],256],119820:[[77],256],119821:[[78],256],119822:[[79],256],119823:[[80],256],119824:[[81],256],119825:[[82],256],119826:[[83],256],119827:[[84],256],119828:[[85],256],119829:[[86],256],119830:[[87],256],119831:[[88],256],119832:[[89],256],119833:[[90],256],119834:[[97],256],119835:[[98],256],119836:[[99],256],119837:[[100],256],119838:[[101],256],119839:[[102],256],119840:[[103],256],119841:[[104],256],119842:[[105],256],119843:[[106],256],119844:[[107],256],119845:[[108],256],119846:[[109],256],119847:[[110],256],119848:[[111],256],119849:[[112],256],119850:[[113],256],119851:[[114],256],119852:[[115],256],119853:[[116],256],119854:[[117],256],119855:[[118],256],119856:[[119],256],119857:[[120],256],119858:[[121],256],119859:[[122],256],119860:[[65],256],119861:[[66],256],119862:[[67],256],119863:[[68],256],119864:[[69],256],119865:[[70],256],119866:[[71],256],119867:[[72],256],119868:[[73],256],119869:[[74],256],119870:[[75],256],119871:[[76],256],119872:[[77],256],119873:[[78],256],119874:[[79],256],119875:[[80],256],119876:[[81],256],119877:[[82],256],119878:[[83],256],119879:[[84],256],119880:[[85],256],119881:[[86],256],119882:[[87],256],119883:[[88],256],119884:[[89],256],119885:[[90],256],119886:[[97],256],119887:[[98],256],119888:[[99],256],119889:[[100],256],119890:[[101],256],119891:[[102],256],119892:[[103],256],119894:[[105],256],119895:[[106],256],119896:[[107],256],119897:[[108],256],119898:[[109],256],119899:[[110],256],119900:[[111],256],119901:[[112],256],119902:[[113],256],119903:[[114],256],119904:[[115],256],119905:[[116],256],119906:[[117],256],119907:[[118],256],119908:[[119],256],119909:[[120],256],119910:[[121],256],119911:[[122],256],119912:[[65],256],119913:[[66],256],119914:[[67],256],119915:[[68],256],119916:[[69],256],119917:[[70],256],119918:[[71],256],119919:[[72],256],119920:[[73],256],119921:[[74],256],119922:[[75],256],119923:[[76],256],119924:[[77],256],119925:[[78],256],119926:[[79],256],119927:[[80],256],119928:[[81],256],119929:[[82],256],119930:[[83],256],119931:[[84],256],119932:[[85],256],119933:[[86],256],119934:[[87],256],119935:[[88],256],119936:[[89],256],119937:[[90],256],119938:[[97],256],119939:[[98],256],119940:[[99],256],119941:[[100],256],119942:[[101],256],119943:[[102],256],119944:[[103],256],119945:[[104],256],119946:[[105],256],119947:[[106],256],119948:[[107],256],119949:[[108],256],119950:[[109],256],119951:[[110],256],119952:[[111],256],119953:[[112],256],119954:[[113],256],119955:[[114],256],119956:[[115],256],119957:[[116],256],119958:[[117],256],119959:[[118],256],119960:[[119],256],119961:[[120],256],119962:[[121],256],119963:[[122],256],119964:[[65],256],119966:[[67],256],119967:[[68],256],119970:[[71],256],119973:[[74],256],119974:[[75],256],119977:[[78],256],119978:[[79],256],119979:[[80],256],119980:[[81],256],119982:[[83],256],119983:[[84],256],119984:[[85],256],119985:[[86],256],119986:[[87],256],119987:[[88],256],119988:[[89],256],119989:[[90],256],119990:[[97],256],119991:[[98],256],119992:[[99],256],119993:[[100],256],119995:[[102],256],119997:[[104],256],119998:[[105],256],119999:[[106],256],12e4:[[107],256],120001:[[108],256],120002:[[109],256],120003:[[110],256],120005:[[112],256],120006:[[113],256],120007:[[114],256],120008:[[115],256],120009:[[116],256],120010:[[117],256],120011:[[118],256],120012:[[119],256],120013:[[120],256],120014:[[121],256],120015:[[122],256],120016:[[65],256],120017:[[66],256],120018:[[67],256],120019:[[68],256],120020:[[69],256],120021:[[70],256],120022:[[71],256],120023:[[72],256],120024:[[73],256],120025:[[74],256],120026:[[75],256],120027:[[76],256],120028:[[77],256],120029:[[78],256],120030:[[79],256],120031:[[80],256],120032:[[81],256],120033:[[82],256],120034:[[83],256],120035:[[84],256],120036:[[85],256],120037:[[86],256],120038:[[87],256],120039:[[88],256],120040:[[89],256],120041:[[90],256],120042:[[97],256],120043:[[98],256],120044:[[99],256],120045:[[100],256],120046:[[101],256],120047:[[102],256],120048:[[103],256],120049:[[104],256],120050:[[105],256],120051:[[106],256],120052:[[107],256],120053:[[108],256],120054:[[109],256],120055:[[110],256],120056:[[111],256],120057:[[112],256],120058:[[113],256],120059:[[114],256],120060:[[115],256],120061:[[116],256],120062:[[117],256],120063:[[118],256]},54528:{120064:[[119],256],120065:[[120],256],120066:[[121],256],120067:[[122],256],120068:[[65],256],120069:[[66],256],120071:[[68],256],120072:[[69],256],120073:[[70],256],120074:[[71],256],120077:[[74],256],120078:[[75],256],120079:[[76],256],120080:[[77],256],120081:[[78],256],120082:[[79],256],120083:[[80],256],120084:[[81],256],120086:[[83],256],120087:[[84],256],120088:[[85],256],120089:[[86],256],120090:[[87],256],120091:[[88],256],120092:[[89],256],120094:[[97],256],120095:[[98],256],120096:[[99],256],120097:[[100],256],120098:[[101],256],120099:[[102],256],120100:[[103],256],120101:[[104],256],120102:[[105],256],120103:[[106],256],120104:[[107],256],120105:[[108],256],120106:[[109],256],120107:[[110],256],120108:[[111],256],120109:[[112],256],120110:[[113],256],120111:[[114],256],120112:[[115],256],120113:[[116],256],120114:[[117],256],120115:[[118],256],120116:[[119],256],120117:[[120],256],120118:[[121],256],120119:[[122],256],120120:[[65],256],120121:[[66],256],120123:[[68],256],120124:[[69],256],120125:[[70],256],120126:[[71],256],120128:[[73],256],120129:[[74],256],120130:[[75],256],120131:[[76],256],120132:[[77],256],120134:[[79],256],120138:[[83],256],120139:[[84],256],120140:[[85],256],120141:[[86],256],120142:[[87],256],120143:[[88],256],120144:[[89],256],120146:[[97],256],120147:[[98],256],120148:[[99],256],120149:[[100],256],120150:[[101],256],120151:[[102],256],120152:[[103],256],120153:[[104],256],120154:[[105],256],120155:[[106],256],120156:[[107],256],120157:[[108],256],120158:[[109],256],120159:[[110],256],120160:[[111],256],120161:[[112],256],120162:[[113],256],120163:[[114],256],120164:[[115],256],120165:[[116],256],120166:[[117],256],120167:[[118],256],120168:[[119],256],120169:[[120],256],120170:[[121],256],120171:[[122],256],120172:[[65],256],120173:[[66],256],120174:[[67],256],120175:[[68],256],120176:[[69],256],120177:[[70],256],120178:[[71],256],120179:[[72],256],120180:[[73],256],120181:[[74],256],120182:[[75],256],120183:[[76],256],120184:[[77],256],120185:[[78],256],120186:[[79],256],120187:[[80],256],120188:[[81],256],120189:[[82],256],120190:[[83],256],120191:[[84],256],120192:[[85],256],120193:[[86],256],120194:[[87],256],120195:[[88],256],120196:[[89],256],120197:[[90],256],120198:[[97],256],120199:[[98],256],120200:[[99],256],120201:[[100],256],120202:[[101],256],120203:[[102],256],120204:[[103],256],120205:[[104],256],120206:[[105],256],120207:[[106],256],120208:[[107],256],120209:[[108],256],120210:[[109],256],120211:[[110],256],120212:[[111],256],120213:[[112],256],120214:[[113],256],120215:[[114],256],120216:[[115],256],120217:[[116],256],120218:[[117],256],120219:[[118],256],120220:[[119],256],120221:[[120],256],120222:[[121],256],120223:[[122],256],120224:[[65],256],120225:[[66],256],120226:[[67],256],120227:[[68],256],120228:[[69],256],120229:[[70],256],120230:[[71],256],120231:[[72],256],120232:[[73],256],120233:[[74],256],120234:[[75],256],120235:[[76],256],120236:[[77],256],120237:[[78],256],120238:[[79],256],120239:[[80],256],120240:[[81],256],120241:[[82],256],120242:[[83],256],120243:[[84],256],120244:[[85],256],120245:[[86],256],120246:[[87],256],120247:[[88],256],120248:[[89],256],120249:[[90],256],120250:[[97],256],120251:[[98],256],120252:[[99],256],120253:[[100],256],120254:[[101],256],120255:[[102],256],120256:[[103],256],120257:[[104],256],120258:[[105],256],120259:[[106],256],120260:[[107],256],120261:[[108],256],120262:[[109],256],120263:[[110],256],120264:[[111],256],120265:[[112],256],120266:[[113],256],120267:[[114],256],120268:[[115],256],120269:[[116],256],120270:[[117],256],120271:[[118],256],120272:[[119],256],120273:[[120],256],120274:[[121],256],120275:[[122],256],120276:[[65],256],120277:[[66],256],120278:[[67],256],120279:[[68],256],120280:[[69],256],120281:[[70],256],120282:[[71],256],120283:[[72],256],120284:[[73],256],120285:[[74],256],120286:[[75],256],120287:[[76],256],120288:[[77],256],120289:[[78],256],120290:[[79],256],120291:[[80],256],120292:[[81],256],120293:[[82],256],120294:[[83],256],120295:[[84],256],120296:[[85],256],120297:[[86],256],120298:[[87],256],120299:[[88],256],120300:[[89],256],120301:[[90],256],120302:[[97],256],120303:[[98],256],120304:[[99],256],120305:[[100],256],120306:[[101],256],120307:[[102],256],120308:[[103],256],120309:[[104],256],120310:[[105],256],120311:[[106],256],120312:[[107],256],120313:[[108],256],120314:[[109],256],120315:[[110],256],120316:[[111],256],120317:[[112],256],120318:[[113],256],120319:[[114],256]},54784:{120320:[[115],256],120321:[[116],256],120322:[[117],256],120323:[[118],256],120324:[[119],256],120325:[[120],256],120326:[[121],256],120327:[[122],256],120328:[[65],256],120329:[[66],256],120330:[[67],256],120331:[[68],256],120332:[[69],256],120333:[[70],256],120334:[[71],256],120335:[[72],256],120336:[[73],256],120337:[[74],256],120338:[[75],256],120339:[[76],256],120340:[[77],256],120341:[[78],256],120342:[[79],256],120343:[[80],256],120344:[[81],256],120345:[[82],256],120346:[[83],256],120347:[[84],256],120348:[[85],256],120349:[[86],256],120350:[[87],256],120351:[[88],256],120352:[[89],256],120353:[[90],256],120354:[[97],256],120355:[[98],256],120356:[[99],256],120357:[[100],256],120358:[[101],256],120359:[[102],256],120360:[[103],256],120361:[[104],256],120362:[[105],256],120363:[[106],256],120364:[[107],256],120365:[[108],256],120366:[[109],256],120367:[[110],256],120368:[[111],256],120369:[[112],256],120370:[[113],256],120371:[[114],256],120372:[[115],256],120373:[[116],256],120374:[[117],256],120375:[[118],256],120376:[[119],256],120377:[[120],256],120378:[[121],256],120379:[[122],256],120380:[[65],256],120381:[[66],256],120382:[[67],256],120383:[[68],256],120384:[[69],256],120385:[[70],256],120386:[[71],256],120387:[[72],256],120388:[[73],256],120389:[[74],256],120390:[[75],256],120391:[[76],256],120392:[[77],256],120393:[[78],256],120394:[[79],256],120395:[[80],256],120396:[[81],256],120397:[[82],256],120398:[[83],256],120399:[[84],256],120400:[[85],256],120401:[[86],256],120402:[[87],256],120403:[[88],256],120404:[[89],256],120405:[[90],256],120406:[[97],256],120407:[[98],256],120408:[[99],256],120409:[[100],256],120410:[[101],256],120411:[[102],256],120412:[[103],256],120413:[[104],256],120414:[[105],256],120415:[[106],256],120416:[[107],256],120417:[[108],256],120418:[[109],256],120419:[[110],256],120420:[[111],256],120421:[[112],256],120422:[[113],256],120423:[[114],256],120424:[[115],256],120425:[[116],256],120426:[[117],256],120427:[[118],256],120428:[[119],256],120429:[[120],256],120430:[[121],256],120431:[[122],256],120432:[[65],256],120433:[[66],256],120434:[[67],256],120435:[[68],256],120436:[[69],256],120437:[[70],256],120438:[[71],256],120439:[[72],256],120440:[[73],256],120441:[[74],256],120442:[[75],256],120443:[[76],256],120444:[[77],256],120445:[[78],256],120446:[[79],256],120447:[[80],256],120448:[[81],256],120449:[[82],256],120450:[[83],256],120451:[[84],256],120452:[[85],256],120453:[[86],256],120454:[[87],256],120455:[[88],256],120456:[[89],256],120457:[[90],256],120458:[[97],256],120459:[[98],256],120460:[[99],256],120461:[[100],256],120462:[[101],256],120463:[[102],256],120464:[[103],256],120465:[[104],256],120466:[[105],256],120467:[[106],256],120468:[[107],256],120469:[[108],256],120470:[[109],256],120471:[[110],256],120472:[[111],256],120473:[[112],256],120474:[[113],256],120475:[[114],256],120476:[[115],256],120477:[[116],256],120478:[[117],256],120479:[[118],256],120480:[[119],256],120481:[[120],256],120482:[[121],256],120483:[[122],256],120484:[[305],256],120485:[[567],256],120488:[[913],256],120489:[[914],256],120490:[[915],256],120491:[[916],256],120492:[[917],256],120493:[[918],256],120494:[[919],256],120495:[[920],256],120496:[[921],256],120497:[[922],256],120498:[[923],256],120499:[[924],256],120500:[[925],256],120501:[[926],256],120502:[[927],256],120503:[[928],256],120504:[[929],256],120505:[[1012],256],120506:[[931],256],120507:[[932],256],120508:[[933],256],120509:[[934],256],120510:[[935],256],120511:[[936],256],120512:[[937],256],120513:[[8711],256],120514:[[945],256],120515:[[946],256],120516:[[947],256],120517:[[948],256],120518:[[949],256],120519:[[950],256],120520:[[951],256],120521:[[952],256],120522:[[953],256],120523:[[954],256],120524:[[955],256],120525:[[956],256],120526:[[957],256],120527:[[958],256],120528:[[959],256],120529:[[960],256],120530:[[961],256],120531:[[962],256],120532:[[963],256],120533:[[964],256],120534:[[965],256],120535:[[966],256],120536:[[967],256],120537:[[968],256],120538:[[969],256],120539:[[8706],256],120540:[[1013],256],120541:[[977],256],120542:[[1008],256],120543:[[981],256],120544:[[1009],256],120545:[[982],256],120546:[[913],256],120547:[[914],256],120548:[[915],256],120549:[[916],256],120550:[[917],256],120551:[[918],256],120552:[[919],256],120553:[[920],256],120554:[[921],256],120555:[[922],256],120556:[[923],256],120557:[[924],256],120558:[[925],256],120559:[[926],256],120560:[[927],256],120561:[[928],256],120562:[[929],256],120563:[[1012],256],120564:[[931],256],120565:[[932],256],120566:[[933],256],120567:[[934],256],120568:[[935],256],120569:[[936],256],120570:[[937],256],120571:[[8711],256],120572:[[945],256],120573:[[946],256],120574:[[947],256],120575:[[948],256]},55040:{120576:[[949],256],120577:[[950],256],120578:[[951],256],120579:[[952],256],120580:[[953],256],120581:[[954],256],120582:[[955],256],120583:[[956],256],120584:[[957],256],120585:[[958],256],120586:[[959],256],120587:[[960],256],120588:[[961],256],120589:[[962],256],120590:[[963],256],120591:[[964],256],120592:[[965],256],120593:[[966],256],120594:[[967],256],120595:[[968],256],120596:[[969],256],120597:[[8706],256],120598:[[1013],256],120599:[[977],256],120600:[[1008],256],120601:[[981],256],120602:[[1009],256],120603:[[982],256],120604:[[913],256],120605:[[914],256],120606:[[915],256],120607:[[916],256],120608:[[917],256],120609:[[918],256],120610:[[919],256],120611:[[920],256],120612:[[921],256],120613:[[922],256],120614:[[923],256],120615:[[924],256],120616:[[925],256],120617:[[926],256],120618:[[927],256],120619:[[928],256],120620:[[929],256],120621:[[1012],256],120622:[[931],256],120623:[[932],256],120624:[[933],256],120625:[[934],256],120626:[[935],256],120627:[[936],256],120628:[[937],256],120629:[[8711],256],120630:[[945],256],120631:[[946],256],120632:[[947],256],120633:[[948],256],120634:[[949],256],120635:[[950],256],120636:[[951],256],120637:[[952],256],120638:[[953],256],120639:[[954],256],120640:[[955],256],120641:[[956],256],120642:[[957],256],120643:[[958],256],120644:[[959],256],120645:[[960],256],120646:[[961],256],120647:[[962],256],120648:[[963],256],120649:[[964],256],120650:[[965],256],120651:[[966],256],120652:[[967],256],120653:[[968],256],120654:[[969],256],120655:[[8706],256],120656:[[1013],256],120657:[[977],256],120658:[[1008],256],120659:[[981],256],120660:[[1009],256],120661:[[982],256],120662:[[913],256],120663:[[914],256],120664:[[915],256],120665:[[916],256],120666:[[917],256],120667:[[918],256],120668:[[919],256],120669:[[920],256],120670:[[921],256],120671:[[922],256],120672:[[923],256],120673:[[924],256],120674:[[925],256],120675:[[926],256],120676:[[927],256],120677:[[928],256],120678:[[929],256],120679:[[1012],256],120680:[[931],256],120681:[[932],256],120682:[[933],256],120683:[[934],256],120684:[[935],256],120685:[[936],256],120686:[[937],256],120687:[[8711],256],120688:[[945],256],120689:[[946],256],120690:[[947],256],120691:[[948],256],120692:[[949],256],120693:[[950],256],120694:[[951],256],120695:[[952],256],120696:[[953],256],120697:[[954],256],120698:[[955],256],120699:[[956],256],120700:[[957],256],120701:[[958],256],120702:[[959],256],120703:[[960],256],120704:[[961],256],120705:[[962],256],120706:[[963],256],120707:[[964],256],120708:[[965],256],120709:[[966],256],120710:[[967],256],120711:[[968],256],120712:[[969],256],120713:[[8706],256],120714:[[1013],256],120715:[[977],256],120716:[[1008],256],120717:[[981],256],120718:[[1009],256],120719:[[982],256],120720:[[913],256],120721:[[914],256],120722:[[915],256],120723:[[916],256],120724:[[917],256],120725:[[918],256],120726:[[919],256],120727:[[920],256],120728:[[921],256],120729:[[922],256],120730:[[923],256],120731:[[924],256],120732:[[925],256],120733:[[926],256],120734:[[927],256],120735:[[928],256],120736:[[929],256],120737:[[1012],256],120738:[[931],256],120739:[[932],256],120740:[[933],256],120741:[[934],256],120742:[[935],256],120743:[[936],256],120744:[[937],256],120745:[[8711],256],120746:[[945],256],120747:[[946],256],120748:[[947],256],120749:[[948],256],120750:[[949],256],120751:[[950],256],120752:[[951],256],120753:[[952],256],120754:[[953],256],120755:[[954],256],120756:[[955],256],120757:[[956],256],120758:[[957],256],120759:[[958],256],120760:[[959],256],120761:[[960],256],120762:[[961],256],120763:[[962],256],120764:[[963],256],120765:[[964],256],120766:[[965],256],120767:[[966],256],120768:[[967],256],120769:[[968],256],120770:[[969],256],120771:[[8706],256],120772:[[1013],256],120773:[[977],256],120774:[[1008],256],120775:[[981],256],120776:[[1009],256],120777:[[982],256],120778:[[988],256],120779:[[989],256],120782:[[48],256],120783:[[49],256],120784:[[50],256],120785:[[51],256],120786:[[52],256],120787:[[53],256],120788:[[54],256],120789:[[55],256],120790:[[56],256],120791:[[57],256],120792:[[48],256],120793:[[49],256],120794:[[50],256],120795:[[51],256],120796:[[52],256],120797:[[53],256],120798:[[54],256],120799:[[55],256],120800:[[56],256],120801:[[57],256],120802:[[48],256],120803:[[49],256],120804:[[50],256],120805:[[51],256],120806:[[52],256],120807:[[53],256],120808:[[54],256],120809:[[55],256],120810:[[56],256],120811:[[57],256],120812:[[48],256],120813:[[49],256],120814:[[50],256],120815:[[51],256],120816:[[52],256],120817:[[53],256],120818:[[54],256],120819:[[55],256],120820:[[56],256],120821:[[57],256],120822:[[48],256],120823:[[49],256],120824:[[50],256],120825:[[51],256],120826:[[52],256],120827:[[53],256],120828:[[54],256],120829:[[55],256],120830:[[56],256],120831:[[57],256]},59392:{125136:[,220],125137:[,220],125138:[,220],125139:[,220],125140:[,220],125141:[,220],125142:[,220]},60928:{126464:[[1575],256],126465:[[1576],256],126466:[[1580],256],126467:[[1583],256],126469:[[1608],256],126470:[[1586],256],126471:[[1581],256],126472:[[1591],256],126473:[[1610],256],126474:[[1603],256],126475:[[1604],256],126476:[[1605],256],126477:[[1606],256],126478:[[1587],256],126479:[[1593],256],126480:[[1601],256],126481:[[1589],256],126482:[[1602],256],126483:[[1585],256],126484:[[1588],256],126485:[[1578],256],126486:[[1579],256],126487:[[1582],256],126488:[[1584],256],126489:[[1590],256],126490:[[1592],256],126491:[[1594],256],126492:[[1646],256],126493:[[1722],256],126494:[[1697],256],126495:[[1647],256],126497:[[1576],256],126498:[[1580],256],126500:[[1607],256],126503:[[1581],256],126505:[[1610],256],126506:[[1603],256],126507:[[1604],256],126508:[[1605],256],126509:[[1606],256],126510:[[1587],256],126511:[[1593],256],126512:[[1601],256],126513:[[1589],256],126514:[[1602],256],126516:[[1588],256],126517:[[1578],256],126518:[[1579],256],126519:[[1582],256],126521:[[1590],256],126523:[[1594],256],126530:[[1580],256],126535:[[1581],256],126537:[[1610],256],126539:[[1604],256],126541:[[1606],256],126542:[[1587],256],126543:[[1593],256],126545:[[1589],256],126546:[[1602],256],126548:[[1588],256],126551:[[1582],256],126553:[[1590],256],126555:[[1594],256],126557:[[1722],256],126559:[[1647],256],126561:[[1576],256],126562:[[1580],256],126564:[[1607],256],126567:[[1581],256],126568:[[1591],256],126569:[[1610],256],126570:[[1603],256],126572:[[1605],256],126573:[[1606],256],126574:[[1587],256],126575:[[1593],256],126576:[[1601],256],126577:[[1589],256],126578:[[1602],256],126580:[[1588],256],126581:[[1578],256],126582:[[1579],256],126583:[[1582],256],126585:[[1590],256],126586:[[1592],256],126587:[[1594],256],126588:[[1646],256],126590:[[1697],256],126592:[[1575],256],126593:[[1576],256],126594:[[1580],256],126595:[[1583],256],126596:[[1607],256],126597:[[1608],256],126598:[[1586],256],126599:[[1581],256],126600:[[1591],256],126601:[[1610],256],126603:[[1604],256],126604:[[1605],256],126605:[[1606],256],126606:[[1587],256],126607:[[1593],256],126608:[[1601],256],126609:[[1589],256],126610:[[1602],256],126611:[[1585],256],126612:[[1588],256],126613:[[1578],256],126614:[[1579],256],126615:[[1582],256],126616:[[1584],256],126617:[[1590],256],126618:[[1592],256],126619:[[1594],256],126625:[[1576],256],126626:[[1580],256],126627:[[1583],256],126629:[[1608],256],126630:[[1586],256],126631:[[1581],256],126632:[[1591],256],126633:[[1610],256],126635:[[1604],256],126636:[[1605],256],126637:[[1606],256],126638:[[1587],256],126639:[[1593],256],126640:[[1601],256],126641:[[1589],256],126642:[[1602],256],126643:[[1585],256],126644:[[1588],256],126645:[[1578],256],126646:[[1579],256],126647:[[1582],256],126648:[[1584],256],126649:[[1590],256],126650:[[1592],256],126651:[[1594],256]},61696:{127232:[[48,46],256],127233:[[48,44],256],127234:[[49,44],256],127235:[[50,44],256],127236:[[51,44],256],127237:[[52,44],256],127238:[[53,44],256],127239:[[54,44],256],127240:[[55,44],256],127241:[[56,44],256],127242:[[57,44],256],127248:[[40,65,41],256],127249:[[40,66,41],256],127250:[[40,67,41],256],127251:[[40,68,41],256],127252:[[40,69,41],256],127253:[[40,70,41],256],127254:[[40,71,41],256],127255:[[40,72,41],256],127256:[[40,73,41],256],127257:[[40,74,41],256],127258:[[40,75,41],256],127259:[[40,76,41],256],127260:[[40,77,41],256],127261:[[40,78,41],256],127262:[[40,79,41],256],127263:[[40,80,41],256],127264:[[40,81,41],256],127265:[[40,82,41],256],127266:[[40,83,41],256],127267:[[40,84,41],256],127268:[[40,85,41],256],127269:[[40,86,41],256],127270:[[40,87,41],256],127271:[[40,88,41],256],127272:[[40,89,41],256],127273:[[40,90,41],256],127274:[[12308,83,12309],256],127275:[[67],256],127276:[[82],256],127277:[[67,68],256],127278:[[87,90],256],127280:[[65],256],127281:[[66],256],127282:[[67],256],127283:[[68],256],127284:[[69],256],127285:[[70],256],127286:[[71],256],127287:[[72],256],127288:[[73],256],127289:[[74],256],127290:[[75],256],127291:[[76],256],127292:[[77],256],127293:[[78],256],127294:[[79],256],127295:[[80],256],127296:[[81],256],127297:[[82],256],127298:[[83],256],127299:[[84],256],127300:[[85],256],127301:[[86],256],127302:[[87],256],127303:[[88],256],127304:[[89],256],127305:[[90],256],127306:[[72,86],256],127307:[[77,86],256],127308:[[83,68],256],127309:[[83,83],256],127310:[[80,80,86],256],127311:[[87,67],256],127338:[[77,67],256],127339:[[77,68],256],127376:[[68,74],256]},61952:{127488:[[12411,12363],256],127489:[[12467,12467],256],127490:[[12469],256],127504:[[25163],256],127505:[[23383],256],127506:[[21452],256],127507:[[12487],256],127508:[[20108],256],127509:[[22810],256],127510:[[35299],256],127511:[[22825],256],127512:[[20132],256],127513:[[26144],256],127514:[[28961],256],127515:[[26009],256],127516:[[21069],256],127517:[[24460],256],127518:[[20877],256],127519:[[26032],256],127520:[[21021],256],127521:[[32066],256],127522:[[29983],256],127523:[[36009],256],127524:[[22768],256],127525:[[21561],256],127526:[[28436],256],127527:[[25237],256],127528:[[25429],256],127529:[[19968],256],127530:[[19977],256],127531:[[36938],256],127532:[[24038],256],127533:[[20013],256],127534:[[21491],256],127535:[[25351],256],127536:[[36208],256],127537:[[25171],256],127538:[[31105],256],127539:[[31354],256],127540:[[21512],256],127541:[[28288],256],127542:[[26377],256],127543:[[26376],256],127544:[[30003],256],127545:[[21106],256],127546:[[21942],256],127552:[[12308,26412,12309],256],127553:[[12308,19977,12309],256],127554:[[12308,20108,12309],256],127555:[[12308,23433,12309],256],127556:[[12308,28857,12309],256],127557:[[12308,25171,12309],256],127558:[[12308,30423,12309],256],127559:[[12308,21213,12309],256],127560:[[12308,25943,12309],256],127568:[[24471],256],127569:[[21487],256]},63488:{194560:[[20029]],194561:[[20024]],194562:[[20033]],194563:[[131362]],194564:[[20320]],194565:[[20398]],194566:[[20411]],194567:[[20482]],194568:[[20602]],194569:[[20633]],194570:[[20711]],194571:[[20687]],194572:[[13470]],194573:[[132666]],194574:[[20813]],194575:[[20820]],194576:[[20836]],194577:[[20855]],194578:[[132380]],194579:[[13497]],194580:[[20839]],194581:[[20877]],194582:[[132427]],194583:[[20887]],194584:[[20900]],194585:[[20172]],194586:[[20908]],194587:[[20917]],194588:[[168415]],194589:[[20981]],194590:[[20995]],194591:[[13535]],194592:[[21051]],194593:[[21062]],194594:[[21106]],194595:[[21111]],194596:[[13589]],194597:[[21191]],194598:[[21193]],194599:[[21220]],194600:[[21242]],194601:[[21253]],194602:[[21254]],194603:[[21271]],194604:[[21321]],194605:[[21329]],194606:[[21338]],194607:[[21363]],194608:[[21373]],194609:[[21375]],194610:[[21375]],194611:[[21375]],194612:[[133676]],194613:[[28784]],194614:[[21450]],194615:[[21471]],194616:[[133987]],194617:[[21483]],194618:[[21489]],194619:[[21510]],194620:[[21662]],194621:[[21560]],194622:[[21576]],194623:[[21608]],194624:[[21666]],194625:[[21750]],194626:[[21776]],194627:[[21843]],194628:[[21859]],194629:[[21892]],194630:[[21892]],194631:[[21913]],194632:[[21931]],194633:[[21939]],194634:[[21954]],194635:[[22294]],194636:[[22022]],194637:[[22295]],194638:[[22097]],194639:[[22132]],194640:[[20999]],194641:[[22766]],194642:[[22478]],194643:[[22516]],194644:[[22541]],194645:[[22411]],194646:[[22578]],194647:[[22577]],194648:[[22700]],194649:[[136420]],194650:[[22770]],194651:[[22775]],194652:[[22790]],194653:[[22810]],194654:[[22818]],194655:[[22882]],194656:[[136872]],194657:[[136938]],194658:[[23020]],194659:[[23067]],194660:[[23079]],194661:[[23e3]],194662:[[23142]],194663:[[14062]],194664:[[14076]],194665:[[23304]],194666:[[23358]],194667:[[23358]],194668:[[137672]],194669:[[23491]],194670:[[23512]],194671:[[23527]],194672:[[23539]],194673:[[138008]],194674:[[23551]],194675:[[23558]],194676:[[24403]],194677:[[23586]],194678:[[14209]],194679:[[23648]],194680:[[23662]],194681:[[23744]],194682:[[23693]],194683:[[138724]],194684:[[23875]],194685:[[138726]],194686:[[23918]],194687:[[23915]],194688:[[23932]],194689:[[24033]],194690:[[24034]],194691:[[14383]],194692:[[24061]],194693:[[24104]],194694:[[24125]],194695:[[24169]],194696:[[14434]],194697:[[139651]],194698:[[14460]],194699:[[24240]],194700:[[24243]],194701:[[24246]],194702:[[24266]],194703:[[172946]],194704:[[24318]],194705:[[140081]],194706:[[140081]],194707:[[33281]],194708:[[24354]],194709:[[24354]],194710:[[14535]],194711:[[144056]],194712:[[156122]],194713:[[24418]],194714:[[24427]],194715:[[14563]],194716:[[24474]],194717:[[24525]],194718:[[24535]],194719:[[24569]],194720:[[24705]],194721:[[14650]],194722:[[14620]],194723:[[24724]],194724:[[141012]],194725:[[24775]],194726:[[24904]],194727:[[24908]],194728:[[24910]],194729:[[24908]],194730:[[24954]],194731:[[24974]],194732:[[25010]],194733:[[24996]],194734:[[25007]],194735:[[25054]],194736:[[25074]],194737:[[25078]],194738:[[25104]],194739:[[25115]],194740:[[25181]],194741:[[25265]],194742:[[25300]],194743:[[25424]],194744:[[142092]],194745:[[25405]],194746:[[25340]],194747:[[25448]],194748:[[25475]],194749:[[25572]],194750:[[142321]],194751:[[25634]],194752:[[25541]],194753:[[25513]],194754:[[14894]],194755:[[25705]],194756:[[25726]],194757:[[25757]],194758:[[25719]],194759:[[14956]],194760:[[25935]],194761:[[25964]],194762:[[143370]],194763:[[26083]],194764:[[26360]],194765:[[26185]],194766:[[15129]],194767:[[26257]],194768:[[15112]],194769:[[15076]],194770:[[20882]],194771:[[20885]],194772:[[26368]],194773:[[26268]],194774:[[32941]],194775:[[17369]],194776:[[26391]],194777:[[26395]],194778:[[26401]],194779:[[26462]],194780:[[26451]],194781:[[144323]],194782:[[15177]],194783:[[26618]],194784:[[26501]],194785:[[26706]],194786:[[26757]],194787:[[144493]],194788:[[26766]],194789:[[26655]],194790:[[26900]],194791:[[15261]],194792:[[26946]],194793:[[27043]],194794:[[27114]],194795:[[27304]],194796:[[145059]],194797:[[27355]],194798:[[15384]],194799:[[27425]],194800:[[145575]],194801:[[27476]],194802:[[15438]],194803:[[27506]],194804:[[27551]],194805:[[27578]],194806:[[27579]],194807:[[146061]],194808:[[138507]],194809:[[146170]],194810:[[27726]],194811:[[146620]],194812:[[27839]],194813:[[27853]],194814:[[27751]],194815:[[27926]]},63744:{63744:[[35912]],63745:[[26356]],63746:[[36554]],63747:[[36040]],63748:[[28369]],63749:[[20018]],63750:[[21477]],63751:[[40860]],63752:[[40860]],63753:[[22865]],63754:[[37329]],63755:[[21895]],63756:[[22856]],63757:[[25078]],63758:[[30313]],63759:[[32645]],63760:[[34367]],63761:[[34746]],63762:[[35064]],63763:[[37007]],63764:[[27138]],63765:[[27931]],63766:[[28889]],63767:[[29662]],63768:[[33853]],63769:[[37226]],63770:[[39409]],63771:[[20098]],63772:[[21365]],63773:[[27396]],63774:[[29211]],63775:[[34349]],63776:[[40478]],63777:[[23888]],63778:[[28651]],63779:[[34253]],63780:[[35172]],63781:[[25289]],63782:[[33240]],63783:[[34847]],63784:[[24266]],63785:[[26391]],63786:[[28010]],63787:[[29436]],63788:[[37070]],63789:[[20358]],63790:[[20919]],63791:[[21214]],63792:[[25796]],63793:[[27347]],63794:[[29200]],63795:[[30439]],63796:[[32769]],63797:[[34310]],63798:[[34396]],63799:[[36335]],63800:[[38706]],63801:[[39791]],63802:[[40442]],63803:[[30860]],63804:[[31103]],63805:[[32160]],63806:[[33737]],63807:[[37636]],63808:[[40575]],63809:[[35542]],63810:[[22751]],63811:[[24324]],63812:[[31840]],63813:[[32894]],63814:[[29282]],63815:[[30922]],63816:[[36034]],63817:[[38647]],63818:[[22744]],63819:[[23650]],63820:[[27155]],63821:[[28122]],63822:[[28431]],63823:[[32047]],63824:[[32311]],63825:[[38475]],63826:[[21202]],63827:[[32907]],63828:[[20956]],63829:[[20940]],63830:[[31260]],63831:[[32190]],63832:[[33777]],63833:[[38517]],63834:[[35712]],63835:[[25295]],63836:[[27138]],63837:[[35582]],63838:[[20025]],63839:[[23527]],63840:[[24594]],63841:[[29575]],63842:[[30064]],63843:[[21271]],63844:[[30971]],63845:[[20415]],63846:[[24489]],63847:[[19981]],63848:[[27852]],63849:[[25976]],63850:[[32034]],63851:[[21443]],63852:[[22622]],63853:[[30465]],63854:[[33865]],63855:[[35498]],63856:[[27578]],63857:[[36784]],63858:[[27784]],63859:[[25342]],63860:[[33509]],63861:[[25504]],63862:[[30053]],63863:[[20142]],63864:[[20841]],63865:[[20937]],63866:[[26753]],63867:[[31975]],63868:[[33391]],63869:[[35538]],63870:[[37327]],63871:[[21237]],63872:[[21570]],63873:[[22899]],63874:[[24300]],63875:[[26053]],63876:[[28670]],63877:[[31018]],63878:[[38317]],63879:[[39530]],63880:[[40599]],63881:[[40654]],63882:[[21147]],63883:[[26310]],63884:[[27511]],63885:[[36706]],63886:[[24180]],63887:[[24976]],63888:[[25088]],63889:[[25754]],63890:[[28451]],63891:[[29001]],63892:[[29833]],63893:[[31178]],63894:[[32244]],63895:[[32879]],63896:[[36646]],63897:[[34030]],63898:[[36899]],63899:[[37706]],63900:[[21015]],63901:[[21155]],63902:[[21693]],63903:[[28872]],63904:[[35010]],63905:[[35498]],63906:[[24265]],63907:[[24565]],63908:[[25467]],63909:[[27566]],63910:[[31806]],63911:[[29557]],63912:[[20196]],63913:[[22265]],63914:[[23527]],63915:[[23994]],63916:[[24604]],63917:[[29618]],63918:[[29801]],63919:[[32666]],63920:[[32838]],63921:[[37428]],63922:[[38646]],63923:[[38728]],63924:[[38936]],63925:[[20363]],63926:[[31150]],63927:[[37300]],63928:[[38584]],63929:[[24801]],63930:[[20102]],63931:[[20698]],63932:[[23534]],63933:[[23615]],63934:[[26009]],63935:[[27138]],63936:[[29134]],63937:[[30274]],63938:[[34044]],63939:[[36988]],63940:[[40845]],63941:[[26248]],63942:[[38446]],63943:[[21129]],63944:[[26491]],63945:[[26611]],63946:[[27969]],63947:[[28316]],63948:[[29705]],63949:[[30041]],63950:[[30827]],63951:[[32016]],63952:[[39006]],63953:[[20845]],63954:[[25134]],63955:[[38520]],63956:[[20523]],63957:[[23833]],63958:[[28138]],63959:[[36650]],63960:[[24459]],63961:[[24900]],63962:[[26647]],63963:[[29575]],63964:[[38534]],63965:[[21033]],63966:[[21519]],63967:[[23653]],63968:[[26131]],63969:[[26446]],63970:[[26792]],63971:[[27877]],63972:[[29702]],63973:[[30178]],63974:[[32633]],63975:[[35023]],63976:[[35041]],63977:[[37324]],63978:[[38626]],63979:[[21311]],63980:[[28346]],63981:[[21533]],63982:[[29136]],63983:[[29848]],63984:[[34298]],63985:[[38563]],63986:[[40023]],63987:[[40607]],63988:[[26519]],63989:[[28107]],63990:[[33256]],63991:[[31435]],63992:[[31520]],63993:[[31890]],63994:[[29376]],63995:[[28825]],63996:[[35672]],63997:[[20160]],63998:[[33590]],63999:[[21050]],194816:[[27966]],194817:[[28023]],194818:[[27969]],194819:[[28009]],194820:[[28024]],194821:[[28037]],194822:[[146718]],194823:[[27956]],194824:[[28207]],194825:[[28270]],194826:[[15667]],194827:[[28363]],194828:[[28359]],194829:[[147153]],194830:[[28153]],194831:[[28526]],194832:[[147294]],194833:[[147342]],194834:[[28614]],194835:[[28729]],194836:[[28702]],194837:[[28699]],194838:[[15766]],194839:[[28746]],194840:[[28797]],194841:[[28791]],194842:[[28845]],194843:[[132389]],194844:[[28997]],194845:[[148067]],194846:[[29084]],194847:[[148395]],194848:[[29224]],194849:[[29237]],194850:[[29264]],194851:[[149e3]],194852:[[29312]],194853:[[29333]],194854:[[149301]],194855:[[149524]],194856:[[29562]],194857:[[29579]],194858:[[16044]],194859:[[29605]],194860:[[16056]],194861:[[16056]],194862:[[29767]],194863:[[29788]],194864:[[29809]],194865:[[29829]],194866:[[29898]],194867:[[16155]],194868:[[29988]],194869:[[150582]],194870:[[30014]],194871:[[150674]],194872:[[30064]],194873:[[139679]],194874:[[30224]],194875:[[151457]],194876:[[151480]],194877:[[151620]],194878:[[16380]],194879:[[16392]],194880:[[30452]],194881:[[151795]],194882:[[151794]],194883:[[151833]],194884:[[151859]],194885:[[30494]],194886:[[30495]],194887:[[30495]],194888:[[30538]],194889:[[16441]],194890:[[30603]],194891:[[16454]],194892:[[16534]],194893:[[152605]],194894:[[30798]],194895:[[30860]],194896:[[30924]],194897:[[16611]],194898:[[153126]],194899:[[31062]],194900:[[153242]],194901:[[153285]],194902:[[31119]],194903:[[31211]],194904:[[16687]],194905:[[31296]],194906:[[31306]],194907:[[31311]],194908:[[153980]],194909:[[154279]],194910:[[154279]],194911:[[31470]],194912:[[16898]],194913:[[154539]],194914:[[31686]],194915:[[31689]],194916:[[16935]],194917:[[154752]],194918:[[31954]],194919:[[17056]],194920:[[31976]],194921:[[31971]],194922:[[32e3]],194923:[[155526]],194924:[[32099]],194925:[[17153]],194926:[[32199]],194927:[[32258]],194928:[[32325]],194929:[[17204]],194930:[[156200]],194931:[[156231]],194932:[[17241]],194933:[[156377]],194934:[[32634]],194935:[[156478]],194936:[[32661]],194937:[[32762]],194938:[[32773]],194939:[[156890]],194940:[[156963]],194941:[[32864]],194942:[[157096]],194943:[[32880]],194944:[[144223]],194945:[[17365]],194946:[[32946]],194947:[[33027]],194948:[[17419]],194949:[[33086]],194950:[[23221]],194951:[[157607]],194952:[[157621]],194953:[[144275]],194954:[[144284]],194955:[[33281]],194956:[[33284]],194957:[[36766]],194958:[[17515]],194959:[[33425]],194960:[[33419]],194961:[[33437]],194962:[[21171]],194963:[[33457]],194964:[[33459]],194965:[[33469]],194966:[[33510]],194967:[[158524]],194968:[[33509]],194969:[[33565]],194970:[[33635]],194971:[[33709]],194972:[[33571]],194973:[[33725]],194974:[[33767]],194975:[[33879]],194976:[[33619]],194977:[[33738]],194978:[[33740]],194979:[[33756]],194980:[[158774]],194981:[[159083]],194982:[[158933]],194983:[[17707]],194984:[[34033]],194985:[[34035]],194986:[[34070]],194987:[[160714]],194988:[[34148]],194989:[[159532]],194990:[[17757]],194991:[[17761]],194992:[[159665]],194993:[[159954]],194994:[[17771]],194995:[[34384]],194996:[[34396]],194997:[[34407]],194998:[[34409]],194999:[[34473]],195e3:[[34440]],195001:[[34574]],195002:[[34530]],195003:[[34681]],195004:[[34600]],195005:[[34667]],195006:[[34694]],195007:[[17879]],195008:[[34785]],195009:[[34817]],195010:[[17913]],195011:[[34912]],195012:[[34915]],195013:[[161383]],195014:[[35031]],195015:[[35038]],195016:[[17973]],195017:[[35066]],195018:[[13499]],195019:[[161966]],195020:[[162150]],195021:[[18110]],195022:[[18119]],195023:[[35488]],195024:[[35565]],195025:[[35722]],195026:[[35925]],195027:[[162984]],195028:[[36011]],195029:[[36033]],195030:[[36123]],195031:[[36215]],195032:[[163631]],195033:[[133124]],195034:[[36299]],195035:[[36284]],195036:[[36336]],195037:[[133342]],195038:[[36564]],195039:[[36664]],195040:[[165330]],195041:[[165357]],195042:[[37012]],195043:[[37105]],195044:[[37137]],195045:[[165678]],195046:[[37147]],195047:[[37432]],195048:[[37591]],195049:[[37592]],195050:[[37500]],195051:[[37881]],195052:[[37909]],195053:[[166906]],195054:[[38283]],195055:[[18837]],195056:[[38327]],195057:[[167287]],195058:[[18918]],195059:[[38595]],195060:[[23986]],195061:[[38691]],195062:[[168261]],195063:[[168474]],195064:[[19054]],195065:[[19062]],195066:[[38880]],195067:[[168970]],195068:[[19122]],195069:[[169110]],195070:[[38923]],195071:[[38923]]},64e3:{64e3:[[20999]],64001:[[24230]],64002:[[25299]],64003:[[31958]],64004:[[23429]],64005:[[27934]],64006:[[26292]],64007:[[36667]],64008:[[34892]],64009:[[38477]],64010:[[35211]],64011:[[24275]],64012:[[20800]],64013:[[21952]],64016:[[22618]],64018:[[26228]],64021:[[20958]],64022:[[29482]],64023:[[30410]],64024:[[31036]],64025:[[31070]],64026:[[31077]],64027:[[31119]],64028:[[38742]],64029:[[31934]],64030:[[32701]],64032:[[34322]],64034:[[35576]],64037:[[36920]],64038:[[37117]],64042:[[39151]],64043:[[39164]],64044:[[39208]],64045:[[40372]],64046:[[37086]],64047:[[38583]],64048:[[20398]],64049:[[20711]],64050:[[20813]],64051:[[21193]],64052:[[21220]],64053:[[21329]],64054:[[21917]],64055:[[22022]],64056:[[22120]],64057:[[22592]],64058:[[22696]],64059:[[23652]],64060:[[23662]],64061:[[24724]],64062:[[24936]],64063:[[24974]],64064:[[25074]],64065:[[25935]],64066:[[26082]],64067:[[26257]],64068:[[26757]],64069:[[28023]],64070:[[28186]],64071:[[28450]],64072:[[29038]],64073:[[29227]],64074:[[29730]],64075:[[30865]],64076:[[31038]],64077:[[31049]],64078:[[31048]],64079:[[31056]],64080:[[31062]],64081:[[31069]],64082:[[31117]],64083:[[31118]],64084:[[31296]],64085:[[31361]],64086:[[31680]],64087:[[32244]],64088:[[32265]],64089:[[32321]],64090:[[32626]],64091:[[32773]],64092:[[33261]],64093:[[33401]],64094:[[33401]],64095:[[33879]],64096:[[35088]],64097:[[35222]],64098:[[35585]],64099:[[35641]],64100:[[36051]],64101:[[36104]],64102:[[36790]],64103:[[36920]],64104:[[38627]],64105:[[38911]],64106:[[38971]],64107:[[24693]],64108:[[148206]],64109:[[33304]],64112:[[20006]],64113:[[20917]],64114:[[20840]],64115:[[20352]],64116:[[20805]],64117:[[20864]],64118:[[21191]],64119:[[21242]],64120:[[21917]],64121:[[21845]],64122:[[21913]],64123:[[21986]],64124:[[22618]],64125:[[22707]],64126:[[22852]],64127:[[22868]],64128:[[23138]],64129:[[23336]],64130:[[24274]],64131:[[24281]],64132:[[24425]],64133:[[24493]],64134:[[24792]],64135:[[24910]],64136:[[24840]],64137:[[24974]],64138:[[24928]],64139:[[25074]],64140:[[25140]],64141:[[25540]],64142:[[25628]],64143:[[25682]],64144:[[25942]],64145:[[26228]],64146:[[26391]],64147:[[26395]],64148:[[26454]],64149:[[27513]],64150:[[27578]],64151:[[27969]],64152:[[28379]],64153:[[28363]],64154:[[28450]],64155:[[28702]],64156:[[29038]],64157:[[30631]],64158:[[29237]],64159:[[29359]],64160:[[29482]],64161:[[29809]],64162:[[29958]],64163:[[30011]],64164:[[30237]],64165:[[30239]],64166:[[30410]],64167:[[30427]],64168:[[30452]],64169:[[30538]],64170:[[30528]],64171:[[30924]],64172:[[31409]],64173:[[31680]],64174:[[31867]],64175:[[32091]],64176:[[32244]],64177:[[32574]],64178:[[32773]],64179:[[33618]],64180:[[33775]],64181:[[34681]],64182:[[35137]],64183:[[35206]],64184:[[35222]],64185:[[35519]],64186:[[35576]],64187:[[35531]],64188:[[35585]],64189:[[35582]],64190:[[35565]],64191:[[35641]],64192:[[35722]],64193:[[36104]],64194:[[36664]],64195:[[36978]],64196:[[37273]],64197:[[37494]],64198:[[38524]],64199:[[38627]],64200:[[38742]],64201:[[38875]],64202:[[38911]],64203:[[38923]],64204:[[38971]],64205:[[39698]],64206:[[40860]],64207:[[141386]],64208:[[141380]],64209:[[144341]],64210:[[15261]],64211:[[16408]],64212:[[16441]],64213:[[152137]],64214:[[154832]],64215:[[163539]],64216:[[40771]],64217:[[40846]],195072:[[38953]],195073:[[169398]],195074:[[39138]],195075:[[19251]],195076:[[39209]],195077:[[39335]],195078:[[39362]],195079:[[39422]],195080:[[19406]],195081:[[170800]],195082:[[39698]],195083:[[4e4]],195084:[[40189]],195085:[[19662]],195086:[[19693]],195087:[[40295]],195088:[[172238]],195089:[[19704]],195090:[[172293]],195091:[[172558]],195092:[[172689]],195093:[[40635]],195094:[[19798]],195095:[[40697]],195096:[[40702]],195097:[[40709]],195098:[[40719]],195099:[[40726]],195100:[[40763]],195101:[[173568]]},64256:{64256:[[102,102],256],64257:[[102,105],256],64258:[[102,108],256],64259:[[102,102,105],256],64260:[[102,102,108],256],64261:[[383,116],256],64262:[[115,116],256],64275:[[1396,1398],256],64276:[[1396,1381],256],64277:[[1396,1387],256],64278:[[1406,1398],256],64279:[[1396,1389],256],64285:[[1497,1460],512],64286:[,26],64287:[[1522,1463],512],64288:[[1506],256],64289:[[1488],256],64290:[[1491],256],64291:[[1492],256],64292:[[1499],256],64293:[[1500],256],64294:[[1501],256],64295:[[1512],256],64296:[[1514],256],64297:[[43],256],64298:[[1513,1473],512],64299:[[1513,1474],512],64300:[[64329,1473],512],64301:[[64329,1474],512],64302:[[1488,1463],512],64303:[[1488,1464],512],64304:[[1488,1468],512],64305:[[1489,1468],512],64306:[[1490,1468],512],64307:[[1491,1468],512],64308:[[1492,1468],512],64309:[[1493,1468],512],64310:[[1494,1468],512],64312:[[1496,1468],512],64313:[[1497,1468],512],64314:[[1498,1468],512],64315:[[1499,1468],512],64316:[[1500,1468],512],64318:[[1502,1468],512],64320:[[1504,1468],512],64321:[[1505,1468],512],64323:[[1507,1468],512],64324:[[1508,1468],512],64326:[[1510,1468],512],64327:[[1511,1468],512],64328:[[1512,1468],512],64329:[[1513,1468],512],64330:[[1514,1468],512],64331:[[1493,1465],512],64332:[[1489,1471],512],64333:[[1499,1471],512],64334:[[1508,1471],512],64335:[[1488,1500],256],64336:[[1649],256],64337:[[1649],256],64338:[[1659],256],64339:[[1659],256],64340:[[1659],256],64341:[[1659],256],64342:[[1662],256],64343:[[1662],256],64344:[[1662],256],64345:[[1662],256],64346:[[1664],256],64347:[[1664],256],64348:[[1664],256],64349:[[1664],256],64350:[[1658],256],64351:[[1658],256],64352:[[1658],256],64353:[[1658],256],64354:[[1663],256],64355:[[1663],256],64356:[[1663],256],64357:[[1663],256],64358:[[1657],256],64359:[[1657],256],64360:[[1657],256],64361:[[1657],256],64362:[[1700],256],64363:[[1700],256],64364:[[1700],256],64365:[[1700],256],64366:[[1702],256],64367:[[1702],256],64368:[[1702],256],64369:[[1702],256],64370:[[1668],256],64371:[[1668],256],64372:[[1668],256],64373:[[1668],256],64374:[[1667],256],64375:[[1667],256],64376:[[1667],256],64377:[[1667],256],64378:[[1670],256],64379:[[1670],256],64380:[[1670],256],64381:[[1670],256],64382:[[1671],256],64383:[[1671],256],64384:[[1671],256],64385:[[1671],256],64386:[[1677],256],64387:[[1677],256],64388:[[1676],256],64389:[[1676],256],64390:[[1678],256],64391:[[1678],256],64392:[[1672],256],64393:[[1672],256],64394:[[1688],256],64395:[[1688],256],64396:[[1681],256],64397:[[1681],256],64398:[[1705],256],64399:[[1705],256],64400:[[1705],256],64401:[[1705],256],64402:[[1711],256],64403:[[1711],256],64404:[[1711],256],64405:[[1711],256],64406:[[1715],256],64407:[[1715],256],64408:[[1715],256],64409:[[1715],256],64410:[[1713],256],64411:[[1713],256],64412:[[1713],256],64413:[[1713],256],64414:[[1722],256],64415:[[1722],256],64416:[[1723],256],64417:[[1723],256],64418:[[1723],256],64419:[[1723],256],64420:[[1728],256],64421:[[1728],256],64422:[[1729],256],64423:[[1729],256],64424:[[1729],256],64425:[[1729],256],64426:[[1726],256],64427:[[1726],256],64428:[[1726],256],64429:[[1726],256],64430:[[1746],256],64431:[[1746],256],64432:[[1747],256],64433:[[1747],256],64467:[[1709],256],64468:[[1709],256],64469:[[1709],256],64470:[[1709],256],64471:[[1735],256],64472:[[1735],256],64473:[[1734],256],64474:[[1734],256],64475:[[1736],256],64476:[[1736],256],64477:[[1655],256],64478:[[1739],256],64479:[[1739],256],64480:[[1733],256],64481:[[1733],256],64482:[[1737],256],64483:[[1737],256],64484:[[1744],256],64485:[[1744],256],64486:[[1744],256],64487:[[1744],256],64488:[[1609],256],64489:[[1609],256],64490:[[1574,1575],256],64491:[[1574,1575],256],64492:[[1574,1749],256],64493:[[1574,1749],256],64494:[[1574,1608],256],64495:[[1574,1608],256],64496:[[1574,1735],256],64497:[[1574,1735],256],64498:[[1574,1734],256],64499:[[1574,1734],256],64500:[[1574,1736],256],64501:[[1574,1736],256],64502:[[1574,1744],256],64503:[[1574,1744],256],64504:[[1574,1744],256],64505:[[1574,1609],256],64506:[[1574,1609],256],64507:[[1574,1609],256],64508:[[1740],256],64509:[[1740],256],64510:[[1740],256],64511:[[1740],256]},64512:{64512:[[1574,1580],256],64513:[[1574,1581],256],64514:[[1574,1605],256],64515:[[1574,1609],256],64516:[[1574,1610],256],64517:[[1576,1580],256],64518:[[1576,1581],256],64519:[[1576,1582],256],64520:[[1576,1605],256],64521:[[1576,1609],256],64522:[[1576,1610],256],64523:[[1578,1580],256],64524:[[1578,1581],256],64525:[[1578,1582],256],64526:[[1578,1605],256],64527:[[1578,1609],256],64528:[[1578,1610],256],64529:[[1579,1580],256],64530:[[1579,1605],256],64531:[[1579,1609],256],64532:[[1579,1610],256],64533:[[1580,1581],256],64534:[[1580,1605],256],64535:[[1581,1580],256],64536:[[1581,1605],256],64537:[[1582,1580],256],64538:[[1582,1581],256],64539:[[1582,1605],256],64540:[[1587,1580],256],64541:[[1587,1581],256],64542:[[1587,1582],256],64543:[[1587,1605],256],64544:[[1589,1581],256],64545:[[1589,1605],256],64546:[[1590,1580],256],64547:[[1590,1581],256],64548:[[1590,1582],256],64549:[[1590,1605],256],64550:[[1591,1581],256],64551:[[1591,1605],256],64552:[[1592,1605],256],64553:[[1593,1580],256],64554:[[1593,1605],256],64555:[[1594,1580],256],64556:[[1594,1605],256],64557:[[1601,1580],256],64558:[[1601,1581],256],64559:[[1601,1582],256],64560:[[1601,1605],256],64561:[[1601,1609],256],64562:[[1601,1610],256],64563:[[1602,1581],256],64564:[[1602,1605],256],64565:[[1602,1609],256],64566:[[1602,1610],256],64567:[[1603,1575],256],64568:[[1603,1580],256],64569:[[1603,1581],256],64570:[[1603,1582],256],64571:[[1603,1604],256],64572:[[1603,1605],256],64573:[[1603,1609],256],64574:[[1603,1610],256],64575:[[1604,1580],256],64576:[[1604,1581],256],64577:[[1604,1582],256],64578:[[1604,1605],256],64579:[[1604,1609],256],64580:[[1604,1610],256],64581:[[1605,1580],256],64582:[[1605,1581],256],64583:[[1605,1582],256],64584:[[1605,1605],256],64585:[[1605,1609],256],64586:[[1605,1610],256],64587:[[1606,1580],256],64588:[[1606,1581],256],64589:[[1606,1582],256],64590:[[1606,1605],256],64591:[[1606,1609],256],64592:[[1606,1610],256],64593:[[1607,1580],256],64594:[[1607,1605],256],64595:[[1607,1609],256],64596:[[1607,1610],256],64597:[[1610,1580],256],64598:[[1610,1581],256],64599:[[1610,1582],256],64600:[[1610,1605],256],64601:[[1610,1609],256],64602:[[1610,1610],256],64603:[[1584,1648],256],64604:[[1585,1648],256],64605:[[1609,1648],256],64606:[[32,1612,1617],256],64607:[[32,1613,1617],256],64608:[[32,1614,1617],256],64609:[[32,1615,1617],256],64610:[[32,1616,1617],256],64611:[[32,1617,1648],256],64612:[[1574,1585],256],64613:[[1574,1586],256],64614:[[1574,1605],256],64615:[[1574,1606],256],64616:[[1574,1609],256],64617:[[1574,1610],256],64618:[[1576,1585],256],64619:[[1576,1586],256],64620:[[1576,1605],256],64621:[[1576,1606],256],64622:[[1576,1609],256],64623:[[1576,1610],256],64624:[[1578,1585],256],64625:[[1578,1586],256],64626:[[1578,1605],256],64627:[[1578,1606],256],64628:[[1578,1609],256],64629:[[1578,1610],256],64630:[[1579,1585],256],64631:[[1579,1586],256],64632:[[1579,1605],256],64633:[[1579,1606],256],64634:[[1579,1609],256],64635:[[1579,1610],256],64636:[[1601,1609],256],64637:[[1601,1610],256],64638:[[1602,1609],256],64639:[[1602,1610],256],64640:[[1603,1575],256],64641:[[1603,1604],256],64642:[[1603,1605],256],64643:[[1603,1609],256],64644:[[1603,1610],256],64645:[[1604,1605],256],64646:[[1604,1609],256],64647:[[1604,1610],256],64648:[[1605,1575],256],64649:[[1605,1605],256],64650:[[1606,1585],256],64651:[[1606,1586],256],64652:[[1606,1605],256],64653:[[1606,1606],256],64654:[[1606,1609],256],64655:[[1606,1610],256],64656:[[1609,1648],256],64657:[[1610,1585],256],64658:[[1610,1586],256],64659:[[1610,1605],256],64660:[[1610,1606],256],64661:[[1610,1609],256],64662:[[1610,1610],256],64663:[[1574,1580],256],64664:[[1574,1581],256],64665:[[1574,1582],256],64666:[[1574,1605],256],64667:[[1574,1607],256],64668:[[1576,1580],256],64669:[[1576,1581],256],64670:[[1576,1582],256],64671:[[1576,1605],256],64672:[[1576,1607],256],64673:[[1578,1580],256],64674:[[1578,1581],256],64675:[[1578,1582],256],64676:[[1578,1605],256],64677:[[1578,1607],256],64678:[[1579,1605],256],64679:[[1580,1581],256],64680:[[1580,1605],256],64681:[[1581,1580],256],64682:[[1581,1605],256],64683:[[1582,1580],256],64684:[[1582,1605],256],64685:[[1587,1580],256],64686:[[1587,1581],256],64687:[[1587,1582],256],64688:[[1587,1605],256],64689:[[1589,1581],256],64690:[[1589,1582],256],64691:[[1589,1605],256],64692:[[1590,1580],256],64693:[[1590,1581],256],64694:[[1590,1582],256],64695:[[1590,1605],256],64696:[[1591,1581],256],64697:[[1592,1605],256],64698:[[1593,1580],256],64699:[[1593,1605],256],64700:[[1594,1580],256],64701:[[1594,1605],256],64702:[[1601,1580],256],64703:[[1601,1581],256],64704:[[1601,1582],256],64705:[[1601,1605],256],64706:[[1602,1581],256],64707:[[1602,1605],256],64708:[[1603,1580],256],64709:[[1603,1581],256],64710:[[1603,1582],256],64711:[[1603,1604],256],64712:[[1603,1605],256],64713:[[1604,1580],256],64714:[[1604,1581],256],64715:[[1604,1582],256],64716:[[1604,1605],256],64717:[[1604,1607],256],64718:[[1605,1580],256],64719:[[1605,1581],256],64720:[[1605,1582],256],64721:[[1605,1605],256],64722:[[1606,1580],256],64723:[[1606,1581],256],64724:[[1606,1582],256],64725:[[1606,1605],256],64726:[[1606,1607],256],64727:[[1607,1580],256],64728:[[1607,1605],256],64729:[[1607,1648],256],64730:[[1610,1580],256],64731:[[1610,1581],256],64732:[[1610,1582],256],64733:[[1610,1605],256],64734:[[1610,1607],256],64735:[[1574,1605],256],64736:[[1574,1607],256],64737:[[1576,1605],256],64738:[[1576,1607],256],64739:[[1578,1605],256],64740:[[1578,1607],256],64741:[[1579,1605],256],64742:[[1579,1607],256],64743:[[1587,1605],256],64744:[[1587,1607],256],64745:[[1588,1605],256],64746:[[1588,1607],256],64747:[[1603,1604],256],64748:[[1603,1605],256],64749:[[1604,1605],256],64750:[[1606,1605],256],64751:[[1606,1607],256],64752:[[1610,1605],256],64753:[[1610,1607],256],64754:[[1600,1614,1617],256],64755:[[1600,1615,1617],256],64756:[[1600,1616,1617],256],64757:[[1591,1609],256],64758:[[1591,1610],256],64759:[[1593,1609],256],64760:[[1593,1610],256],64761:[[1594,1609],256],64762:[[1594,1610],256],64763:[[1587,1609],256],64764:[[1587,1610],256],64765:[[1588,1609],256],64766:[[1588,1610],256],64767:[[1581,1609],256]},64768:{64768:[[1581,1610],256],64769:[[1580,1609],256],64770:[[1580,1610],256],64771:[[1582,1609],256],64772:[[1582,1610],256],64773:[[1589,1609],256],64774:[[1589,1610],256],64775:[[1590,1609],256],64776:[[1590,1610],256],64777:[[1588,1580],256],64778:[[1588,1581],256],64779:[[1588,1582],256],64780:[[1588,1605],256],64781:[[1588,1585],256],64782:[[1587,1585],256],64783:[[1589,1585],256],64784:[[1590,1585],256],64785:[[1591,1609],256],64786:[[1591,1610],256],64787:[[1593,1609],256],64788:[[1593,1610],256],64789:[[1594,1609],256],64790:[[1594,1610],256],64791:[[1587,1609],256],64792:[[1587,1610],256],64793:[[1588,1609],256],64794:[[1588,1610],256],64795:[[1581,1609],256],64796:[[1581,1610],256],64797:[[1580,1609],256],64798:[[1580,1610],256],64799:[[1582,1609],256],64800:[[1582,1610],256],64801:[[1589,1609],256],64802:[[1589,1610],256],64803:[[1590,1609],256],64804:[[1590,1610],256],64805:[[1588,1580],256],64806:[[1588,1581],256],64807:[[1588,1582],256],64808:[[1588,1605],256],64809:[[1588,1585],256],64810:[[1587,1585],256],64811:[[1589,1585],256],64812:[[1590,1585],256],64813:[[1588,1580],256],64814:[[1588,1581],256],64815:[[1588,1582],256],64816:[[1588,1605],256],64817:[[1587,1607],256],64818:[[1588,1607],256],64819:[[1591,1605],256],64820:[[1587,1580],256],64821:[[1587,1581],256],64822:[[1587,1582],256],64823:[[1588,1580],256],64824:[[1588,1581],256],64825:[[1588,1582],256],64826:[[1591,1605],256],64827:[[1592,1605],256],64828:[[1575,1611],256],64829:[[1575,1611],256],64848:[[1578,1580,1605],256],64849:[[1578,1581,1580],256],64850:[[1578,1581,1580],256],64851:[[1578,1581,1605],256],64852:[[1578,1582,1605],256],64853:[[1578,1605,1580],256],64854:[[1578,1605,1581],256],64855:[[1578,1605,1582],256],64856:[[1580,1605,1581],256],64857:[[1580,1605,1581],256],64858:[[1581,1605,1610],256],64859:[[1581,1605,1609],256],64860:[[1587,1581,1580],256],64861:[[1587,1580,1581],256],64862:[[1587,1580,1609],256],64863:[[1587,1605,1581],256],64864:[[1587,1605,1581],256],64865:[[1587,1605,1580],256],64866:[[1587,1605,1605],256],64867:[[1587,1605,1605],256],64868:[[1589,1581,1581],256],64869:[[1589,1581,1581],256],64870:[[1589,1605,1605],256],64871:[[1588,1581,1605],256],64872:[[1588,1581,1605],256],64873:[[1588,1580,1610],256],64874:[[1588,1605,1582],256],64875:[[1588,1605,1582],256],64876:[[1588,1605,1605],256],64877:[[1588,1605,1605],256],64878:[[1590,1581,1609],256],64879:[[1590,1582,1605],256],64880:[[1590,1582,1605],256],64881:[[1591,1605,1581],256],64882:[[1591,1605,1581],256],64883:[[1591,1605,1605],256],64884:[[1591,1605,1610],256],64885:[[1593,1580,1605],256],64886:[[1593,1605,1605],256],64887:[[1593,1605,1605],256],64888:[[1593,1605,1609],256],64889:[[1594,1605,1605],256],64890:[[1594,1605,1610],256],64891:[[1594,1605,1609],256],64892:[[1601,1582,1605],256],64893:[[1601,1582,1605],256],64894:[[1602,1605,1581],256],64895:[[1602,1605,1605],256],64896:[[1604,1581,1605],256],64897:[[1604,1581,1610],256],64898:[[1604,1581,1609],256],64899:[[1604,1580,1580],256],64900:[[1604,1580,1580],256],64901:[[1604,1582,1605],256],64902:[[1604,1582,1605],256],64903:[[1604,1605,1581],256],64904:[[1604,1605,1581],256],64905:[[1605,1581,1580],256],64906:[[1605,1581,1605],256],64907:[[1605,1581,1610],256],64908:[[1605,1580,1581],256],64909:[[1605,1580,1605],256],64910:[[1605,1582,1580],256],64911:[[1605,1582,1605],256],64914:[[1605,1580,1582],256],64915:[[1607,1605,1580],256],64916:[[1607,1605,1605],256],64917:[[1606,1581,1605],256],64918:[[1606,1581,1609],256],64919:[[1606,1580,1605],256],64920:[[1606,1580,1605],256],64921:[[1606,1580,1609],256],64922:[[1606,1605,1610],256],64923:[[1606,1605,1609],256],64924:[[1610,1605,1605],256],64925:[[1610,1605,1605],256],64926:[[1576,1582,1610],256],64927:[[1578,1580,1610],256],64928:[[1578,1580,1609],256],64929:[[1578,1582,1610],256],64930:[[1578,1582,1609],256],64931:[[1578,1605,1610],256],64932:[[1578,1605,1609],256],64933:[[1580,1605,1610],256],64934:[[1580,1581,1609],256],64935:[[1580,1605,1609],256],64936:[[1587,1582,1609],256],64937:[[1589,1581,1610],256],64938:[[1588,1581,1610],256],64939:[[1590,1581,1610],256],64940:[[1604,1580,1610],256],64941:[[1604,1605,1610],256],64942:[[1610,1581,1610],256],64943:[[1610,1580,1610],256],64944:[[1610,1605,1610],256],64945:[[1605,1605,1610],256],64946:[[1602,1605,1610],256],64947:[[1606,1581,1610],256],64948:[[1602,1605,1581],256],64949:[[1604,1581,1605],256],64950:[[1593,1605,1610],256],64951:[[1603,1605,1610],256],64952:[[1606,1580,1581],256],64953:[[1605,1582,1610],256],64954:[[1604,1580,1605],256],64955:[[1603,1605,1605],256],64956:[[1604,1580,1605],256],64957:[[1606,1580,1581],256],64958:[[1580,1581,1610],256],64959:[[1581,1580,1610],256],64960:[[1605,1580,1610],256],64961:[[1601,1605,1610],256],64962:[[1576,1581,1610],256],64963:[[1603,1605,1605],256],64964:[[1593,1580,1605],256],64965:[[1589,1605,1605],256],64966:[[1587,1582,1610],256],64967:[[1606,1580,1610],256],65008:[[1589,1604,1746],256],65009:[[1602,1604,1746],256],65010:[[1575,1604,1604,1607],256],65011:[[1575,1603,1576,1585],256],65012:[[1605,1581,1605,1583],256],65013:[[1589,1604,1593,1605],256],65014:[[1585,1587,1608,1604],256],65015:[[1593,1604,1610,1607],256],65016:[[1608,1587,1604,1605],256],65017:[[1589,1604,1609],256],65018:[[1589,1604,1609,32,1575,1604,1604,1607,32,1593,1604,1610,1607,32,1608,1587,1604,1605],256],65019:[[1580,1604,32,1580,1604,1575,1604,1607],256],65020:[[1585,1740,1575,1604],256]},65024:{65040:[[44],256],65041:[[12289],256],65042:[[12290],256],65043:[[58],256],65044:[[59],256],65045:[[33],256],65046:[[63],256],65047:[[12310],256],65048:[[12311],256],65049:[[8230],256],65056:[,230],65057:[,230],65058:[,230],65059:[,230],65060:[,230],65061:[,230],65062:[,230],65063:[,220],65064:[,220],65065:[,220],65066:[,220],65067:[,220],65068:[,220],65069:[,220],65072:[[8229],256],65073:[[8212],256],65074:[[8211],256],65075:[[95],256],65076:[[95],256],65077:[[40],256],65078:[[41],256],65079:[[123],256],65080:[[125],256],65081:[[12308],256],65082:[[12309],256],65083:[[12304],256],65084:[[12305],256],65085:[[12298],256],65086:[[12299],256],65087:[[12296],256],65088:[[12297],256],65089:[[12300],256],65090:[[12301],256],65091:[[12302],256],65092:[[12303],256],65095:[[91],256],65096:[[93],256],65097:[[8254],256],65098:[[8254],256],65099:[[8254],256],65100:[[8254],256],65101:[[95],256],65102:[[95],256],65103:[[95],256],65104:[[44],256],65105:[[12289],256],65106:[[46],256],65108:[[59],256],65109:[[58],256],65110:[[63],256],65111:[[33],256],65112:[[8212],256],65113:[[40],256],65114:[[41],256],65115:[[123],256],65116:[[125],256],65117:[[12308],256],65118:[[12309],256],65119:[[35],256],65120:[[38],256],65121:[[42],256],65122:[[43],256],65123:[[45],256],65124:[[60],256],65125:[[62],256],65126:[[61],256],65128:[[92],256],65129:[[36],256],65130:[[37],256],65131:[[64],256],65136:[[32,1611],256],65137:[[1600,1611],256],65138:[[32,1612],256],65140:[[32,1613],256],65142:[[32,1614],256],65143:[[1600,1614],256],65144:[[32,1615],256],65145:[[1600,1615],256],65146:[[32,1616],256],65147:[[1600,1616],256],65148:[[32,1617],256],65149:[[1600,1617],256],65150:[[32,1618],256],65151:[[1600,1618],256],65152:[[1569],256],65153:[[1570],256],65154:[[1570],256],65155:[[1571],256],65156:[[1571],256],65157:[[1572],256],65158:[[1572],256],65159:[[1573],256],65160:[[1573],256],65161:[[1574],256],65162:[[1574],256],65163:[[1574],256],65164:[[1574],256],65165:[[1575],256],65166:[[1575],256],65167:[[1576],256],65168:[[1576],256],65169:[[1576],256],65170:[[1576],256],65171:[[1577],256],65172:[[1577],256],65173:[[1578],256],65174:[[1578],256],65175:[[1578],256],65176:[[1578],256],65177:[[1579],256],65178:[[1579],256],65179:[[1579],256],65180:[[1579],256],65181:[[1580],256],65182:[[1580],256],65183:[[1580],256],65184:[[1580],256],65185:[[1581],256],65186:[[1581],256],65187:[[1581],256],65188:[[1581],256],65189:[[1582],256],65190:[[1582],256],65191:[[1582],256],65192:[[1582],256],65193:[[1583],256],65194:[[1583],256],65195:[[1584],256],65196:[[1584],256],65197:[[1585],256],65198:[[1585],256],65199:[[1586],256],65200:[[1586],256],65201:[[1587],256],65202:[[1587],256],65203:[[1587],256],65204:[[1587],256],65205:[[1588],256],65206:[[1588],256],65207:[[1588],256],65208:[[1588],256],65209:[[1589],256],65210:[[1589],256],65211:[[1589],256],65212:[[1589],256],65213:[[1590],256],65214:[[1590],256],65215:[[1590],256],65216:[[1590],256],65217:[[1591],256],65218:[[1591],256],65219:[[1591],256],65220:[[1591],256],65221:[[1592],256],65222:[[1592],256],65223:[[1592],256],65224:[[1592],256],65225:[[1593],256],65226:[[1593],256],65227:[[1593],256],65228:[[1593],256],65229:[[1594],256],65230:[[1594],256],65231:[[1594],256],65232:[[1594],256],65233:[[1601],256],65234:[[1601],256],65235:[[1601],256],65236:[[1601],256],65237:[[1602],256],65238:[[1602],256],65239:[[1602],256],65240:[[1602],256],65241:[[1603],256],65242:[[1603],256],65243:[[1603],256],65244:[[1603],256],65245:[[1604],256],65246:[[1604],256],65247:[[1604],256],65248:[[1604],256],65249:[[1605],256],65250:[[1605],256],65251:[[1605],256],65252:[[1605],256],65253:[[1606],256],65254:[[1606],256],65255:[[1606],256],65256:[[1606],256],65257:[[1607],256],65258:[[1607],256],65259:[[1607],256],65260:[[1607],256],65261:[[1608],256],65262:[[1608],256],65263:[[1609],256],65264:[[1609],256],65265:[[1610],256],65266:[[1610],256],65267:[[1610],256],65268:[[1610],256],65269:[[1604,1570],256],65270:[[1604,1570],256],65271:[[1604,1571],256],65272:[[1604,1571],256],65273:[[1604,1573],256],65274:[[1604,1573],256],65275:[[1604,1575],256],65276:[[1604,1575],256]},65280:{65281:[[33],256],65282:[[34],256],65283:[[35],256],65284:[[36],256],65285:[[37],256],65286:[[38],256],65287:[[39],256],65288:[[40],256],65289:[[41],256],65290:[[42],256],65291:[[43],256],65292:[[44],256],65293:[[45],256],65294:[[46],256],65295:[[47],256],65296:[[48],256],65297:[[49],256],65298:[[50],256],65299:[[51],256],65300:[[52],256],65301:[[53],256],65302:[[54],256],65303:[[55],256],65304:[[56],256],65305:[[57],256],65306:[[58],256],65307:[[59],256],65308:[[60],256],65309:[[61],256],65310:[[62],256],65311:[[63],256],65312:[[64],256],65313:[[65],256],65314:[[66],256],65315:[[67],256],65316:[[68],256],65317:[[69],256],65318:[[70],256],65319:[[71],256],65320:[[72],256],65321:[[73],256],65322:[[74],256],65323:[[75],256],65324:[[76],256],65325:[[77],256],65326:[[78],256],65327:[[79],256],65328:[[80],256],65329:[[81],256],65330:[[82],256],65331:[[83],256],65332:[[84],256],65333:[[85],256],65334:[[86],256],65335:[[87],256],65336:[[88],256],65337:[[89],256],65338:[[90],256],65339:[[91],256],65340:[[92],256],65341:[[93],256],65342:[[94],256],65343:[[95],256],65344:[[96],256],65345:[[97],256],65346:[[98],256],65347:[[99],256],65348:[[100],256],65349:[[101],256],65350:[[102],256],65351:[[103],256],65352:[[104],256],65353:[[105],256],65354:[[106],256],65355:[[107],256],65356:[[108],256],65357:[[109],256],65358:[[110],256],65359:[[111],256],65360:[[112],256],65361:[[113],256],65362:[[114],256],65363:[[115],256],65364:[[116],256],65365:[[117],256],65366:[[118],256],65367:[[119],256],65368:[[120],256],65369:[[121],256],65370:[[122],256],65371:[[123],256],65372:[[124],256],65373:[[125],256],65374:[[126],256],65375:[[10629],256],65376:[[10630],256],65377:[[12290],256],65378:[[12300],256],65379:[[12301],256],65380:[[12289],256],65381:[[12539],256],65382:[[12530],256],65383:[[12449],256],65384:[[12451],256],65385:[[12453],256],65386:[[12455],256],65387:[[12457],256],65388:[[12515],256],65389:[[12517],256],65390:[[12519],256],65391:[[12483],256],65392:[[12540],256],65393:[[12450],256],65394:[[12452],256],65395:[[12454],256],65396:[[12456],256],65397:[[12458],256],65398:[[12459],256],65399:[[12461],256],65400:[[12463],256],65401:[[12465],256],65402:[[12467],256],65403:[[12469],256],65404:[[12471],256],65405:[[12473],256],65406:[[12475],256],65407:[[12477],256],65408:[[12479],256],65409:[[12481],256],65410:[[12484],256],65411:[[12486],256],65412:[[12488],256],65413:[[12490],256],65414:[[12491],256],65415:[[12492],256],65416:[[12493],256],65417:[[12494],256],65418:[[12495],256],65419:[[12498],256],65420:[[12501],256],65421:[[12504],256],65422:[[12507],256],65423:[[12510],256],65424:[[12511],256],65425:[[12512],256],65426:[[12513],256],65427:[[12514],256],65428:[[12516],256],65429:[[12518],256],65430:[[12520],256],65431:[[12521],256],65432:[[12522],256],65433:[[12523],256],65434:[[12524],256],65435:[[12525],256],65436:[[12527],256],65437:[[12531],256],65438:[[12441],256],65439:[[12442],256],65440:[[12644],256],65441:[[12593],256],65442:[[12594],256],65443:[[12595],256],65444:[[12596],256],65445:[[12597],256],65446:[[12598],256],65447:[[12599],256],65448:[[12600],256],65449:[[12601],256],65450:[[12602],256],65451:[[12603],256],65452:[[12604],256],65453:[[12605],256],65454:[[12606],256],65455:[[12607],256],65456:[[12608],256],65457:[[12609],256],65458:[[12610],256],65459:[[12611],256],65460:[[12612],256],65461:[[12613],256],65462:[[12614],256],65463:[[12615],256],65464:[[12616],256],65465:[[12617],256],65466:[[12618],256],65467:[[12619],256],65468:[[12620],256],65469:[[12621],256],65470:[[12622],256],65474:[[12623],256],65475:[[12624],256],65476:[[12625],256],65477:[[12626],256],65478:[[12627],256],65479:[[12628],256],65482:[[12629],256],65483:[[12630],256],65484:[[12631],256],65485:[[12632],256],65486:[[12633],256],65487:[[12634],256],65490:[[12635],256],65491:[[12636],256],65492:[[12637],256],65493:[[12638],256],65494:[[12639],256],65495:[[12640],256],65498:[[12641],256],65499:[[12642],256],65500:[[12643],256],65504:[[162],256],65505:[[163],256],65506:[[172],256],65507:[[175],256],65508:[[166],256],65509:[[165],256],65510:[[8361],256],65512:[[9474],256],65513:[[8592],256],65514:[[8593],256],65515:[[8594],256],65516:[[8595],256],65517:[[9632],256],65518:[[9675],256]}};var ge={nfc:me,nfd:ne,nfkc:Re,nfkd:ue};t.exports=ge,ge.shimApplied=!1,String.prototype.normalize||(Object.defineProperty(String.prototype,"normalize",{enumerable:!1,configurable:!0,writable:!0,value:function(){var v=""+this,b=arguments[0]===void 0?"NFC":arguments[0];if(this===null||this===void 0)throw new TypeError("Cannot call method on "+Object.prototype.toString.call(this));if(b==="NFC")return ge.nfc(v);if(b==="NFD")return ge.nfd(v);if(b==="NFKC")return ge.nfkc(v);if(b==="NFKD")return ge.nfkd(v);throw new RangeError("Invalid normalization form: "+b)}}),ge.shimApplied=!0)})()})(xj);var iNe=xj.exports;const oNe=IT(iNe);/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function aNe(t){const e=t.caseSensitive?t.accentSensitive?"variant":"case":t.accentSensitive?"accent":"base",r=t.caseFirst,n=t.ignorePunctuation;return new Intl.Collator(t.localeLang,{sensitivity:e,caseFirst:r,ignorePunctuation:n})}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const sNe="i",lNe=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;class uNe{constructor(e,r,n){this.config=e,this.dateTimeHelper=r,this.numberLiteralsHelper=n,this.lt=(i,o)=>this.compare(i,o)<0,this.leq=(i,o)=>this.compare(i,o)<=0,this.gt=(i,o)=>this.compare(i,o)>0,this.geq=(i,o)=>this.compare(i,o)>=0,this.eq=(i,o)=>this.compare(i,o)===0,this.neq=(i,o)=>this.compare(i,o)!==0,this.pow=(i,o)=>Math.pow(ye(i),ye(o)),this.addWithEpsilonRaw=(i,o)=>{const a=i+o;return Math.abs(a)<this.actualEps*Math.abs(i)?0:a},this.addWithEpsilon=(i,o)=>{const a=XM(i,o);return this.ExtendedNumberFactory(this.addWithEpsilonRaw(ye(i),ye(o)),a)},this.unaryMinus=i=>dI(i,-ye(i)),this.unaryPlus=i=>i,this.unaryPercent=i=>new a0(ye(i)/100),this.concat=(i,o)=>i.concat(o),this.nonstrictadd=(i,o)=>i instanceof C?i:o instanceof C?o:typeof i=="number"?typeof o=="number"?this.addWithEpsilonRaw(i,o):i:typeof o=="number"?o:0,this.subtract=(i,o)=>{const a=XM(i,o),s=ye(i),l=ye(o);let u=s-l;return Math.abs(u)<this.actualEps*Math.abs(s)&&(u=0),this.ExtendedNumberFactory(u,a)},this.divide=(i,o)=>{const a=ye(i),s=ye(o);if(s===0)return new C(N.DIV_BY_ZERO);{const l=qM(i,o);return this.ExtendedNumberFactory(a/s,l)}},this.multiply=(i,o)=>{const a=qM(i,o);return this.ExtendedNumberFactory(ye(i)*ye(o),a)},this.manyToExactComplex=i=>{const o=[];for(const a of i){if(a instanceof C)return a;if(Rt(a)||typeof a=="string"){const s=this.coerceScalarToComplex(a);s instanceof C||o.push(s)}}return o},this.coerceNumbersExactRanges=i=>this.manyToNumbers(i,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=i=>this.manyToNumbers(i,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=i=>{const o=[];for(const a of i){if(a instanceof C)return a;Rt(a)&&o.push(ye(a))}return o},this.manyToOnlyNumbersDropNulls=i=>{const o=[];for(const a of i){if(a instanceof C)return a;if(Rt(a))o.push(ye(a));else if(a!==ft)return new C(N.VALUE,x.NumberExpected)}return o},this.manyToCoercedNumbersDropNulls=i=>{const o=[];for(const a of i){if(a instanceof C)return a;if(a===ft)continue;const s=this.coerceScalarToNumberOrError(a);Rt(s)&&o.push(ye(s))}return o},this.collator=aNe(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const r=this.buildRegex(e);return n=>typeof n=="string"&&r.test(this.normalizeString(n))}neqMatcherFunction(e){const r=this.buildRegex(e);return n=>typeof n!="string"||!r.test(this.normalizeString(n))}searchString(e,r){var n;const o=this.buildRegex(e,!1).exec(r);return(n=o==null?void 0:o.index)!==null&&n!==void 0?n:-1}requiresRegex(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let r=0;r<e.length;r++){const n=e.charAt(r);if(Sv(n)||this.config.useRegularExpressions&&Rv(n))return!0}return!1}floatCmp(e,r){const n=ye(e),i=ye(r),o=1+this.actualEps;return i>=0&&n*o>=i&&n<=i*o||i<=0&&n*o<=i&&n>=i*o?0:n>i?1:-1}coerceScalarToNumberOrError(e){var r;return e instanceof C?e:(r=this.coerceToMaybeNumber(e))!==null&&r!==void 0?r:new C(N.VALUE,x.NumberCoercion)}coerceToMaybeNumber(e){var r;return(r=this.coerceNonDateScalarToMaybeNumber(e))!==null&&r!==void 0?r:typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){if(e===ft)return 0;if(typeof e=="string"){if(e==="")return 0;const r=this.coerceStringToMaybePercentNumber(e);if(r!==void 0)return r;const n=this.coerceStringToMaybeCurrencyNumber(e);return n!==void 0?n:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim())}else return Rt(e)?e:typeof e=="boolean"?Number(e):void 0}coerceStringToMaybePercentNumber(e){const r=e.trim();if(r.endsWith("%")){const n=r.slice(0,r.length-1).trim(),i=this.numberLiteralsHelper.numericStringToMaybeNumber(n);if(i!==void 0)return new a0(i/100)}}coerceStringToMaybeCurrencyNumber(e){const r=this.currencyMatcher(e.trim());if(r!==void 0){const[n,i]=r,o=this.numberLiteralsHelper.numericStringToMaybeNumber(i);if(o!==void 0)return new g5(o,n)}}currencyMatcher(e){for(const r of this.config.currencySymbol){if(e.startsWith(r))return[r,e.slice(r.length).trim()];if(e.endsWith(r))return[r,e.slice(0,e.length-r.length).trim()]}}coerceComplexExactRanges(e){const r=[];for(const i of e)if(i instanceof Pe)r.push(i);else if(i!==ft){const o=this.coerceScalarToComplex(i);if(o instanceof C)return o;r.push(o)}const n=[];for(const i of r)if(i instanceof Pe){const o=this.manyToExactComplex(i.valuesFromTopLeftCorner());if(o instanceof C)return o;n.push(...o)}else n.push(i);return n}coerceScalarToComplex(e){return e instanceof C?e:e===ft?[0,0]:Rt(e)?[ye(e),0]:typeof e=="string"?this.coerceStringToComplex(e):new C(N.NUM,x.ComplexNumberExpected)}ExtendedNumberFactory(e,r){const{type:n,format:i}=r;switch(n){case Ie.NUMBER_RAW:return e;case Ie.NUMBER_CURRENCY:return new g5(e,i??this.config.currencySymbol[0]);case Ie.NUMBER_DATE:return new pI(e,i);case Ie.NUMBER_DATETIME:return new vI(e,i);case Ie.NUMBER_TIME:return new mI(e,i);case Ie.NUMBER_PERCENT:return new a0(e,i)}}buildRegex(e,r=!0){e=this.normalizeString(e);let n,i=this.config.useWildcards,o=this.config.useRegularExpressions;if(o)try{RegExp(e)}catch{o=!1,i=!1}return o?n=dNe(e,this.config.caseSensitive):i?n=fNe(e,this.config.caseSensitive):n=hNe(e,this.config.caseSensitive),this.config.matchWholeCell&&r?RegExp("^("+n+")$"):RegExp(n)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=Hj(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}compare(e,r){if(typeof e=="string"||typeof r=="string"){const n=typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):e,i=typeof r=="string"?this.dateTimeHelper.dateStringToDateNumber(r):r;if(Rt(n)&&Rt(i))return this.floatCmp(n,i)}return e===ft?e=YM(r):r===ft&&(r=YM(e)),typeof e=="string"&&typeof r=="string"?this.stringCmp(e,r):typeof e=="boolean"&&typeof r=="boolean"?KM(R5(e),R5(r)):Rt(e)&&Rt(r)?this.floatCmp(e,r):e===ft&&r===ft?0:KM(zM(qb(e)),zM(qb(r)))}stringCmp(e,r){return this.collator.compare(e,r)}manyToNumbers(e,r){const n=[];for(const o of e)if(o instanceof Pe)n.push(o);else{const a=ye(this.coerceScalarToNumberOrError(o));if(a instanceof C)return a;n.push(a)}const i=[];for(const o of n)if(o instanceof Pe){const a=r(o.valuesFromTopLeftCorner());if(a instanceof C)return a;i.push(...a)}else i.push(o);return i}coerceStringToComplex(e){const r=lNe.exec(e);if(r===null)return new C(N.NUM,x.ComplexNumberExpected);let n;if(r[6]!==void 0?n=r[1]==="-"?[0,-1]:[0,1]:n=this.parseComplexToken(r[1]+r[3],r[5]),n instanceof C||r[8]===void 0)return n;let i;return r[14]!==void 0?i=r[9]==="-"?[0,-1]:[0,1]:i=this.parseComplexToken(r[9]+r[11],r[13]),i instanceof C?i:r[5]!==""||r[13]===""?new C(N.NUM,x.ComplexNumberExpected):r[8]==="+"?[n[0]+i[0],n[1]+i[1]]:[n[0]-i[0],n[1]-i[1]]}parseComplexToken(e,r){const n=ye(this.coerceNonDateScalarToMaybeNumber(e));return n===void 0?new C(N.NUM,x.ComplexNumberExpected):r===""?[n,0]:[0,n]}}function mr([t,e],r){if(!isFinite(t)||!isFinite(e))return new C(N.NUM,x.NaN);if(r=r??sNe,e===0)return`${t}`;const n=`${e===-1||e===1?"":Math.abs(e)}${r}`;return t===0?`${e<0?"-":""}${n}`:`${t}${e<0?"-":"+"}${n}`}function $j(t){return t instanceof Pe?t:Pe.fromScalar(t)}function R5(t){return Number(t)}function YM(t){return typeof t=="string"?"":Rt(t)?0:typeof t=="boolean"?!1:ft}function Lj(t){if(t instanceof C||typeof t=="boolean")return t;if(t===ft)return!1;if(Rt(t))return ye(t)!==0;{const e=t.toUpperCase();return e==="TRUE"?!0:e==="FALSE"||e===""?!1:void 0}}function E5(t){return t instanceof C||typeof t=="string"?t:t===ft?"":Rt(t)?ye(t).toString():t?"TRUE":"FALSE"}function L6(t){return t===ft?0:t}function KM(t,e){const r=ye(t),n=ye(e);return r>n?1:r<n?-1:0}function Dj(t){return isNaN(t)||t===1/0||t===-1/0}function Fj(t){return t===0?0:t}function Sv(t){return["*","?"].includes(t)}const cNe=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function Rv(t){return cNe.includes(t)}function fNe(t,e){let r="";for(let n=0;n<t.length;n++){const i=t.charAt(n);if(i==="~"){if(n==t.length-1){r+="~";continue}const o=t.charAt(n+1);Sv(o)||Rv(o)?(r+="\\"+o,n++):(r+=o,n++)}else Sv(i)?r+="."+i:Rv(i)?r+="\\"+i:e?r+=i:r+=i.toLowerCase()}return r}function hNe(t,e){let r="";for(let n=0;n<t.length;n++){const i=t.charAt(n);Sv(i)||Rv(i)?r+="\\"+i:e?r+=i:r+=i.toLowerCase()}return r}function dNe(t,e){let r="";for(let n=0;n<t.length;n++){const i=t.charAt(n);Sv(i)||Rv(i)||e?r+=i:r+=i.toLowerCase()}return r}function XM(t,e){const{type:r,format:n}=Yb(t),{type:i,format:o}=Yb(e);if(r===Ie.NUMBER_RAW)return{type:i,format:o};if(i===Ie.NUMBER_RAW)return{type:r,format:n};if((r===Ie.NUMBER_DATETIME||r===Ie.NUMBER_DATE)&&(i===Ie.NUMBER_DATETIME||i===Ie.NUMBER_DATE))return{type:Ie.NUMBER_RAW};if(r===Ie.NUMBER_TIME){if(i===Ie.NUMBER_DATE)return{type:Ie.NUMBER_DATETIME,format:`${o} ${n}`};if(i===Ie.NUMBER_DATETIME)return{type:Ie.NUMBER_DATETIME,format:o}}if(i===Ie.NUMBER_TIME){if(r===Ie.NUMBER_DATE)return{type:Ie.NUMBER_DATETIME,format:`${n} ${o}`};if(r===Ie.NUMBER_DATETIME)return{type:Ie.NUMBER_DATETIME,format:n}}return{type:r,format:n}}function qM(t,e){let{type:r,format:n}=Yb(t),{type:i,format:o}=Yb(e);return r===Ie.NUMBER_PERCENT&&(r=Ie.NUMBER_RAW,n=void 0),i===Ie.NUMBER_PERCENT&&(i=Ie.NUMBER_RAW,o=void 0),r===Ie.NUMBER_RAW?{type:i,format:o}:i===Ie.NUMBER_RAW?{type:r,format:n}:{type:Ie.NUMBER_RAW}}function Hp(t){return Hj(t.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function u0(t,e){var r;if(t.isAdHoc())return(r=t.data[0])===null||r===void 0?void 0:r[0];const n=t.range;if(e.formulaAddress.sheet===n.sheet){if(n.width()===1){const i=e.formulaAddress.row-n.start.row;if(i>=0&&i<n.height())return t.data[i][0]}else if(n.height()===1){const i=e.formulaAddress.col-n.start.col;if(i>=0&&i<n.width())return t.data[0][i]}}}function Hj(t,e){return typeof t.normalize=="function"?t.normalize(e.toUpperCase()):oNe[e](t)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var g;(function(t){t.STRING="STRING",t.NUMBER="NUMBER",t.BOOLEAN="BOOLEAN",t.SCALAR="SCALAR",t.NOERROR="NOERROR",t.RANGE="RANGE",t.INTEGER="INTEGER",t.COMPLEX="COMPLEX",t.ANY="ANY"})(g||(g={}));class Qe{constructor(e){this.coerceScalarToNumberOrError=r=>this.arithmeticHelper.coerceScalarToNumberOrError(r),this.runFunction=(r,n,i,o)=>{const a=this.evaluateArguments(r,n,i),s=a.map(([p,m])=>p),l=a.map(([p,m])=>m),u=this.buildMetadataForEachArgumentValue(s.length,i),c=n.arraysFlag&&!i.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(u,s.length))return new C(N.NA,x.WrongArgNumber);const[f,h]=c?this.calculateSizeOfVectorizedResultArray(s,u):[1,1];if(f===1&&h===1){const p=this.vectorizeAndBroadcastArgumentsIfNecessary(c,s,u,0,0);return this.calculateSingleCellOfResultArray(n,p,u,l,o,i.returnNumberType)}const d=[...Array(f).keys()].map(p=>[...Array(h).keys()].map(m=>{const y=this.vectorizeAndBroadcastArgumentsIfNecessary(c,s,u,p,m),S=this.calculateSingleCellOfResultArray(n,y,u,l,o,i.returnNumberType);if(S instanceof Pe)throw new Error("Function returning array cannot be vectorized.");return S}));return Pe.onlyValues(d)},this.runFunctionWithReferenceArgument=(r,n,i,o,a,s=()=>new C(N.NA,x.CellRefExpected))=>{if(r.length===0)return this.returnNumberWrapper(o(),i.returnNumberType);if(r.length>1)return new C(N.NA,x.WrongArgNumber);let l=r[0];for(;l.type===P.PARENTHESIS;)l=l.expression;let u;if(l.type===P.CELL_REFERENCE)u=l.reference.toSimpleCellAddress(n.formulaAddress);else if(l.type===P.CELL_RANGE||l.type===P.COLUMN_RANGE||l.type===P.ROW_RANGE)try{u=$e.fromAst(l,n.formulaAddress).start}catch{return new C(N.REF,x.CellRefExpected)}return u!==void 0?this.returnNumberWrapper(a(u),i.returnNumberType):this.runFunction(r,n,i,s)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,r){return this.interpreter.evaluateAst(e,r)}arraySizeForAst(e,r){return this.arraySizePredictor.checkArraySizeForAst(e,r)}listOfScalarValues(e,r){const n=[];for(const i of e){const o=this.evaluateAst(i,r);if(o instanceof Pe)for(const a of o.valuesFromTopLeftCorner())n.push([a,!0]);else n.push([o,!1])}return n}coerceToType(e,r,n){let i;if(e instanceof Pe)switch(r.argumentType){case g.RANGE:case g.ANY:i=e;break;default:{const o=u0(e,n);if(o===void 0)return;e=o}}if(!(e instanceof Pe))switch(r.argumentType){case g.INTEGER:case g.NUMBER:const o=this.coerceScalarToNumberOrError(e);if(!Rt(o)){i=o;break}const a=ye(o);if(r.maxValue!==void 0&&a>r.maxValue)return new C(N.NUM,x.ValueLarge);if(r.minValue!==void 0&&a<r.minValue)return new C(N.NUM,x.ValueSmall);if(r.lessThan!==void 0&&a>=r.lessThan)return new C(N.NUM,x.ValueLarge);if(r.greaterThan!==void 0&&a<=r.greaterThan)return new C(N.NUM,x.ValueSmall);if(r.argumentType===g.INTEGER&&!Number.isInteger(a))return new C(N.NUM,x.IntegerExpected);i=o;break;case g.STRING:i=E5(e);break;case g.BOOLEAN:i=Lj(e);break;case g.SCALAR:case g.NOERROR:case g.ANY:i=e;break;case g.RANGE:if(e instanceof C)return e;i=$j(e);break;case g.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(ye(e))}return r.passSubtype||i===void 0?i:ye(i)}calculateSingleCellOfResultArray(e,r,n,i,o,a){const s=this.coerceArgumentsToRequiredTypes(e,r,n,i);if(s instanceof C)return s;const l=o(...s);return this.returnNumberWrapper(l,a)}coerceArgumentsToRequiredTypes(e,r,n,i){const o=[];for(let a=0;a<n.length;a++){const s=n[a],l=r[a]!==void 0?r[a]:s==null?void 0:s.defaultValue;if(l===void 0){o.push(void 0);continue}const u=this.coerceToType(l,s,e);if(u===void 0&&!i[a])return new C(N.VALUE,x.WrongType);if(u instanceof C&&s.argumentType!==g.SCALAR)return u;o.push(u)}return o}vectorizeAndBroadcastArgumentsIfNecessary(e,r,n,i,o){return r.map((a,s)=>e&&this.isRangePassedAsAScalarArgument(a,n[s])?this.vectorizeAndBroadcastRangeArgument(a,i,o):a)}vectorizeAndBroadcastRangeArgument(e,r,n){var i;const o=e.height()===1?0:r,a=e.width()===1?0:n;return(i=e.data[o])===null||i===void 0?void 0:i[a]}evaluateArguments(e,r,n){return n.expandRanges?this.listOfScalarValues(e,r):e.map(i=>[this.evaluateAst(i,r),!1])}buildMetadataForEachArgumentValue(e,r){const n=r.parameters?[...r.parameters]:[];if(r.repeatLastArgs!==void 0&&Number.isInteger(r.repeatLastArgs)&&r.repeatLastArgs>0)for(;e>n.length;)n.push(...n.slice(n.length-r.repeatLastArgs));return n}isNumberOfArgumentValuesValid(e,r){return r>e.length?!1:r<e.length?e.slice(r).every(o=>(o==null?void 0:o.optionalArg)||(o==null?void 0:o.defaultValue)!==void 0):!0}calculateSizeOfVectorizedResultArray(e,r){const n=e.filter((a,s)=>this.isRangePassedAsAScalarArgument(a,r[s])),i=Math.max(1,...n.map(a=>a.height())),o=Math.max(1,...n.map(a=>a.width()));return[i,o]}isRangePassedAsAScalarArgument(e,r){return e==null||r==null?!1:e instanceof Pe&&![g.RANGE,g.ANY].includes(r.argumentType)}metadata(e){const r=this.constructor.implementedFunctions[e];if(r!==void 0)return r;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,r,n){return r!==void 0&&Rt(e)?this.arithmeticHelper.ExtendedNumberFactory(ye(e),{type:r,format:n}):e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class it{constructor(e,r,n=!1){if(this.width=e,this.height=r,this.isRef=n,e<=0||r<=0)throw Error("Incorrect array size")}static fromArray(e){return new it(e.length>0?e[0].length:0,e.length)}static error(){return new it(1,1,!0)}static scalar(){return new it(1,1,!1)}isScalar(){return this.width<=1&&this.height<=1||this.isRef}}function pNe(t,e){return new it(Math.max(t.width,e.width),Math.max(t.height,e.height))}function mNe(t){return new it(t.width,t.height)}class vNe{constructor(e,r){this.config=e,this.functionRegistry=r}checkArraySize(e,r){return this.checkArraySizeForAst(e,{formulaAddress:r,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,r){switch(e.type){case P.FUNCTION_CALL:return this.checkArraySizeForFunction(e,r);case P.COLUMN_RANGE:case P.ROW_RANGE:case P.CELL_RANGE:{const n=$e.fromAstOrUndef(e,r.formulaAddress);return n===void 0?it.error():new it(n.width(),n.height(),!0)}case P.ARRAY:{const n=[],i=[];for(const s of e.args){const l=s.map(f=>this.checkArraySizeForAst(f,r)),u=Math.min(...l.map(f=>f.height)),c=l.reduce((f,h)=>f+h.width,0);n.push(u),i.push(c)}const o=n.reduce((s,l)=>s+l,0),a=Math.min(...i);return new it(a,o)}case P.STRING:case P.NUMBER:return it.scalar();case P.CELL_REFERENCE:return new it(1,1,!0);case P.DIV_OP:case P.CONCATENATE_OP:case P.EQUALS_OP:case P.GREATER_THAN_OP:case P.GREATER_THAN_OR_EQUAL_OP:case P.LESS_THAN_OP:case P.LESS_THAN_OR_EQUAL_OP:case P.MINUS_OP:case P.NOT_EQUAL_OP:case P.PLUS_OP:case P.POWER_OP:case P.TIMES_OP:{const n=this.checkArraySizeForAst(e.left,r),i=this.checkArraySizeForAst(e.right,r);return!r.arraysFlag&&(n.height>1||n.width>1||i.height>1||i.width>1)?it.error():pNe(n,i)}case P.MINUS_UNARY_OP:case P.PLUS_UNARY_OP:case P.PERCENT_OP:{const n=this.checkArraySizeForAst(e.value,r);return!r.arraysFlag&&(n.height>1||n.width>1)?it.error():mNe(n)}case P.PARENTHESIS:return this.checkArraySizeForAst(e.expression,r);case P.EMPTY:return it.error();default:return it.error()}}checkArraySizeForFunction(e,r){const n=this.functionRegistry.getMetadata(e.procedureName),i=this.functionRegistry.getArraySizeFunction(e.procedureName);if(i!==void 0)return i(e,r);const o=e.args.map(u=>{var c;return this.checkArraySizeForAst(u,new Po(r.formulaAddress,r.arraysFlag||((c=n==null?void 0:n.arrayFunction)!==null&&c!==void 0?c:!1)))});if(n===void 0||n.expandRanges||!r.arraysFlag||n.vectorizationForbidden||n.parameters===void 0)return new it(1,1);const a=[...n.parameters];if(n.repeatLastArgs===void 0&&a.length<o.length||n.repeatLastArgs!==void 0&&a.length<o.length&&(o.length-a.length)%n.repeatLastArgs!==0)return it.error();for(;a.length<o.length;)a.push(...a.slice(a.length-n.repeatLastArgs));let s=1,l=1;for(let u=0;u<o.length;u++)a[u].argumentType!==g.RANGE&&a[u].argumentType!==g.ANY&&(l=Math.max(l,o[u].height),s=Math.max(s,o[u].width));return new it(s,l)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Uj{constructor(e,r,n){var i;this.value=r,this.address=n,this.type=e.type,this.message=(i=e.message)!==null&&i!==void 0?i:""}toString(){return this.value}valueOf(){return this.value}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function Mt(t,e,r){if(typeof t>"u")return on.defaultConfig[r];if(typeof e=="string"){if(typeof t===e)return t;throw new St(e,r)}else{if(e.includes(t))return t;throw new Aj(e.map(n=>`'${n}'`).join(" "),r)}}function ic(t,e,r){if(t<r)throw new Tj(e,r)}function gNe(t,e,r){if(t>r)throw new _j(e,r)}function Gy(t,e,r,n){if(e(t))return t;if(typeof t>"u")return on.defaultConfig[n];throw new St(r,n)}function QM(...t){const e=new Map;t.forEach(n=>{const i=e.get(n.value)||[];i.push(n.name),e.set(n.value,i)});const r=[];for(const n of e.values())n.length>1&&r.push(n);if(r.length>0){r.forEach(i=>i.sort());const n=r.map(i=>`[${i}]`).join("; ");throw new Error(`Config initialization failed. Parameters in conflict: ${n}`)}}function he(t,e,r){if(typeof t!==e)throw new St(e,r)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function yNe(t,e,r){t=t.replace(/\s\s+/g," ").trim().toLowerCase();let n=t.substring(t.length-2);n==="am"||n==="pm"?t=t.substring(0,t.length-2).trim():(n=t.substring(t.length-1),n==="a"||n==="p"?t=t.substring(0,t.length-1).trim():n=void 0);const i=t.split(/[ /.-]/g);i.length>=2&&i[i.length-2].includes(":")&&(i[i.length-2]=i[i.length-2]+"."+i[i.length-1],i.pop());const o=i[i.length-1].split(":");if(n!==void 0&&o.push(n),i.length===1)return ZM(o,r);if(o.length===1)return JM(i,e);const a=JM(i.slice(0,i.length-1),e),s=ZM(o,r);if(a!==void 0)return s===void 0?void 0:Object.assign(Object.assign({},a),s)}const bI=/^ss(\.(s+|0+))?$/;function ZM(t,e){if(e===void 0)return;e=e.toLowerCase(),e.endsWith("am/pm")?e=e.substring(0,e.length-5).trim():e.endsWith("a/p")&&(e=e.substring(0,e.length-3).trim());const n=e.split(":");let i;if(t[t.length-1]==="am"||t[t.length-1]==="a"?(i=!1,t.pop()):(t[t.length-1]==="pm"||t[t.length-1]==="p")&&(i=!0,t.pop()),t.length!==n.length)return;const o=n.indexOf("hh"),a=n.indexOf("mm"),s=n.findIndex(p=>bI.test(p)),l=o!==-1?t[o]:"0";if(!/^\d+$/.test(l))return;let u=Number(l);if(i!==void 0){if(u<0||u>12)return;u=u%12,i&&(u=u+12)}const c=a!==-1?t[a]:"0";if(!/^\d+$/.test(c))return;const f=Number(c),h=s!==-1?t[s]:"0";if(!/^\d+(\.\d+)?$/.test(h))return;const d=Math.round(Number(h)*1e3)/1e3;return{hours:u,minutes:f,seconds:d}}function JM(t,e){if(e===void 0)return;const r=e.toLowerCase().split(/[ /.-]/g);if(t.length!==r.length)return;const n=r.indexOf("mm"),i=r.indexOf("dd"),o=r.indexOf("yyyy"),a=r.indexOf("yy");if(!(n in t)||!(i in t)||!(o in t)&&!(a in t)||o in t&&a in t)return;let s;if(o in t){const h=t[o];if(/^\d+$/.test(h)){if(s=Number(h),s<1e3||s>9999)return}else return}else{const h=t[a];if(/^\d+$/.test(h)){if(s=Number(h),s<0||s>99)return}else return}const l=t[n];if(!/^\d+$/.test(l))return;const u=Number(l),c=t[i];if(!/^\d+$/.test(c))return;const f=Number(c);return{year:s,month:u,day:f}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const C5=[31,28,31,30,31,30,31,31,30,31,30,31],Uc=[0,31,59,90,120,151,181,212,243,273,304,334],zy=60,Yy=60,O5=24;function Up(t){return t&&(typeof t=="object"||typeof t=="function")?"year"in t&&typeof t.year=="number"&&"month"in t&&typeof t.month=="number"&&"day"in t&&typeof t.day=="number":!1}function Bj(t){return t&&(typeof t=="object"||typeof t=="function")?"hours"in t&&typeof t.hours=="number"&&"minutes"in t&&typeof t.minutes=="number"&&"seconds"in t&&typeof t.seconds=="number":!1}const bNe={year:9999,month:12,day:31};class wNe{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(bNe),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&e>=0?e:void 0}dateStringToDateNumber(e){const{dateTime:r,dateFormat:n="",timeFormat:i=""}=this.parseDateTimeFromConfigFormats(e);if(r!==void 0)return Bj(r)?Up(r)?new vI(qc(r)+this.dateToNumber(r),n+" "+i):new mI(qc(r),i):Up(r)?new pI(this.dateToNumber(r),n):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1?!1:this.isLeapYear(e.year)&&e.month===2?e.day<=29:e.day<=C5[e.month-1]}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){const r=Math.floor(e)+this.minDateAbsoluteValue;let n=Math.floor(r/365.2425);this.dateToNumberFromZero({year:n+1,month:1,day:1})<=r?n++:this.dateToNumberFromZero({year:n-1,month:1,day:1})>r&&n--;const i=r-this.dateToNumberFromZero({year:n,month:1,day:1}),o=SNe(i-(this.isLeapYear(n)&&i>=59?1:0)),a=i-Uc[o]-(this.isLeapYear(n)&&o>1?1:0);return{year:n,month:o+1,day:a+1}}numberToSimpleDateTime(e){const r=Xc(e%1),n=Math.floor(r.hours/O5);r.hours=r.hours%O5;const i=this.numberToSimpleDate(Math.floor(e)+n);return Object.assign(Object.assign({},i),r)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}daysInMonth(e,r){return this.isLeapYear(e)&&r===2?29:C5[r-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,r){return e.day===31&&(e.day=30),e.day===30&&r.day===31&&(r.day=30),e.month===2&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,r.month===2&&r.day===this.daysInMonth(r.year,r.month)&&(r.day=30)),[e,r]}yearLengthForBasis(e,r){return e.year!==r.year?e.year+1!==r.year||e.month<r.month||e.month===r.month&&e.day<r.day?(this.leapYearsCount(r.year)-this.leapYearsCount(e.year-1))/(r.year-e.year+1)+365:this.countLeapDays(r)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,r,n){const i=this.parseDateTime(e,r,n);if(!(Up(i)&&(i.year>=0&&i.year<100&&(i.year<this.getNullYear()?i.year+=2e3:i.year+=1900),!this.isValidDate(i))))return i}parseDateTimeFromFormats(e,r,n){const i=r.length===0?[void 0]:r,o=n.length===0?[void 0]:n;for(const a of i)for(const s of o){const l=this.parseSingleFormat(e,a,s);if(l!==void 0)return{dateTime:l,timeFormat:s,dateFormat:a}}return{}}countLeapDays(e){return e.month>2||e.month===2&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+Uc[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return e%4?!1:e%100?!0:e%400?e===1900&&this.config.leapYear1900:!0}}function SNe(t){let e=0;return Uc[e+6]<=t&&(e+=6),Uc[e+3]<=t&&(e+=3),Uc[e+2]<=t?e+=2:Uc[e+1]<=t&&(e+=1),e}function e9(t,e){const r=12*t.year+t.month-1+e;return{year:Math.floor(r/12),month:r%12+1,day:t.day}}function RNe(t){return{year:t.year,month:t.month,day:Math.min(t.day,C5[t.month-1])}}function D6(t){return Math.round(t*3600*24)/(3600*24)}function ENe(t,e=1){return Math.round(t*e)/e}function Xc(t){const e=t*O5*Yy*zy,r=ENe(e%zy,1e5)%zy,n=(e-r)/zy,i=Math.round(n%Yy)%Yy,o=(n-i)/Yy;return{hours:Math.round(o),minutes:i,seconds:r}}function qc(t){return((t.seconds/60+t.minutes)/60+t.hours)/24}function t9(t){return{year:t.year,month:t.month,day:Math.min(30,t.day)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class CNe{call(){return X4e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const r9=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,n9=/(\\.|[#0]+(\.[#0]*)?)/g;var No;(function(t){t.FORMAT="FORMAT",t.FREE_TEXT="FREE_TEXT"})(No||(No={}));function Ky(t,e){return{type:t,value:e}}var Qb;(function(t){t.DATE="DATE",t.NUMBER="NUMBER",t.STRING="STRING"})(Qb||(Qb={}));function ONe(t){r9.lastIndex=0;const e=[];let r;do r=r9.exec(t),r!==null&&e.push(r);while(r);return e}function TNe(t){n9.lastIndex=0;const e=n9.exec(t);return e!==null?[e]:[]}function Vj(t,e){const r=[];let n=0;for(let o=0;o<t.length;++o){const a=t[o];if(a.index!==n){const s=e.substr(n,a.index-n);r.push(Ky(No.FREE_TEXT,s))}a[0].startsWith("\\")?r.push(Ky(No.FREE_TEXT,a[0])):r.push(Ky(No.FORMAT,a[0])),n=a.index+a[0].length}const i=t[t.length-1];if(i.index+i[0].length<e.length){const o=e.substr(i.index+i[0].length,e.length);r.push(Ky(No.FREE_TEXT,o))}return r}function jj(t){const e=ONe(t);if(!e.every(r=>Wj(r)))return{type:Qb.DATE,tokens:Vj(e,t)}}function _Ne(t){const e=TNe(t);if(!e.every(r=>Wj(r)))return{type:Qb.NUMBER,tokens:Vj(e,t)}}function Wj(t){return t[0].startsWith("\\")}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function ANe(t,e,r,n){const i=r.stringifyDateTime(n.numberToSimpleDateTime(t),e);if(i!==void 0)return i;const o=r.stringifyDuration(Xc(t),e);if(o!==void 0)return o;const a=_Ne(e);return a!==void 0?NNe(a.tokens,t):e}function Fn(t,e){let r=`${t}`;for(;r.length<e;)r="0"+r;return r}function INe(t,e){let r=`${t}`;for(;r.length<e;)r=r+"0";return r}function i9(t,e){return t.split(e).length-1}function NNe(t,e){let r="";for(let n=0;n<t.length;++n){const i=t[n];if(i.type===No.FREE_TEXT){r+=i.value;continue}const o=i.value.split("."),a=o[0],s=o[1]||"",l=o[1]?".":"",u=Number(e.toFixed(s.length)).toString().split(".");let c=u[0]||"",f=u[1]||"";if(a.length>c.length){const d=i9(a.substr(0,a.length-c.length),"0");c=Fn(c,d+c.length)}const h=i9(s.substr(f.length,s.length-f.length),"0");f=INe(f,h+f.length),r+=c+l+f}return r}function PNe(t,e){const r=jj(e);if(r===void 0)return;const n=r.tokens;let i="";for(const o of n){if(o.type===No.FREE_TEXT){i+=o.value;continue}switch(o.value.toLowerCase()){case"h":case"hh":{i+=Fn(t.hours,o.value.length),t.hours=0;break}case"[hh]":{i+=Fn(t.hours,o.value.length-2),t.hours=0;break}case"m":case"mm":{i+=Fn(t.minutes,o.value.length),t.minutes=0;break}case"[mm]":{i+=Fn(t.minutes+60*t.hours,o.value.length-2),t.minutes=0,t.hours=0;break}case"s":case"ss":{i+=Fn(Math.floor(t.seconds),o.value.length);break}default:{if(bI.test(o.value)){const a=Math.max(o.value.length-3,0);i+=`${t.seconds<10?"0":""}${Math.floor(t.seconds*Math.pow(10,a))/Math.pow(10,a)}`;continue}return}}}return i}function MNe(t,e){const r=jj(e);if(r===void 0)return;const n=r.tokens;let i="",o=!1;const a=n.some(s=>s.type===No.FORMAT&&(s.value==="a/p"||s.value==="A/P"||s.value==="am/pm"||s.value==="AM/PM"));for(let s=0;s<n.length;s++){const l=n[s];if(l.type===No.FREE_TEXT){i+=l.value;continue}switch(l.value.toLowerCase()){case"h":case"hh":{o=!0,i+=Fn(a?(t.hours+11)%12+1:t.hours,l.value.length);break}case"d":case"dd":{i+=Fn(t.day,l.value.length);break}case"s":case"ss":{i+=Fn(Math.floor(t.seconds),l.value.length);break}case"m":case"mm":{s+1<n.length&&n[s+1].value.startsWith(":")&&(o=!0),o?i+=Fn(t.minutes,l.value.length):i+=Fn(t.month,l.value.length),o=!0;break}case"yy":{i+=Fn(t.year%100,l.value.length);break}case"yyyy":{i+=t.year;break}case"am/pm":case"a/p":{const[u,c]=l.value.split("/");i+=t.hours<12?u:c;break}default:{if(bI.test(l.value)){const u=l.value.length-3;i+=`${t.seconds<10?"0":""}${Math.floor(t.seconds*Math.pow(10,u))/Math.pow(10,u)}`;continue}return}}}return i}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const T5="length",Bp=t=>parseInt(t,16),o9=t=>parseInt(t,10),F6=t=>(t+"").replace(/\-/g,""),Zb=(t,e,r)=>t.substr(e,r),Ui=t=>t.codePointAt(0)-65;function kNe(t){return F6(t)[T5]===25?Bp(Zb(F6(t),Bp("12"),Ui("F")))/(Bp(Zb(F6(t),Ui("C"),Ui("Y")>>4))||(~~![][T5]<<3)+1):0}function xNe(t){if(t=(t+"").replace(/\-/g,""),t[T5]!==Ui("Z"))return!1;let e=0;return[[0,Ui("G")+1],[Ui("H"),Ui("H")-1],[Ui("G")+Ui("H"),Ui("G")]].reduce((r,[n,i],o)=>(r|=(o9(`${o9(Bp(Zb(t,e+n-(o===0?0:2),i+(o?2:0)))+(Bp(Zb(t,e+n+i,2))+[]).padStart(2,"0"))}`)%97||2)>>1,e+=2,r),Ui("A"))==="1">>1}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const $Ne={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:t})=>`The license key for HyperFormula expired on ${t}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let a9=!1;function LNe(t){const e={template:"missing",vars:{}};if(t==="gpl-v3"||t==="internal-use-in-handsontable")e.template="valid";else if(typeof t=="string"&&xNe(t)){const[r,n,i]="29/05/2023".split("/"),o=Math.floor(new Date(`${n}/${r}/${i}`).getTime()/864e5),a=kNe(t);e.vars.keyValidityDate=DNe(new Date((a+1)*864e5)),o>a?e.template="expired":e.template="valid"}else t!==""&&(e.template="invalid");return!a9&&e.template!=="valid"&&(console.warn($Ne[e.template](e.vars)),a9=!0),e.template}function DNe(t){const r=["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()],n=t.getDate(),i=t.getFullYear();return`${r} ${n}, ${i}`}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var tr;(function(t){class e{constructor(l){this.value=l,this.value=dI(this.value,Fj(ye(this.value)))}}t.Number=e;class r{constructor(l){this.value=l}}t.String=r;class n{constructor(l){this.value=l}}t.Boolean=n;class i{static getSingletonInstance(){return i.instance||(i.instance=new i),i.instance}}t.Empty=i;class o{constructor(l){this.formula=l}}t.Formula=o;class a{constructor(l,u){this.value=new C(l,u)}}t.Error=a})(tr||(tr={}));function FNe(t){return t.startsWith("=")}function HNe(t){const e=t.toLowerCase();return e==="true"||e==="false"}function UNe(t,e){const r=t.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(r)&&Object.prototype.hasOwnProperty.call(e,r)}class BNe{constructor(e,r,n){this.config=e,this.dateHelper=r,this.numberLiteralsHelper=n}parse(e){if(e==null)return tr.Empty.getSingletonInstance();if(typeof e=="number")return Dj(e)?new tr.Error(N.NUM,x.ValueLarge):new tr.Number(e);if(typeof e=="boolean")return new tr.Boolean(e);if(e instanceof Date){const r=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}),n=qc({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3}),i=r+n;return i<0?new tr.Error(N.NUM,x.DateBounds):i%1===0?new tr.Number(new pI(i,"Date()")):i<1?new tr.Number(new mI(i,"Date()")):new tr.Number(new vI(i,"Date()"))}else if(typeof e=="string"){if(HNe(e))return new tr.Boolean(e.toLowerCase()==="true");if(FNe(e))return new tr.Formula(e);if(UNe(e,this.config.errorMapping))return new tr.Error(this.config.errorMapping[e.toUpperCase()]);{let r=e.trim(),n=0,i;if(r.endsWith("%"))n=1,r=r.slice(0,r.length-1);else{const s=this.currencyMatcher(r);s!==void 0&&(n=2,[i,r]=s)}const o=this.numberLiteralsHelper.numericStringToMaybeNumber(r);if(o!==void 0){let s;return n===1?s=new a0(o/100):n===2?s=new g5(o,i):s=o,new tr.Number(s)}const a=this.dateHelper.dateStringToDateNumber(r);return a!==void 0?new tr.Number(a):new tr.String(e.startsWith("'")?e.slice(1):e)}}else throw new Oj(e)}currencyMatcher(e){for(const r of this.config.currencySymbol){if(e.startsWith(r))return[r,e.slice(r.length)];if(e.endsWith(r))return[r,e.slice(0,e.length-r.length)]}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var _l;(function(t){t[t.COPY=0]="COPY",t[t.CUT=1]="CUT"})(_l||(_l={}));var rn;(function(t){t[t.VALUE=0]="VALUE",t[t.EMPTY=1]="EMPTY",t[t.FORMULA=2]="FORMULA",t[t.PARSING_ERROR=3]="PARSING_ERROR"})(rn||(rn={}));class s9{constructor(e,r,n,i,o){this.sourceLeftCorner=e,this.width=r,this.height=n,this.type=i,this.content=o}*getContent(e){if(this.content!==void 0)for(let r=0;r<this.height;++r)for(let n=0;n<this.width;++n)yield[Se(e.sheet,e.col+n,e.row+r),this.content[r][n]]}}class VNe{constructor(e,r,n){this.dependencyGraph=r,this.operations=n,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,r,n){this.clipboard=new s9(e,r,n,_l.CUT)}copy(e,r,n){const i=[];for(let o=0;o<n;++o){i[o]=[];for(let a=0;a<r;++a){const s=this.operations.getClipboardCell(Se(e.sheet,e.col+a,e.row+o));i[o].push(s)}}this.clipboard=new s9(e,r,n,_l.COPY,i)}abortCut(){this.clipboard&&this.clipboard.type===_l.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(this.clipboard===void 0)return;if(Un(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new Mr("a valid target address.");const r=$e.spanFrom(e,this.clipboard.width,this.clipboard.height);if(r.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new uu;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(r))throw new Error("It is not possible to paste onto an array")}isCutClipboard(){return this.clipboard!==void 0&&this.clipboard.type===_l.CUT}isCopyClipboard(){return this.clipboard!==void 0&&this.clipboard.type===_l.COPY}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Jb{constructor(e,r,n,i){this.displayName=e,this.address=r,this.added=n,this.options=i}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new Jb(this.displayName,this.address,this.added,this.options)}}class jNe{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){const r=this.normalizeExpressionName(e),n=this.mapping.get(r);return!(n&&n.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){const r=this.mapping.get(this.normalizeExpressionName(e));if(r&&r.added)return r}remove(e){const r=this.normalizeExpressionName(e),n=this.mapping.get(r);n&&(n.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}normalizeExpressionName(e){return e.toLowerCase()}}class l9{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}isNameAvailable(e){const r=this.normalizeExpressionName(e);return!this.mapping.has(r)}remove(e){const r=this.normalizeExpressionName(e);this.mapping.get(r)&&this.mapping.delete(r)}normalizeExpressionName(e){return e.toLowerCase()}}class Cu{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new jNe,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,r){var n,i;return r===void 0?this.workbookStore.isNameAvailable(e):(i=(n=this.worksheetStore(r))===null||n===void 0?void 0:n.isNameAvailable(e))!==null&&i!==void 0?i:!0}namedExpressionInAddress(e){const r=this.addressCache.get(e);if(r&&r.added)return r}namedExpressionForScope(e,r){var n;return r===void 0?this.workbookStore.getExisting(e):(n=this.worksheetStore(r))===null||n===void 0?void 0:n.get(e)}nearestNamedExpression(e,r){var n,i;return(i=(n=this.worksheetStore(r))===null||n===void 0?void 0:n.get(e))!==null&&i!==void 0?i:this.workbookStore.getExisting(e)}isExpressionInScope(e,r){var n,i;return(i=(n=this.worksheetStore(r))===null||n===void 0?void 0:n.has(e))!==null&&i!==void 0?i:!1}isNameValid(e){const r=new RegExp(`^${aV}$`),n=new RegExp(`^${sV}$`),i=new RegExp(`^${lV}$`);return r.test(e)||n.test(e)?!1:i.test(e)}addNamedExpression(e,r,n){const i=r===void 0?this.workbookStore:this.worksheetStoreOrCreate(r);let o=i.get(e);return o!==void 0?(o.added=!0,o.displayName=e,o.options=n):(o=new Jb(e,this.nextAddress(),!0,n),i.add(o)),this.addressCache.set(o.address.row,o),o}restoreNamedExpression(e,r){const n=r===void 0?this.workbookStore:this.worksheetStoreOrCreate(r);return e.added=!0,n.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,r){var n;return(n=this.worksheetStoreOrCreate(r).get(e))!==null&&n!==void 0?n:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let r=this.workbookStore.get(e);return r===void 0&&(r=new Jb(e,this.nextAddress(),!1),this.workbookStore.add(r)),r}remove(e,r){let n;r===void 0?n=this.workbookStore:n=this.worksheetStore(r);const i=n==null?void 0:n.get(e);if(n===void 0||i===void 0||!i.added)throw Error("Named expression does not exist");n.remove(e),n instanceof l9&&n.mapping.size===0&&this.worksheetStores.delete(r),this.addressCache.delete(i.address.row)}getAllNamedExpressionsNamesInScope(e){return this.getAllNamedExpressions().filter(({scope:r})=>r===e).map(r=>r.expression.displayName)}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map(e=>e.expression.displayName)}getAllNamedExpressions(){const e=[];return this.workbookStore.getAllNamedExpressions().forEach(r=>{e.push({expression:r,scope:void 0})}),this.worksheetStores.forEach((r,n)=>{r.getAllNamedExpressions().forEach(i=>{e.push({expression:i,scope:n})})}),e}getAllNamedExpressionsForScope(e){var r,n;return e===void 0?this.workbookStore.getAllNamedExpressions():(n=(r=this.worksheetStores.get(e))===null||r===void 0?void 0:r.getAllNamedExpressions())!==null&&n!==void 0?n:[]}worksheetStoreOrCreate(e){let r=this.worksheetStores.get(e);return r||(r=new l9,this.worksheetStores.set(e,r)),r}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return Se(Cu.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}Cu.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const ps=t=>{switch(t.type){case P.EMPTY:case P.NUMBER:case P.STRING:case P.ERROR:case P.ERROR_WITH_RAW_INPUT:return!1;case P.CELL_REFERENCE:return!t.reference.isAbsolute();case P.CELL_RANGE:case P.COLUMN_RANGE:case P.ROW_RANGE:return!t.start.isAbsolute();case P.NAMED_EXPRESSION:return!1;case P.PERCENT_OP:case P.PLUS_UNARY_OP:case P.MINUS_UNARY_OP:return ps(t.value);case P.CONCATENATE_OP:case P.EQUALS_OP:case P.NOT_EQUAL_OP:case P.LESS_THAN_OP:case P.GREATER_THAN_OP:case P.LESS_THAN_OR_EQUAL_OP:case P.GREATER_THAN_OR_EQUAL_OP:case P.MINUS_OP:case P.PLUS_OP:case P.TIMES_OP:case P.DIV_OP:case P.POWER_OP:return ps(t.left)||ps(t.right);case P.PARENTHESIS:return ps(t.expression);case P.FUNCTION_CALL:return t.args.some(e=>ps(e));case P.ARRAY:return t.args.some(e=>e.some(r=>ps(r)))}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class tl{performEagerTransformations(e,r){for(const n of e.arrayFormulaNodes()){const[i,o]=this.transformSingleAst(n.getFormula(e.lazilyTransformingAstService),n.getAddress(e.lazilyTransformingAstService)),a=r.rememberNewAst(i);n.setFormula(a),n.setAddress(o)}}transformSingleAst(e,r){const n=this.transformAst(e,r),i=this.fixNodeAddress(r);return[n,i]}transformAst(e,r){switch(e.type){case P.CELL_REFERENCE:return this.transformCellReferenceAst(e,r);case P.CELL_RANGE:return this.transformCellRangeAst(e,r);case P.COLUMN_RANGE:return this.transformColumnRangeAst(e,r);case P.ROW_RANGE:return this.transformRowRangeAst(e,r);case P.EMPTY:case P.ERROR:case P.NUMBER:case P.NAMED_EXPRESSION:case P.ERROR_WITH_RAW_INPUT:case P.STRING:return e;case P.PERCENT_OP:case P.MINUS_UNARY_OP:case P.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,r)});case P.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map(n=>this.transformAst(n,r))});case P.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,r)});case P.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map(n=>n.map(i=>this.transformAst(i,r)))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,r),right:this.transformAst(e.right,r)})}}transformCellReferenceAst(e,r){const n=this.transformCellAddress(e.reference,r);return n instanceof Ht?Object.assign(Object.assign({},e),{reference:n}):n===N.REF?Co(new C(N.REF)):e}transformCellRangeAst(e,r){const n=this.transformCellRange(e.start,e.end,r);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===N.REF?Co(new C(N.REF)):e}transformColumnRangeAst(e,r){const n=this.transformColumnRange(e.start,e.end,r);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===N.REF?Co(new C(N.REF)):e}transformRowRangeAst(e,r){const n=this.transformRowRange(e.start,e.end,r);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===N.REF?Co(new C(N.REF)):e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class WNe extends tl{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,r){return e}transformCellRange(e,r,n){return this.transformRange(e,r,n)}transformRowRange(e,r,n){throw Error("Not implemented")}transformColumnRange(e,r,n){return this.transformRange(e,r,n)}transformCellAddress(e,r){const n=Zi(e,r);if(n!==this.columnsSpan.sheet&&r.sheet!==this.columnsSpan.sheet)return!1;const i=e.toSimpleColumnAddress(r);return n===this.columnsSpan.sheet&&r.sheet!==this.columnsSpan.sheet?this.columnsSpan.columnStart<=i.col?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1:r.sheet===this.columnsSpan.sheet&&n!==this.columnsSpan.sheet?e.isColumnAbsolute()||r.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):e.isColumnAbsolute()?e.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(this.columnsSpan.numberOfColumns):e.toSimpleColumnAddress(r).col<this.columnsSpan.columnStart?r.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):r.col<this.columnsSpan.columnStart?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,r,n){const i=this.transformCellAddress(e,n),o=this.transformCellAddress(r,n);return i===N.REF||o===N.REF?N.REF:i||o?[i||e,o||r]:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class _5 extends tl{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,r){return e}transformCellRange(e,r,n){return this.transformRange(e,r,n)}transformRowRange(e,r,n){return this.transformRange(e,r,n)}transformColumnRange(e,r,n){throw Error("Not implemented")}transformCellAddress(e,r){const n=Zi(e,r);if(n!==this.rowsSpan.sheet&&r.sheet!==this.rowsSpan.sheet)return!1;const i=e.toSimpleRowAddress(r);return n===this.rowsSpan.sheet&&r.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=i.row?e.shiftedByRows(this.rowsSpan.numberOfRows):!1:r.sheet===this.rowsSpan.sheet&&n!==this.rowsSpan.sheet?e.isRowAbsolute()||r.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?e.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(this.rowsSpan.numberOfRows):i.row<this.rowsSpan.rowStart?r.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):r.row<this.rowsSpan.rowStart?e.shiftedByRows(this.rowsSpan.numberOfRows):!1}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,r,n){const i=this.transformCellAddress(e,n),o=this.transformCellAddress(r,n);return i===N.REF||o===N.REF?N.REF:i||o?[i||e,o||r]:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class GNe extends tl{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,r){return e.isInvalid(r)?N.REF:!1}transformCellRange(e,r,n){return e.isInvalid(n)||r.isInvalid(n)?N.REF:!1}transformColumnRange(e,r,n){return e.isInvalid(n)||r.isInvalid(n)?N.REF:!1}transformRowRange(e,r,n){return e.isInvalid(n)||r.isInvalid(n)?N.REF:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class zNe extends tl{constructor(e,r,n,i){super(),this.sourceRange=e,this.toRight=r,this.toBottom=n,this.toSheet=i,this.dependentFormulaTransformer=new YNe(e,r,n,i)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,r){return this.sourceRange.addressInRange(r)?[this.transformAst(e,r),this.fixNodeAddress(r)]:this.dependentFormulaTransformer.transformSingleAst(e,r)}fixNodeAddress(e){return Se(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,r){return this.transformAddress(e,r)}transformCellRange(e,r,n){return this.transformRange(e,r,n)}transformColumnRange(e,r,n){return this.transformRange(e,r,n)}transformRowRange(e,r,n){return this.transformRange(e,r,n)}transformAddress(e,r){const n=this.sourceRange;if(e instanceof Ht){const i=e.toSimpleCellAddress(r);if(n.addressInRange(i))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,r,n){const i=this.sourceRange;if(e instanceof Ht&&r instanceof Ht){const o=e.toSimpleCellAddress(n),a=r.toSimpleCellAddress(n);if(i.addressInRange(o)&&i.addressInRange(a))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),r.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),r.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}class YNe extends tl{constructor(e,r,n,i){super(),this.sourceRange=e,this.toRight=r,this.toBottom=n,this.toSheet=i}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,r){return this.shouldMove(e,r)?e.moved(this.toSheet,this.toRight,this.toBottom):!1}transformCellRange(e,r,n){return this.transformRange(e,r,n)}transformColumnRange(e,r,n){return this.transformRange(e,r,n)}transformRowRange(e,r,n){return this.transformRange(e,r,n)}shouldMove(e,r){return e instanceof Ht?this.sourceRange.addressInRange(e.toSimpleCellAddress(r)):e instanceof dn?this.sourceRange.rowInRange(e.toSimpleRowAddress(r))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(r))&&!this.sourceRange.isFinite()}transformRange(e,r,n){const i=this.transformCellAddress(e,n),o=this.transformCellAddress(r,n);return i&&o?[i,o]:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class KNe extends tl{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,r){return e}transformCellRange(e,r,n){return this.transformRange(e,r,n)}transformRowRange(e,r,n){throw Error("Not implemented")}transformColumnRange(e,r,n){return this.transformRange(e,r,n)}transformCellAddress(e,r){const n=Zi(e,r);if(this.columnsSpan.sheet!==r.sheet&&this.columnsSpan.sheet!==n)return!1;if(this.columnsSpan.sheet!==r.sheet&&this.columnsSpan.sheet===n){const i=e.toSimpleColumnAddress(r);if(i.col<this.columnsSpan.columnStart)return!1;if(i.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===r.sheet&&this.columnsSpan.sheet!==n){if(e.isColumnAbsolute())return!1;if(r.col<this.columnsSpan.columnStart)return!1;if(r.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===r.sheet&&this.columnsSpan.sheet===n)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{const i=e.toSimpleColumnAddress(r);if(i.col<this.columnsSpan.columnStart){if(r.col<this.columnsSpan.columnStart)return!1;if(r.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(i.col>this.columnsSpan.columnEnd){if(r.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(r.col>this.columnsSpan.columnEnd)return!1}}return N.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,r,n){const i=Zi(e,n);let o=e,a=r;if(this.columnsSpan.sheet===i){const u=e.toSimpleColumnAddress(n),c=r.toSimpleColumnAddress(n);if(this.columnsSpan.columnStart<=u.col&&this.columnsSpan.columnEnd>=c.col)return N.REF;u.col>=this.columnsSpan.columnStart&&u.col<=this.columnsSpan.columnEnd&&(o=e.shiftedByColumns(this.columnsSpan.columnEnd-u.col+1)),c.col>=this.columnsSpan.columnStart&&c.col<=this.columnsSpan.columnEnd&&(a=r.shiftedByColumns(-(c.col-this.columnsSpan.columnStart+1)))}const s=this.transformCellAddress(o,n),l=this.transformCellAddress(a,n);if(s===!1&&l===!1)return[o,a];if(s===N.REF||l===N.REF)throw Error("Cannot happen");return[s||o,l||a]}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class A5 extends tl{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,r){return e}transformCellAddress(e,r){const n=Zi(e,r);if(this.rowsSpan.sheet!==r.sheet&&this.rowsSpan.sheet!==n)return!1;if(this.rowsSpan.sheet!==r.sheet&&this.rowsSpan.sheet===n){const i=e.toSimpleRowAddress(r);if(i.row<this.rowsSpan.rowStart)return!1;if(i.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===r.sheet&&this.rowsSpan.sheet!==n){if(e.isRowAbsolute())return!1;if(r.row<this.rowsSpan.rowStart)return!1;if(r.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===r.sheet&&this.rowsSpan.sheet===n)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{const i=e.toSimpleRowAddress(r);if(i.row<this.rowsSpan.rowStart){if(r.row<this.rowsSpan.rowStart)return!1;if(r.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(i.row>this.rowsSpan.rowEnd){if(r.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(r.row>this.rowsSpan.rowEnd)return!1}}return N.REF}transformCellRange(e,r,n){return this.transformRange(e,r,n)}transformRowRange(e,r,n){return this.transformRange(e,r,n)}transformColumnRange(e,r,n){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,r,n){const i=Zi(e,n);let o=e,a=r;if(this.rowsSpan.sheet===i){const u=e.toSimpleRowAddress(n),c=r.toSimpleRowAddress(n);if(this.rowsSpan.rowStart<=u.row&&this.rowsSpan.rowEnd>=c.row)return N.REF;u.row>=this.rowsSpan.rowStart&&u.row<=this.rowsSpan.rowEnd&&(o=e.shiftedByRows(this.rowsSpan.rowEnd-u.row+1)),c.row>=this.rowsSpan.rowStart&&c.row<=this.rowsSpan.rowEnd&&(a=r.shiftedByRows(-(c.row-this.rowsSpan.rowStart+1)))}const s=this.transformCellAddress(o,n),l=this.transformCellAddress(a,n);return s===!1&&l===!1?[o,a]:s===N.REF||l===N.REF?N.REF:[s||o,l||a]}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class XNe extends tl{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,r){for(const n of e.arrayFormulaNodes()){const[i]=this.transformSingleAst(n.getFormula(e.lazilyTransformingAstService),n.getAddress(e.lazilyTransformingAstService));n.setFormula(i)}}fixNodeAddress(e){return e}transformCellAddress(e,r){return this.transformAddress(e)}transformCellRange(e,r,n){return this.transformAddress(e)}transformColumnRange(e,r,n){return this.transformAddress(e)}transformRowRange(e,r,n){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet?N.REF:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function Gj(t){if(!Array.isArray(t))throw new Mr("an array of arrays.");for(let e=0;e<t.length;e++)if(!Array.isArray(t[e]))throw new Mr("an array of arrays.")}function e2(t){let e=0,r=0,n=0;for(let o=0;o<t.length;o++){let a=0;for(let s=0;s<t[o].length;s++){const l=t[o][s];l!=null&&(a=s+1,++n)}e=Math.max(e,a),a>0&&(r=o+1)}const i=e*r;return{height:r,width:e,fill:i===0?0:n/i}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class zj{constructor(e,r){this.sheet=e,this.indexes=r}normalizedIndexes(){return t2(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>Vn.fromNumberOfRows(this.sheet,e[0],e[1]))}}class Yj{constructor(e,r){this.sheet=e,this.indexes=r}normalizedIndexes(){return r2(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>Vn.fromNumberOfRows(this.sheet,e[0],e[1]))}}class Kj{constructor(e,r){this.sheet=e,this.indexes=r}normalizedIndexes(){return r2(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>si.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class Xj{constructor(e,r){this.sheet=e,this.indexes=r}normalizedIndexes(){return t2(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>si.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class qNe{constructor(e,r,n,i,o,a,s,l,u){this.dependencyGraph=r,this.columnSearch=n,this.cellContentParser=i,this.parser=o,this.stats=a,this.lazilyTransformingAstService=s,this.namedExpressions=l,this.arraySizePredictor=u,this.changes=Ps.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){const r=[];for(const n of e.rowsSpans()){const i=this.doRemoveRows(n);i&&r.push(i)}return r}addRows(e){for(const r of e.rowsSpans())this.doAddRows(r)}addColumns(e){for(const r of e.columnsSpans())this.doAddColumns(r)}removeColumns(e){const r=[];for(const n of e.columnsSpans()){const i=this.doRemoveColumns(n);i&&r.push(i)}return r}removeSheet(e){this.dependencyGraph.removeSheet(e);let r;this.stats.measure(Ke.TRANSFORM_ASTS,()=>{const i=new XNe(e);i.performEagerTransformations(this.dependencyGraph,this.parser),r=this.lazilyTransformingAstService.addTransformation(i)}),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);const n=this.namedExpressions.getAllNamedExpressionsForScope(e).map(i=>this.removeNamedExpression(i.normalizeExpressionName(),e));return{version:r,scopedNamedExpressions:n}}removeSheetByName(e){const r=this.sheetMapping.fetch(e);return this.removeSheet(r)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){const r=this.sheetMapping.addSheet(e),n=[];return this.dependencyGraph.addressMapping.autoAddSheet(r,n,e2(n)),this.sheetMapping.fetchDisplayName(r)}renameSheet(e,r){return this.sheetMapping.renameSheet(e,r)}moveRows(e,r,n,i){const o=Vn.fromNumberOfRows(e,i,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(o),i<r&&(r+=n);const a=Se(e,0,r),s=Se(e,0,i);this.moveCells(a,Number.POSITIVE_INFINITY,n,s);const l=Vn.fromNumberOfRows(e,r,n);return this.doRemoveRows(l),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,r,n,i){const o=si.fromNumberOfColumns(e,i,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(o),i<r&&(r+=n);const a=Se(e,r,0),s=Se(e,i,0);this.moveCells(a,n,Number.POSITIVE_INFINITY,s);const l=si.fromNumberOfColumns(e,r,n);return this.doRemoveColumns(l),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,r,n,i){this.ensureItIsPossibleToMoveCells(e,r,n,i);const o=$e.spanFrom(e,r,n),a=$e.spanFrom(i,r,n),s=i.col-e.col,l=i.row-e.row,u=i.sheet,c=this.getRangeClipboardCells(a),f=this.dependencyGraph.rawValuesFromRange(a);this.columnSearch.removeValues(f);const h=this.dependencyGraph.rawValuesFromRange(o);this.columnSearch.moveValues(h,s,l,u);let d;this.stats.measure(Ke.TRANSFORM_ASTS,()=>{const m=new zNe(o,s,l,u);m.performEagerTransformations(this.dependencyGraph,this.parser),d=this.lazilyTransformingAstService.addTransformation(m)}),this.dependencyGraph.moveCells(o,s,l,u);const p=this.updateNamedExpressionsForMovedCells(e,r,n,i);return{version:d,overwrittenCellsData:c,addedGlobalNamedExpressions:p}}setRowOrder(e,r){const n=[];let i=[];for(const[o,a]of r)if(o!==a){const s=$e.spanFrom({sheet:e,col:0,row:o},1/0,1),l=this.getRangeClipboardCells(s);i=i.concat(l),n.push(l.map(([{sheet:u,col:c},f])=>[{sheet:u,col:c,row:a},f]))}return n.forEach(o=>this.restoreClipboardCells(e,o.values())),i}setColumnOrder(e,r){const n=[];let i=[];for(const[o,a]of r)if(o!==a){const s=$e.spanFrom({sheet:e,col:o,row:0},1,1/0),l=this.getRangeClipboardCells(s);i=i.concat(l),n.push(l.map(([{sheet:u,col:c,row:f},h])=>[{sheet:u,col:a,row:f},h]))}return n.forEach(o=>this.restoreClipboardCells(e,o.values())),i}addNamedExpression(e,r,n,i){const o=this.namedExpressions.addNamedExpression(e,n,i);this.storeNamedExpressionInCell(o.address,r),this.adjustNamedExpressionEdges(o,e,n)}restoreNamedExpression(e,r,n){const i=e.displayName;this.restoreCell(e.address,r);const o=this.namedExpressions.restoreNamedExpression(e,n);this.adjustNamedExpressionEdges(o,i,n)}changeNamedExpressionExpression(e,r,n,i){const o=this.namedExpressions.namedExpressionForScope(e,n);if(!o)throw new yv(e);const a=o.copy();o.options=i;const s=this.getClipboardCell(o.address);return this.storeNamedExpressionInCell(o.address,r),[a,s]}removeNamedExpression(e,r){const n=this.namedExpressions.namedExpressionForScope(e,r);if(!n)throw new yv(e);this.namedExpressions.remove(n.displayName,r);const i=this.getClipboardCell(n.address);if(r!==void 0){const o=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(n.address,o.address)}else this.dependencyGraph.setCellEmpty(n.address);return[n,i]}ensureItIsPossibleToMoveCells(e,r,n,i){if(Un(e)||!(n2(r)&&n2(n)||QNe(e,r,n))||Un(i)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(i.sheet))throw new Mr("a valid range of cells to move.");const o=$e.spanFrom(e,r,n),a=$e.spanFrom(i,r,n);if(a.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new uu;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new Hc;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(a))throw new Kb}restoreClipboardCells(e,r){const n=[];for(const[i,o]of r)if(this.restoreCell(i,o),o.type===rn.FORMULA){const{dependencies:a}=this.parser.fetchCachedResult(o.hash);n.push(...this.updateNamedExpressionsForTargetAddress(e,i,a))}return n}restoreCell(e,r){switch(r.type){case rn.VALUE:{this.setValueToCell(r,e);break}case rn.FORMULA:{this.setFormulaToCellFromCache(r.hash,e);break}case rn.EMPTY:{this.setCellEmpty(e);break}case rn.PARSING_ERROR:{this.setParsingErrorToCell(r.rawInput,r.errors,e);break}}}getOldContent(e){const r=this.dependencyGraph.getCell(e);if(r===void 0||r instanceof bs)return[e,{type:rn.EMPTY}];if(r instanceof Ms)return[e,Object.assign({type:rn.VALUE},r.getValues())];if(r instanceof li)return[r.getAddress(this.lazilyTransformingAstService),{type:rn.FORMULA,hash:this.parser.computeHashFromAst(r.getFormula(this.lazilyTransformingAstService))}];if(r instanceof Kc)return[e,{type:rn.PARSING_ERROR,rawInput:r.rawInput,errors:r.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){const r=this.dependencyGraph.getCell(e);if(r===void 0||r instanceof bs)return{type:rn.EMPTY};if(r instanceof Ms)return Object.assign({type:rn.VALUE},r.getValues());if(r instanceof yr){const n=r.getArrayCellValue(e);return n===ft?{type:rn.EMPTY}:{type:rn.VALUE,parsedValue:n,rawValue:r.getArrayCellRawValue(e)}}else{if(r instanceof Io)return{type:rn.FORMULA,hash:this.parser.computeHashFromAst(r.getFormula(this.lazilyTransformingAstService))};if(r instanceof Kc)return{type:rn.PARSING_ERROR,rawInput:r.rawInput,errors:r.errors}}throw Error("Trying to copy unsupported type")}getSheetClipboardCells(e){const r=this.dependencyGraph.getSheetHeight(e),n=this.dependencyGraph.getSheetWidth(e),i=new Array(r);for(let o=0;o<r;o++){i[o]=new Array(n);for(let a=0;a<n;a++){const s=Se(e,a,o);i[o][a]=this.getClipboardCell(s)}}return i}getRangeClipboardCells(e){const r=[];for(const n of e.addresses(this.dependencyGraph))r.push([n,this.getClipboardCell(n)]);return r}setCellContent(e,r){const n=this.cellContentParser.parse(r),i=this.getOldContent(e);if(n instanceof tr.Formula){const o=this.parser.parse(n.formula,e),{ast:a,errors:s}=o;if(s.length>0)this.setParsingErrorToCell(n.formula,s,e);else{const l=this.arraySizePredictor.checkArraySize(a,e);this.setFormulaToCell(e,l,o)}}else n instanceof tr.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:r},e);return i}setSheetContent(e,r){this.clearSheet(e);for(let n=0;n<r.length;n++)for(let i=0;i<r[n].length;i++){const o=Se(e,i,n);this.setCellContent(o,r[n][i])}}setParsingErrorToCell(e,r,n){const i=this.dependencyGraph.getCellValue(n),o=new Kc(r,e),a=this.dependencyGraph.setParsingErrorToCell(n,o);this.columnSearch.remove(ye(i),n),this.columnSearch.applyChanges(a.getChanges()),this.changes.addAll(a),this.changes.addChange(o.getCellValue(),n)}setFormulaToCell(e,r,{ast:n,hasVolatileFunction:i,hasStructuralChangeFunction:o,dependencies:a}){const s=this.dependencyGraph.getCellValue(e),l=this.dependencyGraph.setFormulaToCell(e,n,Oo(a,e),r,i,o);this.columnSearch.remove(ye(s),e),this.columnSearch.applyChanges(l.getChanges()),this.changes.addAll(l)}setValueToCell(e,r){const n=this.dependencyGraph.getCellValue(r),i=this.dependencyGraph.setValueToCell(r,e);this.columnSearch.change(ye(n),ye(e.parsedValue),r),this.columnSearch.applyChanges(i.getChanges().filter(o=>!wv(o.address,r))),this.changes.addAll(i),this.changes.addChange(e.parsedValue,r)}setCellEmpty(e){if(this.dependencyGraph.isArrayInternalCell(e))return;const r=this.dependencyGraph.getCellValue(e),n=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove(ye(r),e),this.columnSearch.applyChanges(n.getChanges()),this.changes.addAll(n),this.changes.addChange(ft,e)}setFormulaToCellFromCache(e,r){const{ast:n,hasVolatileFunction:i,hasStructuralChangeFunction:o,dependencies:a}=this.parser.fetchCachedResult(e),s=Oo(a,r),[l]=new GNe(r.sheet).transformSingleAst(n,r);this.parser.rememberNewAst(l);const u=N4e(s),c=this.arraySizePredictor.checkArraySize(n,r);this.dependencyGraph.setFormulaToCell(r,l,u,c,i,o)}rowEffectivelyNotInSheet(e,r){const n=this.dependencyGraph.addressMapping.getHeight(r);return e>=n}getAndClearContentChanges(){const e=this.changes;return this.changes=Ps.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const r=[];for(const[a]of this.dependencyGraph.entriesFromRowsSpan(e))r.push({address:a,cellType:this.getClipboardCell(a)});const{affectedArrays:n,contentChanges:i}=this.dependencyGraph.removeRows(e);this.columnSearch.applyChanges(i.getChanges());let o;return this.stats.measure(Ke.TRANSFORM_ASTS,()=>{const a=new A5(e);a.performEagerTransformations(this.dependencyGraph,this.parser),o=this.lazilyTransformingAstService.addTransformation(a)}),this.rewriteAffectedArrays(n),{version:o,removedCells:r,rowFrom:e.rowStart,rowCount:e.numberOfRows}}doRemoveColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const r=[];for(const[a]of this.dependencyGraph.entriesFromColumnsSpan(e))r.push({address:a,cellType:this.getClipboardCell(a)});const{affectedArrays:n,contentChanges:i}=this.dependencyGraph.removeColumns(e);this.columnSearch.applyChanges(i.getChanges()),this.columnSearch.removeColumns(e);let o;return this.stats.measure(Ke.TRANSFORM_ASTS,()=>{const a=new KNe(e);a.performEagerTransformations(this.dependencyGraph,this.parser),o=this.lazilyTransformingAstService.addTransformation(a)}),this.rewriteAffectedArrays(n),{version:o,removedCells:r,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}doAddRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const{affectedArrays:r}=this.dependencyGraph.addRows(e);this.stats.measure(Ke.TRANSFORM_ASTS,()=>{const n=new _5(e);n.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(n)}),this.rewriteAffectedArrays(r)}rewriteAffectedArrays(e){for(const r of e.values()){if(r.array.size.isRef)continue;const n=r.getFormula(this.lazilyTransformingAstService),i=r.getAddress(this.lazilyTransformingAstService),o=this.parser.computeHashFromAst(n);this.setFormulaToCellFromCache(o,i)}}doAddColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const{affectedArrays:r,contentChanges:n}=this.dependencyGraph.addColumns(e);this.columnSearch.addColumns(e),this.columnSearch.applyChanges(n.getChanges()),this.stats.measure(Ke.TRANSFORM_ASTS,()=>{const i=new WNe(e);i.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(i)}),this.rewriteAffectedArrays(r)}columnEffectivelyNotInSheet(e,r){const n=this.dependencyGraph.addressMapping.getWidth(r);return e>=n}adjustNamedExpressionEdges(e,r,n){if(n===void 0)return;const i=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),o=this.namedExpressions.workbookNamedExpressionOrPlaceholder(r),a=this.dependencyGraph.fetchCellOrCreateEmpty(o.address);for(const s of this.dependencyGraph.graph.adjacentNodes(a))if(s instanceof Io&&s.getAddress(this.lazilyTransformingAstService).sheet===n){const l=s.getFormula(this.lazilyTransformingAstService),u=s.getAddress(this.lazilyTransformingAstService),{dependencies:c}=this.parser.fetchCachedResultForAst(l);for(const f of Oo(c,u))f instanceof Os&&f.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(a,s),this.dependencyGraph.graph.addEdge(i,s))}}storeNamedExpressionInCell(e,r){const n=this.cellContentParser.parse(r);if(n instanceof tr.Formula){const i=this.parser.parse(n.formula,Se(-1,0,0));if(ps(i.ast))throw new gI;const{ast:o,hasVolatileFunction:a,hasStructuralChangeFunction:s,dependencies:l}=i;this.dependencyGraph.setFormulaToCell(e,o,Oo(l,e),it.scalar(),a,s)}else n instanceof tr.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:r},e)}updateNamedExpressionsForMovedCells(e,r,n,i){if(e.sheet===i.sheet)return[];const o=[],a=$e.spanFrom(i,r,n);for(const s of a.addresses(this.dependencyGraph)){const l=this.addressMapping.fetchCell(s);if(l instanceof Io&&s.sheet!==e.sheet){const u=l.getFormula(this.lazilyTransformingAstService),{dependencies:c}=this.parser.fetchCachedResultForAst(u);o.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,s,c))}}return o}updateNamedExpressionsForTargetAddress(e,r,n){if(e===r.sheet)return[];const i=[],o=this.addressMapping.fetchCell(r);for(const a of Oo(n,r)){if(!(a instanceof Os))continue;const s=a.name,l=this.dependencyGraph.fetchNamedExpressionVertex(s,e),c=this.namedExpressions.isExpressionInScope(s,r.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(s,r.sheet):this.copyOrFetchGlobalNamedExpressionVertex(s,l,i);c!==l&&(this.dependencyGraph.graph.softRemoveEdge(l,o),this.dependencyGraph.graph.addEdge(c,o))}return i}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(Cu.SHEET_FOR_WORKBOOK_EXPRESSIONS,new K4e(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,r,n){let i=this.namedExpressions.namedExpressionForScope(e);if(i===void 0)if(i=this.namedExpressions.addNamedExpression(e),n.push(i.normalizeExpressionName()),r instanceof Io){const o=this.parser.fetchCachedResultForAst(r.getFormula(this.lazilyTransformingAstService)),{ast:a,hasVolatileFunction:s,hasStructuralChangeFunction:l,dependencies:u}=o;this.dependencyGraph.setFormulaToCell(i.address,a,Oo(u,i.address),it.scalar(),s,l)}else r instanceof bs?this.setCellEmpty(i.address):r instanceof Ms&&this.setValueToCell(r.getValues(),i.address);return this.dependencyGraph.fetchCellOrCreateEmpty(i.address)}}function t2(t){if(t.length<=1)return t;const e=[...t].sort(([i],[o])=>i-o),r=e.reduce((i,[o,a])=>{const s=i[i.length-1],l=s[0]+s[1];return o<=l?s[1]+=Math.max(0,a-(l-o)):i.push([o,a]),i},[e[0]]);let n=0;for(let i=0;i<r.length;++i)r[i][0]-=n,n+=r[i][1];return r}function r2(t){if(t.length<=1)return t;const e=[...t].sort(([i],[o])=>i-o),r=e.reduce((i,[o,a])=>{const s=i[i.length-1];return o===s[0]?s[1]=Math.max(s[1],a):i.push([o,a]),i},[e[0]]);let n=0;for(let i=0;i<r.length;++i)r[i][0]+=n,n+=r[i][1];return r}function n2(t){return Number.isInteger(t)&&t>0}function QNe(t,e,r){return t.row===0&&n2(e)&&r===Number.POSITIVE_INFINITY||t.col===0&&n2(r)&&e===Number.POSITIVE_INFINITY}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Fr{}class ZNe extends Fr{constructor(e,r){super(),this.command=e,this.rowsRemovals=r}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}}class JNe extends Fr{constructor(e,r,n,i,o,a,s){super(),this.sourceLeftCorner=e,this.width=r,this.height=n,this.destinationLeftCorner=i,this.overwrittenCellsData=o,this.addedGlobalNamedExpressions=a,this.version=s}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}}class ePe extends Fr{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}}class tPe extends Fr{constructor(e,r,n){super(),this.sheetId=e,this.rowMapping=r,this.oldContent=n}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}}class rPe extends Fr{constructor(e,r,n){super(),this.sheetId=e,this.columnMapping=r,this.oldContent=n}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}}class nPe extends Fr{constructor(e,r,n){super(),this.sheetId=e,this.oldSheetContent=r,this.newSheetContent=n}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}}class iPe extends Fr{constructor(e,r,n,i,o){super(),this.sheet=e,this.startRow=r,this.numberOfRows=n,this.targetRow=i,this.version=o,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}}class oPe extends Fr{constructor(e,r,n,i,o){super(),this.sheet=e,this.startColumn=r,this.numberOfColumns=n,this.targetColumn=i,this.version=o,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}}class aPe extends Fr{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}}class sPe extends Fr{constructor(e,r){super(),this.command=e,this.columnsRemovals=r}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}}class lPe extends Fr{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}}class uPe extends Fr{constructor(e,r,n,i,o){super(),this.sheetName=e,this.sheetId=r,this.oldSheetContent=n,this.scopedNamedExpressions=i,this.version=o}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}}class cPe extends Fr{constructor(e,r,n){super(),this.sheetId=e,this.oldName=r,this.newName=n}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}}class fPe extends Fr{constructor(e,r){super(),this.sheetId=e,this.oldSheetContent=r}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}}class hPe extends Fr{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}}class dPe extends Fr{constructor(e,r,n,i){super(),this.targetLeftCorner=e,this.oldContent=r,this.newContent=n,this.addedGlobalNamedExpressions=i}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}}class pPe extends Fr{constructor(e,r,n,i){super(),this.name=e,this.newContent=r,this.scope=n,this.options=i}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}}class mPe extends Fr{constructor(e,r,n){super(),this.namedExpression=e,this.content=r,this.scope=n}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}}class vPe extends Fr{constructor(e,r,n,i,o){super(),this.namedExpression=e,this.newContent=r,this.oldContent=n,this.scope=i,this.options=o}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}}class gPe extends Fr{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;e>=0;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}let yPe=class{constructor(e,r){this.operations=r,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){this.batchUndoEntry!==void 0?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new gPe}commitBatchMode(){if(this.batchUndoEntry===void 0)throw Error("Batch mode wasn't started");this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,r,n){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([r,n])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return this.undoStack.length===0}isRedoStackEmpty(){return this.redoStack.length===0}undo(){const e=this.undoStack.pop();if(!e)throw Error("Attempted to undo without operation on stack");this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const r of e.reversedOperations())this.undoEntry(r)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:r},rowsRemovals:n}=e;for(let i=n.length-1;i>=0;--i){const o=n[i];this.operations.addRows(new Yj(r,[[o.rowFrom,o.rowCount]]));for(const{address:a,cellType:s}of o.removedCells)this.operations.restoreCell(a,s);this.restoreOldDataFromVersion(o.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:r},columnsRemovals:n}=e;for(let i=n.length-1;i>=0;--i){const o=n[i];this.operations.addColumns(new Kj(r,[[o.columnFrom,o.columnCount]]));for(const{address:a,cellType:s}of o.removedCells)this.operations.restoreCell(a,s);this.restoreOldDataFromVersion(o.version-1)}}undoAddRows(e){const r=e.command.rowsSpans();for(let n=r.length-1;n>=0;--n){const i=r[n];this.operations.removeRows(new zj(e.command.sheet,[[i.rowStart,i.numberOfRows]]))}}undoAddColumns(e){const r=e.command.columnsSpans();for(let n=r.length-1;n>=0;--n){const i=r[n];this.operations.removeColumns(new Xj(e.command.sheet,[[i.columnStart,i.numberOfColumns]]))}}undoSetCellContents(e){for(const r of e.cellContents){const n=r.address,[i,o]=r.oldContent;wv(n,i)||this.operations.setCellEmpty(n),this.operations.restoreCell(i,o)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const r of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(r)}undoMoveRows(e){const{sheet:r}=e;this.operations.moveRows(r,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){const{sheet:r}=e;this.operations.moveColumns(r,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const r of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(r)}undoAddSheet(e){const{sheetName:r}=e;this.operations.removeSheetByName(r)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();const{oldSheetContent:r,sheetId:n}=e;this.operations.addSheet(e.sheetName);for(let i=0;i<r.length;i++){const o=r[i];for(let a=0;a<o.length;a++){const s=o[a],l=Se(n,a,i);this.operations.restoreCell(l,s)}}for(const[i,o]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(i,o,n);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){const{oldSheetContent:r,sheetId:n}=e;for(let i=0;i<r.length;i++){const o=r[i];for(let a=0;a<o.length;a++){const s=o[a],l=Se(n,a,i);this.operations.restoreCell(l,s)}}}undoSetSheetContent(e){const{oldSheetContent:r,sheetId:n}=e;this.operations.clearSheet(n);for(let i=0;i<r.length;i++){const o=r[i];for(let a=0;a<o.length;a++){const s=o[a],l=Se(n,a,i);this.operations.restoreCell(l,s)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){const e=this.redoStack.pop();if(!e)throw Error("Attempted to redo without operation on stack");this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const r of e.operations)this.redoEntry(r)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){const{targetLeftCorner:r,newContent:n}=e,i=n.length,o=n[0].length;for(let a=0;a<i;++a)for(let s=0;s<o;++s){const l=Se(r.sheet,r.col+s,r.row+a);this.operations.restoreCell(l,n[a][s])}}redoSetCellContents(e){for(const r of e.cellContents)this.operations.setCellContent(r.address,r.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){const{sheetId:r,newSheetContent:n}=e;this.operations.setSheetContent(r,n)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(const[r,n]of e)this.operations.restoreCell(r,n)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){const r=this.oldData.get(e)||[];for(const n of r){const[i,o]=n;this.operations.setFormulaToCellFromCache(o,i)}}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class bPe{constructor(e,r,n,i,o,a,s,l,u,c){this.operations=r,this.undoRedo=n,this.clipboardOperations=i,this.dependencyGraph=o,this.columnSearch=a,this.parser=s,this.cellContentParser=l,this.lazilyTransformingAstService=u,this.namedExpressions=c,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...r){const n=new Yj(e,r);this.ensureItIsPossibleToAddRows(e,...r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(n),this.undoRedo.saveOperation(new ePe(n))}removeRows(e,...r){const n=new zj(e,r);this.ensureItIsPossibleToRemoveRows(e,...r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.removeRows(n);this.undoRedo.saveOperation(new ZNe(n,i))}addColumns(e,...r){const n=new Kj(e,r);this.ensureItIsPossibleToAddColumns(e,...r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(n),this.undoRedo.saveOperation(new aPe(n))}removeColumns(e,...r){const n=new Xj(e,r);this.ensureItIsPossibleToRemoveColumns(e,...r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.removeColumns(n);this.undoRedo.saveOperation(new sPe(n,i))}moveCells(e,r,n,i){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const{version:o,overwrittenCellsData:a,addedGlobalNamedExpressions:s}=this.operations.moveCells(e,r,n,i);this.undoRedo.saveOperation(new JNe(e,r,n,i,a,s,o))}moveRows(e,r,n,i){this.ensureItIsPossibleToMoveRows(e,r,n,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const o=this.operations.moveRows(e,r,n,i);this.undoRedo.saveOperation(new iPe(e,r,n,i,o))}moveColumns(e,r,n,i){this.ensureItIsPossibleToMoveColumns(e,r,n,i),this.undoRedo.clearRedoStack();const o=this.operations.moveColumns(e,r,n,i);this.undoRedo.saveOperation(new oPe(e,r,n,i,o))}cut(e,r,n){this.clipboardOperations.cut(e,r,n)}ensureItIsPossibleToCopy(e,r,n){if(!oc(r))throw new Mr("width to be positive integer.");if(!oc(n))throw new Mr("height to be positive integer.")}copy(e,r,n){this.ensureItIsPossibleToCopy(e,r,n),this.clipboardOperations.copy(e,r,n)}paste(e){const r=this.clipboardOperations.clipboard;if(r===void 0)throw new Cj;if(this.clipboardOperations.isCutClipboard())this.moveCells(r.sourceLeftCorner,r.width,r.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);const n=$e.spanFrom(e,r.width,r.height),i=this.operations.getRangeClipboardCells(n);this.undoRedo.clearRedoStack();const o=this.operations.restoreClipboardCells(r.sourceLeftCorner.sheet,r.getContent(e));this.undoRedo.saveOperation(new dPe(e,i,r.content,o))}}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return this.clipboardOperations.clipboard===void 0}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){e!==void 0&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();const r=this.operations.addSheet(e);return this.undoRedo.saveOperation(new lPe(r)),r}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.sheetMapping.fetchDisplayName(e),n=this.operations.getSheetClipboardCells(e),{version:i,scopedNamedExpressions:o}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new uPe(r,e,n,o,i))}renameSheet(e,r){this.ensureItIsPossibleToRenameSheet(e,r);const n=this.operations.renameSheet(e,r);return n!==void 0&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new cPe(e,n,r))),n}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new fPe(e,r))}setCellContents(e,r){if(!(r instanceof Array))r=[[r]];else for(let i=0;i<r.length;i++)if(!(r[i]instanceof Array))throw new Mr("an array of arrays or a raw cell value.");this.ensureItIsPossibleToChangeCellContents(e,r),this.undoRedo.clearRedoStack();const n=[];for(let i=0;i<r.length;i++)for(let o=0;o<r[i].length;o++){const a={sheet:e.sheet,row:e.row+i,col:e.col+o},s=r[i][o];this.clipboardOperations.abortCut();const l=this.operations.setCellContent(a,s);n.push({address:a,newContent:s,oldContent:l})}this.undoRedo.saveOperation(new hPe(n))}setSheetContent(e,r){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,r),Gj(r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,r),this.undoRedo.saveOperation(new nPe(e,n,r))}setRowOrder(e,r){this.validateSwapRowIndexes(e,r),this.testRowOrderForArrays(e,r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.setRowOrder(e,r);this.undoRedo.saveOperation(new tPe(e,r,n))}validateSwapRowIndexes(e,r){if(!this.sheetMapping.hasSheetWithId(e))throw new ar(e);this.validateRowOrColumnMapping(e,r,"row")}testColumnOrderForArrays(e,r){for(const[n,i]of r)if(n!==i){const o=$e.spanFrom({sheet:e,col:n,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new Hc}}setColumnOrder(e,r){this.validateSwapColumnIndexes(e,r),this.testColumnOrderForArrays(e,r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.setColumnOrder(e,r);this.undoRedo.saveOperation(new rPe(e,r,n))}validateSwapColumnIndexes(e,r){if(!this.sheetMapping.hasSheetWithId(e))throw new ar(e);this.validateRowOrColumnMapping(e,r,"column")}testRowOrderForArrays(e,r){for(const[n,i]of r)if(n!==i){const o=$e.spanFrom({sheet:e,col:0,row:n},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new Hc}}mappingFromOrder(e,r,n){if(!this.sheetMapping.hasSheetWithId(e))throw new ar(e);const i=n==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(r.length!==i)throw new Mr(`number of ${n}s provided to be sheet ${n==="row"?"height":"width"}.`);const o=[];for(let a=0;a<i;a++)r[a]!==a&&o.push([a,r[a]]);return o}undo(){if(this.undoRedo.isUndoStackEmpty())throw new Rj;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new Ej;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,r,n,i){this.ensureItIsPossibleToAddNamedExpression(e,r,n),this.operations.addNamedExpression(e,r,n,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new pPe(e,r,n,i))}changeNamedExpressionExpression(e,r,n,i){this.ensureItIsPossibleToChangeNamedExpression(e,n,r);const[o,a]=this.operations.changeNamedExpressionExpression(e,n,r,i);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new vPe(o,n,a,r,i))}removeNamedExpression(e,r){this.ensureScopeIdIsValid(r);const[n,i]=this.operations.removeNamedExpression(e,r);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new mPe(n,i,r)),n}ensureItIsPossibleToAddNamedExpression(e,r,n){this.ensureScopeIdIsValid(n),this.ensureNamedExpressionNameIsValid(e,n),this.ensureNamedExpressionIsValid(r)}ensureItIsPossibleToChangeNamedExpression(e,r,n){if(this.ensureScopeIdIsValid(n),this.namedExpressions.namedExpressionForScope(e,n)===void 0)throw new yv(e);this.ensureNamedExpressionIsValid(r)}isItPossibleToRemoveNamedExpression(e,r){if(this.ensureScopeIdIsValid(r),this.namedExpressions.namedExpressionForScope(e,r)===void 0)throw new yv(e)}ensureItIsPossibleToAddRows(e,...r){if(!this.sheetMapping.hasSheetWithId(e))throw new ar(e);const n=this.dependencyGraph.getSheetHeight(e),i=r.map(o=>o[1]).reduce((o,a)=>o+a,0);if(n+i>this.maxRows)throw new uu;for(const[o,a]of r)if(!cl(o)||!oc(a))throw new Mr("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...r){for(const[n,i]of r){const o=n+i-1;if(!cl(n)||!cl(o))throw new Mr("starting and ending row to be nonnegative.");if(o<n)throw new Mr("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new ar(e)}}ensureItIsPossibleToAddColumns(e,...r){if(!this.sheetMapping.hasSheetWithId(e))throw new ar(e);const n=this.dependencyGraph.getSheetWidth(e),i=r.map(o=>o[1]).reduce((o,a)=>o+a,0);if(n+i>this.maxColumns)throw new uu;for(const[o,a]of r)if(!cl(o)||!oc(a))throw new Mr("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...r){for(const[n,i]of r){const o=n+i-1;if(!cl(n)||!cl(o))throw new Mr("starting and ending column to be nonnegative.");if(o<n)throw new Mr("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new ar(e)}}ensureItIsPossibleToMoveRows(e,r,n,i){this.ensureItIsPossibleToAddRows(e,[i,n]);const o=Se(e,0,r),a=Se(e,0,i);if(!this.sheetMapping.hasSheetWithId(e)||Un(o)||Un(a)||!oc(n)||i<=r+n&&i>=r)throw new Mr("a valid range of rows to move.");const s=this.dependencyGraph.getSheetWidth(e),l=$e.spanFrom(o,s,n);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new Hc;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(Vn.fromNumberOfRows(e,i-1,2)))throw new Kb}ensureItIsPossibleToMoveColumns(e,r,n,i){this.ensureItIsPossibleToAddColumns(e,[i,n]);const o=Se(e,r,0),a=Se(e,i,0);if(!this.sheetMapping.hasSheetWithId(e)||Un(o)||Un(a)||!oc(n)||i<=r+n&&i>=r)throw new Mr("a valid range of columns to move.");const s=this.dependencyGraph.getSheetHeight(e),l=$e.spanFrom(o,n,s);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new Hc;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(si.fromNumberOfColumns(e,i-1,2)))throw new Kb}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new vv(e)}ensureItIsPossibleToRenameSheet(e,r){if(!this.sheetMapping.hasSheetWithId(e))throw new ar(e);const n=this.sheetMapping.get(r);if(n!==void 0&&n!==e)throw new vv(r)}ensureItIsPossibleToChangeContent(e){if(Un(e))throw new bj(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new ar(e.sheet)}ensureItIsPossibleToChangeCellContents(e,r){const n=e2(r),i=$e.spanFrom(e,n.width,n.height);this.ensureRangeInSizeLimits(i);for(const o of i.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(o)}ensureItIsPossibleToChangeSheetContents(e,r){const n=e2(r),i=$e.spanFrom(Se(e,0,0),n.width,n.height);this.ensureRangeInSizeLimits(i)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new uu}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(e!==void 0&&!this.sheetMapping.hasSheetWithId(e))throw new ar(e)}validateRowOrColumnMapping(e,r,n){const i=n==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),o=r.map(([s,l])=>s).sort((s,l)=>s-l),a=r.map(([s,l])=>l).sort((s,l)=>s-l);for(let s=0;s<o.length;s++){if(!cl(o[s])||o[s]>=i)throw new Mr(`${n} numbers to be nonnegative integers and less than sheet ${n==="row"?"height":"width"}.`);if(o[s]===o[s+1])throw new Mr(`source ${n} numbers to be unique.`);if(o[s]!==a[s])throw new Mr(`target ${n} numbers to be permutation of source ${n} numbers.`)}}ensureNamedExpressionNameIsValid(e,r){if(!this.namedExpressions.isNameValid(e))throw new Sj(e);if(!this.namedExpressions.isNameAvailable(e,r))throw new wj(e)}ensureNamedExpressionIsValid(e){const r=this.cellContentParser.parse(e);if(r instanceof tr.Formula){const n=this.parser.parse(r.formula,Se(-1,0,0));if(ps(n.ast))throw new gI}}}function oc(t){return Number.isInteger(t)&&t>0}function cl(t){return Number.isInteger(t)&&t>=0}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class wPe{constructor(e,r,n,i,o,a){this.config=e,this.stats=r,this.interpreter=n,this.lazilyTransformingAstService=i,this.dependencyGraph=o,this.columnSearch=a}run(){this.stats.start(Ke.TOP_SORT);const{sorted:e,cycled:r}=this.dependencyGraph.topSortWithScc();this.stats.end(Ke.TOP_SORT),this.stats.measure(Ke.EVALUATION,()=>{this.recomputeFormulas(r,e)})}partialRun(e){const r=Ps.empty();return this.stats.measure(Ke.EVALUATION,()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,n=>{if(n instanceof li){const i=n.isComputed()?n.getCellValue():void 0,o=this.recomputeFormulaVertexValue(n);if(o!==i){const a=n.getAddress(this.lazilyTransformingAstService);return r.addChange(o,a),this.columnSearch.change(ye(i),ye(o),a),!0}return!1}else return n instanceof fn&&n.clearCache(),!0},n=>{if(n instanceof fn)n.clearCache();else if(n instanceof li){const i=n.getAddress(this.lazilyTransformingAstService);this.columnSearch.remove(ye(n.valueOrUndef()),i);const o=new C(N.CYCLE,void 0,n);n.setCellValue(o),r.addChange(o,i)}})}),r}runAndForget(e,r,n){const i=[];for(const a of Oo(n,r))if(a instanceof $e){const s=a;if(this.dependencyGraph.getRange(s.start,s.end)===void 0){const l=new fn(s);this.dependencyGraph.rangeMapping.setRange(l),i.push(l)}}const o=this.evaluateAstToCellValue(e,new Po(r,this.config.useArrayArithmetic));return i.forEach(a=>{this.dependencyGraph.rangeMapping.removeRange(a)}),o}recomputeFormulas(e,r){e.forEach(n=>{n instanceof li&&n.setCellValue(new C(N.CYCLE,void 0,n))}),r.forEach(n=>{if(n instanceof li){const i=this.recomputeFormulaVertexValue(n),o=n.getAddress(this.lazilyTransformingAstService);this.columnSearch.add(ye(i),o)}else n instanceof fn&&n.clearCache()})}recomputeFormulaVertexValue(e){const r=e.getAddress(this.lazilyTransformingAstService);if(e instanceof yr&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();{const n=e.getFormula(this.lazilyTransformingAstService),i=this.evaluateAstToCellValue(n,new Po(r,this.config.useArrayArithmetic,e));return e.setCellValue(i)}}evaluateAstToCellValue(e,r){const n=this.interpreter.evaluateAst(e,r);return n instanceof Pe?n:n===ft&&this.config.evaluateNullToZero?0:n}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class I5{constructor(e,r){this.address=e,this.newValue=r}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}class qj{constructor(e,r){this.name=e,this.newValue=r}}class SPe{constructor(e,r,n,i){this.config=e,this.namedExpressions=r,this.sheetIndexMapping=n,this.lazilyTransformingService=i}exportChange(e){const r=e.value,n=e.address;if(n.sheet===Cu.SHEET_FOR_WORKBOOK_EXPRESSIONS){const i=this.namedExpressions.namedExpressionInAddress(n.row);if(!i)throw new Error("Missing named expression");return new qj(i.displayName,this.exportScalarOrRange(r))}else if(r instanceof Pe){const i=[];for(const[o,a]of r.entriesFromTopLeftCorner(n))i.push(new I5(a,this.exportValue(o)));return i}else return new I5(n,this.exportValue(r))}exportValue(e){return e instanceof Pe?this.detailedError(new C(N.VALUE,x.ScalarExpected)):this.config.smartRounding&&Rt(e)?this.cellValueRounding(ye(e)):e instanceof C?this.detailedError(e):e===ft?null:ye(e)}exportScalarOrRange(e){return e instanceof Pe?e.rawData().map(r=>r.map(n=>this.exportValue(n))):this.exportValue(e)}detailedError(e){var r,n;let i;const o=(r=e.root)===null||r===void 0?void 0:r.getAddress(this.lazilyTransformingService);return o!==void 0&&(o.sheet===Cu.SHEET_FOR_WORKBOOK_EXPRESSIONS?i=(n=this.namedExpressions.namedExpressionInAddress(o.row))===null||n===void 0?void 0:n.displayName:i=$b(this.sheetIndexMapping,o,-1)),new Uj(e,this.config.translationPackage.getErrorTranslation(e.type),i)}cellValueRounding(e){if(e===0)return e;const r=Math.floor(Math.log10(Math.abs(e))),n=Math.pow(10,this.config.precisionRounding-r);return e<0?-Math.round(-e*n)/n:Math.round(e*n)/n}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class RPe{constructor(e,r,n,i,o,a){this.dependencyGraph=e,this.columnSearch=r,this.parser=n,this.cellContentParser=i,this.stats=o,this.arraySizePredictor=a,this.buildStrategy=new EPe(e,r,n,o,i,a)}buildGraph(e,r){const n=r.measure(Ke.COLLECT_DEPENDENCIES,()=>this.buildStrategy.run(e));this.dependencyGraph.getAndClearContentChanges(),r.measure(Ke.PROCESS_DEPENDENCIES,()=>this.processDependencies(n))}processDependencies(e){e.forEach((r,n)=>{this.dependencyGraph.processCellDependencies(r,n)})}}class EPe{constructor(e,r,n,i,o,a){this.dependencyGraph=e,this.columnIndex=r,this.parser=n,this.stats=i,this.cellContentParser=o,this.arraySizePredictor=a}run(e){const r=new Map;for(const n in e){const i=this.dependencyGraph.getSheetId(n),o=e[n];for(let a=0;a<o.length;++a){const s=o[a];for(let l=0;l<s.length;++l){const u=s[l],c=Se(i,l,a),f=this.cellContentParser.parse(u);if(f instanceof tr.Formula){const h=this.stats.measure(Ke.PARSER,()=>this.parser.parse(f.formula,c));if(h.errors.length>0){this.shrinkArrayIfNeeded(c);const d=new Kc(h.errors,f.formula);this.dependencyGraph.addVertex(c,d)}else{this.shrinkArrayIfNeeded(c);const d=this.arraySizePredictor.checkArraySize(h.ast,c);if(d.isScalar()){const p=new Io(h.ast,c,0);r.set(p,Oo(h.dependencies,c)),this.dependencyGraph.addVertex(c,p),h.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(p),h.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(p)}else{const p=new yr(h.ast,c,new it(d.width,d.height));r.set(p,Oo(h.dependencies,c)),this.dependencyGraph.addArrayVertex(c,p)}}}else if(!(f instanceof tr.Empty)){this.shrinkArrayIfNeeded(c);const h=new Ms(f.value,u);this.columnIndex.add(ye(f.value),c),this.dependencyGraph.addVertex(c,h)}}}}return r}shrinkArrayIfNeeded(e){const r=this.dependencyGraph.getCell(e);r instanceof yr&&this.dependencyGraph.shrinkArrayToCorner(r)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Xy=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class Qj extends Qe{version(e,r){return this.runFunction(e.args,r,this.metadata("VERSION"),()=>{const{licenseKeyValidityState:n,licenseKey:i}=this.config;let o;return Xy.has(i)?o=Xy.get(i):Xy.has(n)?o=Xy.get(n):n==="valid"&&(o=i.slice(-5)),`HyperFormula v${Zr.version}, ${o}`})}}Qj.implementedFunctions={VERSION:{method:"version",parameters:[]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function H6(t,e){var r;let n=e.implementedFunctions[t];const i=(r=e.aliases)===null||r===void 0?void 0:r[t];if(i!==void 0){if(n!==void 0)throw new L4e(t,e.name);n=e.implementedFunctions[i]}if(n===void 0)throw jf.functionNotDeclaredInPlugin(t,e.name);return n}class Hr{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=r=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(r),this.isFunctionVolatile=r=>this.volatileFunctions.has(r),this.isArrayFunction=r=>this.arrayFunctions.has(r),this.isFunctionDependentOnSheetStructureChange=r=>this.structuralChangeFunctions.has(r),e.functionPlugins.length>0){this.instancePlugins=new Map;for(const r of e.functionPlugins)Hr.loadPluginFunctions(r,this.instancePlugins)}else this.instancePlugins=new Map(Hr.plugins);for(const[r,n]of Hr.protectedFunctions())Hr.loadFunctionUnprotected(n,r,this.instancePlugins);for(const[r,n]of this.instancePlugins.entries())this.categorizeFunction(r,H6(r,n))}static registerFunctionPlugin(e,r){this.loadPluginFunctions(e,this.plugins),r!==void 0&&this.loadTranslations(r)}static registerFunction(e,r,n){this.loadPluginFunction(r,e,this.plugins),n!==void 0&&this.loadTranslations(n)}static unregisterFunction(e){if(this.functionIsProtected(e))throw cu.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const r of this.protectedPlugins())if(r===e)throw cu.cannotUnregisterProtectedPlugin();for(const[r,n]of this.plugins.entries())n===e&&this.plugins.delete(r)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){if(!this.functionIsProtected(e))return this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(e){const r=new Set(Zr.getRegisteredLanguagesCodes());Object.keys(e).forEach(n=>{r.has(n)&&Zr.getLanguage(n).extendFunctions(e[n])})}static loadPluginFunctions(e,r){Object.keys(e.implementedFunctions).forEach(n=>{this.loadPluginFunction(e,n,r)}),e.aliases!==void 0&&Object.keys(e.aliases).forEach(n=>{this.loadPluginFunction(e,n,r)})}static loadPluginFunction(e,r,n){if(this.functionIsProtected(r))throw cu.cannotRegisterFunctionWithId(r);this.loadFunctionUnprotected(e,r,n)}static loadFunctionUnprotected(e,r,n){const i=H6(r,e).method;if(Object.prototype.hasOwnProperty.call(e.prototype,i))n.set(r,e);else throw jf.functionMethodNotFound(i,e.name)}static*protectedFunctions(){for(const[e,r]of this._protectedPlugins)r!==void 0&&(yield[e,r])}static*protectedPlugins(){for(const[,e]of this._protectedPlugins)e!==void 0&&(yield e)}initializePlugins(e){const r=[];for(const[n,i]of this.instancePlugins.entries()){let o=r.find(u=>u instanceof i);o===void 0&&(o=new i(e),r.push(o));const a=H6(n,i),s=a.method;this.functions.set(n,[s,o]);const l=a.arraySizeMethod;l!==void 0&&this.arraySizeFunctions.set(n,[l,o])}}getFunctionPlugin(e){if(!Hr.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){const r=this.functions.get(e);if(r!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[n,i]=r;return(o,a)=>i[n](o,a)}else return}getArraySizeFunction(e){const r=this.arraySizeFunctions.get(e);if(r!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[n,i]=r;return(o,a)=>i[n](o,a)}else return}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){const e=new Set;for(const[r,n]of this.instancePlugins)Hr.functionIsProtected(r)||e.add(n);return Array.from(e)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,r){r.isVolatile&&this.volatileFunctions.add(e),r.arrayFunction&&this.arrayFunctions.add(e),r.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),r.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,r)}}Hr.plugins=new Map;Hr._protectedPlugins=new Map([["VERSION",Qj],["OFFSET",void 0]]);/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var Yr;(function(t){t.GREATER_THAN="GREATER_THAN",t.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",t.LESS_THAN="LESS_THAN",t.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",t.NOT_EQUAL="NOT_EQUAL",t.EQUAL="EQUAL"})(Yr||(Yr={}));const qy=(t,e)=>({operator:t,value:e});class CPe{constructor(e){var r,n,i,o;this.trueString=(n=(r=e.translationPackage.getMaybeFunctionTranslation("TRUE"))===null||r===void 0?void 0:r.toLowerCase())!==null&&n!==void 0?n:"true",this.falseString=(o=(i=e.translationPackage.getMaybeFunctionTranslation("FALSE"))===null||i===void 0?void 0:i.toLowerCase())!==null&&o!==void 0?o:"false"}fromCellValue(e,r){if(typeof e!="string"&&typeof e!="boolean"&&typeof e!="number")return;const n=this.parseCriterion(e,r);if(n!==void 0)return{raw:e,lambda:_Pe(n,r)}}parseCriterion(e,r){if(typeof e=="number"||typeof e=="boolean")return qy(Yr.EQUAL,e);if(typeof e=="string"){const n=OPe.exec(e);let i,o;n?(o=TPe(n[1]),i=n[2]):(o=Yr.EQUAL,i=e);const a=r.coerceToMaybeNumber(i),s=i.toLowerCase()===this.trueString?!0:i.toLowerCase()===this.falseString?!1:void 0;if(o===void 0)return;if(i==="")return qy(o,null);if(a===void 0){if(o===Yr.EQUAL||o===Yr.NOT_EQUAL)return qy(o,s??i)}else return qy(o,ye(a))}}}const OPe=/([<>=]+)(.*)/;function TPe(t){switch(t){case">":return Yr.GREATER_THAN;case">=":return Yr.GREATER_THAN_OR_EQUAL;case"<":return Yr.LESS_THAN;case"<=":return Yr.LESS_THAN_OR_EQUAL;case"<>":return Yr.NOT_EQUAL;case"=":return Yr.EQUAL;default:return}}const _Pe=(t,e)=>{switch(t.operator){case Yr.GREATER_THAN:return typeof t.value=="number"?r=>typeof r=="number"&&e.floatCmp(r,t.value)>0:r=>!1;case Yr.GREATER_THAN_OR_EQUAL:return typeof t.value=="number"?r=>typeof r=="number"&&e.floatCmp(r,t.value)>=0:r=>!1;case Yr.LESS_THAN:return typeof t.value=="number"?r=>typeof r=="number"&&e.floatCmp(r,t.value)<0:r=>!1;case Yr.LESS_THAN_OR_EQUAL:return typeof t.value=="number"?r=>typeof r=="number"&&e.floatCmp(r,t.value)<=0:r=>!1;case Yr.EQUAL:return typeof t.value=="number"?r=>{if(typeof r=="number")return e.floatCmp(r,t.value)===0;if(typeof r=="string"){if(r==="")return!1;const n=e.coerceToMaybeNumber(r);return n===void 0?!1:e.floatCmp(n,t.value)===0}else return!1}:typeof t.value=="string"?e.eqMatcherFunction(t.value):typeof t.value=="boolean"?r=>typeof r=="boolean"&&r===t.value:r=>r===ft;case Yr.NOT_EQUAL:return typeof t.value=="number"?r=>{if(typeof r=="number")return e.floatCmp(r,t.value)!==0;if(typeof r=="string"){if(r==="")return!0;const n=e.coerceToMaybeNumber(r);return n===void 0?!0:e.floatCmp(n,t.value)!==0}else return!0}:typeof t.value=="string"?e.neqMatcherFunction(t.value):typeof t.value=="boolean"?r=>typeof r!="boolean"||r!==t.value:r=>r!==ft}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class APe{constructor(e,r,n,i,o,a,s,l,u,c){this.config=e,this.dependencyGraph=r,this.columnSearch=n,this.stats=i,this.arithmeticHelper=o,this.functionRegistry=a,this.namedExpressions=s,this.serialization=l,this.arraySizePredictor=u,this.dateTimeHelper=c,this.equalOp=(f,h)=>yi(this.arithmeticHelper.eq,f,h),this.notEqualOp=(f,h)=>yi(this.arithmeticHelper.neq,f,h),this.greaterThanOp=(f,h)=>yi(this.arithmeticHelper.gt,f,h),this.lessThanOp=(f,h)=>yi(this.arithmeticHelper.lt,f,h),this.greaterThanOrEqualOp=(f,h)=>yi(this.arithmeticHelper.geq,f,h),this.lessThanOrEqualOp=(f,h)=>yi(this.arithmeticHelper.leq,f,h),this.concatOp=(f,h)=>yi(this.arithmeticHelper.concat,E5(f),E5(h)),this.plusOp=(f,h)=>yi(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.minusOp=(f,h)=>yi(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.timesOp=(f,h)=>yi(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.powerOp=(f,h)=>yi(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.divOp=(f,h)=>yi(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.unaryMinusOp=f=>u9(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(f)),this.percentOp=f=>u9(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(f)),this.unaryPlusOp=f=>this.arithmeticHelper.unaryPlus(f),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new CPe(e)}evaluateAst(e,r){let n=this.evaluateAstWithoutPostprocessing(e,r);if(Rt(n)){if(Dj(ye(n)))return new C(N.NUM,x.NaN);n=dI(n,Fj(ye(n)))}return n instanceof Pe&&n.height()===1&&n.width()===1&&([[n]]=n.data),IPe(n,r.formulaVertex)}evaluateAstWithoutPostprocessing(e,r){switch(e.type){case P.EMPTY:return ft;case P.CELL_REFERENCE:{const n=e.reference.toSimpleCellAddress(r.formulaAddress);return Un(n)?new C(N.REF,x.BadRef):this.dependencyGraph.getCellValue(n)}case P.NUMBER:case P.STRING:return e.value;case P.CONCATENATE_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.concatOp,n,i,r)}case P.EQUALS_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.equalOp,n,i,r)}case P.NOT_EQUAL_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.notEqualOp,n,i,r)}case P.GREATER_THAN_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.greaterThanOp,n,i,r)}case P.LESS_THAN_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.lessThanOp,n,i,r)}case P.GREATER_THAN_OR_EQUAL_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,n,i,r)}case P.LESS_THAN_OR_EQUAL_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.lessThanOrEqualOp,n,i,r)}case P.PLUS_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.plusOp,n,i,r)}case P.MINUS_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.minusOp,n,i,r)}case P.TIMES_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.timesOp,n,i,r)}case P.POWER_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.powerOp,n,i,r)}case P.DIV_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.divOp,n,i,r)}case P.PLUS_UNARY_OP:{const n=this.evaluateAst(e.value,r);return this.unaryRangeWrapper(this.unaryPlusOp,n,r)}case P.MINUS_UNARY_OP:{const n=this.evaluateAst(e.value,r);return this.unaryRangeWrapper(this.unaryMinusOp,n,r)}case P.PERCENT_OP:{const n=this.evaluateAst(e.value,r);return this.unaryRangeWrapper(this.percentOp,n,r)}case P.FUNCTION_CALL:{if(this.config.licenseKeyValidityState!=="valid"&&!Hr.functionIsProtected(e.procedureName))return new C(N.LIC,x.LicenseKey(this.config.licenseKeyValidityState));const n=this.functionRegistry.getFunction(e.procedureName);return n!==void 0?n(e,new Po(r.formulaAddress,r.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),r.formulaVertex)):new C(N.NAME,x.FunctionName(e.procedureName))}case P.NAMED_EXPRESSION:{const n=this.namedExpressions.nearestNamedExpression(e.expressionName,r.formulaAddress.sheet);return n?this.dependencyGraph.getCellValue(n.address):new C(N.NAME,x.NamedExpressionName(e.expressionName))}case P.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new C(N.REF,x.RangeManySheets);const n=$e.fromCellRange(e,r.formulaAddress),i=this.dependencyGraph.getArray(n);if(i){const o=i.array;if(o instanceof yp)throw new Error("Array should be already computed");if(o instanceof C)return o;if(o instanceof Wf)return Pe.fromRange(o.raw(),n,this.dependencyGraph);throw new Error("Unknown array")}else return Pe.onlyRange(n,this.dependencyGraph)}case P.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new C(N.REF,x.RangeManySheets);const n=Fa.fromColumnRange(e,r.formulaAddress);return Pe.onlyRange(n,this.dependencyGraph)}case P.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new C(N.REF,x.RangeManySheets);const n=Ha.fromRowRangeAst(e,r.formulaAddress);return Pe.onlyRange(n,this.dependencyGraph)}case P.PARENTHESIS:return this.evaluateAst(e.expression,r);case P.ARRAY:{let n;const i=[];for(const o of e.args){let a;const s=[];for(const u of o){const c=$j(this.evaluateAst(u,r)),f=c.height();if(a===void 0)a=f,s.push(...c.data);else if(a===f)for(let h=0;h<f;h++)s[h].push(...c.data[h]);else return new C(N.REF,x.SizeMismatch)}const l=s[0].length;if(n===void 0)n=l,i.push(...s);else if(n===l)i.push(...s);else return new C(N.REF,x.SizeMismatch)}return Pe.onlyValues(i)}case P.ERROR_WITH_RAW_INPUT:case P.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(e,r,n){var i;if(r instanceof Pe&&!n.arraysFlag&&(r=(i=u0(r,n))!==null&&i!==void 0?i:new C(N.VALUE,x.ScalarExpected)),r instanceof C)return r;if(r instanceof Pe){const o=r.data.map(a=>a.map(e));return Pe.onlyValues(o)}return e(r)}binaryRangeWrapper(e,r,n,i){var o,a;if(r instanceof Pe&&!i.arraysFlag&&(r=(o=u0(r,i))!==null&&o!==void 0?o:new C(N.VALUE,x.ScalarExpected)),r instanceof C)return r;if(n instanceof Pe&&!i.arraysFlag&&(n=(a=u0(n,i))!==null&&a!==void 0?a:new C(N.VALUE,x.ScalarExpected)),n instanceof C)return n;if(r instanceof Pe||n instanceof Pe){if(!(r instanceof Pe))if(n.isAdHoc()){const c=n.data;for(let f=0;f<c.length;f++)for(let h=0;h<c[0].length;h++)c[f][h]=e(r,c[f][h]);return Pe.onlyValues(c)}else r=Pe.fromScalar(r);if(!(n instanceof Pe))if(r.isAdHoc()){const c=r.data;for(let f=0;f<c.length;f++)for(let h=0;h<c[0].length;h++)c[f][h]=e(c[f][h],n);return Pe.onlyValues(c)}else n=Pe.fromScalar(n);if(r.width()===n.width()&&r.height()===n.height()){if(r.isAdHoc()){const c=r.data,f=n.data;for(let h=0;h<c.length;h++)for(let d=0;d<c[0].length;d++)c[h][d]=e(c[h][d],f[h][d]);return Pe.onlyValues(c)}if(n.isAdHoc()){const c=r.data,f=n.data;for(let h=0;h<c.length;h++)for(let d=0;d<c[0].length;d++)f[h][d]=e(c[h][d],f[h][d]);return Pe.onlyValues(f)}}const s=Math.max(r.width(),n.width()),l=Math.max(r.height(),n.height()),u=Array(l);for(let c=0;c<l;c++)u[c]=Array(s);for(let c=0;c<l;c++){const f=r.height()!==1?c:0,h=n.height()!==1?c:0;for(let d=0;d<s;d++){const p=r.width()!==1?d:0,m=n.width()!==1?d:0;f<r.height()&&h<n.height()&&p<r.width()&&m<n.width()?u[c][d]=e(r.data[f][p],n.data[h][m]):u[c][d]=new C(N.NA)}}return Pe.onlyValues(u)}return e(r,n)}}function u9(t,e){return e instanceof C?e:t(e)}function yi(t,e,r){return e instanceof C?e:r instanceof C?r:t(e,r)}function IPe(t,e){return t instanceof C&&e!==void 0?t.attachRootVertex(e):t}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class NPe{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(e,r){this.transformations.forEach(n=>n.performEagerTransformations(e,r))}transformSingleAst(e,r){let[n,i]=[e,r];return this.transformations.forEach(o=>{[n,i]=o.transformSingleAst(n,i)}),[n,i]}isIrreversible(){return!0}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class PPe{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return this.combinedTransformer!==void 0?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new NPe(e)}commitCombinedMode(){if(this.combinedTransformer===void 0)throw Error("Combined mode wasn't started");return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(e,r,n){this.stats.start(Ke.TRANSFORM_ASTS_POSTPONED);for(let o=n;o<this.transformations.length;o++){const a=this.transformations[o];a.isIrreversible()&&(this.undoRedo.storeDataForVersion(o,r,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));const[s,l]=a.transformSingleAst(e,r);e=s,r=l}const i=this.parser.rememberNewAst(e);return this.stats.end(Ke.TRANSFORM_ASTS_POSTPONED),[i,r,this.transformations.length]}*getTransformationsFrom(e,r){for(let n=e;n<this.transformations.length;n++){const i=this.transformations[n];(!r||r(i))&&(yield i)}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const c0=-1;function MPe(t,e,{searchCoordinate:r,orderingDirection:n,matchExactly:i},o){const a=e.start[r],s=r==="col"?e.effectiveEndColumn(o):e.effectiveEndRow(o),l=r==="col"?h=>ye(o.getCellValue(Se(e.sheet,h,e.start.row))):h=>ye(o.getCellValue(Se(e.sheet,e.start.col,h))),u=n==="asc"?(h,d)=>c9(h,d):(h,d)=>-c9(h,d),c=kPe(h=>u(t,l(h))>=0,a,s),f=l(c);return c===c0||typeof f!=typeof t||i&&f!==t?c0:c-a}function kPe(t,e,r){let n=e,i=r;for(;n<i;){const o=Math.ceil((n+i)/2);t(o)?n=o:i=o-1}return n===i&&t(n)?n:c0}function c9(t,e){return typeof t==typeof e?t===ft?0:t<e?-1:t>e?1:0:t===ft?-1:e===ft?1:e instanceof C||typeof t=="number"&&typeof e=="string"||typeof t=="number"&&typeof e=="boolean"?-1:typeof t=="string"&&typeof e=="number"?1:typeof t=="string"&&typeof e=="boolean"?-1:1}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Zj{constructor(e){this.dependencyGraph=e}advancedFind(e,r){let n;const i=r.range;i===void 0?n=r.valuesFromTopLeftCorner():n=this.dependencyGraph.computeListOfValuesInRange(i);for(let o=0;o<n.length;o++)if(e(ye(n[o])))return o;return-1}basicFind(e,r,n,{ordering:i,matchExactly:o}){const a=typeof e=="string"?Hp(e):e,s=r.range;return s===void 0?this.findNormalizedValue(a,r.valuesFromTopLeftCorner()):i==="none"?this.findNormalizedValue(a,this.dependencyGraph.computeListOfValuesInRange(s)):MPe(a,s,{searchCoordinate:n,orderingDirection:i,matchExactly:o},this.dependencyGraph)}findNormalizedValue(e,r){return r.map(ye).map(n=>typeof n=="string"?Hp(n):n).indexOf(e)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Jj extends Zj{constructor(e){super(e),this.dependencyGraph=e}add(e,r){}remove(e,r){}change(e,r,n){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,r,n,i){}removeValues(e){}find(e,r,n){return this.basicFind(e,r,"row",n)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Al{constructor(e,r,n){this.dependencyGraph=e,this.config=r,this.stats=n,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new Jj(e)}add(e,r){if(!(e===ft||e instanceof C))if(e instanceof Pe)for(const[n,i]of e.entriesFromTopLeftCorner(r))this.addSingleCellValue(ye(n),i);else this.addSingleCellValue(e,r)}remove(e,r){if(e!==void 0)if(e instanceof Pe)for(const[n,i]of e.entriesFromTopLeftCorner(r))this.removeSingleValue(ye(n),i);else this.removeSingleValue(e,r)}change(e,r,n){e!==r&&(this.remove(e,n),this.add(r,n))}applyChanges(e){for(const r of e)r.oldValue!==void 0&&this.change(ye(r.oldValue),ye(r.value),r.address)}moveValues(e,r,n,i){for(const[o,a]of e){const s=rNe(a,i,r,n);this.remove(o,a),this.add(o,s)}}removeValues(e){for(const[r,n]of e)this.remove(r,n)}find(e,r,{ordering:n,matchExactly:i}){const o=i===!0?"findFirst":"findLast",a=this.findUsingColumnIndex(e,r,o);return a!==void 0?a:this.binarySearchStrategy.find(e,r,{ordering:n,matchExactly:i})}findUsingColumnIndex(e,r,n){const i=r.range;if(i===void 0)return;this.ensureRecentData(i.sheet,i.start.col,e);const o=this.getColumnMap(i.sheet,i.start.col);if(!o)return-1;const a=typeof e=="string"?Hp(e):e,s=o.get(a);if(!s||!s.index||s.index.length===0)return;const l=Al.findRowBelongingToRange(s,i,n);return l!==void 0?l-i.start.row:void 0}static findRowBelongingToRange(e,r,n){const i=r.start.row,o=r.end.row,a=n==="findFirst"?fl(i,e.index,"upperBound"):fl(o,e.index,"lowerBound");if(a===-1)return;const s=e.index[a];return s>=i&&s<=o?s:void 0}advancedFind(e,r){return this.binarySearchStrategy.advancedFind(e,r)}addColumns(e){const r=this.index.get(e.sheet);r&&r.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){const r=this.index.get(e.sheet);r&&r.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,r){this.index.has(e)||this.index.set(e,[]);const n=this.index.get(e);let i=n[r];return i||(i=new Map,n[r]=i),i}getValueIndex(e,r,n){const i=this.getColumnMap(e,r);let o=this.getColumnMap(e,r).get(n);return o||(o={version:this.transformingService.version(),index:[]},i.set(n,o)),o}ensureRecentData(e,r,n){const i=this.getValueIndex(e,r,n),o=this.transformingService.version();if(i.version===o)return;const a=this.transformingService.getTransformationsFrom(i.version,s=>s.sheet===e&&(s instanceof _5||s instanceof A5));for(const s of a)s instanceof _5?this.addRows(r,s.rowsSpan,n):s instanceof A5&&this.removeRows(r,s.rowsSpan,n);i.version=o}addSingleCellValue(e,r){this.stats.measure(Ke.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(r.sheet,r.col,e),typeof e=="string"&&(e=Hp(e));const n=this.getValueIndex(r.sheet,r.col,e);Al.addValue(n,r.row)})}removeSingleValue(e,r){this.stats.measure(Ke.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(r.sheet,r.col,e);const n=this.getColumnMap(r.sheet,r.col);typeof e=="string"&&(e=Hp(e));const i=n.get(e);if(!i)return;const o=fl(r.row,i.index);o>-1&&i.index.splice(o,1),i.index.length===0&&n.delete(e),n.size===0&&delete this.index.get(r.sheet)[r.col]})}addRows(e,r,n){const i=this.getValueIndex(r.sheet,e,n);Al.shiftRows(i,r.rowStart,r.numberOfRows)}removeRows(e,r,n){const i=this.getValueIndex(r.sheet,e,n);Al.removeRowsFromValues(i,r),Al.shiftRows(i,r.rowEnd+1,-r.numberOfRows)}static addValue(e,r){const n=fl(r,e.index,"lowerBound");e.index[n]===r||e.index.splice(n+1,0,r)}static removeRowsFromValues(e,r){const n=fl(r.rowStart,e.index,"upperBound"),i=fl(r.rowEnd,e.index,"lowerBound");n>-1&&i>-1&&n<=i&&e.index[n]<=r.rowEnd&&e.index.splice(n,i-n+1)}static shiftRows(e,r,n){const i=fl(r,e.index,"upperBound");if(i!==-1)for(let o=i;o<e.index.length;++o)e.index[o]+=n}}function fl(t,e,r="upperBound"){let n=0,i=e.length-1;for(;n<=i;){const s=Math.floor((n+i)/2);if(t>e[s])n=s+1;else if(t<e[s])i=s-1;else return s}const o=r==="lowerBound"?i:n;return o>=0&&o<=e.length?o:-1}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function xPe(t,e,r){return e.useColumnIndex?new Al(t,e,r):new Jj(t)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class $Pe{constructor(e){this.config=e;const r=this.config.thousandSeparator==="."?`\\${this.config.thousandSeparator}`:this.config.thousandSeparator,n=this.config.decimalSeparator==="."?`\\${this.config.decimalSeparator}`:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${n}\\d+)|(\\d+(${r}\\d{3,})*(${n}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(`${r}`,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e)){const r=this.numericStringToNumber(e);return isNaN(r)?void 0:r}}numericStringToNumber(e){const r=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(r)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class wI{constructor(e,r,n){this.dependencyGraph=e,this.unparser=r,this.exporter=n}getCellHyperlink(e){const r=this.dependencyGraph.getCell(e);if(r instanceof Io){const n=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(n.procedureName==="HYPERLINK")return n.hyperlink}}getCellFormula(e,r){const n=this.dependencyGraph.getCell(e);if(n instanceof Io){const i=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);return r=r??e,this.unparser.unparse(i,r)}else if(n instanceof yr){const i=n.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(i.row!==e.row||i.col!==e.col||i.sheet!==e.sheet)return;r=r??e;const o=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(o!==void 0)return this.unparser.unparse(o,r)}else if(n instanceof Kc)return n.getFormula()}getCellSerialized(e,r){var n;return(n=this.getCellFormula(e,r))!==null&&n!==void 0?n:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,r=>this.getCellValue(r))}getSheetFormulas(e){return this.genericSheetGetter(e,r=>this.getCellFormula(r))}genericSheetGetter(e,r){const n=this.dependencyGraph.getSheetHeight(e),i=this.dependencyGraph.getSheetWidth(e),o=new Array(n);for(let a=0;a<n;a++){o[a]=new Array(i);for(let s=0;s<i;s++){const l=Se(e,s,a);o[a][s]=r(l)}for(let s=i-1;s>=0&&(o[a][s]===null||o[a][s]===void 0);s--)o[a].pop()}for(let a=n-1;a>=0&&o[a].length===0;a--)o.pop();return o}genericAllSheetsGetter(e){const r={};for(const n of this.dependencyGraph.sheetMapping.displayNames()){const i=this.dependencyGraph.sheetMapping.fetch(n);r[n]=e(i)}return r}getSheetSerialized(e){return this.genericSheetGetter(e,r=>this.getCellSerialized(r))}getAllSheetsValues(){return this.genericAllSheetsGetter(e=>this.getSheetValues(e))}getAllSheetsFormulas(){return this.genericAllSheetsGetter(e=>this.getSheetFormulas(e))}getAllSheetsSerialized(){return this.genericAllSheetsGetter(e=>this.getSheetSerialized(e))}getAllNamedExpressionsSerialized(){const e=[];let r=0;for(const n of this.dependencyGraph.sheetMapping.displayNames()){const i=this.dependencyGraph.sheetMapping.fetch(n);e[i]=r,r++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map(n=>({name:n.expression.displayName,expression:this.getCellSerialized(n.expression.address),scope:n.scope!==void 0?e[n.scope]:void 0,options:n.expression.options}))}withNewConfig(e,r){const n=new pj(e,hI(e),this.dependencyGraph.sheetMapping.fetchDisplayName,r);return new wI(this.dependencyGraph,n,this.exporter)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Qy{static buildFromSheets(e,r={},n=[]){const i=new on(r);return this.buildEngine(i,e,n)}static buildFromSheet(e,r={},n=[]){const i=new on(r),o=i.translationPackage.getUITranslation(bv.NEW_SHEET_PREFIX)+"1";return this.buildEngine(i,{[o]:e},n)}static buildEmpty(e={},r=[]){return this.buildEngine(new on(e),{},r)}static rebuildWithConfig(e,r,n,i){return this.buildEngine(e,r,n,i)}static buildEngine(e,r={},n=[],i=e.useStats?new gj:new k4e){i.start(Ke.BUILD_ENGINE_TOTAL);const o=new Cu,a=new Hr(e),s=new PPe(i),l=yI.buildEmpty(s,e,a,o,i),u=xPe(l,e,i),c=l.sheetMapping,f=l.addressMapping;for(const ee in r)if(Object.prototype.hasOwnProperty.call(r,ee)){const ae=r[ee];Gj(ae);const ne=e2(ae);if(ne.height>e.maxRows||ne.width>e.maxColumns)throw new uu;const ue=c.addSheet(ee);f.autoAddSheet(ue,ae,ne)}const h=new Fp(e,a,c.get);s.parser=h;const d=new pj(e,hI(e),c.fetchDisplayName,o),p=new wNe(e),m=new $Pe(e),y=new uNe(e,p,m),S=new BNe(e,p,m),R=new vNe(e,a),E=new qNe(e,l,u,S,h,i,s,o,R),O=new yPe(e,E);s.undoRedo=O;const A=new VNe(e,l,E),B=new bPe(e,E,O,A,l,u,h,S,s,o);n.forEach(ee=>{B.ensureItIsPossibleToAddNamedExpression(ee.name,ee.expression,ee.scope),B.operations.addNamedExpression(ee.name,ee.expression,ee.scope,ee.options)});const j=new SPe(e,o,c.fetchDisplayName,s),J=new wI(l,d,j),Y=new APe(e,l,u,i,y,a,o,J,R,p);i.measure(Ke.GRAPH_BUILD,()=>{new RPe(l,u,h,S,i,R).buildGraph(r,i)});const q=new wPe(e,i,Y,s,l,u);return q.run(),i.end(Ke.BUILD_ENGINE_TOTAL),{config:e,stats:i,dependencyGraph:l,columnSearch:u,parser:h,unparser:d,cellContentParser:S,evaluator:q,lazilyTransformingAstService:s,crudOperations:B,exporter:j,namedExpressions:o,serialization:J,functionRegistry:a}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function LPe(t){for(const[e,r]of Object.entries(t))r instanceof Function?t[e]=DPe(r):delete t[e]}function DPe(t){return()=>{throw new Error(`The "${t}" method cannot be called because this HyperFormula instance has been destroyed`)}}var eW={exports:{}};function SI(){}SI.prototype={on:function(t,e,r){var n=this.e||(this.e={});return(n[t]||(n[t]=[])).push({fn:e,ctx:r}),this},once:function(t,e,r){var n=this;function i(){n.off(t,i),e.apply(r,arguments)}return i._=e,this.on(t,i,r)},emit:function(t){var e=[].slice.call(arguments,1),r=((this.e||(this.e={}))[t]||[]).slice(),n=0,i=r.length;for(n;n<i;n++)r[n].fn.apply(r[n].ctx,e);return this},off:function(t,e){var r=this.e||(this.e={}),n=r[t],i=[];if(n&&e)for(var o=0,a=n.length;o<a;o++)n[o].fn!==e&&n[o].fn._!==e&&i.push(n[o]);return i.length?r[t]=i:delete r[t],this}};eW.exports=SI;var FPe=eW.exports.TinyEmitter=SI;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var So;(function(t){t.SheetAdded="sheetAdded",t.SheetRemoved="sheetRemoved",t.SheetRenamed="sheetRenamed",t.NamedExpressionAdded="namedExpressionAdded",t.NamedExpressionRemoved="namedExpressionRemoved",t.ValuesUpdated="valuesUpdated",t.EvaluationSuspended="evaluationSuspended",t.EvaluationResumed="evaluationResumed"})(So||(So={}));class HPe extends FPe{emit(e,...r){return super.emit(e,...r),this}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Zr{constructor(e,r,n,i,o,a,s,l,u,c,f,h,d,p){this._config=e,this._stats=r,this._dependencyGraph=n,this._columnSearch=i,this._parser=o,this._unparser=a,this._cellContentParser=s,this._evaluator=l,this._lazilyTransformingAstService=u,this._crudOperations=c,this._exporter=f,this._namedExpressions=h,this._serialization=d,this._functionRegistry=p,this._emitter=new HPe,this._evaluationSuspended=!1}static get defaultConfig(){return UPe()}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,r={},n=[]){return this.buildFromEngineState(Qy.buildFromSheet(e,r,n))}static buildFromSheets(e,r={},n=[]){return this.buildFromEngineState(Qy.buildFromSheets(e,r,n))}static buildEmpty(e={},r=[]){return this.buildFromEngineState(Qy.buildEmpty(e,r))}static getLanguage(e){he(e,"string","languageCode");const r=this.registeredLanguages.get(e);if(r===void 0)throw new b5;return r}static registerLanguage(e,r){if(he(e,"string","languageCode"),this.registeredLanguages.has(e))throw new Pj;this.registeredLanguages.set(e,G4e(r))}static unregisterLanguage(e){if(he(e,"string","languageCode"),this.registeredLanguages.has(e))this.registeredLanguages.delete(e);else throw new b5}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,r){Hr.registerFunctionPlugin(e,r)}static unregisterFunctionPlugin(e){Hr.unregisterFunctionPlugin(e)}static registerFunction(e,r,n){he(e,"string","functionId"),Hr.registerFunction(e,r,n)}static unregisterFunction(e){he(e,"string","functionId"),Hr.unregisterFunction(e)}static unregisterAllFunctions(){Hr.unregisterAll()}static getRegisteredFunctionNames(e){he(e,"string","code");const r=Hr.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(r)}static getFunctionPlugin(e){return he(e,"string","functionId"),Hr.getFunctionPlugin(e)}static getAllFunctionPlugins(){return Hr.getPlugins()}static buildFromEngineState(e){return new Zr(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if(!gr(e))throw new St("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}getCellFormula(e){if(!gr(e))throw new St("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}getCellHyperlink(e){if(!gr(e))throw new St("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellHyperlink(e)}getCellSerialized(e){if(!gr(e))throw new St("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}getSheetValues(e){return he(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return he(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return he(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter(e=>this.getSheetDimensions(e))}getSheetDimensions(e){return he(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){Object.entries(e).every(([n,i])=>this._config[n]===i)||this.rebuildWithConfig(e)}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.rebuildWithConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let r;if(gr(e))r=new $e(e,e);else if(qn(e))r=new $e(e.start,e.end);else throw new St("SimpleCellAddress | SimpleCellRange","address");try{this._crudOperations.ensureRangeInSizeLimits(r);for(const n of r.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(n)}catch{return!1}return!0}setCellContents(e,r){return this._crudOperations.setCellContents(e,r),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,r){return he(e,"number","sheetId"),this._crudOperations.setRowOrder(e,r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,r){he(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,r),this._crudOperations.testRowOrderForArrays(e,r),!0}catch{return!1}}setRowOrder(e,r){he(e,"number","sheetId");const n=this._crudOperations.mappingFromOrder(e,r,"row");return this.swapRowIndexes(e,n)}isItPossibleToSetRowOrder(e,r){he(e,"number","sheetId");try{const n=this._crudOperations.mappingFromOrder(e,r,"row");return this._crudOperations.validateSwapRowIndexes(e,n),this._crudOperations.testRowOrderForArrays(e,n),!0}catch{return!1}}swapColumnIndexes(e,r){return he(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,r){he(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,r),this._crudOperations.testColumnOrderForArrays(e,r),!0}catch{return!1}}setColumnOrder(e,r){he(e,"number","sheetId");const n=this._crudOperations.mappingFromOrder(e,r,"column");return this.swapColumnIndexes(e,n)}isItPossibleToSetColumnOrder(e,r){he(e,"number","sheetId");try{const n=this._crudOperations.mappingFromOrder(e,r,"column");return this._crudOperations.validateSwapColumnIndexes(e,n),this._crudOperations.testColumnOrderForArrays(e,n),!0}catch{return!1}}isItPossibleToAddRows(e,...r){he(e,"number","sheetId");const n=r2(r);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...n),!0}catch{return!1}}addRows(e,...r){return he(e,"number","sheetId"),this._crudOperations.addRows(e,...r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...r){he(e,"number","sheetId");const n=t2(r);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...n),!0}catch{return!1}}removeRows(e,...r){return he(e,"number","sheetId"),this._crudOperations.removeRows(e,...r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...r){he(e,"number","sheetId");const n=r2(r);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...n),!0}catch{return!1}}addColumns(e,...r){return he(e,"number","sheetId"),this._crudOperations.addColumns(e,...r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...r){he(e,"number","sheetId");const n=t2(r);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...n),!0}catch{return!1}}removeColumns(e,...r){return he(e,"number","sheetId"),this._crudOperations.removeColumns(e,...r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,r){if(!gr(r))throw new St("SimpleCellAddress","destinationLeftCorner");if(!qn(e))throw new St("SimpleCellRange","source");try{const n=new $e(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(n.start,n.width(),n.height(),r),!0}catch{return!1}}moveCells(e,r){if(!gr(r))throw new St("SimpleCellAddress","destinationLeftCorner");if(!qn(e))throw new St("SimpleCellRange","source");const n=new $e(e.start,e.end);return this._crudOperations.moveCells(n.start,n.width(),n.height(),r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveRows(e,r,n,i){he(e,"number","sheetId"),he(r,"number","startRow"),he(n,"number","numberOfRows"),he(i,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,r,n,i),!0}catch{return!1}}moveRows(e,r,n,i){return he(e,"number","sheetId"),he(r,"number","startRow"),he(n,"number","numberOfRows"),he(i,"number","targetRow"),this._crudOperations.moveRows(e,r,n,i),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,r,n,i){he(e,"number","sheetId"),he(r,"number","startColumn"),he(n,"number","numberOfColumns"),he(i,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,r,n,i),!0}catch{return!1}}moveColumns(e,r,n,i){return he(e,"number","sheetId"),he(r,"number","startColumn"),he(n,"number","numberOfColumns"),he(i,"number","targetColumn"),this._crudOperations.moveColumns(e,r,n,i),this.recomputeIfDependencyGraphNeedsIt()}copy(e){if(!qn(e))throw new St("SimpleCellRange","source");const r=new $e(e.start,e.end);return this._crudOperations.copy(r.start,r.width(),r.height()),this.getRangeValues(e)}cut(e){if(!qn(e))throw new St("SimpleCellRange","source");const r=new $e(e.start,e.end);return this._crudOperations.cut(r.start,r.width(),r.height()),this.getRangeValues(e)}paste(e){if(!gr(e))throw new St("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if(!qn(e))throw new St("SimpleCellRange","source");return new $e(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(i=>this.getCellValue(i)))}getRangeFormulas(e){if(!qn(e))throw new St("SimpleCellRange","source");return new $e(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(i=>this.getCellFormula(i)))}getRangeSerialized(e){if(!qn(e))throw new St("SimpleCellRange","source");return new $e(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(i=>this.getCellSerialized(i)))}getFillRangeData(e,r,n=!1){if(!qn(e))throw new St("SimpleCellRange","source");if(!qn(r))throw new St("SimpleCellRange","target");const i=new $e(e.start,e.end),o=new $e(r.start,r.end);return this.ensureEvaluationIsNotSuspended(),o.arrayOfAddressesInRange().map(a=>a.map(s=>{const l=((s.row-(n?r:e).start.row)%i.height()+i.height())%i.height()+e.start.row,u=((s.col-(n?r:e).start.col)%i.width()+i.width())%i.width()+e.start.col;return this._serialization.getCellSerialized({row:l,col:u,sheet:i.sheet},s)}))}isItPossibleToAddSheet(e){he(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch{return!1}}addSheet(e){e!==void 0&&he(e,"string","sheetName");const r=this._crudOperations.addSheet(e);return this._emitter.emit(So.SheetAdded,r),r}isItPossibleToRemoveSheet(e){he(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}removeSheet(e){he(e,"number","sheetId");const r=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);const n=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(So.SheetRemoved,r,n),n}isItPossibleToClearSheet(e){he(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}clearSheet(e){return he(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,r){he(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,r),!0}catch{return!1}}setSheetContent(e,r){return he(e,"number","sheetId"),this._crudOperations.setSheetContent(e,r),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,r){return he(e,"string","cellAddress"),he(r,"number","sheetId"),o5(this.sheetMapping.get,e,r)}simpleCellRangeFromString(e,r){return he(e,"string","cellRange"),he(r,"number","sheetId"),kAe(this.sheetMapping.get,e,r)}simpleCellAddressToString(e,r){if(!gr(e))throw new St("SimpleCellAddress","cellAddress");return he(r,"number","sheetId"),$b(this.sheetMapping.fetchDisplayName,e,r)}simpleCellRangeToString(e,r){if(!qn(e))throw new St("SimpleCellRange","cellRange");return he(r,"number","sheetId"),xAe(this.sheetMapping.fetchDisplayName,e,r)}getCellDependents(e){let r;if(gr(e))r=this._dependencyGraph.addressMapping.getCell(e);else if(qn(e))r=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new St("SimpleCellAddress | SimpleCellRange",e);return r===void 0?[]:this._dependencyGraph.getAdjacentNodesAddresses(r)}getCellPrecedents(e){let r;if(gr(e))r=this._dependencyGraph.addressMapping.getCell(e);else if(qn(e))r=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new St("SimpleCellAddress | SimpleCellRange",e);return r===void 0?[]:this._dependencyGraph.dependencyQueryAddresses(r)}getSheetName(e){return he(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return he(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return he(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){if(!gr(e))throw new St("SimpleCellAddress","cellAddress");const r=this.dependencyGraph.getCell(e);return q4e(r,e)}doesCellHaveSimpleValue(e){if(!gr(e))throw new St("SimpleCellAddress","cellAddress");return this.getCellType(e)===Dn.VALUE}doesCellHaveFormula(e){if(!gr(e))throw new St("SimpleCellAddress","cellAddress");const r=this.getCellType(e);return r===Dn.FORMULA||r===Dn.ARRAYFORMULA}isCellEmpty(e){if(!gr(e))throw new St("SimpleCellAddress","cellAddress");return this.getCellType(e)===Dn.EMPTY}isCellPartOfArray(e){if(!gr(e))throw new St("SimpleCellAddress","cellAddress");const r=this.getCellType(e);return r===Dn.ARRAY||r===Dn.ARRAYFORMULA}getCellValueType(e){if(!gr(e))throw new St("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const r=this.dependencyGraph.getCellValue(e);return qb(r)}getCellValueDetailedType(e){if(!gr(e))throw new St("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const r=this.dependencyGraph.getCellValue(e);return Z4e(r)}getCellValueFormat(e){if(!gr(e))throw new St("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const r=this.dependencyGraph.getCellValue(e);return J4e(r)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,r){he(e,"number","sheetId"),he(r,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,r),!0}catch{return!1}}renameSheet(e,r){he(e,"number","sheetId"),he(r,"string","newName");const n=this._crudOperations.renameSheet(e,r);n!==void 0&&this._emitter.emit(So.SheetRenamed,n,r)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(r){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),r}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(So.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(So.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,r,n){he(e,"string","expressionName"),n!==void 0&&he(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,r,n),!0}catch{return!1}}addNamedExpression(e,r,n,i){he(e,"string","expressionName"),n!==void 0&&he(n,"number","scope"),this._crudOperations.addNamedExpression(e,r,n,i);const o=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(So.NamedExpressionAdded,e,o),o}getNamedExpressionValue(e,r){he(e,"string","expressionName"),r!==void 0&&he(r,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(r);const n=this._namedExpressions.namedExpressionForScope(e,r);if(n)return this._serialization.getCellValue(n.address)}getNamedExpressionFormula(e,r){he(e,"string","expressionName"),r!==void 0&&he(r,"number","scope"),this._crudOperations.ensureScopeIdIsValid(r);const n=this._namedExpressions.namedExpressionForScope(e,r);if(n!==void 0)return this._serialization.getCellFormula(n.address)}getNamedExpression(e,r){he(e,"string","expressionName"),r!==void 0&&he(r,"number","scope");const n=this._namedExpressions.namedExpressionForScope(e,r);if(n===void 0)return;const i=this._serialization.getCellFormula(n.address);return{name:e,scope:r,expression:i,options:n.options}}isItPossibleToChangeNamedExpression(e,r,n){he(e,"string","expressionName"),n!==void 0&&he(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,r,n),!0}catch{return!1}}changeNamedExpression(e,r,n,i){return he(e,"string","expressionName"),n!==void 0&&he(n,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,n,r,i),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,r){he(e,"string","expressionName"),r!==void 0&&he(r,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,r),!0}catch{return!1}}removeNamedExpression(e,r){he(e,"string","expressionName"),r!==void 0&&he(r,"number","scope");const n=this._crudOperations.removeNamedExpression(e,r);if(n){const i=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(So.NamedExpressionRemoved,n.displayName,i),i}else return[]}listNamedExpressions(e){return e!==void 0&&he(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){he(e,"string","formulaString");const{ast:r,address:n}=this.extractTemporaryFormula(e);if(r===void 0)throw new y5;return this._unparser.unparse(r,n)}calculateFormula(e,r){he(e,"string","formulaString"),he(r,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(r);const{ast:n,address:i,dependencies:o}=this.extractTemporaryFormula(e,r);if(n===void 0)throw new y5;const a=this.evaluator.runAndForget(n,i,o);return this._exporter.exportScalarOrRange(a)}validateFormula(e){he(e,"string","formulaString");const{ast:r}=this.extractTemporaryFormula(e);return!(r===void 0||r.type===P.ERROR&&!r.error)}getRegisteredFunctionNames(){return Zr.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return he(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return he(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return he(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return he(e,"number","val"),Xc(e)}on(e,r){this._emitter.on(e,r)}once(e,r){this._emitter.once(e,r)}off(e,r){this._emitter.off(e,r)}destroy(){LPe(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new Ij}extractTemporaryFormula(e,r=1){const n=this._cellContentParser.parse(e),i={sheet:r,col:0,row:0};if(!(n instanceof tr.Formula))return{address:i,dependencies:[]};const{ast:o,errors:a,dependencies:s}=this._parser.parse(n.formula,i);return a.length>0?{address:i,dependencies:[]}:{ast:o,address:i,dependencies:s}}rebuildWithConfig(e){const r=this._config.mergeConfig(e),n=this._config.mergeConfig({language:e.language}),i=this._serialization.withNewConfig(n,this._namedExpressions).getAllSheetsSerialized(),o=this._serialization.getAllNamedExpressionsSerialized(),a=Qy.rebuildWithConfig(r,i,o,this._stats);this._config=a.config,this._stats=a.stats,this._dependencyGraph=a.dependencyGraph,this._columnSearch=a.columnSearch,this._parser=a.parser,this._unparser=a.unparser,this._cellContentParser=a.cellContentParser,this._evaluator=a.evaluator,this._lazilyTransformingAstService=a.lazilyTransformingAstService,this._crudOperations=a.crudOperations,this._exporter=a.exporter,this._namedExpressions=a.namedExpressions,this._serialization=a.serialization,this._functionRegistry=a.functionRegistry}recomputeIfDependencyGraphNeedsIt(){if(this._evaluationSuspended)return[];{const e=this._crudOperations.getAndClearContentChanges(),r=Array.from(this.dependencyGraph.verticesToRecompute());this.dependencyGraph.clearRecentlyChangedVertices(),r.length>0&&e.addAll(this.evaluator.partialRun(r));const n=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(So.ValuesUpdated,n),n}}}Zr.version="2.5.0";Zr.buildDate="29/05/2023 09:32:33";Zr.releaseDate="29/05/2023";Zr.languages={};Zr.registeredLanguages=new Map;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const f9=new WeakMap;class on{constructor(e={},r=!0){const{accentSensitive:n,binarySearchThreshold:i,caseSensitive:o,caseFirst:a,chooseAddressMappingPolicy:s,currencySymbol:l,dateFormats:u,decimalSeparator:c,evaluateNullToZero:f,functionArgSeparator:h,functionPlugins:d,ignorePunctuation:p,leapYear1900:m,localeLang:y,language:S,ignoreWhiteSpace:R,licenseKey:E,matchWholeCell:O,arrayColumnSeparator:A,arrayRowSeparator:B,maxRows:j,maxColumns:J,nullYear:Y,nullDate:q,parseDateTime:ee,precisionEpsilon:ae,precisionRounding:ne,stringifyDateTime:ue,stringifyDuration:me,smartRounding:Re,timeFormats:ge,thousandSeparator:I,useArrayArithmetic:v,useStats:b,undoLimit:w,useColumnIndex:_,useRegularExpressions:M,useWildcards:L}=e;r&&on.warnDeprecatedOptions(e),this.useArrayArithmetic=Mt(v,"boolean","useArrayArithmetic"),this.accentSensitive=Mt(n,"boolean","accentSensitive"),this.caseSensitive=Mt(o,"boolean","caseSensitive"),this.caseFirst=Mt(a,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=Mt(p,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=s??on.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...Gy(u,Array.isArray,"array","dateFormats")],this.timeFormats=[...Gy(ge,Array.isArray,"array","timeFormats")],this.functionArgSeparator=Mt(h,"string","functionArgSeparator"),this.decimalSeparator=Mt(c,[".",","],"decimalSeparator"),this.language=Mt(S,"string","language"),this.ignoreWhiteSpace=Mt(R,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=Mt(E,"string","licenseKey"),this.thousandSeparator=Mt(I,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=Mt(A,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=Mt(B,[";","|"],"arrayRowSeparator"),this.localeLang=Mt(y,"string","localeLang"),this.functionPlugins=[...d??on.defaultConfig.functionPlugins],this.smartRounding=Mt(Re,"boolean","smartRounding"),this.evaluateNullToZero=Mt(f,"boolean","evaluateNullToZero"),this.nullYear=Mt(Y,"number","nullYear"),ic(this.nullYear,"nullYear",0),gNe(this.nullYear,"nullYear",100),this.precisionRounding=Mt(ne,"number","precisionRounding"),ic(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=Mt(ae,"number","precisionEpsilon"),ic(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=Mt(_,"boolean","useColumnIndex"),this.useStats=Mt(b,"boolean","useStats"),this.binarySearchThreshold=i??on.defaultConfig.binarySearchThreshold,this.parseDateTime=Mt(ee,"function","parseDateTime"),this.stringifyDateTime=Mt(ue,"function","stringifyDateTime"),this.stringifyDuration=Mt(me,"function","stringifyDuration"),this.translationPackage=Zr.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=Gy(q,Up,"IDate","nullDate"),this.leapYear1900=Mt(m,"boolean","leapYear1900"),this.undoLimit=Mt(w,"number","undoLimit"),this.useRegularExpressions=Mt(M,"boolean","useRegularExpressions"),this.useWildcards=Mt(L,"boolean","useWildcards"),this.matchWholeCell=Mt(O,"boolean","matchWholeCell"),ic(this.undoLimit,"undoLimit",0),this.maxRows=Mt(j,"number","maxRows"),ic(this.maxRows,"maxRows",1),this.maxColumns=Mt(J,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(l),ic(this.maxColumns,"maxColumns",1),f9.set(this,{licenseKeyValidityState:LNe(this.licenseKey)}),QM({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),QM({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){const r=[...Gy(e,Array.isArray,"array","currencySymbol")];return r.forEach(n=>{if(typeof n!="string")throw new St("string[]","currencySymbol");if(n==="")throw new $4e("currencySymbol")}),r}get licenseKeyValidityState(){return f9.get(this).licenseKeyValidityState}getConfig(){return tW(this)}mergeConfig(e){const r=Object.assign({},this.getConfig(),e);return on.warnDeprecatedOptions(e),new on(r,!1)}static warnDeprecatedOptions(e){on.warnDeprecatedIfUsed(e.binarySearchThreshold,"binarySearchThreshold","1.1")}static warnDeprecatedIfUsed(e,r,n,i){e!==void 0&&console.warn(i===void 0?`${r} option is deprecated since ${n}`:`${r} option is deprecated since ${n}, please use ${i}`)}}on.defaultConfig={accentSensitive:!1,binarySearchThreshold:20,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",chooseAddressMappingPolicy:new CNe,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:yNe,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,stringifyDateTime:MNe,stringifyDuration:PNe,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};function tW(t){var e;const r={};for(const n in on.defaultConfig){const i=(e=t[n])!==null&&e!==void 0?e:on.defaultConfig[n];Array.isArray(i)?r[n]=[...i]:r[n]=i}return r}function UPe(){return tW({})}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const N5={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ADDRESS:"ADDRESS",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",HYPERLINK:"HYPERLINK",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",IFS:"IFS",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var ms;(function(t){t[t.FullyAbsolute=1]="FullyAbsolute",t[t.RowAbsoluteColRelative=2]="RowAbsoluteColRelative",t[t.RowRelativeColAbsolute=3]="RowRelativeColAbsolute",t[t.FullyRelative=4]="FullyRelative"})(ms||(ms={}));class rW extends Qe{verifyAddressArguments(e,r,n,i){if(i){if(e<1||r<1)return new C(N.VALUE,x.LessThanOne)}else if(ms.FullyAbsolute==n){if(e<1||r<1)return new C(N.VALUE,x.LessThanOne)}else if(ms.RowAbsoluteColRelative==n){if(e<1)return new C(N.VALUE,x.LessThanOne)}else if(ms.RowRelativeColAbsolute==n&&r<1)return new C(N.VALUE,x.LessThanOne)}address(e,r){return this.runFunction(e.args,r,this.metadata("ADDRESS"),(n,i,o,a,s)=>{const l=this.verifyAddressArguments(n,i,o,a);if(l!==void 0)return l;const u=Tw(i-1);let c="";s!=null&&(c=`${s}!`);const f=i==0?"C":`C[${i}]`,h=n==0?"R":`R[${n}]`;return ms.FullyRelative==o?a?`${c}${u}${n}`:`${c}${h}${f}`:ms.RowRelativeColAbsolute==o?a?`${c}$${u}${n}`:`${c}${h}C${i}`:ms.RowAbsoluteColRelative==o?a?`${c}${u}$${n}`:`${c}R${n}${f}`:a?`${c}$${u}$${n}`:`${c}R${n}C${i}`})}}rW.implementedFunctions={ADDRESS:{method:"address",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0,defaultValue:1,minValue:1,maxValue:4},{argumentType:g.BOOLEAN,optionalArg:!0,defaultValue:!0},{argumentType:g.STRING,optionalArg:!0}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class nW extends Qe{arrayformula(e,r){return this.runFunction(e.args,r,this.metadata("ARRAYFORMULA"),n=>n)}arrayformulaArraySize(e,r){if(e.args.length!==1)return it.error();const n=this.metadata("ARRAYFORMULA");return e.args.map(o=>{var a;return this.arraySizeForAst(o,new Po(r.formulaAddress,r.arraysFlag||((a=n==null?void 0:n.arrayFunction)!==null&&a!==void 0?a:!1)))})[0]}arrayconstrain(e,r){return this.runFunction(e.args,r,this.metadata("ARRAY_CONSTRAIN"),(n,i,o)=>{i=Math.min(i,n.height()),o=Math.min(o,n.width());const a=n.data,s=[];for(let l=0;l<i;l++)s.push(a[l].slice(0,o));return Pe.onlyValues(s)})}arrayconstrainArraySize(e,r){if(e.args.length!==3)return it.error();const n=this.metadata("ARRAY_CONSTRAIN"),i=e.args.map(s=>{var l;return this.arraySizeForAst(s,new Po(r.formulaAddress,r.arraysFlag||((l=n==null?void 0:n.arrayFunction)!==null&&l!==void 0?l:!1)))});let{height:o,width:a}=i[0];return e.args[1].type===P.NUMBER&&(o=Math.min(o,e.args[1].value)),e.args[2].type===P.NUMBER&&(a=Math.min(a,e.args[2].value)),o<1||a<1||!Number.isInteger(o)||!Number.isInteger(a)?it.error():new it(a,o)}filter(e,r){return this.runFunction(e.args,r,this.metadata("FILTER"),(n,...i)=>{for(const s of i)if(n.width()!==s.width()||n.height()!==s.height())return new C(N.NA,x.EqualLength);if(n.width()>1&&n.height()>1)return new C(N.NA,x.WrongDimension);const o=n.data,a=[];for(let s=0;s<n.height();s++){const l=[];for(let u=0;u<n.width();u++){let c=!0;for(const f of i)if(Lj(f.data[s][u])!==!0){c=!1;break}c&&l.push(o[s][u])}l.length>0&&a.push(l)}return a.length>0?Pe.onlyValues(a):new C(N.NA,x.EmptyRange)})}filterArraySize(e,r){if(e.args.length<=1)return it.error();const n=this.metadata("FILTER"),i=e.args.map(s=>{var l;return this.arraySizeForAst(s,new Po(r.formulaAddress,r.arraysFlag||((l=n==null?void 0:n.arrayFunction)!==null&&l!==void 0?l:!1)))}),o=Math.max(...i.map(s=>s.width)),a=Math.max(...i.map(s=>s.height));return new it(o,a)}}nW.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:g.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:g.RANGE},{argumentType:g.INTEGER,minValue:1},{argumentType:g.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class iW extends Qe{abs(e,r){return this.runFunction(e.args,r,this.metadata("ABS"),Math.abs)}}iW.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:g.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const BPe=0xffffffffffff,h9=-53,d9=53;class oW extends Qe{bitlshift(e,r){return this.runFunction(e.args,r,this.metadata("BITLSHIFT"),aW)}bitrshift(e,r){return this.runFunction(e.args,r,this.metadata("BITRSHIFT"),sW)}}oW.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:h9,maxValue:d9}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:h9,maxValue:d9}]}};function aW(t,e){return e<0?sW(t,-e):lW(t*Math.pow(2,e))}function sW(t,e){return e<0?aW(t,-e):lW(Math.floor(t/Math.pow(2,e)))}function lW(t){return t>BPe?new C(N.NUM,x.BitshiftLong):t}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class uW extends Qe{bitand(e,r){return this.runFunction(e.args,r,this.metadata("BITAND"),(n,i)=>n&i)}bitor(e,r){return this.runFunction(e.args,r,this.metadata("BITOR"),(n,i)=>n|i)}bitxor(e,r){return this.runFunction(e.args,r,this.metadata("BITXOR"),(n,i)=>n^i)}}uW.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class cW extends Qe{literalTrue(e,r){return this.runFunction(e.args,r,this.metadata("TRUE"),()=>!0)}literalFalse(e,r){return this.runFunction(e.args,r,this.metadata("FALSE"),()=>!1)}conditionalIf(e,r){return this.runFunction(e.args,r,this.metadata("IF"),(n,i,o)=>n?i:o)}ifs(e,r){return this.runFunction(e.args,r,this.metadata("IFS"),(...n)=>{for(let i=0;i<n.length;i+=2)if(n[i])return n[i+1];return new C(N.NA,x.NoConditionMet)})}and(e,r){return this.runFunction(e.args,r,this.metadata("AND"),(...n)=>n.filter(i=>i!==void 0).every(i=>!!i))}or(e,r){return this.runFunction(e.args,r,this.metadata("OR"),(...n)=>n.filter(i=>i!==void 0).some(i=>i))}not(e,r){return this.runFunction(e.args,r,this.metadata("NOT"),n=>!n)}xor(e,r){return this.runFunction(e.args,r,this.metadata("XOR"),(...n)=>{let i=0;return n.filter(o=>o!==void 0).forEach(o=>{o&&i++}),i%2===1})}switch(e,r){return this.runFunction(e.args,r,this.metadata("SWITCH"),(n,...i)=>{const o=i.length;let a=0;for(;a+1<o;a+=2)if(!(i[a]instanceof C)&&this.arithmeticHelper.eq(n,i[a]))return i[a+1];return a<o?i[a]:new C(N.NA,x.NoDefault)})}iferror(e,r){return this.runFunction(e.args,r,this.metadata("IFERROR"),(n,i)=>n instanceof C?i:n)}ifna(e,r){return this.runFunction(e.args,r,this.metadata("IFNA"),(n,i)=>n instanceof C&&n.type===N.NA?i:n)}choose(e,r){return this.runFunction(e.args,r,this.metadata("CHOOSE"),(n,...i)=>n>i.length?new C(N.NUM,x.Selector):i[n-1])}}cW.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:g.BOOLEAN},{argumentType:g.SCALAR,passSubtype:!0},{argumentType:g.SCALAR,defaultValue:!1,passSubtype:!0}]},IFS:{method:"ifs",parameters:[{argumentType:g.BOOLEAN},{argumentType:g.SCALAR,passSubtype:!0}],repeatLastArgs:2},AND:{method:"and",parameters:[{argumentType:g.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:g.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:g.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:g.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:g.NOERROR},{argumentType:g.SCALAR,passSubtype:!0},{argumentType:g.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:g.SCALAR,passSubtype:!0},{argumentType:g.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:g.SCALAR,passSubtype:!0},{argumentType:g.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:g.INTEGER,minValue:1},{argumentType:g.SCALAR,passSubtype:!0}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class fW extends Qe{char(e,r){return this.runFunction(e.args,r,this.metadata("CHAR"),n=>n<1||n>=256?new C(N.VALUE,x.CharacterCodeBounds):String.fromCharCode(Math.trunc(n)))}unichar(e,r){return this.runFunction(e.args,r,this.metadata("CHAR"),n=>n<1||n>=1114112?new C(N.VALUE,x.CharacterCodeBounds):String.fromCodePoint(Math.trunc(n)))}}fW.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:g.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:g.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class hW extends Qe{code(e,r){return this.runFunction(e.args,r,this.metadata("CODE"),n=>n.length===0?new C(N.VALUE,x.EmptyString):n.charCodeAt(0))}unicode(e,r){return this.runFunction(e.args,r,this.metadata("UNICODE"),n=>{var i;return(i=n.codePointAt(0))!==null&&i!==void 0?i:new C(N.VALUE,x.EmptyString)})}}hW.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:g.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:g.STRING}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class dW extends Qe{countblank(e,r){return this.runFunction(e.args,r,this.metadata("COUNTBLANK"),(...n)=>{let i=0;return n.forEach(o=>{o===ft&&i++}),i})}}dW.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:g.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class pW extends Qe{countunique(e,r){return this.runFunction(e.args,r,this.metadata("COUNTUNIQUE"),(...n)=>{const i=new Set,o=new Set;for(const a of n)a instanceof C?o.add(a.type):a!==""&&i.add(a);return i.size+o.size})}}pW.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:g.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class mW extends Qe{constructor(){super(...arguments),this.isoweeknumCore=e=>{const r=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),n=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.dateToNumber({year:n.year,month:1,day:1}),o=this.dateTimeHelper.relativeNumberToAbsoluteNumber(i),a=o+((4-o)%7+7)%7,s=Math.floor((r-1)/7)-Math.floor((a-1)/7)+1;return s===0?this.isoweeknumCore(e-7)+1:s},this.days360Core=(e,r,n)=>{const i=this.dateTimeHelper.numberToSimpleDate(e),o=this.dateTimeHelper.numberToSimpleDate(r);let a,s;return n?(a=t9(i),s=t9(o)):[a,s]=this.dateTimeHelper.toBasisUS(i,o),360*(s.year-a.year)+30*(s.month-a.month)+s.day-a.day}}date(e,r){return this.runFunction(e.args,r,this.metadata("DATE"),(n,i,o)=>{const a=Math.trunc(o);let s=Math.trunc(i),l=Math.trunc(n);l<this.dateTimeHelper.getEpochYearZero()&&(l+=this.dateTimeHelper.getEpochYearZero());const u=Math.floor((s-1)/12);l+=u,s-=u*12;const c={year:l,month:s,day:1};if(this.dateTimeHelper.isValidDate(c)){let f=this.dateTimeHelper.dateToNumber(c)+(a-1);return f=this.dateTimeHelper.getWithinBounds(f),f===void 0?new C(N.NUM,x.DateBounds):f}return new C(N.VALUE,x.InvalidDate)})}time(e,r){return this.runFunction(e.args,r,this.metadata("TIME"),(n,i,o)=>{const a=qc({hours:Math.trunc(n),minutes:Math.trunc(i),seconds:Math.trunc(o)});return a<0?new C(N.NUM,x.NegativeTime):a%1})}eomonth(e,r){return this.runFunction(e.args,r,this.metadata("EOMONTH"),(n,i)=>{const o=this.dateTimeHelper.numberToSimpleDate(n);let a=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth(e9(o,i)));return a=this.dateTimeHelper.getWithinBounds(a),a===void 0?new C(N.NUM,x.DateBounds):a})}day(e,r){return this.runFunction(e.args,r,this.metadata("DAY"),n=>this.dateTimeHelper.numberToSimpleDate(n).day)}days(e,r){return this.runFunction(e.args,r,this.metadata("DAYS"),(n,i)=>Math.trunc(n)-Math.trunc(i))}month(e,r){return this.runFunction(e.args,r,this.metadata("MONTH"),n=>this.dateTimeHelper.numberToSimpleDate(n).month)}year(e,r){return this.runFunction(e.args,r,this.metadata("YEAR"),n=>this.dateTimeHelper.numberToSimpleDate(n).year)}hour(e,r){return this.runFunction(e.args,r,this.metadata("HOUR"),n=>Xc(D6(n)%1).hours)}minute(e,r){return this.runFunction(e.args,r,this.metadata("MINUTE"),n=>Xc(D6(n)%1).minutes)}second(e,r){return this.runFunction(e.args,r,this.metadata("SECOND"),n=>Xc(D6(n)%1).seconds)}text(e,r){return this.runFunction(e.args,r,this.metadata("TEXT"),(n,i)=>ANe(n,i,this.config,this.dateTimeHelper))}weekday(e,r){return this.runFunction(e.args,r,this.metadata("WEEKDAY"),(n,i)=>{const o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(n));if(i===3)return(o-1)%7;const a=v9.get(i);return a===void 0?new C(N.NUM,x.BadMode):(o-a)%7+1})}weeknum(e,r){return this.runFunction(e.args,r,this.metadata("WEEKNUM"),(n,i)=>{const o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(n)),a=this.dateTimeHelper.numberToSimpleDate(n),s=this.dateTimeHelper.dateToNumber({year:a.year,month:1,day:1}),l=this.dateTimeHelper.relativeNumberToAbsoluteNumber(s);if(i===21)return this.isoweeknumCore(n);const u=v9.get(i);return u===void 0?new C(N.NUM,x.BadMode):Math.floor((o-u)/7)-Math.floor((l-u)/7)+1})}isoweeknum(e,r){return this.runFunction(e.args,r,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,r){return this.runFunction(e.args,r,this.metadata("DATEVALUE"),n=>{const{dateTime:i}=this.dateTimeHelper.parseDateTimeFromConfigFormats(n);return i===void 0?new C(N.VALUE,x.IncorrectDateTime):Up(i)?(Bj(i)?Math.trunc(qc(i)):0)+this.dateTimeHelper.dateToNumber(i):0})}timevalue(e,r){return this.runFunction(e.args,r,this.metadata("TIMEVALUE"),n=>{const i=this.dateTimeHelper.dateStringToDateNumber(n);return i===void 0?new C(N.VALUE,x.IncorrectDateTime):ye(i)%1})}now(e,r){return this.runFunction(e.args,r,this.metadata("NOW"),()=>{const n=new Date(Date.now());return qc({hours:n.getHours(),minutes:n.getMinutes(),seconds:n.getSeconds()})+this.dateTimeHelper.dateToNumber({year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate()})})}today(e,r){return this.runFunction(e.args,r,this.metadata("TODAY"),()=>{const n=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate()})})}edate(e,r){return this.runFunction(e.args,r,this.metadata("EDATE"),(n,i)=>{const o=this.dateTimeHelper.numberToSimpleDate(n),a=RNe(e9(o,i));let s=this.dateTimeHelper.dateToNumber(a);return s=this.dateTimeHelper.getWithinBounds(s),s===void 0?new C(N.NUM,x.DateBounds):s})}datedif(e,r){return this.runFunction(e.args,r,this.metadata("DATEDIF"),(n,i,o)=>{if(n>i)return new C(N.NUM,x.StartEndDate);if(o==="D")return Math.floor(i)-Math.floor(n);const a=this.dateTimeHelper.numberToSimpleDate(n),s=this.dateTimeHelper.numberToSimpleDate(i);switch(o){case"M":return(s.year-a.year)*12+(s.month-a.month)-(s.day<a.day?1:0);case"YM":return(12+(s.month-a.month)-(s.day<a.day?1:0))%12;case"Y":return s.month>a.month||s.month===a.month&&s.day>=a.day?s.year-a.year:s.year-a.year-1;case"MD":if(s.day>=a.day)return s.day-a.day;{const l=s.month===1?12:s.month-1,u=s.month===1?s.year-1:s.year;return this.dateTimeHelper.daysInMonth(u,l)+s.day-a.day}case"YD":return s.month>a.month||s.month===a.month&&s.day>=a.day?Math.floor(i)-this.dateTimeHelper.dateToNumber({year:s.year,month:a.month,day:a.day}):Math.floor(i)-Math.floor(n)-365*(s.year-a.year-1)-this.dateTimeHelper.leapYearsCount(s.year-1)+this.dateTimeHelper.leapYearsCount(a.year);default:return new C(N.NUM,x.BadMode)}})}days360(e,r){return this.runFunction(e.args,r,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,r){return this.runFunction(e.args,r,this.metadata("YEARFRAC"),(n,i,o)=>{switch(n=Math.trunc(n),i=Math.trunc(i),n>i&&([n,i]=[i,n]),o){case 0:return this.days360Core(n,i,!1)/360;case 1:return(i-n)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(n),this.dateTimeHelper.numberToSimpleDate(i));case 2:return(i-n)/360;case 3:return(i-n)/365;case 4:return this.days360Core(n,i,!0)/360}throw new Error("Should not be reachable.")})}interval(e,r){return this.runFunction(e.args,r,this.metadata("INTERVAL"),n=>{n=Math.trunc(n);const i=n%60;n=Math.trunc(n/60);const o=n%60;n=Math.trunc(n/60);const a=n%24;n=Math.trunc(n/24);const s=n%30;n=Math.trunc(n/30);const l=n%12,u=Math.trunc(n/12);return"P"+(u>0?`${u}Y`:"")+(l>0?`${l}M`:"")+(s>0?`${s}D`:"")+"T"+(a>0?`${a}H`:"")+(o>0?`${o}M`:"")+(i>0?`${i}S`:"")})}networkdays(e,r){return this.runFunction(e.args,r,this.metadata("NETWORKDAYS"),(n,i,o)=>this.networkdayscore(n,i,1,o))}networkdaysintl(e,r){return this.runFunction(e.args,r,this.metadata("NETWORKDAYS.INTL"),(n,i,o,a)=>this.networkdayscore(n,i,o,a))}workday(e,r){return this.runFunction(e.args,r,this.metadata("WORKDAY"),(n,i,o)=>this.workdaycore(n,i,1,o))}workdayintl(e,r){return this.runFunction(e.args,r,this.metadata("WORKDAY.INTL"),(n,i,o,a)=>this.workdaycore(n,i,o,a))}networkdayscore(e,r,n,i){e=Math.trunc(e),r=Math.trunc(r);let o=1;e>r&&([e,r]=[r,e],o=-1);const a=m9(n);if(a instanceof C)return a;const s=this.simpleRangeToFilteredHolidays(a,i);return s instanceof C?s:o*this.countWorkdays(e,r,a,s)}workdaycore(e,r,n,i){e=Math.trunc(e),r=Math.trunc(r);const o=m9(n);if(o instanceof C)return o;const a=this.simpleRangeToFilteredHolidays(o,i);if(a instanceof C)return a;if(r>0){let s=1;for(;this.countWorkdays(e+1,e+s,o,a)<r;)s*=2;let l=1;for(;l+1<s;){const u=Math.trunc((l+s)/2);this.countWorkdays(e+1,e+u,o,a)<r?l=u:s=u}return e+s}else if(r<0){r*=-1;let s=1;for(;this.countWorkdays(e-s,e-1,o,a)<r;)s*=2;let l=1;for(;l+1<s;){const u=Math.trunc((l+s)/2);this.countWorkdays(e-u,e-1,o,a)<r?l=u:s=u}return e-s}else return e}countWorkdays(e,r,n,i){const o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(r)),a=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let s=0;for(let l=0;l<7;l++)n.charAt(l)==="0"&&(s+=Math.floor((o+6-l)/7),s-=Math.floor((a-1+6-l)/7));return s-=p9(r+1,i)-p9(e,i),s}simpleRangeToFilteredHolidays(e,r){var n;const i=(n=r==null?void 0:r.valuesFromTopLeftCorner())!==null&&n!==void 0?n:[];for(const a of i)if(a instanceof C)return a;const o=[];for(const a of i)if(a!==ft)if(Rt(a))o.push(Math.trunc(ye(a)));else return new C(N.VALUE,x.WrongType);return[...new Set(o)].sort((a,s)=>a-s).filter(a=>{const l=(this.dateTimeHelper.relativeNumberToAbsoluteNumber(a)-1)%7;return e.charAt(l)==="0"})}}mW.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER}],returnNumberType:Ie.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER}],returnNumberType:Ie.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:g.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:g.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:g.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:g.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:g.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:g.NUMBER},{argumentType:g.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER}],returnNumberType:Ie.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:g.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:g.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:g.STRING}],returnNumberType:Ie.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:g.STRING}],returnNumberType:Ie.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:Ie.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:Ie.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER}],returnNumberType:Ie.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:g.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.NOERROR,defaultValue:1},{argumentType:g.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER},{argumentType:g.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER},{argumentType:g.NOERROR,defaultValue:1},{argumentType:g.RANGE,optionalArg:!0}]}};function p9(t,e){if(e.length===0||t<=e[0])return 0;if(e[e.length-1]<t)return e.length;let r=0,n=e.length-1;for(;r+1<n;){const i=Math.floor((n+r)/2);e[i]>=t?n=i:r=i}return n}function m9(t){var e;return typeof t!="number"&&typeof t!="string"?new C(N.VALUE,x.WrongType):typeof t=="string"?t.length!==7||!/^(0|1)*$/.test(t)||t==="1111111"?new C(N.NUM,x.WeekendString):t:(e=VPe.get(t))!==null&&e!==void 0?e:new C(N.NUM,x.BadMode)}const v9=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),VPe=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class vW extends Qe{degrees(e,r){return this.runFunction(e.args,r,this.metadata("DEGREES"),n=>n*(180/Math.PI))}}vW.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:g.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class gW extends Qe{delta(e,r){return this.runFunction(e.args,r,this.metadata("DELTA"),(n,i)=>n===i?1:0)}}gW.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class yW extends Qe{exp(e,r){return this.runFunction(e.args,r,this.metadata("EXP"),Math.exp)}}yW.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:g.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class bW extends Qe{pmt(e,r){return this.runFunction(e.args,r,this.metadata("PMT"),RI)}ipmt(e,r){return this.runFunction(e.args,r,this.metadata("IPMT"),P5)}ppmt(e,r){return this.runFunction(e.args,r,this.metadata("PPMT"),g9)}fv(e,r){return this.runFunction(e.args,r,this.metadata("FV"),M5)}cumipmt(e,r){return this.runFunction(e.args,r,this.metadata("CUMIPMT"),(n,i,o,a,s,l)=>{if(a>s)return new C(N.NUM,x.EndStartPeriod);let u=0;for(let c=a;c<=s;c++)u+=P5(n,c,i,o,0,l);return u})}cumprinc(e,r){return this.runFunction(e.args,r,this.metadata("CUMPRINC"),(n,i,o,a,s,l)=>{if(a>s)return new C(N.NUM,x.EndStartPeriod);let u=0;for(let c=a;c<=s;c++)u+=g9(n,c,i,o,0,l);return u})}db(e,r){return this.runFunction(e.args,r,this.metadata("DB"),(n,i,o,a,s)=>{if(s===12&&a>o||a>o+1)return new C(N.NUM,x.PeriodLong);if(i>=n)return 0;const l=Math.round((1-Math.pow(i/n,1/o))*1e3)/1e3,u=n*l*s/12;if(a===1)return u;let c=u;for(let f=0;f<a-2;f++)c+=(n-c)*l;return a===o+1?(n-c)*l*(12-s)/12:(n-c)*l})}ddb(e,r){return this.runFunction(e.args,r,this.metadata("DDB"),(n,i,o,a,s)=>{if(a>o)return new C(N.NUM);let l=s/o,u;l>=1?(l=1,a===1?u=n:u=0):u=n*Math.pow(1-l,a-1);const c=n*Math.pow(1-l,a);return Math.max(u-Math.max(i,c),0)})}dollarde(e,r){return this.runFunction(e.args,r,this.metadata("DOLLARDE"),(n,i)=>{if(i<1)return new C(N.DIV_BY_ZERO);for(i=Math.trunc(i);i>10;)i/=10;return Math.trunc(n)+(n-Math.trunc(n))*10/i})}dollarfr(e,r){return this.runFunction(e.args,r,this.metadata("DOLLARFR"),(n,i)=>{if(i<1)return new C(N.DIV_BY_ZERO);for(i=Math.trunc(i);i>10;)i/=10;return Math.trunc(n)+(n-Math.trunc(n))*i/10})}effect(e,r){return this.runFunction(e.args,r,this.metadata("EFFECT"),(n,i)=>(i=Math.trunc(i),Math.pow(1+n/i,i)-1))}ispmt(e,r){return this.runFunction(e.args,r,this.metadata("ISPMT"),(n,i,o,a)=>o===0?new C(N.DIV_BY_ZERO):a*n*(i/o-1))}nominal(e,r){return this.runFunction(e.args,r,this.metadata("NOMINAL"),(n,i)=>(i=Math.trunc(i),(Math.pow(n+1,1/i)-1)*i))}nper(e,r){return this.runFunction(e.args,r,this.metadata("NPER"),(n,i,o,a,s)=>n===0?i===0?new C(N.DIV_BY_ZERO):(-o-a)/i:(s&&(i*=1+n),Math.log((i-a*n)/(o*n+i))/Math.log(1+n)))}rate(e,r){return this.runFunction(e.args,r,this.metadata("RATE"),(n,i,o,a,s,l)=>{if(l<=-1)return new C(N.VALUE);const u=1e-7,c=50;let f=l;s=s?1:0;for(let h=0;h<c;h++){if(f<=-1)return new C(N.NUM);let d;if(Math.abs(f)<u)d=o*(1+n*f)+i*(1+f*s)*n+a;else{const m=Math.pow(1+f,n);d=o*m+i*(1/f+s)*(m-1)+a}if(Math.abs(d)<u)return f;let p;if(Math.abs(f)<u)p=o*n+i*s*n;else{const m=Math.pow(1+f,n),y=n*Math.pow(1+f,n-1);p=o*y+i*(1/f+s)*y+i*(-1/(f*f))*(m-1)}f-=d/p}return new C(N.NUM)})}pv(e,r){return this.runFunction(e.args,r,this.metadata("PV"),(n,i,o,a,s)=>(s=s?1:0,n===-1?i===0?new C(N.NUM):new C(N.DIV_BY_ZERO):n===0?-o*i-a:((1-Math.pow(1+n,i))*o*(1+n*s)/n-a)/Math.pow(1+n,i)))}rri(e,r){return this.runFunction(e.args,r,this.metadata("RRI"),(n,i,o)=>i===0||o<0&&i>0||o>0&&i<0?new C(N.NUM):Math.pow(o/i,1/n)-1)}sln(e,r){return this.runFunction(e.args,r,this.metadata("SLN"),(n,i,o)=>o===0?new C(N.DIV_BY_ZERO):(n-i)/o)}syd(e,r){return this.runFunction(e.args,r,this.metadata("SYD"),(n,i,o,a)=>a>o?new C(N.NUM):(n-i)*(o-a+1)*2/(o*(o+1)))}tbilleq(e,r){return this.runFunction(e.args,r,this.metadata("TBILLEQ"),(n,i,o)=>{if(n=Math.round(n),i=Math.round(i),n>=i)return new C(N.NUM);const a=this.dateTimeHelper.numberToSimpleDate(n),s=this.dateTimeHelper.numberToSimpleDate(i);if(s.year>a.year+1||s.year===a.year+1&&(s.month>a.month||s.month===a.month&&s.day>a.day))return new C(N.NUM);const l=360-o*(i-n);return l===0?0:l<0?new C(N.NUM):365*o/l})}tbillprice(e,r){return this.runFunction(e.args,r,this.metadata("TBILLPRICE"),(n,i,o)=>{if(n=Math.round(n),i=Math.round(i),n>=i)return new C(N.NUM);const a=this.dateTimeHelper.numberToSimpleDate(n),s=this.dateTimeHelper.numberToSimpleDate(i);if(s.year>a.year+1||s.year===a.year+1&&(s.month>a.month||s.month===a.month&&s.day>a.day))return new C(N.NUM);const l=360-o*(i-n);return l===0?0:l<0?new C(N.NUM):100*(1-o*(i-n)/360)})}tbillyield(e,r){return this.runFunction(e.args,r,this.metadata("TBILLYIELD"),(n,i,o)=>{if(n=Math.round(n),i=Math.round(i),n>=i)return new C(N.NUM);const a=this.dateTimeHelper.numberToSimpleDate(n),s=this.dateTimeHelper.numberToSimpleDate(i);return s.year>a.year+1||s.year===a.year+1&&(s.month>a.month||s.month===a.month&&s.day>a.day)?new C(N.NUM):(100-o)*360/(o*(i-n))})}fvschedule(e,r){return this.runFunction(e.args,r,this.metadata("FVSCHEDULE"),(n,i)=>{const o=i.valuesFromTopLeftCorner();for(const a of o)if(a instanceof C)return a;for(const a of o)if(Rt(a))n*=1+ye(a);else if(a!==ft)return new C(N.VALUE,x.NumberExpected);return n})}npv(e,r){return this.runFunction(e.args,r,this.metadata("NPV"),(n,...i)=>{const o=this.arithmeticHelper.coerceNumbersExactRanges(i);return o instanceof C?o:U6(n,o)})}mirr(e,r){return this.runFunction(e.args,r,this.metadata("MIRR"),(n,i,o)=>{const a=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());if(a instanceof C)return a;let s=!1,l=!1;const u=[],c=[];for(const p of a)p>0?(s=!0,u.push(p),c.push(0)):p<0?(l=!0,c.push(p),u.push(0)):(c.push(0),u.push(0));if(!s||!l)return new C(N.DIV_BY_ZERO);const f=a.length,h=U6(o,u);if(h instanceof C)return h;const d=U6(i,c);return d instanceof C?d:Math.pow(-h*Math.pow(1+o,f)/d/(1+i),1/(f-1))-1})}pduration(e,r){return this.runFunction(e.args,r,this.metadata("PDURATION"),(n,i,o)=>(Math.log(o)-Math.log(i))/Math.log(1+n))}xnpv(e,r){return this.runFunction(e.args,r,this.metadata("XNPV"),(n,i,o)=>{const a=i.valuesFromTopLeftCorner();for(const h of a)if(typeof h!="number")return new C(N.VALUE,x.NumberExpected);const s=a,l=o.valuesFromTopLeftCorner();for(const h of l)if(typeof h!="number")return new C(N.VALUE,x.NumberExpected);const u=l;if(u.length!==s.length)return new C(N.NUM,x.EqualLength);const c=u.length;let f=0;if(u[0]<0)return new C(N.NUM,x.ValueSmall);for(let h=0;h<c;h++){if(u[h]=Math.floor(u[h]),u[h]<u[0])return new C(N.NUM,x.ValueSmall);f+=s[h]/Math.pow(1+n,(u[h]-u[0])/365)}return f})}}bW.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0}],returnNumberType:Ie.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0}],returnNumberType:Ie.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0}],returnNumberType:Ie.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0}],returnNumberType:Ie.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.INTEGER,minValue:1},{argumentType:g.INTEGER,minValue:1},{argumentType:g.INTEGER,minValue:0,maxValue:1}],returnNumberType:Ie.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.INTEGER,minValue:1},{argumentType:g.INTEGER,minValue:1},{argumentType:g.INTEGER,minValue:0,maxValue:1}],returnNumberType:Ie.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:0},{argumentType:g.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:Ie.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.INTEGER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:Ie.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1}],returnNumberType:Ie.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1}],returnNumberType:Ie.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0}],returnNumberType:Ie.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:.1}],returnNumberType:Ie.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER},{argumentType:g.NUMBER}],returnNumberType:Ie.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER}],returnNumberType:Ie.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0}],returnNumberType:Ie.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0}],returnNumberType:Ie.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0}],returnNumberType:Ie.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0}],returnNumberType:Ie.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:g.NUMBER},{argumentType:g.RANGE}],returnNumberType:Ie.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:g.NUMBER},{argumentType:g.ANY}],repeatLastArgs:1,returnNumberType:Ie.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.NUMBER}],returnNumberType:Ie.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:g.NUMBER,greaterThan:-1},{argumentType:g.RANGE},{argumentType:g.RANGE}]}};function RI(t,e,r,n,i){if(t===0)return(-r-n)/e;{const o=Math.pow(1+t,e);return(n*t+r*t*o)*(i?1/(1+t):1)/(1-o)}}function P5(t,e,r,n,i,o){const a=RI(t,r,n,i,o);return e===1?t*(o?0:-n):t*(o?M5(t,e-2,a,n,o)-a:M5(t,e-1,a,n,o))}function M5(t,e,r,n,i){if(t===0)return-n-r*e;{const o=Math.pow(1+t,e);return r*(i?1+t:1)*(1-o)/t-n*o}}function g9(t,e,r,n,i,o){return RI(t,r,n,i,o)-P5(t,e,r,n,i,o)}function U6(t,e){let r=0;for(let n=e.length-1;n>=0;n--){if(r+=e[n],t===-1){if(r===0)continue;return new C(N.DIV_BY_ZERO)}r/=1+t}return r}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class wW extends Qe{formulatext(e,r){return this.runFunctionWithReferenceArgument(e.args,r,this.metadata("FORMULATEXT"),()=>new C(N.NA,x.WrongArgNumber),n=>{var i;return(i=this.serialization.getCellFormula(n))!==null&&i!==void 0?i:new C(N.NA,x.Formula)})}}wW.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:g.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class SW extends Qe{hyperlink(e,r){return this.runFunction(e.args,r,this.metadata("HYPERLINK"),(n,i)=>(e.hyperlink=n,i??n))}}SW.implementedFunctions={HYPERLINK:{method:"hyperlink",parameters:[{argumentType:g.STRING},{argumentType:g.STRING,optionalArg:!0}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class RW extends Qe{isbinary(e,r){return this.runFunction(e.args,r,this.metadata("ISBINARY"),n=>/^[01]{1,10}$/.test(n))}iserr(e,r){return this.runFunction(e.args,r,this.metadata("ISERR"),n=>n instanceof C&&n.type!==N.NA)}iserror(e,r){return this.runFunction(e.args,r,this.metadata("ISERROR"),n=>n instanceof C)}isformula(e,r){return this.runFunctionWithReferenceArgument(e.args,r,this.metadata("ISFORMULA"),()=>new C(N.NA,x.WrongArgNumber),n=>this.dependencyGraph.addressMapping.getCell(n)instanceof li)}isblank(e,r){return this.runFunction(e.args,r,this.metadata("ISBLANK"),n=>n===ft)}isna(e,r){return this.runFunction(e.args,r,this.metadata("ISNA"),n=>n instanceof C&&n.type==N.NA)}isnumber(e,r){return this.runFunction(e.args,r,this.metadata("ISNUMBER"),Rt)}islogical(e,r){return this.runFunction(e.args,r,this.metadata("ISLOGICAL"),n=>typeof n=="boolean")}isref(e,r){return this.runFunction(e.args,r,this.metadata("ISREF"),n=>n instanceof C&&(n.type==N.REF||n.type==N.CYCLE))}istext(e,r){return this.runFunction(e.args,r,this.metadata("ISTEXT"),n=>typeof n=="string")}isnontext(e,r){return this.runFunction(e.args,r,this.metadata("ISNONTEXT"),n=>typeof n!="string")}column(e,r){return this.runFunctionWithReferenceArgument(e.args,r,this.metadata("COLUMN"),()=>r.formulaAddress.col+1,n=>n.col+1)}columns(e,r){if(e.args.length!==1)return new C(N.NA,x.WrongArgNumber);if(e.args.some(i=>i.type===P.EMPTY))return new C(N.NUM,x.EmptyArg);let n=e.args[0];for(;n.type===P.PARENTHESIS;)n=n.expression;if(n.type===P.CELL_RANGE||n.type===P.COLUMN_RANGE)return n.end.col-n.start.col+1;if(n.type===P.CELL_REFERENCE)return 1;if(n.type===P.ROW_RANGE)return this.config.maxColumns;{const i=this.evaluateAst(n,r);return i instanceof Pe?i.width():i instanceof C?i:1}}row(e,r){return this.runFunctionWithReferenceArgument(e.args,r,this.metadata("ROW"),()=>r.formulaAddress.row+1,n=>n.row+1)}rows(e,r){if(e.args.length!==1)return new C(N.NA,x.WrongArgNumber);if(e.args.some(i=>i.type===P.EMPTY))return new C(N.NUM,x.EmptyArg);let n=e.args[0];for(;n.type===P.PARENTHESIS;)n=n.expression;if(n.type===P.CELL_RANGE||n.type===P.ROW_RANGE)return n.end.row-n.start.row+1;if(n.type===P.CELL_REFERENCE)return 1;if(n.type===P.COLUMN_RANGE)return this.config.maxRows;{const i=this.evaluateAst(n,r);return i instanceof Pe?i.height():i instanceof C?i:1}}index(e,r){return this.runFunction(e.args,r,this.metadata("INDEX"),(n,i,o)=>{var a,s,l,u,c,f;return o<1||i<1?new C(N.VALUE,x.LessThanOne):o>n.width()||i>n.height()?new C(N.NUM,x.ValueLarge):(f=(l=(s=(a=n==null?void 0:n.data)===null||a===void 0?void 0:a[i-1])===null||s===void 0?void 0:s[o-1])!==null&&l!==void 0?l:(c=(u=n==null?void 0:n.data)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c[0])!==null&&f!==void 0?f:new C(N.VALUE,x.CellRangeExpected)})}na(e,r){return new C(N.NA)}sheet(e,r){return this.runFunctionWithReferenceArgument(e.args,r,this.metadata("SHEET"),()=>r.formulaAddress.sheet+1,n=>n.sheet+1,n=>{const i=this.dependencyGraph.sheetMapping.get(n);return i!==void 0?i+1:new C(N.NA,x.SheetRef)})}sheets(e,r){return this.runFunctionWithReferenceArgument(e.args,r,this.metadata("SHEETS"),()=>this.dependencyGraph.sheetMapping.numberOfSheets(),()=>1,()=>new C(N.VALUE,x.CellRefExpected))}}RW.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:g.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:g.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:g.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:g.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:g.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:g.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:g.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:g.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:g.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:g.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:g.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:g.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:g.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:g.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:g.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:g.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:g.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class EW extends Qe{iseven(e,r){return this.runFunction(e.args,r,this.metadata("ISEVEN"),n=>n%2===0)}}EW.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:g.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class CW extends Qe{isodd(e,r){return this.runFunction(e.args,r,this.metadata("ISODD"),n=>n%2===1)}}CW.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:g.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class OW extends Qe{log10(e,r){return this.runFunction(e.args,r,this.metadata("LOG10"),Math.log10)}log(e,r){return this.runFunction(e.args,r,this.metadata("LOG"),(n,i)=>Math.log(n)/Math.log(i))}ln(e,r){return this.runFunction(e.args,r,this.metadata("LN"),Math.log)}}OW.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:g.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:g.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const k5=parseFloat(Math.PI.toFixed(14));class TW extends Qe{pi(e,r){return this.runFunction(e.args,r,this.metadata("PI"),()=>k5)}sqrtpi(e,r){return this.runFunction(e.args,r,this.metadata("SQRTPI"),n=>Math.sqrt(k5*n))}}TW.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:g.NUMBER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function y9(t,e){return new it(e.width,t.height)}function B6(t,e,r){return new it(1+(t.width-e)/r,1+(t.height-e)/r)}class _W extends Qe{mmult(e,r){return this.runFunction(e.args,r,this.metadata("MMULT"),(n,i)=>{if(!n.hasOnlyNumbers()||!i.hasOnlyNumbers())return new C(N.VALUE,x.NumberRange);if(i.height()!==n.width())return new C(N.VALUE,x.ArrayDimensions);const o=y9(n.size,i.size),a=this.createKernel(function(s,l,u){let c=0;for(let f=0;f<u;++f)c+=s[this.thread.y][f]*l[f][this.thread.x];return c},o)(n.rawNumbers(),i.rawNumbers(),n.width());return Pe.onlyNumbers(a)})}mmultArraySize(e,r){if(e.args.length!==2)return it.error();const n=this.metadata("MMULT"),i=e.args.map(s=>{var l;return this.arraySizeForAst(s,new Po(r.formulaAddress,r.arraysFlag||((l=n==null?void 0:n.arrayFunction)!==null&&l!==void 0?l:!1)))}),[o,a]=i;return y9(o,a)}maxpool(e,r){return this.runFunction(e.args,r,this.metadata("MAXPOOL"),(n,i,o=i)=>{if(!n.hasOnlyNumbers())return new C(N.VALUE,x.NumberRange);const a=B6(n.size,i,o),s=this.createKernel(function(l,u,c){const f=this.thread.x*c,h=this.thread.y*c;let d=l[h][f];for(let p=0;p<u;p++)for(let m=0;m<u;m++)d=Math.max(d,l[h+p][f+m]);return d},a)(n.rawNumbers(),i,o);return Pe.onlyNumbers(s)})}medianpool(e,r){return this.runFunction(e.args,r,this.metadata("MEDIANPOOL"),(n,i,o=i)=>{if(!n.hasOnlyNumbers())return new C(N.VALUE,x.NumberRange);const a=B6(n.size,i,o),s=this.createKernel(function(l,u,c){const f=this.thread.x*c,h=this.thread.y*c;let d=l[h][f];for(let E=0;E<u;E++)for(let O=0;O<u;O++)d=Math.max(d,l[h+E][f+O]);let p=l[h][f];for(let E=0;E<u;E++)for(let O=0;O<u;O++)p=Math.min(p,l[h+E][f+O]);const m=u*u;let y=p,S=d,R=42;for(let E=0;E<32;E++){const O=(y+S)/2;let A=0;for(let B=0;B<u;B++)for(let j=0;j<u;j++)l[h+B][f+j]>O&&A++;if(u%2===0)if(A===m/2){R=O;break}else A>m/2?y=O:S=O;else if(A===(m-1)/2){R=O;break}else A>(m-1)/2?y=O:S=O}return R},a)(n.rawNumbers(),i,o);return Pe.onlyNumbers(s)})}maxpoolArraySize(e,r){if(e.args.length<2||e.args.length>3)return it.error();const n=this.metadata("MAXPOOL"),o=e.args.map(u=>{var c;return this.arraySizeForAst(u,new Po(r.formulaAddress,r.arraysFlag||((c=n==null?void 0:n.arrayFunction)!==null&&c!==void 0?c:!1)))})[0],a=e.args[1];let s;a.type===P.NUMBER?s=a.value:s=1;let l=s;if(e.args.length===3){const u=e.args[2];u.type===P.NUMBER?l=u.value:l=1}return s>o.width||s>o.height||l>s||(o.width-s)%l!==0||(o.height-s)%l!==0?it.error():B6(o,s,l)}medianpoolArraySize(e,r){return this.maxpoolArraySize(e,r)}transpose(e,r){return this.runFunction(e.args,r,this.metadata("TRANSPOSE"),n=>{const i=n.rawData(),o=n.size,a=[];for(let s=0;s<o.width;++s){a[s]=[];for(let l=0;l<o.height;++l)a[s][l]=i[l][s]}return Pe.onlyValues(a)})}transposeArraySize(e,r){if(e.args.length!==1)return it.error();const n=this.metadata("MMULT"),i=e.args.map(a=>{var s;return this.arraySizeForAst(a,new Po(r.formulaAddress,r.arraysFlag||((s=n==null?void 0:n.arrayFunction)!==null&&s!==void 0?s:!1)))}),[o]=i;return new it(o.height,o.width)}createKernel(e,r){return function(...n){const i=[];for(let o=0;o<r.height;++o){i.push([]);for(let a=0;a<r.width;++a)i[o][a]=e.apply({thread:{x:a,y:o}},n)}return i}}}_W.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:g.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class AW extends Qe{median(e,r){return this.runFunction(e.args,r,this.metadata("MEDIAN"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);return i instanceof C?i:i.length===0?new C(N.NUM,x.OneValue):(i.sort((o,a)=>o-a),i.length%2===0?(i[i.length/2-1]+i[i.length/2])/2:i[Math.floor(i.length/2)])})}large(e,r){return this.runFunction(e.args,r,this.metadata("LARGE"),(n,i)=>{const o=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());return o instanceof C?o:(o.sort((a,s)=>a-s),i=Math.trunc(i),i>o.length?new C(N.NUM,x.ValueLarge):o[o.length-i])})}small(e,r){return this.runFunction(e.args,r,this.metadata("SMALL"),(n,i)=>{const o=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());return o instanceof C?o:(o.sort((a,s)=>a-s),i=Math.trunc(i),i>o.length?new C(N.NUM,x.ValueLarge):o[i-1])})}}AW.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER,minValue:1}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class IW extends Qe{mod(e,r){return this.runFunction(e.args,r,this.metadata("MOD"),(n,i)=>i===0?new C(N.DIV_BY_ZERO):n%i)}}IW.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function Zy(t){return Rt(t)&&!Number.isFinite(ye(t))?0:t}class zi{constructor(e,r,n){this.sumsq=e,this.sum=r,this.count=n}static single(e){return new zi(e*e,e,1)}compose(e){return new zi(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}varSValue(){if(this.count>1)return(this.sumsq-this.sum*this.sum/this.count)/(this.count-1)}varPValue(){if(this.count>0)return(this.sumsq-this.sum*this.sum/this.count)/this.count}}zi.empty=new zi(0,0,0);class EI extends Qe{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,r)=>this.arithmeticHelper.addWithEpsilonRaw(e,r)}sum(e,r){return this.doSum(e.args,r)}sumsq(e,r){return this.reduce(e.args,r,0,"SUMSQ",this.addWithEpsilonRaw,n=>Math.pow(ye(n),2),ac)}max(e,r){return this.doMax(e.args,r)}maxa(e,r){const n=this.reduce(e.args,r,Number.NEGATIVE_INFINITY,"MAXA",(i,o)=>Math.max(i,o),ye,Jy);return Zy(n)}min(e,r){return this.doMin(e.args,r)}mina(e,r){const n=this.reduce(e.args,r,Number.POSITIVE_INFINITY,"MINA",(i,o)=>Math.min(i,o),ye,Jy);return Zy(n)}count(e,r){return this.doCount(e.args,r)}counta(e,r){return this.doCounta(e.args,r)}average(e,r){return this.doAverage(e.args,r)}averagea(e,r){var n;const i=this.reduce(e.args,r,zi.empty,"_AGGREGATE_A",(o,a)=>o.compose(a),o=>zi.single(ye(o)),Jy);return i instanceof C?i:(n=i.averageValue())!==null&&n!==void 0?n:new C(N.DIV_BY_ZERO)}vars(e,r){return this.doVarS(e.args,r)}varp(e,r){return this.doVarP(e.args,r)}vara(e,r){var n;const i=this.reduceAggregateA(e.args,r);return i instanceof C?i:(n=i.varSValue())!==null&&n!==void 0?n:new C(N.DIV_BY_ZERO)}varpa(e,r){var n;const i=this.reduceAggregateA(e.args,r);return i instanceof C?i:(n=i.varPValue())!==null&&n!==void 0?n:new C(N.DIV_BY_ZERO)}stdevs(e,r){return this.doStdevS(e.args,r)}stdevp(e,r){return this.doStdevP(e.args,r)}stdeva(e,r){const n=this.reduceAggregateA(e.args,r);if(n instanceof C)return n;{const i=n.varSValue();return i===void 0?new C(N.DIV_BY_ZERO):Math.sqrt(i)}}stdevpa(e,r){const n=this.reduceAggregateA(e.args,r);if(n instanceof C)return n;{const i=n.varPValue();return i===void 0?new C(N.DIV_BY_ZERO):Math.sqrt(i)}}product(e,r){return this.doProduct(e.args,r)}subtotal(e,r){if(e.args.length<2)return new C(N.NA,x.WrongArgNumber);const n=this.coerceToType(this.evaluateAst(e.args[0],r),{argumentType:g.NUMBER},r),i=e.args.slice(1);switch(n){case 1:case 101:return this.doAverage(i,r);case 2:case 102:return this.doCount(i,r);case 3:case 103:return this.doCounta(i,r);case 4:case 104:return this.doMax(i,r);case 5:case 105:return this.doMin(i,r);case 6:case 106:return this.doProduct(i,r);case 7:case 107:return this.doStdevS(i,r);case 8:case 108:return this.doStdevP(i,r);case 9:case 109:return this.doSum(i,r);case 10:case 110:return this.doVarS(i,r);case 11:case 111:return this.doVarP(i,r);default:return new C(N.VALUE,x.BadMode)}}reduceAggregate(e,r){return this.reduce(e,r,zi.empty,"_AGGREGATE",(n,i)=>n.compose(i),n=>zi.single(ye(n)),ac)}reduceAggregateA(e,r){return this.reduce(e,r,zi.empty,"_AGGREGATE_A",(n,i)=>n.compose(i),n=>zi.single(ye(n)),Jy)}doAverage(e,r){var n;const i=this.reduceAggregate(e,r);return i instanceof C?i:(n=i.averageValue())!==null&&n!==void 0?n:new C(N.DIV_BY_ZERO)}doVarS(e,r){var n;const i=this.reduceAggregate(e,r);return i instanceof C?i:(n=i.varSValue())!==null&&n!==void 0?n:new C(N.DIV_BY_ZERO)}doVarP(e,r){var n;const i=this.reduceAggregate(e,r);return i instanceof C?i:(n=i.varPValue())!==null&&n!==void 0?n:new C(N.DIV_BY_ZERO)}doStdevS(e,r){const n=this.reduceAggregate(e,r);if(n instanceof C)return n;{const i=n.varSValue();return i===void 0?new C(N.DIV_BY_ZERO):Math.sqrt(i)}}doStdevP(e,r){const n=this.reduceAggregate(e,r);if(n instanceof C)return n;{const i=n.varPValue();return i===void 0?new C(N.DIV_BY_ZERO):Math.sqrt(i)}}doCount(e,r){return this.reduce(e,r,0,"COUNT",(n,i)=>n+i,ye,n=>Rt(n)?1:0)}doCounta(e,r){return this.reduce(e,r,0,"COUNTA",(n,i)=>n+i,ye,n=>n===ft?0:1)}doMax(e,r){const n=this.reduce(e,r,Number.NEGATIVE_INFINITY,"MAX",(i,o)=>Math.max(i,o),ye,ac);return Zy(n)}doMin(e,r){const n=this.reduce(e,r,Number.POSITIVE_INFINITY,"MIN",(i,o)=>Math.min(i,o),ye,ac);return Zy(n)}doSum(e,r){return this.reduce(e,r,0,"SUM",this.addWithEpsilonRaw,ye,ac)}doProduct(e,r){return this.reduce(e,r,1,"PRODUCT",(n,i)=>n*i,ye,ac)}reduce(e,r,n,i,o,a,s){return e.length<1?new C(N.NA,x.WrongArgNumber):e.reduce((l,u)=>{if(l instanceof C)return l;if(u.type===P.CELL_RANGE||u.type===P.COLUMN_RANGE||u.type===P.ROW_RANGE){const f=this.evaluateRange(u,r,n,i,o,a,s);return f instanceof C?f:o(f,l)}let c;if(c=this.evaluateAst(u,r),c instanceof Pe)return Array.from(c.valuesFromTopLeftCorner()).map(s).filter(h=>h!==void 0).map(h=>h instanceof C?h:a(h)).reduce((h,d)=>h instanceof C?h:d instanceof C?d:o(h,d),l);if(u.type===P.CELL_REFERENCE){if(c=s(c),c===void 0)return l}else if(c=this.coerceScalarToNumberOrError(c),c=s(c),c===void 0)return l;return c instanceof C?c:o(l,a(c))},n)}evaluateRange(e,r,n,i,o,a,s){let l;try{l=$e.fromAst(e,r.formulaAddress)}catch(f){if(f instanceof gv)return new C(N.REF,x.RangeManySheets);throw f}const u=this.dependencyGraph.getRange(l.start,l.end);if(u===void 0)throw new Error("Range does not exists in graph");let c=u.getFunctionValue(i);return c===void 0&&(c=this.getRangeValues(i,l,u,a,s).reduce((h,d)=>h instanceof C?h:d instanceof C?d:o(h,d),n),u.setFunctionValue(i,c)),c}getRangeValues(e,r,n,i,o){const a=[],{smallerRangeVertex:s,restRange:l}=this.dependencyGraph.rangeMapping.findSmallerRange(r);let u;if(s!==void 0&&this.dependencyGraph.existsEdge(s,n)){const c=s.getFunctionValue(e);if(c!==void 0)a.push(c);else for(const f of s.range.addresses(this.dependencyGraph)){const h=o(this.dependencyGraph.getScalarValue(f));h instanceof C?a.push(h):h!==void 0&&a.push(i(h))}u=l}else u=r;for(const c of u.addresses(this.dependencyGraph)){const f=o(this.dependencyGraph.getScalarValue(c));f instanceof C?a.push(f):f!==void 0&&a.push(i(f))}return a}}EI.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:g.NUMBER},{argumentType:g.ANY}],repeatLastArgs:1}};EI.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};function ac(t){if(Rt(t)||t instanceof C)return t}function Jy(t){return typeof t=="boolean"?R5(t):Rt(t)||t instanceof C?t:typeof t=="string"?0:void 0}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class NW extends Qe{power(e,r){return this.runFunction(e.args,r,this.metadata("POWER"),Math.pow)}}NW.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class PW extends Qe{radians(e,r){return this.runFunction(e.args,r,this.metadata("RADIANS"),n=>n*(Math.PI/180))}}PW.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:g.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Gr=10,MW=255,b9=2,w9=36,jPe="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";class kW extends Qe{dec2bin(e,r){return this.runFunction(e.args,r,this.metadata("DEC2BIN"),(n,i)=>Xo(n,2,i))}dec2oct(e,r){return this.runFunction(e.args,r,this.metadata("DEC2OCT"),(n,i)=>Xo(n,8,i))}dec2hex(e,r){return this.runFunction(e.args,r,this.metadata("DEC2HEX"),(n,i)=>Xo(n,16,i))}bin2dec(e,r){return this.runFunction(e.args,r,this.metadata("BIN2DEC"),n=>{const i=co(n,2,Gr);return i===void 0?new C(N.NUM,x.NotBinary):qo(i,2)})}bin2oct(e,r){return this.runFunction(e.args,r,this.metadata("BIN2OCT"),(n,i)=>{const o=co(n,2,Gr);return o===void 0?new C(N.NUM,x.NotBinary):Xo(qo(o,2),8,i)})}bin2hex(e,r){return this.runFunction(e.args,r,this.metadata("BIN2HEX"),(n,i)=>{const o=co(n,2,Gr);return o===void 0?new C(N.NUM,x.NotBinary):Xo(qo(o,2),16,i)})}oct2dec(e,r){return this.runFunction(e.args,r,this.metadata("OCT2DEC"),n=>{const i=co(n,8,Gr);return i===void 0?new C(N.NUM,x.NotOctal):qo(i,8)})}oct2bin(e,r){return this.runFunction(e.args,r,this.metadata("OCT2BIN"),(n,i)=>{const o=co(n,8,Gr);return o===void 0?new C(N.NUM,x.NotOctal):Xo(qo(o,8),2,i)})}oct2hex(e,r){return this.runFunction(e.args,r,this.metadata("OCT2HEX"),(n,i)=>{const o=co(n,8,Gr);return o===void 0?new C(N.NUM,x.NotOctal):Xo(qo(o,8),16,i)})}hex2dec(e,r){return this.runFunction(e.args,r,this.metadata("HEX2DEC"),n=>{const i=co(n,16,Gr);return i===void 0?new C(N.NUM,x.NotHex):qo(i,16)})}hex2bin(e,r){return this.runFunction(e.args,r,this.metadata("HEX2BIN"),(n,i)=>{const o=co(n,16,Gr);return o===void 0?new C(N.NUM,x.NotHex):Xo(qo(o,16),2,i)})}hex2oct(e,r){return this.runFunction(e.args,r,this.metadata("HEX2OCT"),(n,i)=>{const o=co(n,16,Gr);return o===void 0?new C(N.NUM,x.NotHex):Xo(qo(o,16),8,i)})}base(e,r){return this.runFunction(e.args,r,this.metadata("BASE"),GPe)}decimal(e,r){return this.runFunction(e.args,r,this.metadata("DECIMAL"),(n,i)=>{const o=co(n,i,MW);return o===void 0?new C(N.NUM,x.NotHex):parseInt(o,i)})}}kW.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:g.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:Gr}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:Gr}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:g.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:Gr}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:Gr}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:g.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:Gr}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:Gr}]},DECIMAL:{method:"decimal",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,minValue:b9,maxValue:w9}]},BASE:{method:"base",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:b9,maxValue:w9},{argumentType:g.NUMBER,optionalArg:!0,minValue:0,maxValue:MW}]}};function co(t,e,r){const n=jPe.substr(0,e),i=new RegExp(`^[${n}]+$`);if(!(t.length>r||!i.test(t)))return t}function Xo(t,e,r){if(t>WPe(e))return new C(N.NUM,x.ValueBaseLarge);if(t<xW(e))return new C(N.NUM,x.ValueBaseSmall);const n=$W(t,e);return r===void 0||t<0?n:n.length>r?new C(N.NUM,x.ValueBaseLong):Fn(n,r)}function xW(t){return-Math.pow(t,Gr)/2}function WPe(t){return-xW(t)-1}function GPe(t,e,r){const n=$W(t,e);return r!==void 0&&r>n.length?Fn(n,r):n}function $W(t,e){const r=t<0?Math.pow(e,Gr):0;return(t+r).toString(e).toUpperCase()}function qo(t,e){const r=parseInt(t,e),n=Math.pow(e,Gr);return r>=n/2?r-n:r}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class LW extends Qe{rand(e,r){return this.runFunction(e.args,r,this.metadata("RAND"),Math.random)}randbetween(e,r){return this.runFunction(e.args,r,this.metadata("RANDBETWEEN"),(n,i)=>i<n?new C(N.NUM,x.WrongOrder):(n=Math.ceil(n),i=Math.floor(i)+1,n===i&&(i+=1),n+Math.floor(Math.random()*(i-n))))}}LW.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}],isVolatile:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function S9(t){const e=Math.ceil(t);return e%2===1?e:e+1}function R9(t){const e=Math.ceil(t);return e%2===0?e:e+1}class CI extends Qe{roundup(e,r){return this.runFunction(e.args,r,this.metadata("ROUNDDOWN"),(n,i)=>{const o=Math.pow(10,i);return n<0?-Math.ceil(-n*o)/o:Math.ceil(n*o)/o})}rounddown(e,r){return this.runFunction(e.args,r,this.metadata("ROUNDDOWN"),(n,i)=>{const o=Math.pow(10,i);return n<0?-Math.floor(-n*o)/o:Math.floor(n*o)/o})}round(e,r){return this.runFunction(e.args,r,this.metadata("ROUND"),(n,i)=>{const o=Math.pow(10,i);return n<0?-Math.round(-n*o)/o:Math.round(n*o)/o})}intFunc(e,r){return this.runFunction(e.args,r,this.metadata("INT"),n=>n<0?-Math.floor(-n):Math.floor(n))}even(e,r){return this.runFunction(e.args,r,this.metadata("EVEN"),n=>n<0?-R9(-n):R9(n))}odd(e,r){return this.runFunction(e.args,r,this.metadata("ODD"),n=>n<0?-S9(-n):S9(n))}ceilingmath(e,r){return this.runFunction(e.args,r,this.metadata("CEILING.MATH"),(n,i,o)=>i===0||n===0?0:(i=Math.abs(i),o===1&&n<0&&(i=-i),Math.ceil(n/i)*i))}ceiling(e,r){return this.runFunction(e.args,r,this.metadata("CEILING"),(n,i)=>n===0?0:i===0?new C(N.DIV_BY_ZERO):n>0&&i<0?new C(N.NUM,x.DistinctSigns):Math.ceil(n/i)*i)}ceilingprecise(e,r){return this.runFunction(e.args,r,this.metadata("CEILING.PRECISE"),(n,i)=>i===0||n===0?0:(i=Math.abs(i),Math.ceil(n/i)*i))}floormath(e,r){return this.runFunction(e.args,r,this.metadata("FLOOR.MATH"),(n,i,o)=>i===0||n===0?0:(i=Math.abs(i),o===1&&n<0&&(i*=-1),Math.floor(n/i)*i))}floor(e,r){return this.runFunction(e.args,r,this.metadata("FLOOR"),(n,i)=>n===0?0:i===0?new C(N.DIV_BY_ZERO):n>0&&i<0?new C(N.NUM,x.DistinctSigns):Math.floor(n/i)*i)}floorprecise(e,r){return this.runFunction(e.args,r,this.metadata("FLOOR.PRECISE"),(n,i)=>i===0||n===0?0:(i=Math.abs(i),Math.floor(n/i)*i))}}CI.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:g.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:g.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:g.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:1},{argumentType:g.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:1},{argumentType:g.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,defaultValue:1}]}};CI.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class DW extends Qe{sqrt(e,r){return this.runFunction(e.args,r,this.metadata("SQRT"),Math.sqrt)}}DW.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:g.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function*zPe(){}function YPe(t){const e=t[Symbol.iterator](),{done:r,value:n}=e.next();return r?{rest:zPe()}:{value:n,rest:e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const KPe=(t,e,r)=>{if(r.end.row>r.start.row){const n=Se(r.end.sheet,r.end.col,r.end.row-1),i=t.getRange(r.start,n);if(i!==void 0)return{smallerRangeVertex:i,restValuesRange:r.withStart(Se(r.start.sheet,r.start.col,r.end.row)),restConditionRanges:e.map(o=>o.withStart(Se(o.start.sheet,o.start.col,o.end.row)))}}return{restValuesRange:r,restConditionRanges:e}};class XPe{constructor(e,r,n,i,o){this.interpreter=e,this.cacheKey=r,this.reduceInitialValue=n,this.composeFunction=i,this.mapFunction=o,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,r){for(const o of r)if(!o.conditionRange.sameDimensionsAs(e))return new C(N.VALUE,x.EqualLength);const n=this.tryToGetRangeVertexForRangeValue(e),i=r.map(o=>this.tryToGetRangeVertexForRangeValue(o.conditionRange));if(n&&i.every(o=>o!==void 0)){const o=r.map(l=>l.criterionPackage.raw).join(","),a=this.findAlreadyComputedValueInCache(n,this.cacheKey(r),o);if(a!==void 0)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),a;const s=this.buildNewCriterionCache(this.cacheKey(r),r.map(l=>l.conditionRange.range),e.range);return s.has(o)||s.set(o,[this.evaluateRangeValue(e,r),r.map(l=>l.criterionPackage.lambda)]),n.setCriterionFunctionValues(this.cacheKey(r),s),i.forEach(l=>{l!==void 0&&l.addDependentCacheRange(n)}),s.get(o)[0]}else return this.evaluateRangeValue(e,r)}tryToGetRangeVertexForRangeValue(e){const r=e.range;if(r!==void 0)return this.dependencyGraph.getRange(r.start,r.end)}reduceFunction(e){let r=this.reduceInitialValue;for(const n of e)r=this.composeFunction(r,n);return r}findAlreadyComputedValueInCache(e,r,n){return e.getCriterionFunctionValue(r,n)}evaluateRangeValue(e,r){const n=r.map(s=>s.criterionPackage.lambda),i=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),o=r.map(s=>s.conditionRange.iterateValuesFromTopLeftCorner()),a=C9(n,o,i);return this.reduceFunction(a)}buildNewCriterionCache(e,r,n){const i=this.dependencyGraph.getRange(n.start,n.end),{smallerRangeVertex:o,restConditionRanges:a,restValuesRange:s}=KPe(this.dependencyGraph,r,n);let l;o!==void 0&&this.dependencyGraph.existsEdge(o,i)?l=o.getCriterionFunctionValues(e):l=new Map;const u=new Map;return l.forEach(([c,f],h)=>{const d=C9(f,a.map(m=>E9(this.dependencyGraph,m)),Array.from(E9(this.dependencyGraph,s)).map(this.mapFunction)[Symbol.iterator]()),p=this.composeFunction(c,this.reduceFunction(d));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),u.set(h,[p,f])}),u}}class qPe{constructor(e,r){this.conditionRange=e,this.criterionPackage=r}}function*E9(t,e){for(const r of e.addresses(t))yield ye(t.getScalarValue(r))}function*C9(t,e,r){for(const n of r){const i=e.map(a=>YPe(a));if(!i.every(a=>Object.prototype.hasOwnProperty.call(a,"value")))return;const o=i.map(a=>ye(a.value));QPe(o,t).every(([a,s])=>s(a))&&(yield n),e=i.map(a=>a.rest)}}function QPe(t,e){const r=[];for(let n=0;n<Math.min(t.length,e.length);n++)r.push([t[n],e[n]]);return r}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class ks{constructor(e,r){this.sum=e,this.count=r}static single(e){return new ks(e,1)}compose(e){return new ks(this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}}ks.empty=new ks(0,0);function ZPe(t){return e=>{const r=e.map(n=>`${n.conditionRange.range.sheet},${n.conditionRange.range.start.col},${n.conditionRange.range.start.row}`);return[t,...r].join(",")}}function O9(t){return Rt(t)&&!Number.isFinite(ye(t))?0:t}function e1(t){if(t instanceof C)return t;if(Rt(t))return ye(t)}class FW extends Qe{sumif(e,r){const n="SUMIF",i=(o,a,s)=>this.computeConditionalAggregationFunction(s??o,[o,a],n,0,(l,u)=>this.arithmeticHelper.nonstrictadd(l,u),e1);return this.runFunction(e.args,r,this.metadata(n),i)}sumifs(e,r){const n="SUMIFS",i=(o,...a)=>this.computeConditionalAggregationFunction(o,a,n,0,(s,l)=>this.arithmeticHelper.nonstrictadd(s,l),e1);return this.runFunction(e.args,r,this.metadata(n),i)}averageif(e,r){const n="AVERAGEIF",i=(o,a,s)=>{const l=this.computeConditionalAggregationFunction(s??o,[o,a],n,ks.empty,(u,c)=>u.compose(c),u=>Rt(u)?ks.single(ye(u)):ks.empty);return l instanceof C?l:l.averageValue()||new C(N.DIV_BY_ZERO)};return this.runFunction(e.args,r,this.metadata(n),i)}countif(e,r){const n="COUNTIF",i=(o,a)=>this.computeConditionalAggregationFunction(o,[o,a],n,0,(s,l)=>s+l,()=>1);return this.runFunction(e.args,r,this.metadata(n),i)}countifs(e,r){const n="COUNTIFS",i=(...o)=>this.computeConditionalAggregationFunction(o[0],o,n,0,(a,s)=>a+s,()=>1);return this.runFunction(e.args,r,this.metadata(n),i)}minifs(e,r){const n="MINIFS",i=(a,s)=>s===void 0||a===void 0?s===void 0?a:s:Math.min(a,s),o=(a,...s)=>{const l=this.computeConditionalAggregationFunction(a,s,n,Number.POSITIVE_INFINITY,i,e1);return O9(l)};return this.runFunction(e.args,r,this.metadata(n),o)}maxifs(e,r){const n="MAXIFS",i=(a,s)=>s===void 0||a===void 0?s===void 0?a:s:Math.max(a,s),o=(a,...s)=>{const l=this.computeConditionalAggregationFunction(a,s,n,Number.NEGATIVE_INFINITY,i,e1);return O9(l)};return this.runFunction(e.args,r,this.metadata(n),o)}computeConditionalAggregationFunction(e,r,n,i,o,a){const s=[];for(let l=0;l<r.length;l+=2){const u=r[l],c=this.interpreter.criterionBuilder.fromCellValue(r[l+1],this.arithmeticHelper);if(c===void 0)return new C(N.VALUE,x.BadCriterion);s.push(new qPe(u,c))}return new XPe(this.interpreter,ZPe(n),i,o,a).compute(e,s)}}FW.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:g.RANGE},{argumentType:g.NOERROR},{argumentType:g.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:g.RANGE},{argumentType:g.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:g.RANGE},{argumentType:g.NOERROR},{argumentType:g.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE},{argumentType:g.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:g.RANGE},{argumentType:g.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE},{argumentType:g.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE},{argumentType:g.NOERROR}],repeatLastArgs:2}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class HW extends Qe{sumproduct(e,r){return this.runFunction(e.args,r,this.metadata("SUMPRODUCT"),(...n)=>{const i=n[0].width(),o=n[0].height();for(const l of n)if(l.width()!==i||l.height()!==o)return new C(N.VALUE,x.EqualLength);let a=0;const s=n.map(l=>l.iterateValuesFromTopLeftCorner());for(let l=0;l<i*o;l++){let u=1;for(const c of s){const f=c.next().value;if(f instanceof C)return f;const h=this.coerceScalarToNumberOrError(f);Rt(h)?u*=ye(h):u=0}a+=u}return a})}}HW.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:g.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class UW extends Qe{concatenate(e,r){return this.runFunction(e.args,r,this.metadata("CONCATENATE"),(...n)=>"".concat(...n))}split(e,r){return this.runFunction(e.args,r,this.metadata("SPLIT"),(n,i)=>{const o=n.split(" ");return i>=o.length||i<0?new C(N.VALUE,x.IndexBounds):o[i]})}len(e,r){return this.runFunction(e.args,r,this.metadata("LEN"),n=>n.length)}lower(e,r){return this.runFunction(e.args,r,this.metadata("LOWER"),n=>n.toLowerCase())}trim(e,r){return this.runFunction(e.args,r,this.metadata("TRIM"),n=>n.replace(/^ +| +$/g,"").replace(/ +/g," "))}proper(e,r){return this.runFunction(e.args,r,this.metadata("PROPER"),n=>n.replace(new RegExp("\\p{L}+","gu"),i=>i.charAt(0).toUpperCase()+i.substring(1).toLowerCase()))}clean(e,r){return this.runFunction(e.args,r,this.metadata("CLEAN"),n=>n.replace(/[\u0000-\u001F]/g,""))}exact(e,r){return this.runFunction(e.args,r,this.metadata("EXACT"),(n,i)=>n===i)}rept(e,r){return this.runFunction(e.args,r,this.metadata("REPT"),(n,i)=>i<0?new C(N.VALUE,x.NegativeCount):n.repeat(i))}right(e,r){return this.runFunction(e.args,r,this.metadata("RIGHT"),(n,i)=>i<0?new C(N.VALUE,x.NegativeLength):i===0?"":n.slice(-i))}left(e,r){return this.runFunction(e.args,r,this.metadata("LEFT"),(n,i)=>i<0?new C(N.VALUE,x.NegativeLength):n.slice(0,i))}mid(e,r){return this.runFunction(e.args,r,this.metadata("MID"),(n,i,o)=>i<1?new C(N.VALUE,x.LessThanOne):o<0?new C(N.VALUE,x.NegativeLength):n.substring(i-1,i+o-1))}replace(e,r){return this.runFunction(e.args,r,this.metadata("REPLACE"),(n,i,o,a)=>i<1?new C(N.VALUE,x.LessThanOne):o<0?new C(N.VALUE,x.NegativeLength):n.substring(0,i-1)+a+n.substring(i+o-1))}search(e,r){return this.runFunction(e.args,r,this.metadata("SEARCH"),(n,i,o)=>{if(o<1||o>i.length)return new C(N.VALUE,x.LengthBounds);const a=n.toLowerCase(),s=i.substring(o-1).toLowerCase(),l=this.arithmeticHelper.requiresRegex(a)?this.arithmeticHelper.searchString(a,s):s.indexOf(a);return l>-1?l+o:new C(N.VALUE,x.PatternNotFound)})}substitute(e,r){return this.runFunction(e.args,r,this.metadata("SUBSTITUTE"),(n,i,o,a)=>{const s=new RegExp(i,"g");if(a===void 0)return n.replace(s,o);if(a<1)return new C(N.VALUE,x.LessThanOne);let l,u=0;for(;(l=s.exec(n))!==null;)if(a===++u)return n.substring(0,l.index)+o+n.substring(s.lastIndex);return n})}find(e,r){return this.runFunction(e.args,r,this.metadata("FIND"),(n,i,o)=>{if(o<1||o>i.length)return new C(N.VALUE,x.IndexBounds);const s=i.substring(o-1).indexOf(n)+o;return s>0?s:new C(N.VALUE,x.PatternNotFound)})}t(e,r){return this.runFunction(e.args,r,this.metadata("T"),n=>n instanceof C||typeof n=="string"?n:"")}upper(e,r){return this.runFunction(e.args,r,this.metadata("UPPER"),n=>n.toUpperCase())}}UW.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:g.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:g.STRING},{argumentType:g.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:g.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:g.STRING}]},MID:{method:"mid",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:g.STRING}]},T:{method:"t",parameters:[{argumentType:g.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:g.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:g.STRING}]},REPT:{method:"rept",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:g.STRING},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:g.STRING},{argumentType:g.STRING},{argumentType:g.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:g.STRING},{argumentType:g.STRING},{argumentType:g.STRING},{argumentType:g.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:g.STRING},{argumentType:g.STRING},{argumentType:g.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:g.STRING}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class BW extends Qe{acos(e,r){return this.runFunction(e.args,r,this.metadata("ACOS"),Math.acos)}asin(e,r){return this.runFunction(e.args,r,this.metadata("ASIN"),Math.asin)}cos(e,r){return this.runFunction(e.args,r,this.metadata("COS"),Math.cos)}sin(e,r){return this.runFunction(e.args,r,this.metadata("SIN"),Math.sin)}tan(e,r){return this.runFunction(e.args,r,this.metadata("TAN"),Math.tan)}atan(e,r){return this.runFunction(e.args,r,this.metadata("ATAN"),Math.atan)}atan2(e,r){return this.runFunction(e.args,r,this.metadata("ATAN2"),(n,i)=>n===0&&i===0?new C(N.DIV_BY_ZERO):Math.atan2(i,n))}cot(e,r){return this.runFunction(e.args,r,this.metadata("COT"),n=>n===0?new C(N.DIV_BY_ZERO):1/Math.tan(n))}acot(e,r){return this.runFunction(e.args,r,this.metadata("ACOT"),n=>n===0?k5/2:Math.atan(1/n))}sec(e,r){return this.runFunction(e.args,r,this.metadata("SEC"),n=>1/Math.cos(n))}csc(e,r){return this.runFunction(e.args,r,this.metadata("CSC"),n=>n===0?new C(N.DIV_BY_ZERO):1/Math.sin(n))}sinh(e,r){return this.runFunction(e.args,r,this.metadata("SINH"),Math.sinh)}asinh(e,r){return this.runFunction(e.args,r,this.metadata("ASINH"),Math.asinh)}cosh(e,r){return this.runFunction(e.args,r,this.metadata("COSH"),Math.cosh)}acosh(e,r){return this.runFunction(e.args,r,this.metadata("ACOSH"),Math.acosh)}tanh(e,r){return this.runFunction(e.args,r,this.metadata("TANH"),Math.tanh)}atanh(e,r){return this.runFunction(e.args,r,this.metadata("ATANH"),Math.atanh)}coth(e,r){return this.runFunction(e.args,r,this.metadata("COTH"),n=>n===0?new C(N.DIV_BY_ZERO):1/Math.tanh(n))}acoth(e,r){return this.runFunction(e.args,r,this.metadata("ACOTH"),n=>n===0?new C(N.NUM,x.NonZero):Math.atanh(1/n))}sech(e,r){return this.runFunction(e.args,r,this.metadata("SECH"),n=>1/Math.cosh(n))}csch(e,r){return this.runFunction(e.args,r,this.metadata("CSCH"),n=>n===0?new C(N.DIV_BY_ZERO):1/Math.sinh(n))}}BW.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:g.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:g.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:g.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:g.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:g.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:g.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:g.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:g.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:g.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:g.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:g.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:g.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:g.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:g.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:g.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:g.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:g.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:g.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:g.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:g.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class JPe extends Zj{constructor(e){super(e),this.dependencyGraph=e}find(e,r,n){return this.basicFind(e,r,"col",n)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class VW extends Qe{constructor(){super(...arguments),this.rowSearch=new JPe(this.dependencyGraph)}vlookup(e,r){return this.runFunction(e.args,r,this.metadata("VLOOKUP"),(n,i,o,a)=>{const s=i.range;return s===void 0?new C(N.VALUE,x.WrongType):o<1?new C(N.VALUE,x.LessThanOne):o>s.width()?new C(N.REF,x.IndexLarge):this.doVlookup(L6(n),i,o-1,a)})}hlookup(e,r){return this.runFunction(e.args,r,this.metadata("HLOOKUP"),(n,i,o,a)=>{const s=i.range;return s===void 0?new C(N.VALUE,x.WrongType):o<1?new C(N.VALUE,x.LessThanOne):o>s.height()?new C(N.REF,x.IndexLarge):this.doHlookup(L6(n),i,o-1,a)})}match(e,r){return this.runFunction(e.args,r,this.metadata("MATCH"),(n,i,o)=>this.doMatch(L6(n),i,o))}searchInRange(e,r,n,i){if(!n&&typeof e=="string"&&this.arithmeticHelper.requiresRegex(e))return i.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),r);{const o=n?{ordering:"asc"}:{ordering:"none",matchExactly:!0};return i.find(e,r,o)}}doVlookup(e,r,n,i){this.dependencyGraph.stats.start(Ke.VLOOKUP);const o=r.range;let a;o===void 0?a=Pe.onlyValues(r.data.map(u=>[u[0]])):a=Pe.onlyRange($e.spanFrom(o.start,1,o.height()),this.dependencyGraph);const s=this.searchInRange(e,a,i,this.columnSearch);if(this.dependencyGraph.stats.end(Ke.VLOOKUP),s===-1)return new C(N.NA,x.ValueNotFound);let l;if(o===void 0)l=r.data[s][n];else{const u=Se(o.sheet,o.start.col+n,o.start.row+s);l=this.dependencyGraph.getCellValue(u)}return l instanceof Pe?new C(N.VALUE,x.WrongType):l}doHlookup(e,r,n,i){const o=r.range;let a;o===void 0?a=Pe.onlyValues([r.data[0]]):a=Pe.onlyRange($e.spanFrom(o.start,o.width(),1),this.dependencyGraph);const s=this.searchInRange(e,a,i,this.rowSearch);if(s===-1)return new C(N.NA,x.ValueNotFound);let l;if(o===void 0)l=r.data[n][s];else{const u=Se(o.sheet,o.start.col+s,o.start.row+n);l=this.dependencyGraph.getCellValue(u)}return l instanceof Pe?new C(N.VALUE,x.WrongType):l}doMatch(e,r,n){if(![-1,0,1].includes(n))return new C(N.VALUE,x.BadMode);if(r.width()>1&&r.height()>1)return new C(N.NA);const i=r.width()===1?this.columnSearch:this.rowSearch,o=n===0?{ordering:"none",matchExactly:!0}:{ordering:n===-1?"desc":"asc"},a=i.find(e,r,o);return a===-1?new C(N.NA,x.ValueNotFound):a+1}}VW.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:g.NOERROR},{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:g.NOERROR},{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:g.NOERROR},{argumentType:g.RANGE},{argumentType:g.NUMBER,defaultValue:1}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class jW extends Qe{roman(e,r){return this.runFunction(e.args,r,this.metadata("ROMAN"),(n,i)=>(n=Math.trunc(n),i===!1?i=4:i===!0&&(i=0),i=ye(this.coerceScalarToNumberOrError(i)),i instanceof C?i:(i=Math.trunc(i),i<0?new C(N.VALUE,x.ValueSmall):i>4?new C(N.VALUE,x.ValueLarge):e8e(n,i))))}arabic(e,r){return this.runFunction(e.args,r,this.metadata("ARABIC"),n=>{n=n.trim().toUpperCase();let i=!1;if(n.startsWith("-")&&(n=n.slice(1),i=!0,n===""))return new C(N.VALUE,x.InvalidRoman);const o={input:n,acc:0};return fo(o,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),fo(o,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),fo(o,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),fo(o,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),fo(o,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),fo(o,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),fo(o,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),fo(o,{token:"IX",val:9}),fo(o,{token:"V",val:5},{token:"IV",val:4}),fo(o,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),o.input!==""?new C(N.VALUE,x.InvalidRoman):i?-o.acc:o.acc})}}jW.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:g.NUMBER,minValue:1,lessThan:4e3},{argumentType:g.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:g.STRING}]}};function fo(t,...e){for(const r of e)if(t.input.startsWith(r.token)){t.input=t.input.slice(r.token.length),t.acc+=r.val;break}}function e8e(t,e){const r={val:t%1e3,acc:"M".repeat(Math.floor(t/1e3))};return e===4&&(Er(r,"IM",999,1e3),Er(r,"ID",499,500)),e>=3&&(Er(r,"VM",995,1e3),Er(r,"VD",495,500)),e>=2&&(Er(r,"XM",990,1e3),Er(r,"XD",490,500)),e>=1&&(Er(r,"LM",950,1e3),Er(r,"LD",450,500)),Er(r,"CM",900,1e3),Er(r,"CD",400,500),Er(r,"D",500,900),r.acc+="C".repeat(Math.floor(r.val/100)),r.val%=100,e>=2&&(Er(r,"IC",99,100),Er(r,"IL",49,50)),e>=1&&(Er(r,"VC",95,100),Er(r,"VL",45,50)),Er(r,"XC",90,100),Er(r,"XL",40,50),Er(r,"L",50,90),r.acc+="X".repeat(Math.floor(r.val/10)),r.val%=10,Er(r,"IX",9,10),Er(r,"IV",4,5),Er(r,"V",5,9),r.acc+="I".repeat(r.val),r.acc}function Er(t,e,r,n){t.val>=r&&t.val<n&&(t.val-=r,t.acc+=e)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class WW extends Qe{add(e,r){return this.runFunction(e.args,r,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,r){return this.runFunction(e.args,r,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,r){return this.runFunction(e.args,r,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,r){return this.runFunction(e.args,r,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,r){return this.runFunction(e.args,r,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,r){return this.runFunction(e.args,r,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,r){return this.runFunction(e.args,r,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,r){return this.runFunction(e.args,r,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,r){return this.runFunction(e.args,r,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,r){return this.runFunction(e.args,r,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,r){return this.runFunction(e.args,r,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,r){return this.runFunction(e.args,r,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,r){return this.runFunction(e.args,r,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,r){return this.runFunction(e.args,r,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,r){return this.runFunction(e.args,r,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}WW.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:g.NUMBER,passSubtype:!0},{argumentType:g.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:g.STRING,passSubtype:!0},{argumentType:g.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:g.NUMBER,passSubtype:!0},{argumentType:g.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:g.NOERROR,passSubtype:!0},{argumentType:g.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:g.NOERROR,passSubtype:!0},{argumentType:g.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:g.NOERROR,passSubtype:!0},{argumentType:g.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:g.NOERROR,passSubtype:!0},{argumentType:g.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:g.NOERROR,passSubtype:!0},{argumentType:g.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:g.NUMBER,passSubtype:!0},{argumentType:g.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:g.NUMBER,passSubtype:!0},{argumentType:g.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:g.NOERROR,passSubtype:!0},{argumentType:g.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:g.NUMBER,passSubtype:!0},{argumentType:g.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:g.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:g.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:g.NUMBER,passSubtype:!0}]}};/**
 * @license
 bessel.js (C) 2013-present SheetJS -- http://sheetjs.com

 Apache License
 Version 2.0, January 2004
 http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

 "License" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 "Licensor" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 "Legal Entity" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 "control" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 "You" (or "Your") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 "Source" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 "Object" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not limited to compiled object code, generated documentation,
 and conversions to other media types.

 "Work" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 "Derivative Works" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 "Contribution" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, "submitted"
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as "Not a Contribution."

 "Contributor" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a "NOTICE" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
 or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
 negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all
 other commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets "{}"
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same "printed page" as the copyright notice for easier
 identification within third-party archives.

 Copyright (C) 2013-present   SheetJS LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 */var tt=Math;function nr(t,e){for(var r=0,n=0;r<t.length;++r)n=e*n+t[r];return n}function GW(t,e,r,n,i){if(e===0)return r;if(e===1)return n;for(var o=2/t,a=n,s=1;s<e;++s)a=n*s*o+i*r,r=n,n=a;return a}function zW(t,e,r,n,i){return function(a,s){if(n){if(a===0)return n==1?-1/0:1/0;if(a<0)return NaN}if(s===0)return t(a);if(s===1)return e(a);if(s<0)return NaN;s|=0;var l=t(a),u=e(a);return GW(a,s,l,u,i)}}var x5=function(){var t=.636619772,e=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),r=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function o(f){var h=0,d=0,p=0,m=f*f;if(f<8)d=nr(e,m),p=nr(r,m),h=d/p;else{var y=f-.785398164;m=64/m,d=nr(n,m),p=nr(i,m),h=tt.sqrt(t/f)*(tt.cos(y)*d-tt.sin(y)*p*8/f)}return h}var a=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),s=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function c(f){var h=0,d=0,p=0,m=f*f,y=tt.abs(f)-2.356194491;return Math.abs(f)<8?(d=f*nr(a,m),p=nr(s,m),h=d/p):(m=64/m,d=nr(l,m),p=nr(u,m),h=tt.sqrt(t/tt.abs(f))*(tt.cos(y)*d-tt.sin(y)*p*8/tt.abs(f)),f<0&&(h=-h)),h}return function f(h,d){if(d=Math.round(d),!isFinite(h))return isNaN(h)?h:0;if(d<0)return(d%2?-1:1)*f(h,-d);if(h<0)return(d%2?-1:1)*f(-h,d);if(d===0)return o(h);if(d===1)return c(h);if(h===0)return 0;var p=0;if(h>d)p=GW(h,d,o(h),c(h),-1);else{for(var m=2*tt.floor((d+tt.floor(tt.sqrt(40*d)))/2),y=!1,S=0,R=0,E=1,O=0,A=2/h,B=m;B>0;B--)O=B*A*E-S,S=E,E=O,tt.abs(E)>1e10&&(E*=1e-10,S*=1e-10,p*=1e-10,R*=1e-10),y&&(R+=E),y=!y,B==d&&(p=S);R=2*R-E,p/=R}return p}}(),t8e=function(){var t=.636619772,e=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),r=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function o(f){var h=0,d=0,p=0,m=f*f,y=f-.785398164;return f<8?(d=nr(e,m),p=nr(r,m),h=d/p+t*x5(f,0)*tt.log(f)):(m=64/m,d=nr(n,m),p=nr(i,m),h=tt.sqrt(t/f)*(tt.sin(y)*d+tt.cos(y)*p*8/f)),h}var a=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),s=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function c(f){var h=0,d=0,p=0,m=f*f,y=f-2.356194491;return f<8?(d=f*nr(a,m),p=nr(s,m),h=d/p+t*(x5(f,1)*tt.log(f)-1/f)):(m=64/m,d=nr(l,m),p=nr(u,m),h=tt.sqrt(t/f)*(tt.sin(y)*d+tt.cos(y)*p*8/f)),h}return zW(o,c,"BESSELY",1,-1)}(),$5=function(){var t=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),e=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function r(a){return a<=3.75?nr(t,a*a/(3.75*3.75)):tt.exp(tt.abs(a))/tt.sqrt(tt.abs(a))*nr(e,3.75/tt.abs(a))}var n=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),i=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function o(a){return a<3.75?a*nr(n,a*a/(3.75*3.75)):(a<0?-1:1)*tt.exp(tt.abs(a))/tt.sqrt(tt.abs(a))*nr(i,3.75/tt.abs(a))}return function a(s,l){if(l=Math.round(l),l===0)return r(s);if(l===1)return o(s);if(l<0)return NaN;if(tt.abs(s)===0)return 0;if(s==1/0)return 1/0;var u=0,c,f=2/tt.abs(s),h=0,d=1,p=0,m=2*tt.round((l+tt.round(tt.sqrt(40*l)))/2);for(c=m;c>0;c--)p=c*f*d+h,h=d,d=p,tt.abs(d)>1e10&&(d*=1e-10,h*=1e-10,u*=1e-10),c==l&&(u=h);return u*=a(s,0)/d,s<0&&l%2?-u:u}}(),r8e=function(){var t=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),e=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function r(a){return a<=2?-tt.log(a/2)*$5(a,0)+nr(t,a*a/4):tt.exp(-a)/tt.sqrt(a)*nr(e,2/a)}var n=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),i=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function o(a){return a<=2?tt.log(a/2)*$5(a,1)+1/a*nr(n,a*a/4):tt.exp(-a)/tt.sqrt(a)*nr(i,2/a)}return zW(r,o,"BESSELK",2,1)}();/**
 * @license
 Copyright (c) 2013 jStat

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */function Qc(t){const e=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let r=e.length-1,n=!1,i=0,o=0,a,s,l,u;if(t===0)return 0;for(t<0&&(t=-t,n=!0),a=2/(2+t),s=4*a-2;r>0;r--)l=i,i=s*i-o+e[r],o=l;return u=a*Math.exp(-t*t+.5*(e[0]+s*i)-o),n?u-1:1-u}function YW(t){return 1-Qc(t)}function KW(t){let e=0,r,n,i,o;if(t>=2)return-100;if(t<=0)return 100;for(o=t<1?t:2-t,i=Math.sqrt(-2*Math.log(o/2)),r=-.70711*((2.30753+i*.27061)/(1+i*(.99229+i*.04481))-i);e<2;e++)n=YW(r)-o,r+=n/(1.1283791670955126*Math.exp(-r*r)-r*n);return t<1?r:-r}const T9={pdf:(t,e)=>t<0?0:e*Math.exp(-e*t),cdf:(t,e)=>t<0?0:1-Math.exp(-e*t)};function Vp(t){const e=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],r=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let n=!1,i=0,o=0,a=0,s=t,l,u,c,f;if(t>171.6243769536076)return 1/0;if(s<=0)if(f=s%1,f)n=(s&1?-1:1)*Math.PI/Math.sin(Math.PI*f),s=1-s;else return 1/0;for(c=s,s<1?u=s++:u=(s-=i=(s|0)-1)-1,l=0;l<8;++l)a=(a+e[l])*u,o=o*u+r[l];if(f=a/o+1,c<s)f/=c;else if(c>s)for(l=0;l<i;++l)f*=s,s++;return n&&(f=n/f),f}const V6={pdf:function(e,r,n){return e<0?0:e===0&&r===1?1/n:Math.exp((r-1)*Math.log(e)-e/n-qr(r)-r*Math.log(n))},cdf:function(e,r,n){return e<0?0:OI(r,e/n)},inv:function(t,e,r){return XW(t,e)*r}};function qr(t){let e=0;const r=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let n=1.000000000190015,i,o,a;for(a=(o=i=t)+5.5,a-=(i+.5)*Math.log(a);e<6;e++)n+=r[e]/++o;return Math.log(2.5066282746310007*n/i)-a}function OI(t,e){const r=qr(t);let n=t,i=1/t,o=i,a=e+1-t,s=1/1e-30,l=1/a,u=l,c=1;const f=-~(Math.log(t>=1?t:1/t)*8.5+t*.4+17);let h;if(e<0||t<=0)return NaN;if(e<t+1){for(;c<=f;c++)i+=o*=e/++n;return i*Math.exp(-e+t*Math.log(e)-r)}for(;c<=f;c++)h=-c*(c-t),a+=2,l=h*l+a,s=a+h/s,l=1/l,u*=l*s;return 1-u*Math.exp(-e+t*Math.log(e)-r)}function XW(t,e){let r=0;const n=e-1,i=1e-8,o=qr(e);let a,s,l,u,c,f,h;if(t>=1)return Math.max(100,e+100*Math.sqrt(e));if(t<=0)return 0;for(e>1?(f=Math.log(n),h=Math.exp(n*(f-1)-o),c=t<.5?t:1-t,l=Math.sqrt(-2*Math.log(c)),a=(2.30753+l*.27061)/(1+l*(.99229+l*.04481))-l,t<.5&&(a=-a),a=Math.max(.001,e*Math.pow(1-1/(9*e)-a/(3*Math.sqrt(e)),3))):(l=1-e*(.253+e*.12),t<l?a=Math.pow(t/l,1/e):a=1-Math.log(1-(t-l)/(1-l)));r<12;r++){if(a<=0)return 0;if(s=OI(e,a)-t,e>1?l=h*Math.exp(-(a-n)+n*(Math.log(a)-f)):l=Math.exp(-a+n*Math.log(a)-o),u=s/l,a-=l=u/(1-.5*Math.min(1,u*((e-1)/a-1))),a<=0&&(a=.5*(a+l)),Math.abs(l)<i*a)break}return a}const Bi={pdf:function(e,r,n){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(e-r,2)/(2*n*n))},cdf:function(e,r,n){return .5*(1+Qc((e-r)/Math.sqrt(2*n*n)))},inv:function(t,e,r){return-1.4142135623730951*r*KW(2*t)+e}},j6={pdf:function(e,r,n){return e>1||e<0?0:r==1&&n==1?1:r<512&&n<512?Math.pow(e,r-1)*Math.pow(1-e,n-1)/TI(r,n):Math.exp((r-1)*Math.log(e)+(n-1)*Math.log(1-e)-qW(r,n))},cdf:function(e,r,n){return e>1||e<0?+(e>1):Fw(e,r,n)},inv:function(e,r,n){return _I(e,r,n)}};function TI(t,e){if(!(t<=0||e<=0))return t+e>170?Math.exp(qW(t,e)):Vp(t)*Vp(e)/Vp(t+e)}function qW(t,e){return qr(t)+qr(e)-qr(t+e)}function _I(t,e,r){var n=1e-8,i=e-1,o=r-1,a=0,s,l,u,c,f,h,d,p,m,y,S;if(t<=0)return 0;if(t>=1)return 1;for(e>=1&&r>=1?(u=t<.5?t:1-t,c=Math.sqrt(-2*Math.log(u)),d=(2.30753+c*.27061)/(1+c*(.99229+c*.04481))-c,t<.5&&(d=-d),p=(d*d-3)/6,m=2/(1/(2*e-1)+1/(2*r-1)),y=d*Math.sqrt(p+m)/m-(1/(2*r-1)-1/(2*e-1))*(p+5/6-2/(3*m)),d=e/(e+r*Math.exp(2*y))):(s=Math.log(e/(e+r)),l=Math.log(r/(e+r)),c=Math.exp(e*s)/e,f=Math.exp(r*l)/r,y=c+f,t<c/y?d=Math.pow(e*y*t,1/e):d=1-Math.pow(r*y*(1-t),1/r)),S=-qr(e)-qr(r)+qr(e+r);a<10;a++){if(d===0||d===1)return d;if(h=Fw(d,e,r)-t,c=Math.exp(i*Math.log(d)+o*Math.log(1-d)+S),f=h/c,d-=c=f/(1-.5*Math.min(1,f*(i/d-o/(1-d)))),d<=0&&(d=.5*(d+c)),d>=1&&(d=.5*(d+c+1)),Math.abs(c)<n*d&&a>0)break}return d}function Fw(t,e,r){var n=t===0||t===1?0:Math.exp(qr(e+r)-qr(e)-qr(r)+e*Math.log(t)+r*Math.log(1-t));return t<0||t>1?!1:t<(e+1)/(e+r+2)?n*_9(t,e,r)/e:1-n*_9(1-t,r,e)/r}function _9(t,e,r){var n=1e-30,i=1,o=e+r,a=e+1,s=e-1,l=1,u=1-o*t/a,c,f,h,d;for(Math.abs(u)<n&&(u=n),u=1/u,d=u;i<=100&&(c=2*i,f=i*(r-i)*t/((s+c)*(e+c)),u=1+f*u,Math.abs(u)<n&&(u=n),l=1+f/l,Math.abs(l)<n&&(l=n),u=1/u,d*=u*l,f=-(e+i)*(o+i)*t/((e+c)*(a+c)),u=1+f*u,Math.abs(u)<n&&(u=n),l=1+f/l,Math.abs(l)<n&&(l=n),u=1/u,h=u*l,d*=h,!(Math.abs(h-1)<3e-7));i++);return d}const f0={pdf:function(t,e,r){return r===0||r===1?e*r===t?1:0:QW(e,t)*Math.pow(r,t)*Math.pow(1-r,e-t)},cdf:function(t,e,r){var n,i=1e-10;if(t<0)return 0;if(t>=e)return 1;if(r<0||r>1||e<=0)return NaN;t=Math.floor(t);var o=r,a=t+1,s=e-t,l=a+s,u=Math.exp(qr(l)-qr(s)-qr(a)+a*Math.log(o)+s*Math.log(1-o));return o<(a+1)/(l+2)?n=u*A9(o,a,s,i):n=1-u*A9(1-o,s,a,i),Math.round((1-n)*(1/i))/(1/i)}};function A9(t,e,r,n){for(var i=0,o=1,a=1,s=1,l=0,u=0,c;Math.abs((a-u)/a)>n;)u=a,c=-(e+l)*(e+r+l)*t/(e+2*l)/(e+2*l+1),i=a+c*i,o=s+c*o,l=l+1,c=l*(r-l)*t/(e+2*l-1)/(e+2*l),a=i+c*a,s=o+c*s,i=i/s,o=o/s,a=a/s,s=1;return a/e}function QW(t,e){return t>170||e>170?Math.exp(n8e(t,e)):h0(t)/h0(e)/h0(t-e)}function n8e(t,e){return W6(t)-W6(e)-W6(t-e)}function W6(t){return t<0?NaN:qr(t+1)}function h0(t){return t<0?NaN:Vp(t+1)}const Mc={pdf:function(e,r){return e<0?0:e===0&&r===2?.5:Math.exp((r/2-1)*Math.log(e)-e/2-r/2*Math.log(2)-qr(r/2))},cdf:function(e,r){return e<0?0:OI(r/2,e/2)},inv:function(t,e){return 2*XW(t,.5*e)}},kc={pdf:function(e,r,n){var i,o,a;return e<0?0:r<=2?e===0&&r<2?1/0:e===0&&r===2?1:1/TI(r/2,n/2)*Math.pow(r/n,r/2)*Math.pow(e,r/2-1)*Math.pow(1+r/n*e,-(r+n)/2):(i=r*e/(n+e*r),o=n/(n+e*r),a=r*o/2,a*f0.pdf((r-2)/2,(r+n-2)/2,i))},cdf:function(e,r,n){return e<0?0:Fw(r*e/(r*e+n),r/2,n/2)},inv:function(e,r,n){return n/(r*(1/_I(e,r/2,n/2)-1))}},I9={pdf:function(e,r,n){return e<0||r<0||n<0?0:n/r*Math.pow(e/r,n-1)*Math.exp(-Math.pow(e/r,n))},cdf:function(e,r,n){return e<0?0:1-Math.exp(-Math.pow(e/r,n))}},L5={pdf:function(e,r){return r<0||e%1!==0||e<0?0:Math.pow(r,e)*Math.exp(-r)/h0(e)},cdf:function(e,r){var n=0;if(e<0)return 0;for(var i=0;n<=e;n++)i+=L5.pdf(n,r);return i}},sa={pdf:function(e,r,n,i){if(e<0||e<n-(r-i))return 0;if(e>i||e>n)return 0;if(n*2>r)return i*2>r?sa.pdf(r-n-i+e,r,r-n,r-i):sa.pdf(i-e,r,r-n,i);if(i*2>r)return sa.pdf(n-e,r,n,r-i);if(n<i)return sa.pdf(e,r,i,n);for(var o=1,a=0,s=0;s<e;s++){for(;o>1&&a<i;)o*=1-n/(r-a),a++;o*=(i-s)*(n-s)/((s+1)*(r-n-i+s+1))}for(;a<i;a++)o*=1-n/(r-a);return Math.min(1,Math.max(0,o))},cdf:function t(e,r,n,i){if(e<0||e<n-(r-i))return 0;if(e>=i||e>=n)return 1;if(n*2>r)return i*2>r?t(r-n-i+e,r,r-n,r-i):1-sa.cdf(i-e-1,r,r-n,i);if(i*2>r)return 1-sa.cdf(n-e-1,r,n,r-i);if(n<i)return sa.cdf(e,r,i,n);for(var o=1,a=1,s=0,l=0;l<e;l++){for(;o>1&&s<i;){var u=1-n/(r-s);a*=u,o*=u,s++}a*=(i-l)*(n-l)/((l+1)*(r-n-i+l+1)),o+=a}for(;s<i;s++)o*=1-n/(r-s);return Math.min(1,Math.max(0,o))}},Ri={pdf:function(e,r){return r=r>1e100?1e100:r,1/(Math.sqrt(r)*TI(.5,r/2))*Math.pow(1+e*e/r,-((r+1)/2))},cdf:function(e,r){var n=r/2;return Fw((e+Math.sqrt(e*e+r))/(2*Math.sqrt(e*e+r)),n,n)},inv:function(t,e){var r=_I(2*Math.min(t,1-t),.5*e,.5);return r=Math.sqrt(e*(1-r)/r),t>.5?r:-r}},G6={pdf:function(e,r,n){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(Math.log(e)-r,2)/(2*n*n))},cdf:function(e,r,n){return e<0?0:.5+.5*Qc((Math.log(e)-r)/Math.sqrt(2*n*n))},inv:function(t,e,r){return Math.exp(-1.4142135623730951*r*KW(2*t)+e)}},D5={pdf:function(e,r,n){return e!==e>>>0?!1:e<0?0:QW(e+r-1,r-1)*Math.pow(1-n,e)*Math.pow(n,r)},cdf:function(e,r,n){var i=0,o=0;if(e<0)return 0;for(;o<=e;o++)i+=D5.pdf(o,r,n);return i}};function ZW(t){for(var e=0,r=t.length;--r>=0;)e+=t[r];return e}function wi(t){return ZW(t)/t.length}function Ol(t){for(var e=wi(t),r=0,n=t.length,i;--n>=0;)i=t[n]-e,r+=i*i;return r}function bp(t,e){return Ol(t)/(t.length-(e?1:0))}function Ts(t,e){return Math.sqrt(bp(t,e))}function i8e(){var t=[].slice.call(arguments),e=new Array(2),r;return t.length===4?r=Math.abs(Bi.inv(t[1]/2,0,1)*t[2]/Math.sqrt(t[3])):r=Math.abs(Bi.inv(t[1]/2,0,1)*Ts(t[2])/Math.sqrt(t[2].length)),e[0]=t[0]-r,e[1]=t[0]+r,e}function o8e(){var t=[].slice.call(arguments),e=new Array(2),r;return t.length===4?r=Math.abs(Ri.inv(t[1]/2,t[3]-1)*t[2]/Math.sqrt(t[3])):r=Math.abs(Ri.inv(t[1]/2,t[2].length-1)*Ts(t[2],!0)/Math.sqrt(t[2].length)),e[0]=t[0]-r,e[1]=t[0]+r,e}function a8e(t){for(var e=1,r=t.length;--r>=0;)e*=t[r];return e}function s8e(t){return Math.pow(a8e(t),1/t.length)}function wp(t,e){var r=wi(t),n=wi(e),i=t.length,o=new Array(i),a;for(a=0;a<i;a++)o[a]=(t[a]-r)*(e[a]-n);return ZW(o)/(i-1)}function N9(t,e){return wp(t,e)/Ts(t,1)/Ts(e,1)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class AI extends Qe{erf(e,r){return this.runFunction(e.args,r,this.metadata("ERF"),(n,i)=>i===void 0?Qc(n):Qc(i)-Qc(n))}erfc(e,r){return this.runFunction(e.args,r,this.metadata("ERFC"),YW)}expondist(e,r){return this.runFunction(e.args,r,this.metadata("EXPON.DIST"),(n,i,o)=>o?T9.cdf(n,i):T9.pdf(n,i))}fisher(e,r){return this.runFunction(e.args,r,this.metadata("FISHER"),n=>Math.log((1+n)/(1-n))/2)}fisherinv(e,r){return this.runFunction(e.args,r,this.metadata("FISHERINV"),n=>1-2/(Math.exp(2*n)+1))}gamma(e,r){return this.runFunction(e.args,r,this.metadata("GAMMA"),Vp)}gammadist(e,r){return this.runFunction(e.args,r,this.metadata("GAMMA.DIST"),(n,i,o,a)=>a?V6.cdf(n,i,o):V6.pdf(n,i,o))}gammaln(e,r){return this.runFunction(e.args,r,this.metadata("GAMMALN"),qr)}gammainv(e,r){return this.runFunction(e.args,r,this.metadata("GAMMA.INV"),V6.inv)}gauss(e,r){return this.runFunction(e.args,r,this.metadata("GAUSS"),n=>Bi.cdf(n,0,1)-.5)}betadist(e,r){return this.runFunction(e.args,r,this.metadata("BETA.DIST"),(n,i,o,a,s,l)=>n<=s?new C(N.NUM,x.ValueSmall):n>=l?new C(N.NUM,x.ValueLarge):(n=(n-s)/(l-s),a?j6.cdf(n,i,o):j6.pdf(n,i,o)))}betainv(e,r){return this.runFunction(e.args,r,this.metadata("BETA.INV"),(n,i,o,a,s)=>a>=s?new C(N.NUM,x.WrongOrder):j6.inv(n,i,o)*(s-a)+a)}binomialdist(e,r){return this.runFunction(e.args,r,this.metadata("BINOM.DIST"),(n,i,o,a)=>n>i?new C(N.NUM,x.WrongOrder):(n=Math.trunc(n),i=Math.trunc(i),a?f0.cdf(n,i,o):f0.pdf(n,i,o)))}binomialinv(e,r){return this.runFunction(e.args,r,this.metadata("BINOM.INV"),(n,i,o)=>{n=Math.trunc(n);let a=-1,s=n;for(;s>a+1;){const l=Math.trunc((a+s)/2);f0.cdf(l,n,i)>=o?s=l:a=l}return s})}besselifn(e,r){return this.runFunction(e.args,r,this.metadata("BESSELI"),(n,i)=>$5(n,Math.trunc(i)))}besseljfn(e,r){return this.runFunction(e.args,r,this.metadata("BESSELJ"),(n,i)=>x5(n,Math.trunc(i)))}besselkfn(e,r){return this.runFunction(e.args,r,this.metadata("BESSELK"),(n,i)=>r8e(n,Math.trunc(i)))}besselyfn(e,r){return this.runFunction(e.args,r,this.metadata("BESSELY"),(n,i)=>t8e(n,Math.trunc(i)))}chisqdist(e,r){return this.runFunction(e.args,r,this.metadata("CHISQ.DIST"),(n,i,o)=>(i=Math.trunc(i),o?Mc.cdf(n,i):Mc.pdf(n,i)))}chisqdistrt(e,r){return this.runFunction(e.args,r,this.metadata("CHISQ.DIST.RT"),(n,i)=>1-Mc.cdf(n,Math.trunc(i)))}chisqinv(e,r){return this.runFunction(e.args,r,this.metadata("CHISQ.INV"),(n,i)=>Mc.inv(n,Math.trunc(i)))}chisqinvrt(e,r){return this.runFunction(e.args,r,this.metadata("CHISQ.INV.RT"),(n,i)=>Mc.inv(1-n,Math.trunc(i)))}fdist(e,r){return this.runFunction(e.args,r,this.metadata("F.DIST"),(n,i,o,a)=>(i=Math.trunc(i),o=Math.trunc(o),a?kc.cdf(n,i,o):kc.pdf(n,i,o)))}fdistrt(e,r){return this.runFunction(e.args,r,this.metadata("F.DIST.RT"),(n,i,o)=>1-kc.cdf(n,Math.trunc(i),Math.trunc(o)))}finv(e,r){return this.runFunction(e.args,r,this.metadata("F.INV"),(n,i,o)=>kc.inv(n,Math.trunc(i),Math.trunc(o)))}finvrt(e,r){return this.runFunction(e.args,r,this.metadata("F.INV.RT"),(n,i,o)=>kc.inv(1-n,Math.trunc(i),Math.trunc(o)))}weibulldist(e,r){return this.runFunction(e.args,r,this.metadata("WEIBULL.DIST"),(n,i,o,a)=>a?I9.cdf(n,o,i):I9.pdf(n,o,i))}poissondist(e,r){return this.runFunction(e.args,r,this.metadata("POISSON.DIST"),(n,i,o)=>(n=Math.trunc(n),o?L5.cdf(n,i):L5.pdf(n,i)))}hypgeomdist(e,r){return this.runFunction(e.args,r,this.metadata("HYPGEOM.DIST"),(n,i,o,a,s)=>n>i||n>o||i>a||o>a?new C(N.NUM,x.ValueLarge):n+a<o+i?new C(N.NUM,x.ValueLarge):(n=Math.trunc(n),i=Math.trunc(i),o=Math.trunc(o),a=Math.trunc(a),s?sa.cdf(n,a,o,i):sa.pdf(n,a,o,i)))}tdist(e,r){return this.runFunction(e.args,r,this.metadata("T.DIST"),(n,i,o)=>(i=Math.trunc(i),o?Ri.cdf(n,i):Ri.pdf(n,i)))}tdist2t(e,r){return this.runFunction(e.args,r,this.metadata("T.DIST.2T"),(n,i)=>(1-Ri.cdf(n,Math.trunc(i)))*2)}tdistrt(e,r){return this.runFunction(e.args,r,this.metadata("T.DIST.RT"),(n,i)=>1-Ri.cdf(n,Math.trunc(i)))}tdistold(e,r){return this.runFunction(e.args,r,this.metadata("TDIST"),(n,i,o)=>o*(1-Ri.cdf(n,Math.trunc(i))))}tinv(e,r){return this.runFunction(e.args,r,this.metadata("T.INV"),(n,i)=>Ri.inv(n,Math.trunc(i)))}tinv2t(e,r){return this.runFunction(e.args,r,this.metadata("T.INV.2T"),(n,i)=>Ri.inv(1-n/2,Math.trunc(i)))}lognormdist(e,r){return this.runFunction(e.args,r,this.metadata("LOGNORM.DIST"),(n,i,o,a)=>a?G6.cdf(n,i,o):G6.pdf(n,i,o))}lognorminv(e,r){return this.runFunction(e.args,r,this.metadata("LOGNORM.INV"),(n,i,o)=>G6.inv(n,i,o))}normdist(e,r){return this.runFunction(e.args,r,this.metadata("NORM.DIST"),(n,i,o,a)=>a?Bi.cdf(n,i,o):Bi.pdf(n,i,o))}norminv(e,r){return this.runFunction(e.args,r,this.metadata("NORM.INV"),(n,i,o)=>Bi.inv(n,i,o))}normsdist(e,r){return this.runFunction(e.args,r,this.metadata("NORM.S.DIST"),(n,i)=>i?Bi.cdf(n,0,1):Bi.pdf(n,0,1))}normsinv(e,r){return this.runFunction(e.args,r,this.metadata("NORM.S.INV"),n=>Bi.inv(n,0,1))}phi(e,r){return this.runFunction(e.args,r,this.metadata("PHI"),n=>Bi.pdf(n,0,1))}negbinomdist(e,r){return this.runFunction(e.args,r,this.metadata("NEGBINOM.DIST"),(n,i,o,a)=>(n=Math.trunc(n),i=Math.trunc(i),a?D5.cdf(n,i,o):D5.pdf(n,i,o)))}confidencenorm(e,r){return this.runFunction(e.args,r,this.metadata("CONFIDENCE.NORM"),(n,i,o)=>i8e(1,n,i,Math.trunc(o))[1]-1)}confidencet(e,r){return this.runFunction(e.args,r,this.metadata("CONFIDENCE.T"),(n,i,o)=>(o=Math.trunc(o),o===1?new C(N.DIV_BY_ZERO):o8e(1,n,i,o)[1]-1))}standardize(e,r){return this.runFunction(e.args,r,this.metadata("STANDARDIZE"),(n,i,o)=>(n-i)/o)}}AI.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:g.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:g.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:g.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:g.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:g.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:g.NUMBER,minValue:0,lessThan:1},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:g.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:g.NUMBER,greaterThan:0,maxValue:1},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,defaultValue:0},{argumentType:g.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:1,maxValue:1e10},{argumentType:g.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1},{argumentType:g.NUMBER,minValue:1},{argumentType:g.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1},{argumentType:g.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.NUMBER,minValue:1},{argumentType:g.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.NUMBER,minValue:1},{argumentType:g.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0},{argumentType:g.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:1},{argumentType:g.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1},{argumentType:g.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:g.NUMBER,greaterThan:0,lessThan:1},{argumentType:g.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:g.NUMBER,greaterThan:0,maxValue:1},{argumentType:g.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:g.NUMBER,greaterThan:0,lessThan:1},{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:g.NUMBER,greaterThan:0,lessThan:1},{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:g.NUMBER},{argumentType:g.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:g.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:g.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:1},{argumentType:g.NUMBER,minValue:0,maxValue:1},{argumentType:g.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:g.NUMBER,greaterThan:0,lessThan:1},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:g.NUMBER,greaterThan:0,lessThan:1},{argumentType:g.NUMBER,greaterThan:0},{argumentType:g.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER,greaterThan:0}]}};AI.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class JW extends Qe{fact(e,r){return this.runFunction(e.args,r,this.metadata("FACT"),n=>{n=Math.trunc(n);let i=1;for(let o=1;o<=n;o++)i*=o;return i})}factdouble(e,r){return this.runFunction(e.args,r,this.metadata("FACTDOUBLE"),n=>{n=Math.trunc(n);let i=1;for(let o=n;o>=1;o-=2)i*=o;return i})}combin(e,r){return this.runFunction(e.args,r,this.metadata("COMBIN"),(n,i)=>i>n?new C(N.NUM,x.WrongOrder):(n=Math.trunc(n),i=Math.trunc(i),P9(n,i)))}combina(e,r){return this.runFunction(e.args,r,this.metadata("COMBINA"),(n,i)=>(n=Math.trunc(n),i=Math.trunc(i),n+i-1>=1030?new C(N.NUM,x.ValueLarge):n===0&&i===0?1:P9(n+i-1,i)))}gcd(e,r){return this.runFunction(e.args,r,this.metadata("GCD"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(n);if(i instanceof C)return i;let o=0;for(const a of i){if(a<0)return new C(N.NUM,x.ValueSmall);o=eG(o,Math.trunc(a))}return o>Number.MAX_SAFE_INTEGER?new C(N.NUM,x.ValueLarge):o})}lcm(e,r){return this.runFunction(e.args,r,this.metadata("LCM"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(n);if(i instanceof C)return i;let o=1;for(const a of i){if(a<0)return new C(N.NUM,x.ValueSmall);o=l8e(o,Math.trunc(a))}return o>Number.MAX_SAFE_INTEGER?new C(N.NUM,x.ValueLarge):o})}mround(e,r){return this.runFunction(e.args,r,this.metadata("MROUND"),(n,i)=>i===0?0:n>0&&i<0||n<0&&i>0?new C(N.NUM,x.DistinctSigns):Math.round(n/i)*i)}multinomial(e,r){return this.runFunction(e.args,r,this.metadata("MULTINOMIAL"),(...n)=>{let i=0,o=1;for(let a of n){if(a<0)return new C(N.NUM,x.ValueSmall);a=Math.trunc(a);for(let s=1;s<=a;s++)o*=(i+s)/s;i+=a}return Math.round(o)})}quotient(e,r){return this.runFunction(e.args,r,this.metadata("QUOTIENT"),(n,i)=>i===0?new C(N.DIV_BY_ZERO):Math.trunc(n/i))}seriessum(e,r){return this.runFunction(e.args,r,this.metadata("SERIESSUM"),(n,i,o,a)=>{const s=this.arithmeticHelper.manyToOnlyNumbersDropNulls(a.valuesFromTopLeftCorner());if(s instanceof C)return s;let l=0;s.reverse();for(const u of s)l*=Math.pow(n,o),l+=u;return l*Math.pow(n,i)})}sign(e,r){return this.runFunction(e.args,r,this.metadata("SIGN"),n=>n>0?1:n<0?-1:0)}sumx2my2(e,r){return this.runFunction(e.args,r,this.metadata("SUMX2MY2"),(n,i)=>{const o=n.valuesFromTopLeftCorner(),a=i.valuesFromTopLeftCorner();if(o.length!==a.length)return new C(N.NA,x.EqualLength);const s=o.length;let l=0;for(let u=0;u<s;u++){const c=o[u],f=a[u];if(c instanceof C)return c;if(f instanceof C)return f;typeof c=="number"&&typeof f=="number"&&(l+=Math.pow(c,2)-Math.pow(f,2))}return l})}sumx2py2(e,r){return this.runFunction(e.args,r,this.metadata("SUMX2PY2"),(n,i)=>{const o=n.valuesFromTopLeftCorner(),a=i.valuesFromTopLeftCorner();if(o.length!==a.length)return new C(N.NA,x.EqualLength);const s=o.length;let l=0;for(let u=0;u<s;u++){const c=o[u],f=a[u];if(c instanceof C)return c;if(f instanceof C)return f;typeof c=="number"&&typeof f=="number"&&(l+=Math.pow(c,2)+Math.pow(f,2))}return l})}sumxmy2(e,r){return this.runFunction(e.args,r,this.metadata("SUMXMY2"),(n,i)=>{const o=n.valuesFromTopLeftCorner(),a=i.valuesFromTopLeftCorner();if(o.length!==a.length)return new C(N.NA,x.EqualLength);const s=o.length;let l=0;for(let u=0;u<s;u++){const c=o[u],f=a[u];if(c instanceof C)return c;if(f instanceof C)return f;typeof c=="number"&&typeof f=="number"&&(l+=Math.pow(c-f,2))}return l})}}JW.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:g.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:g.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:g.NUMBER,minValue:0,lessThan:1030},{argumentType:g.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:g.NUMBER,minValue:0},{argumentType:g.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:g.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:g.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]}};function P9(t,e){2*e>t&&(e=t-e);let r=1;for(let n=1;n<=e;n++)r*=(t-e+n)/n;return Math.round(r)}function eG(t,e){for(t<e&&([t,e]=[e,t]);e>0;)[t,e]=[e,t%e];return t}function l8e(t,e){return t===0||e===0?0:t*(e/eG(t,e))}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class tG extends Qe{complex(e,r){return this.runFunction(e.args,r,this.metadata("COMPLEX"),(n,i,o)=>o!=="i"&&o!=="j"?new C(N.VALUE,x.ShouldBeIorJ):mr([n,i],o))}imabs(e,r){return this.runFunction(e.args,r,this.metadata("IMABS"),iG)}imaginary(e,r){return this.runFunction(e.args,r,this.metadata("IMAGINARY"),([n,i])=>i)}imreal(e,r){return this.runFunction(e.args,r,this.metadata("IMREAL"),([n,i])=>n)}imargument(e,r){return this.runFunction(e.args,r,this.metadata("IMARGUMENT"),([n,i])=>n===0&&i===0?new C(N.DIV_BY_ZERO):Math.atan2(i,n))}imconjugate(e,r){return this.runFunction(e.args,r,this.metadata("IMCONJUGATE"),([n,i])=>mr([n,-i]))}imcos(e,r){return this.runFunction(e.args,r,this.metadata("IMCOS"),n=>mr(t1(n)))}imcosh(e,r){return this.runFunction(e.args,r,this.metadata("IMCOSH"),n=>mr(M9(n)))}imcot(e,r){return this.runFunction(e.args,r,this.metadata("IMCOT"),n=>mr(hl(t1(n),r1(n))))}imcsc(e,r){return this.runFunction(e.args,r,this.metadata("IMCSC"),n=>mr(hl([1,0],r1(n))))}imcsch(e,r){return this.runFunction(e.args,r,this.metadata("IMCSCH"),n=>mr(hl([1,0],k9(n))))}imsec(e,r){return this.runFunction(e.args,r,this.metadata("IMSEC"),n=>mr(hl([1,0],t1(n))))}imsech(e,r){return this.runFunction(e.args,r,this.metadata("IMSECH"),n=>mr(hl([1,0],M9(n))))}imsin(e,r){return this.runFunction(e.args,r,this.metadata("IMSIN"),n=>mr(r1(n)))}imsinh(e,r){return this.runFunction(e.args,r,this.metadata("IMSINH"),n=>mr(k9(n)))}imtan(e,r){return this.runFunction(e.args,r,this.metadata("IMTAN"),n=>mr(hl(r1(n),t1(n))))}imdiv(e,r){return this.runFunction(e.args,r,this.metadata("IMDIV"),(n,i)=>mr(hl(n,i)))}improduct(e,r){return this.runFunction(e.args,r,this.metadata("IMPRODUCT"),(...n)=>{const i=this.arithmeticHelper.coerceComplexExactRanges(n);if(i instanceof C)return i;let o=[1,0];for(const a of i)o=rG(o,a);return mr(o)})}imsum(e,r){return this.runFunction(e.args,r,this.metadata("IMSUM"),(...n)=>{const i=this.arithmeticHelper.coerceComplexExactRanges(n);if(i instanceof C)return i;let o=[0,0];for(const a of i)o=u8e(o,a);return mr(o)})}imsub(e,r){return this.runFunction(e.args,r,this.metadata("IMSUB"),(n,i)=>mr(c8e(n,i)))}imexp(e,r){return this.runFunction(e.args,r,this.metadata("IMEXP"),n=>mr(nG(n)))}imln(e,r){return this.runFunction(e.args,r,this.metadata("IMLN"),n=>mr(d0(n)))}imlog10(e,r){return this.runFunction(e.args,r,this.metadata("IMLOG10"),n=>{const[i,o]=d0(n),a=Math.log(10);return mr([i/a,o/a])})}imlog2(e,r){return this.runFunction(e.args,r,this.metadata("IMLOG2"),n=>{const[i,o]=d0(n),a=Math.log(2);return mr([i/a,o/a])})}impower(e,r){return this.runFunction(e.args,r,this.metadata("IMPOWER"),(n,i)=>mr(x9(n,i)))}imsqrt(e,r){return this.runFunction(e.args,r,this.metadata("IMSQRT"),n=>mr(x9(n,.5)))}}tG.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:g.NUMBER},{argumentType:g.NUMBER},{argumentType:g.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:g.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:g.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:g.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:g.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:g.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:g.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:g.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:g.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:g.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:g.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:g.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:g.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:g.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:g.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:g.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:g.COMPLEX},{argumentType:g.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:g.COMPLEX},{argumentType:g.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:g.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:g.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:g.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:g.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:g.COMPLEX},{argumentType:g.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:g.COMPLEX}]}};function u8e([t,e],[r,n]){return[t+r,e+n]}function c8e([t,e],[r,n]){return[t-r,e-n]}function rG([t,e],[r,n]){return[t*r-e*n,t*n+r*e]}function hl([t,e],[r,n]){const i=Math.pow(r,2)+Math.pow(n,2),[o,a]=rG([t,e],[r,-n]);return[o/i,a/i]}function t1([t,e]){return[Math.cos(t)*Math.cosh(e),-Math.sin(t)*Math.sinh(e)]}function M9([t,e]){return[Math.cosh(t)*Math.cos(e),Math.sinh(t)*Math.sin(e)]}function r1([t,e]){return[Math.sin(t)*Math.cosh(e),Math.cos(t)*Math.sinh(e)]}function k9([t,e]){return[Math.sinh(t)*Math.cos(e),Math.cosh(t)*Math.sin(e)]}function nG([t,e]){return[Math.exp(t)*Math.cos(e),Math.exp(t)*Math.sin(e)]}function iG([t,e]){return Math.sqrt(t*t+e*e)}function d0([t,e]){return[Math.log(iG([t,e])),Math.atan2(e,t)]}function x9(t,e){const[r,n]=d0(t);return nG([e*r,e*n])}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class II extends Qe{avedev(e,r){return this.runFunction(e.args,r,this.metadata("AVEDEV"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof C)return i;if(i.length===0)return new C(N.DIV_BY_ZERO);const o=wi(i);return i.reduce((a,s)=>a+Math.abs(s-o),0)/i.length})}devsq(e,r){return this.runFunction(e.args,r,this.metadata("DEVSQ"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);return i instanceof C?i:i.length===0?0:Ol(i)})}geomean(e,r){return this.runFunction(e.args,r,this.metadata("GEOMEAN"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof C)return i;if(i.length===0)return new C(N.NUM,x.OneValue);for(const o of i)if(o<=0)return new C(N.NUM,x.ValueSmall);return s8e(i)})}harmean(e,r){return this.runFunction(e.args,r,this.metadata("HARMEAN"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof C)return i;if(i.length===0)return new C(N.NUM,x.OneValue);for(const o of i)if(o<=0)return new C(N.NUM,x.ValueSmall);return i.length/i.reduce((o,a)=>o+1/a,0)})}correl(e,r){return this.runFunction(e.args,r,this.metadata("CORREL"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new C(N.NA,x.EqualLength);const o=dl(n,i);return o instanceof C?o:o[0].length<=1?new C(N.DIV_BY_ZERO,x.TwoValues):N9(o[0],o[1])})}rsq(e,r){return this.runFunction(e.args,r,this.metadata("RSQ"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new C(N.NA,x.EqualLength);const o=dl(n,i);return o instanceof C?o:o[0].length<=1?new C(N.DIV_BY_ZERO,x.TwoValues):Math.pow(N9(o[0],o[1]),2)})}covariancep(e,r){return this.runFunction(e.args,r,this.metadata("COVARIANCE.P"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new C(N.NA,x.EqualLength);const o=dl(n,i);if(o instanceof C)return o;const a=o[0].length;return a<1?new C(N.DIV_BY_ZERO,x.OneValue):a===1?0:wp(o[0],o[1])*(a-1)/a})}covariances(e,r){return this.runFunction(e.args,r,this.metadata("COVARIANCE.S"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new C(N.NA,x.EqualLength);const o=dl(n,i);return o instanceof C?o:o[0].length<=1?new C(N.DIV_BY_ZERO,x.TwoValues):wp(o[0],o[1])})}ztest(e,r){return this.runFunction(e.args,r,this.metadata("Z.TEST"),(n,i,o)=>{const a=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());if(a instanceof C)return a;const s=a.length;if(o===void 0){if(s<2)return new C(N.DIV_BY_ZERO,x.TwoValues);o=Ts(a,!0)}return s<1?new C(N.NA,x.OneValue):o===0?new C(N.DIV_BY_ZERO):1-Bi.cdf((wi(a)-i)/(o/Math.sqrt(s)),0,1)})}ftest(e,r){return this.runFunction(e.args,r,this.metadata("F.TEST"),(n,i)=>{const o=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner()),a=this.arithmeticHelper.manyToExactNumbers(i.valuesFromTopLeftCorner());if(o instanceof C)return o;if(a instanceof C)return a;if(o.length<=1||a.length<=1)return new C(N.DIV_BY_ZERO);const s=bp(o,!0),l=bp(a,!0);if(s===0||l===0)return new C(N.DIV_BY_ZERO);const u=s/l,c=kc.cdf(u,o.length-1,a.length-1);return 2*Math.min(c,1-c)})}steyx(e,r){return this.runFunction(e.args,r,this.metadata("STEYX"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new C(N.NA,x.EqualLength);const o=dl(n,i);if(o instanceof C)return o;const a=o[0].length;return a<=2?new C(N.DIV_BY_ZERO,x.ThreeValues):Math.sqrt((Ol(o[0])-Math.pow(wp(o[0],o[1])*(a-1),2)/Ol(o[1]))/(a-2))})}slope(e,r){return this.runFunction(e.args,r,this.metadata("SLOPE"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new C(N.NA,x.EqualLength);const o=dl(n,i);if(o instanceof C)return o;const a=o[0].length;return a<=1?new C(N.DIV_BY_ZERO,x.TwoValues):wp(o[0],o[1])*(a-1)/Ol(o[1])})}chisqtest(e,r){return this.runFunction(e.args,r,this.metadata("CHISQ.TEST"),(n,i)=>{const o=n.height(),a=n.width();if(i.height()!==o||i.width()!==a)return new C(N.NA,x.EqualLength);const s=dl(n,i);if(s instanceof C)return s;if(s[0].length<=1)return new C(N.DIV_BY_ZERO,x.TwoValues);let l=0;for(let u=0;u<s[0].length;u++){if(s[1][u]===0)return new C(N.DIV_BY_ZERO);l+=Math.pow(s[0][u]-s[1][u],2)/s[1][u]}return l<0?new C(N.NUM,x.NaN):1-Mc.cdf(l,o>1&&a>1?(o-1)*(a-1):o*a-1)})}ttest(e,r){return this.runFunction(e.args,r,this.metadata("T.TEST"),(n,i,o,a)=>{const s=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner()),l=this.arithmeticHelper.manyToExactNumbers(i.valuesFromTopLeftCorner());if(s instanceof C)return s;if(l instanceof C)return l;const u=s.length,c=l.length;if(a===1){if(c!==u)return new C(N.NA,x.EqualLength);if(u<=1)return new C(N.DIV_BY_ZERO,x.TwoValues);const f=Array(u);for(let p=0;p<u;p++)f[p]=s[p]-l[p];const h=Ts(f,!0);if(h===0)return new C(N.DIV_BY_ZERO);const d=Math.abs(Math.sqrt(u)*wi(f)/h);return o*(1-Ri.cdf(d,u-1))}else if(a===2){if(u<=1||c<=1)return new C(N.DIV_BY_ZERO,x.TwoValues);const f=(Ol(s)+Ol(l))/(u+c-2);if(f===0)return new C(N.DIV_BY_ZERO);const h=Math.abs((wi(s)-wi(l))/Math.sqrt(f*(1/u+1/c)));return o*(1-Ri.cdf(h,u+c-2))}else{if(u<=1||c<=1)return new C(N.DIV_BY_ZERO,x.TwoValues);const f=bp(s,!0),h=bp(l,!0);if(f===0&&h===0)return new C(N.DIV_BY_ZERO);const d=Math.abs((wi(s)-wi(l))/Math.sqrt(f/u+h/c)),p=Math.pow(f/u+h/c,2)/(Math.pow(f/u,2)/(u-1)+Math.pow(h/c,2)/(c-1));return o*(1-Ri.cdf(d,p))}})}skew(e,r){return this.runFunction(e.args,r,this.metadata("SKEW"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof C)return i;const o=i.length;if(o<3)return new C(N.DIV_BY_ZERO,x.ThreeValues);const a=wi(i),s=Ts(i,!0);return s===0?new C(N.DIV_BY_ZERO):i.reduce((l,u)=>l+Math.pow((u-a)/s,3),0)*o/(o-1)/(o-2)})}skewp(e,r){return this.runFunction(e.args,r,this.metadata("SKEW.P"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof C)return i;const o=i.length;if(o<3)return new C(N.DIV_BY_ZERO,x.ThreeValues);const a=wi(i),s=Ts(i,!1);return s===0?new C(N.DIV_BY_ZERO):i.reduce((l,u)=>l+Math.pow((u-a)/s,3),0)/o})}}II.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:g.RANGE},{argumentType:g.NUMBER},{argumentType:g.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:g.RANGE},{argumentType:g.RANGE},{argumentType:g.INTEGER,minValue:1,maxValue:2},{argumentType:g.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:g.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:g.ANY}],repeatLastArgs:1}};II.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};function dl(t,e){const r=t.iterateValuesFromTopLeftCorner(),n=e.iterateValuesFromTopLeftCorner();let i,o;const a=[],s=[];for(;i=r.next(),o=n.next(),!i.done&&!o.done;){const l=i.value,u=o.value;if(l instanceof C)return l;if(u instanceof C)return u;Rt(l)&&Rt(u)&&(a.push(ye(l)),s.push(ye(u)))}return[a,s]}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const $9=Object.freeze(Object.defineProperty({__proto__:null,AbsPlugin:iW,AddressPlugin:rW,ArrayPlugin:nW,BitShiftPlugin:oW,BitwiseLogicOperationsPlugin:uW,BooleanPlugin:cW,CharPlugin:fW,CodePlugin:hW,ComplexPlugin:tG,ConditionalAggregationPlugin:FW,CountBlankPlugin:dW,CountUniquePlugin:pW,DateTimePlugin:mW,DegreesPlugin:vW,DeltaPlugin:gW,ExpPlugin:yW,FinancialPlugin:bW,FormulaTextPlugin:wW,HyperlinkPlugin:SW,InformationPlugin:RW,IsEvenPlugin:EW,IsOddPlugin:CW,LogarithmPlugin:OW,LookupPlugin:VW,MathConstantsPlugin:TW,MathPlugin:JW,MatrixPlugin:_W,MedianPlugin:AW,ModuloPlugin:IW,NumericAggregationPlugin:EI,PowerPlugin:NW,RadiansPlugin:PW,RadixConversionPlugin:kW,RandomPlugin:LW,RomanPlugin:jW,RoundingPlugin:CI,SimpleArithmerticPlugin:WW,SqrtPlugin:DW,StatisticalAggregationPlugin:II,StatisticalPlugin:AI,SumprodPlugin:HW,TextPlugin:UW,TrigonometryPlugin:BW},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class ht extends Zr{}ht.HyperFormula=Zr;ht.ErrorType=N;ht.CellError=C;ht.CellType=Dn;ht.CellValueType=Ki;ht.CellValueDetailedType=Q4e;ht.DetailedCellError=Uj;ht.ExportedCellChange=I5;ht.ExportedNamedExpressionChange=qj;ht.ConfigValueTooBigError=_j;ht.ConfigValueTooSmallError=Tj;ht.EvaluationSuspendedError=Ij;ht.ExpectedOneOfValuesError=Aj;ht.ExpectedValueOfTypeError=St;ht.ArraySize=it;ht.SimpleRangeValue=Pe;ht.FunctionPlugin=Qe;ht.FunctionArgumentType=g;ht.FunctionPluginValidationError=jf;ht.InvalidAddressError=bj;ht.InvalidArgumentsError=Mr;ht.LanguageNotRegisteredError=b5;ht.LanguageAlreadyRegisteredError=Pj;ht.MissingTranslationError=Nc;ht.NamedExpressionDoesNotExistError=yv;ht.NamedExpressionNameIsAlreadyTakenError=wj;ht.NamedExpressionNameIsInvalidError=Sj;ht.NoOperationToRedoError=Ej;ht.NoOperationToUndoError=Rj;ht.NoRelativeAddressesAllowedError=gI;ht.NoSheetWithIdError=ar;ht.NoSheetWithNameError=yj;ht.NotAFormulaError=y5;ht.NothingToPasteError=Cj;ht.ProtectedFunctionTranslationError=Nj;ht.SheetNameAlreadyTakenError=vv;ht.SheetSizeLimitExceededError=uu;ht.SourceLocationHasArrayError=Hc;ht.TargetLocationHasArrayError=Kb;ht.UnableToParseError=Oj;const f8e=on.defaultConfig.language;Zr.registerLanguage(f8e,N5);Zr.languages[N5.langCode]=N5;for(const t of Object.getOwnPropertyNames($9))t.startsWith("_")||Zr.registerFunctionPlugin($9[t]);function Gf(t){"@babel/helpers - typeof";return Gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gf(t)}function h8e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function L9(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,p8e(n.key),n)}}function d8e(t,e,r){return e&&L9(t.prototype,e),r&&L9(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function p8e(t){var e=m8e(t,"string");return Gf(e)==="symbol"?e:String(e)}function m8e(t,e){if(Gf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Gf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Vi(){return typeof Reflect<"u"&&Reflect.get?Vi=Reflect.get.bind():Vi=function(e,r,n){var i=v8e(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Vi.apply(this,arguments)}function v8e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ii(t),t!==null););return t}function g8e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&F5(t,e)}function F5(t,e){return F5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},F5(t,e)}function y8e(t){var e=S8e();return function(){var n=ii(t),i;if(e){var o=ii(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return b8e(this,i)}}function b8e(t,e){if(e&&(Gf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w8e(t)}function w8e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S8e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ii(t){return ii=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ii(t)}var D9="handsontableEditor",R8e="handsontable",NI=function(t){g8e(r,t);var e=y8e(r);function r(){return h8e(this,r),e.apply(this,arguments)}return d8e(r,[{key:"open",value:function(){Vi(ii(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),tw(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),Vi(ii(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(i,o,a,s,l,u){Vi(ii(r.prototype),"prepare",this).call(this,i,o,a,s,l,u);var c=this,f={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(d,p){var m=this.getSourceData(p.row,p.col);m!==void 0&&c.setValue(m),c.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&$r(f,u.handsontable),this.htOptions=f}},{key:"beginEditing",value:function(i,o){var a=this.hot.getSettings().onBeginEditing;a&&a()===!1||Vi(ii(r.prototype),"beginEditing",this).call(this,i,o)}},{key:"createElements",value:function(){Vi(ii(r.prototype),"createElements",this).call(this);var i=this.hot.rootDocument.createElement("DIV");i.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(i),this.htContainer=i,this.assignHooks()}},{key:"finishEditing",value:function(i,o,a){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var s=this.htEditor.getInstance().getValue();s!==void 0&&this.setValue(s)}Vi(ii(r.prototype),"finishEditing",this).call(this,i,o,a)}},{key:"assignHooks",value:function(){var i=this;this.hot.addHook("afterDestroy",function(){i.htEditor&&i.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),a=o.getContext("editor");Vi(ii(r.prototype),"registerShortcuts",this).call(this);var s={group:D9,relativeToGroup:nw,position:"before"},l=function(c,f){var h=i.htEditor.getInstance();if(c!==void 0&&(c<0||h.flipped&&c>h.countRows()-1?h.deselectCell():h.selectCell(c,0),h.getData().length))return f.preventDefault(),Lo(f),i.hot.listen(),i.TEXTAREA.focus(),!1};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(c){var f=i.htEditor.getInstance(),h,d;return!f.getSelectedLast()&&f.flipped?h=f.countRows()-1:f.getSelectedLast()&&(f.flipped?(d=f.getSelectedLast()[0],h=Math.max(0,d-1)):(d=f.getSelectedLast()[0],h=d-1)),l(h,c)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(c){var f=i.htEditor.getInstance(),h,d;if(!f.getSelectedLast()&&!f.flipped)h=0;else if(f.getSelectedLast()){if(f.flipped)h=f.getSelectedLast()[0]+1;else if(!f.flipped){var p=f.countRows()-1;d=f.getSelectedLast()[0],h=Math.min(p,d+1)}}return l(h,c)},preventDefault:!1}],s)}},{key:"unregisterShortcuts",value:function(){Vi(ii(r.prototype),"unregisterShortcuts",this).call(this);var i=this.hot.getShortcutManager(),o=i.getContext("editor");o.removeShortcutsByGroup(D9)}}],[{key:"EDITOR_TYPE",get:function(){return R8e}}]),r}(Fu);function zf(t){"@babel/helpers - typeof";return zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zf(t)}function E8e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function F9(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,oG(n.key),n)}}function C8e(t,e,r){return e&&F9(t.prototype,e),r&&F9(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Pl(){return typeof Reflect<"u"&&Reflect.get?Pl=Reflect.get.bind():Pl=function(e,r,n){var i=O8e(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Pl.apply(this,arguments)}function O8e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=da(t),t!==null););return t}function T8e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&H5(t,e)}function H5(t,e){return H5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},H5(t,e)}function _8e(t){var e=I8e();return function(){var n=da(t),i;if(e){var o=da(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return A8e(this,i)}}function A8e(t,e){if(e&&(zf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return U5(t)}function U5(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function I8e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function da(t){return da=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},da(t)}function N8e(t,e,r){return e=oG(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oG(t){var e=P8e(t,"string");return zf(e)==="symbol"?e:String(e)}function P8e(t,e){if(zf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(zf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var z6=new WeakMap,M8e="autocomplete",PI=function(t){T8e(r,t);var e=_8e(r);function r(n){var i;return E8e(this,r),i=e.call(this,n),N8e(U5(i),"sortByRelevance",function(o,a,s){var l=[],u=[],c=o.length,f=a.length,h,d,p,m;if(c===0){for(p=0;p<f;p++)u.push(p);return u}for(p=0;p<f;p++){if(d=p8(Ar(a[p])),s)m=d.indexOf(o);else{var y=this.cellProperties.locale;m=d.toLocaleLowerCase(y).indexOf(o.toLocaleLowerCase(y))}m!==-1&&(h=d.length-m-c,l.push({baseIndex:p,index:m,charsLeft:h,value:d}))}for(l.sort(function(S,R){if(R.index===-1)return-1;if(S.index===-1)return 1;if(S.index<R.index)return-1;if(R.index<S.index)return 1;if(S.index===R.index){if(S.charsLeft<R.charsLeft)return-1;if(S.charsLeft>R.charsLeft)return 1}return 0}),p=0,f=l.length;p<f;p++)u.push(l[p].baseIndex);return u}),i.query=null,i.strippedChoices=[],i.rawChoices=[],z6.set(U5(i),{skipOne:!1,isMacOS:i.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),i}return C8e(r,[{key:"getValue",value:function(){var i=this,o=this.rawChoices.find(function(a){var s=i.stripValueIfNeeded(a);return s===i.TEXTAREA.value});return Ae(o)?o:this.TEXTAREA.value}},{key:"createElements",value:function(){Pl(da(r.prototype),"createElements",this).call(this),le(this.htContainer,"autocompleteEditor"),le(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var i=this,o=z6.get(this);Pl(da(r.prototype),"open",this).call(this);var a=this.htEditor.getInstance(),s=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var l=Xr();l===0&&o.isMacOS&&(l+=15),this.addHook("beforeKeyDown",function(u){return i.onBeforeKeyDown(u)}),a.updateSettings({colWidths:s?[Ut(this.TEXTAREA)-2]:void 0,width:s?Ut(this.TEXTAREA)+l:void 0,renderer:function(c,f,h,d,p,m,y){Qs(c,f,h,d,p,m,y);var S=i.cellProperties,R=S.filteringCaseSensitive,E=S.allowHtml,O=S.locale,A=i.query,B=Ar(m),j,J;B&&!E&&(j=R===!0?B.indexOf(A):B.toLocaleLowerCase(O).indexOf(A.toLocaleLowerCase(O)),j!==-1&&(J=B.substr(j,A.length),B=B.replace(J,"<strong>".concat(J,"</strong>")))),f.innerHTML=B},autoColumnSize:!0}),o.skipOne&&(o.skipOne=!1),this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),Pl(da(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(i){Pl(da(r.prototype),"discardEditor",this).call(this,i),this.hot.view.render()}},{key:"queryChoices",value:function(i){var o=this,a=this.cellProperties.source;this.query=i,typeof a=="function"?a.call(this.cellProperties,i,function(s){o.rawChoices=s,o.updateChoicesList(o.stripValuesIfNeeded(s))}):Array.isArray(a)?(this.rawChoices=a,this.updateChoicesList(this.stripValuesIfNeeded(a))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(i){var o=VH(this.TEXTAREA),a=lpe(this.TEXTAREA),s=this.cellProperties.sortByRelevance,l=this.cellProperties.filter,u=null,c=null,f=i;s&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),f,this.cellProperties.filteringCaseSensitive));var h=Array.isArray(u)?u.length:0;if(l===!1)h&&(c=u[0]);else{for(var d=[],p=0,m=f.length;p<m&&!(s&&h<=p);p++)h?d.push(f[u[p]]):d.push(f[p]);c=0,f=d}this.strippedChoices=f,this.htEditor.loadData(H1([f])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(c),this.hot.listen(),tw(this.TEXTAREA,o,o===a?void 0:a)}},{key:"flipDropdownIfNeeded",value:function(){var i=hf(this.hot.view._wt.wtTable.TABLE),o=i===this.hot.rootWindow,a=this.cellProperties.preventOverflow;if(o||!o&&(a||a==="horizontal"))return!1;var s=xr(this.TEXTAREA),l=ur(this.TEXTAREA),u=this.getDropdownHeight(),c=i.scrollTop,f=ur(this.hot.view._wt.wtTable.THEAD),h=xr(i),d=s.top-h.top-f+c,p=i.scrollHeight-d-f-l,m=u>p&&d>p;return m?this.flipDropdown(u):this.unflipDropdown(),this.limitDropdownIfNeeded(m?d:p,u),m}},{key:"limitDropdownIfNeeded",value:function(i,o){if(o>i){var a=0,s=0,l=0,u=null;do l=this.htEditor.getRowHeight(s)||this.htEditor.view._wt.getSetting("defaultRowHeight"),a+=l,s+=1;while(a<i);u=a-l,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+o-u,"px")),this.setDropdownHeight(a-l)}}},{key:"flipDropdown",value:function(i){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="".concat(-i,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var i=this.htEditor.getColWidth(0)+Xr(this.hot.rootDocument)+2,o=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:o?void 0:i}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(i){this.htEditor.updateSettings({height:i})}},{key:"highlightBestMatchingChoice",value:function(i){typeof i=="number"?this.htEditor.selectCell(i,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var i=this.htEditor.getInstance().getRowHeight(0)||23,o=this.cellProperties.visibleRows;return this.strippedChoices.length>=o?o*i:this.strippedChoices.length*i+8}},{key:"stripValueIfNeeded",value:function(i){return this.stripValuesIfNeeded([i])[0]}},{key:"stripValuesIfNeeded",value:function(i){var o=this.cellProperties.allowHtml,a=st(i,function(l){return Ar(l)}),s=st(a,function(l){return o?l:p8(l)});return s}},{key:"allowKeyEventPropagation",value:function(i){var o=this.htEditor.getSelectedRangeLast(),a={row:o?o.from.row:-1},s=!1;return i===Le.ARROW_DOWN&&a.row>0&&a.row<this.htEditor.countRows()-1&&(s=!0),i===Le.ARROW_UP&&a.row>-1&&(s=!0),s}},{key:"onBeforeKeyDown",value:function(i){var o=this,a=z6.get(this);if(a.skipOne=!1,xpe(i.keyCode)||i.keyCode===Le.BACKSPACE||i.keyCode===Le.DELETE||i.keyCode===Le.INSERT){var s=10;if(i.keyCode===Le.C&&(i.ctrlKey||i.metaKey))return;this.isOpened()||(s+=10),this.htEditor&&this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value),a.skipOne=!0},s)}}}],[{key:"EDITOR_TYPE",get:function(){return M8e}}]),r}(NI);function Yf(t){"@babel/helpers - typeof";return Yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yf(t)}function k8e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function H9(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$8e(n.key),n)}}function x8e(t,e,r){return e&&H9(t.prototype,e),r&&H9(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function $8e(t){var e=L8e(t,"string");return Yf(e)==="symbol"?e:String(e)}function L8e(t,e){if(Yf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Yf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function D8e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&B5(t,e)}function B5(t,e){return B5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},B5(t,e)}function F8e(t){var e=B8e();return function(){var n=i2(t),i;if(e){var o=i2(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return H8e(this,i)}}function H8e(t,e){if(e&&(Yf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return U8e(t)}function U8e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function B8e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function i2(t){return i2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},i2(t)}var V8e="checkbox",aG=function(t){D8e(r,t);var e=F8e(r);function r(){return k8e(this,r),e.apply(this,arguments)}return x8e(r,[{key:"beginEditing",value:function(i,o){if(o&&o.type==="mouseup"){var a=this.TD.querySelector('input[type="checkbox"]');Xe(a,"htBadValue")||a.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return V8e}}]),r}(_d),sG={exports:{}};const j8e=MY(Kde);/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(t,e){(function(r,n){var i;{try{i=j8e}catch{}t.exports=n(i)}})(M0,function(r){var n=typeof r=="function",i=!!window.addEventListener,o=window.document,a=window.setTimeout,s=function(I,v,b,w){i?I.addEventListener(v,b,!!w):I.attachEvent("on"+v,b)},l=function(I,v,b,w){i?I.removeEventListener(v,b,!!w):I.detachEvent("on"+v,b)},u=function(I){return I.trim?I.trim():I.replace(/^\s+|\s+$/g,"")},c=function(I,v){return(" "+I.className+" ").indexOf(" "+v+" ")!==-1},f=function(I,v){c(I,v)||(I.className=I.className===""?v:I.className+" "+v)},h=function(I,v){I.className=u((" "+I.className+" ").replace(" "+v+" "," "))},d=function(I){return/Array/.test(Object.prototype.toString.call(I))},p=function(I){return/Date/.test(Object.prototype.toString.call(I))&&!isNaN(I.getTime())},m=function(I){var v=I.getDay();return v===0||v===6},y=function(I){return I%4===0&&I%100!==0||I%400===0},S=function(I,v){return[31,y(I)?29:28,31,30,31,30,31,31,30,31,30,31][v]},R=function(I){p(I)&&I.setHours(0,0,0,0)},E=function(I,v){return I.getTime()===v.getTime()},O=function(I,v,b){var w,_;for(w in v)_=I[w]!==void 0,_&&typeof v[w]=="object"&&v[w]!==null&&v[w].nodeName===void 0?p(v[w])?b&&(I[w]=new Date(v[w].getTime())):d(v[w])?b&&(I[w]=v[w].slice(0)):I[w]=O({},v[w],b):(b||!_)&&(I[w]=v[w]);return I},A=function(I,v,b){var w;o.createEvent?(w=o.createEvent("HTMLEvents"),w.initEvent(v,!0,!1),w=O(w,b),I.dispatchEvent(w)):o.createEventObject&&(w=o.createEventObject(),w=O(w,b),I.fireEvent("on"+v,w))},B=function(I){return I.month<0&&(I.year-=Math.ceil(Math.abs(I.month)/12),I.month+=12),I.month>11&&(I.year+=Math.floor(Math.abs(I.month)/12),I.month-=12),I},j={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},J=function(I,v,b){for(v+=I.firstDay;v>=7;)v-=7;return b?I.i18n.weekdaysShort[v]:I.i18n.weekdays[v]},Y=function(I){var v=[],b="false";if(I.isEmpty)if(I.showDaysInNextAndPreviousMonths)v.push("is-outside-current-month"),I.enableSelectionDaysInNextAndPreviousMonths||v.push("is-selection-disabled");else return'<td class="is-empty"></td>';return I.isDisabled&&v.push("is-disabled"),I.isToday&&v.push("is-today"),I.isSelected&&(v.push("is-selected"),b="true"),I.hasEvent&&v.push("has-event"),I.isInRange&&v.push("is-inrange"),I.isStartRange&&v.push("is-startrange"),I.isEndRange&&v.push("is-endrange"),'<td data-day="'+I.day+'" class="'+v.join(" ")+'" aria-selected="'+b+'"><button class="pika-button pika-day" type="button" data-pika-year="'+I.year+'" data-pika-month="'+I.month+'" data-pika-day="'+I.day+'">'+I.day+"</button></td>"},q=function(I,v){I.setHours(0,0,0,0);var b=I.getDate(),w=I.getDay(),_=v,M=_-1,L=7,H=function(ve){return(ve+L-1)%L};I.setDate(b+M-H(w));var Z=new Date(I.getFullYear(),0,_),te=24*60*60*1e3,ie=(I.getTime()-Z.getTime())/te,oe=1+Math.round((ie-M+H(Z.getDay()))/L);return oe},ee=function(I,v,b,w){var _=new Date(b,v,I),M=n?r(_).isoWeek():q(_,w);return'<td class="pika-week">'+M+"</td>"},ae=function(I,v,b,w){return'<tr class="pika-row'+(b?" pick-whole-week":"")+(w?" is-selected":"")+'">'+(v?I.reverse():I).join("")+"</tr>"},ne=function(I){return"<tbody>"+I.join("")+"</tbody>"},ue=function(I){var v,b=[];for(I.showWeekNumber&&b.push("<th></th>"),v=0;v<7;v++)b.push('<th scope="col"><abbr title="'+J(I,v)+'">'+J(I,v,!0)+"</abbr></th>");return"<thead><tr>"+(I.isRTL?b.reverse():b).join("")+"</tr></thead>"},me=function(I,v,b,w,_,M){var L,H,Z,te=I._o,ie=b===te.minYear,oe=b===te.maxYear,ve='<div id="'+M+'" class="pika-title" role="heading" aria-live="assertive">',ke,pe,Ce=!0,re=!0;for(Z=[],L=0;L<12;L++)Z.push('<option value="'+(b===_?L-v:12+L-v)+'"'+(L===w?' selected="selected"':"")+(ie&&L<te.minMonth||oe&&L>te.maxMonth?' disabled="disabled"':"")+">"+te.i18n.months[L]+"</option>");for(ke='<div class="pika-label">'+te.i18n.months[w]+'<select class="pika-select pika-select-month" tabindex="-1">'+Z.join("")+"</select></div>",d(te.yearRange)?(L=te.yearRange[0],H=te.yearRange[1]+1):(L=b-te.yearRange,H=1+b+te.yearRange),Z=[];L<H&&L<=te.maxYear;L++)L>=te.minYear&&Z.push('<option value="'+L+'"'+(L===b?' selected="selected"':"")+">"+L+"</option>");return pe='<div class="pika-label">'+b+te.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+Z.join("")+"</select></div>",te.showMonthAfterYear?ve+=pe+ke:ve+=ke+pe,ie&&(w===0||te.minMonth>=w)&&(Ce=!1),oe&&(w===11||te.maxMonth<=w)&&(re=!1),v===0&&(ve+='<button class="pika-prev'+(Ce?"":" is-disabled")+'" type="button">'+te.i18n.previousMonth+"</button>"),v===I._o.numberOfMonths-1&&(ve+='<button class="pika-next'+(re?"":" is-disabled")+'" type="button">'+te.i18n.nextMonth+"</button>"),ve+="</div>"},Re=function(I,v,b){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+b+'">'+ue(I)+ne(v)+"</table>"},ge=function(I){var v=this,b=v.config(I);v._onMouseDown=function(_){if(v._v){_=_||window.event;var M=_.target||_.srcElement;if(M)if(c(M,"is-disabled")||(c(M,"pika-button")&&!c(M,"is-empty")&&!c(M.parentNode,"is-disabled")?(v.setDate(new Date(M.getAttribute("data-pika-year"),M.getAttribute("data-pika-month"),M.getAttribute("data-pika-day"))),b.bound&&a(function(){v.hide(),b.blurFieldOnSelect&&b.field&&b.field.blur()},100)):c(M,"pika-prev")?v.prevMonth():c(M,"pika-next")&&v.nextMonth()),c(M,"pika-select"))v._c=!0;else if(_.preventDefault)_.preventDefault();else return _.returnValue=!1,!1}},v._onChange=function(_){_=_||window.event;var M=_.target||_.srcElement;M&&(c(M,"pika-select-month")?v.gotoMonth(M.value):c(M,"pika-select-year")&&v.gotoYear(M.value))},v._onKeyChange=function(_){if(_=_||window.event,v.isVisible())switch(_.keyCode){case 13:case 27:b.field&&b.field.blur();break;case 37:v.adjustDate("subtract",1);break;case 38:v.adjustDate("subtract",7);break;case 39:v.adjustDate("add",1);break;case 40:v.adjustDate("add",7);break;case 8:case 46:v.setDate(null);break}},v._parseFieldValue=function(){if(b.parse)return b.parse(b.field.value,b.format);if(n){var _=r(b.field.value,b.format,b.formatStrict);return _&&_.isValid()?_.toDate():null}else return new Date(Date.parse(b.field.value))},v._onInputChange=function(_){var M;_.firedBy!==v&&(M=v._parseFieldValue(),p(M)&&v.setDate(M),v._v||v.show())},v._onInputFocus=function(){v.show()},v._onInputClick=function(){v.show()},v._onInputBlur=function(){var _=o.activeElement;do if(c(_,"pika-single"))return;while(_=_.parentNode);v._c||(v._b=a(function(){v.hide()},50)),v._c=!1},v._onClick=function(_){_=_||window.event;var M=_.target||_.srcElement,L=M;if(M){!i&&c(M,"pika-select")&&(M.onchange||(M.setAttribute("onchange","return;"),s(M,"change",v._onChange)));do if(c(L,"pika-single")||L===b.trigger)return;while(L=L.parentNode);v._v&&M!==b.trigger&&L!==b.trigger&&v.hide()}},v.el=o.createElement("div"),v.el.className="pika-single"+(b.isRTL?" is-rtl":"")+(b.theme?" "+b.theme:""),s(v.el,"mousedown",v._onMouseDown,!0),s(v.el,"touchend",v._onMouseDown,!0),s(v.el,"change",v._onChange),b.keyboardInput&&s(o,"keydown",v._onKeyChange),b.field&&(b.container?b.container.appendChild(v.el):b.bound?o.body.appendChild(v.el):b.field.parentNode.insertBefore(v.el,b.field.nextSibling),s(b.field,"change",v._onInputChange),b.defaultDate||(b.defaultDate=v._parseFieldValue(),b.setDefaultDate=!0));var w=b.defaultDate;p(w)?b.setDefaultDate?v.setDate(w,!0):v.gotoDate(w):v.gotoDate(new Date),b.bound?(this.hide(),v.el.className+=" is-bound",s(b.trigger,"click",v._onInputClick),s(b.trigger,"focus",v._onInputFocus),s(b.trigger,"blur",v._onInputBlur)):this.show()};return ge.prototype={config:function(I){this._o||(this._o=O({},j,!0));var v=O(this._o,I,!0);v.isRTL=!!v.isRTL,v.field=v.field&&v.field.nodeName?v.field:null,v.theme=typeof v.theme=="string"&&v.theme?v.theme:null,v.bound=!!(v.bound!==void 0?v.field&&v.bound:v.field),v.trigger=v.trigger&&v.trigger.nodeName?v.trigger:v.field,v.disableWeekends=!!v.disableWeekends,v.disableDayFn=typeof v.disableDayFn=="function"?v.disableDayFn:null;var b=parseInt(v.numberOfMonths,10)||1;if(v.numberOfMonths=b>4?4:b,p(v.minDate)||(v.minDate=!1),p(v.maxDate)||(v.maxDate=!1),v.minDate&&v.maxDate&&v.maxDate<v.minDate&&(v.maxDate=v.minDate=!1),v.minDate&&this.setMinDate(v.minDate),v.maxDate&&this.setMaxDate(v.maxDate),d(v.yearRange)){var w=new Date().getFullYear()-10;v.yearRange[0]=parseInt(v.yearRange[0],10)||w,v.yearRange[1]=parseInt(v.yearRange[1],10)||w}else v.yearRange=Math.abs(parseInt(v.yearRange,10))||j.yearRange,v.yearRange>100&&(v.yearRange=100);return v},toString:function(I){return I=I||this._o.format,p(this._d)?this._o.toString?this._o.toString(this._d,I):n?r(this._d).format(I):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function(I,v){n&&r.isMoment(I)&&this.setDate(I.toDate(),v)},getDate:function(){return p(this._d)?new Date(this._d.getTime()):null},setDate:function(I,v){if(!I)return this._d=null,this._o.field&&(this._o.field.value="",A(this._o.field,"change",{firedBy:this})),this.draw();if(typeof I=="string"&&(I=new Date(Date.parse(I))),!!p(I)){var b=this._o.minDate,w=this._o.maxDate;p(b)&&I<b?I=b:p(w)&&I>w&&(I=w),this._d=new Date(I.getTime()),R(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),A(this._o.field,"change",{firedBy:this})),!v&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(I){var v=!0;if(p(I)){if(this.calendars){var b=new Date(this.calendars[0].year,this.calendars[0].month,1),w=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),_=I.getTime();w.setMonth(w.getMonth()+1),w.setDate(w.getDate()-1),v=_<b.getTime()||w.getTime()<_}v&&(this.calendars=[{month:I.getMonth(),year:I.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(I,v){var b=this.getDate()||new Date,w=parseInt(v)*24*60*60*1e3,_;I==="add"?_=new Date(b.valueOf()+w):I==="subtract"&&(_=new Date(b.valueOf()-w)),this.setDate(_)},adjustCalendars:function(){this.calendars[0]=B(this.calendars[0]);for(var I=1;I<this._o.numberOfMonths;I++)this.calendars[I]=B({month:this.calendars[0].month+I,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(I){isNaN(I)||(this.calendars[0].month=parseInt(I,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(I){isNaN(I)||(this.calendars[0].year=parseInt(I,10),this.adjustCalendars())},setMinDate:function(I){I instanceof Date?(R(I),this._o.minDate=I,this._o.minYear=I.getFullYear(),this._o.minMonth=I.getMonth()):(this._o.minDate=j.minDate,this._o.minYear=j.minYear,this._o.minMonth=j.minMonth,this._o.startRange=j.startRange),this.draw()},setMaxDate:function(I){I instanceof Date?(R(I),this._o.maxDate=I,this._o.maxYear=I.getFullYear(),this._o.maxMonth=I.getMonth()):(this._o.maxDate=j.maxDate,this._o.maxYear=j.maxYear,this._o.maxMonth=j.maxMonth,this._o.endRange=j.endRange),this.draw()},setStartRange:function(I){this._o.startRange=I},setEndRange:function(I){this._o.endRange=I},draw:function(I){if(!(!this._v&&!I)){var v=this._o,b=v.minYear,w=v.maxYear,_=v.minMonth,M=v.maxMonth,L="",H;this._y<=b&&(this._y=b,!isNaN(_)&&this._m<_&&(this._m=_)),this._y>=w&&(this._y=w,!isNaN(M)&&this._m>M&&(this._m=M));for(var Z=0;Z<v.numberOfMonths;Z++)H="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),L+='<div class="pika-lendar">'+me(this,Z,this.calendars[Z].year,this.calendars[Z].month,this.calendars[0].year,H)+this.render(this.calendars[Z].year,this.calendars[Z].month,H)+"</div>";this.el.innerHTML=L,v.bound&&v.field.type!=="hidden"&&a(function(){v.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),v.bound&&v.field.setAttribute("aria-label",v.ariaLabel)}},adjustPosition:function(){var I,v,b,w,_,M,L,H,Z,te,ie,oe;if(!this._o.container){if(this.el.style.position="absolute",I=this._o.trigger,v=I,b=this.el.offsetWidth,w=this.el.offsetHeight,_=window.innerWidth||o.documentElement.clientWidth,M=window.innerHeight||o.documentElement.clientHeight,L=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,ie=!0,oe=!0,typeof I.getBoundingClientRect=="function")te=I.getBoundingClientRect(),H=te.left+window.pageXOffset,Z=te.bottom+window.pageYOffset;else for(H=v.offsetLeft,Z=v.offsetTop+v.offsetHeight;v=v.offsetParent;)H+=v.offsetLeft,Z+=v.offsetTop;(this._o.reposition&&H+b>_||this._o.position.indexOf("right")>-1&&H-b+I.offsetWidth>0)&&(H=H-b+I.offsetWidth,ie=!1),(this._o.reposition&&Z+w>M+L||this._o.position.indexOf("top")>-1&&Z-w-I.offsetHeight>0)&&(Z=Z-w-I.offsetHeight,oe=!1),this.el.style.left=H+"px",this.el.style.top=Z+"px",f(this.el,ie?"left-aligned":"right-aligned"),f(this.el,oe?"bottom-aligned":"top-aligned"),h(this.el,ie?"right-aligned":"left-aligned"),h(this.el,oe?"top-aligned":"bottom-aligned")}},render:function(I,v,b){var w=this._o,_=new Date,M=S(I,v),L=new Date(I,v,1).getDay(),H=[],Z=[];R(_),w.firstDay>0&&(L-=w.firstDay,L<0&&(L+=7));for(var te=v===0?11:v-1,ie=v===11?0:v+1,oe=v===0?I-1:I,ve=v===11?I+1:I,ke=S(oe,te),pe=M+L,Ce=pe;Ce>7;)Ce-=7;pe+=7-Ce;for(var re=!1,Ve=0,Ze=0;Ve<pe;Ve++){var Ge=new Date(I,v,1+(Ve-L)),je=p(this._d)?E(Ge,this._d):!1,ze=E(Ge,_),T=w.events.indexOf(Ge.toDateString())!==-1,k=Ve<L||Ve>=M+L,$=1+(Ve-L),W=v,F=I,K=w.startRange&&E(w.startRange,Ge),V=w.endRange&&E(w.endRange,Ge),U=w.startRange&&w.endRange&&w.startRange<Ge&&Ge<w.endRange,X=w.minDate&&Ge<w.minDate||w.maxDate&&Ge>w.maxDate||w.disableWeekends&&m(Ge)||w.disableDayFn&&w.disableDayFn(Ge);k&&(Ve<L?($=ke+$,W=te,F=oe):($=$-M,W=ie,F=ve));var z={day:$,month:W,year:F,hasEvent:T,isSelected:je,isToday:ze,isDisabled:X,isEmpty:k,isStartRange:K,isEndRange:V,isInRange:U,showDaysInNextAndPreviousMonths:w.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:w.enableSelectionDaysInNextAndPreviousMonths};w.pickWholeWeek&&je&&(re=!0),Z.push(Y(z)),++Ze===7&&(w.showWeekNumber&&Z.unshift(ee(Ve-L,v,I,w.firstWeekOfYearMinDays)),H.push(ae(Z,w.isRTL,w.pickWholeWeek,re)),Z=[],Ze=0,re=!1)}return Re(w,H,b)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(s(o,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var I=this._v;I!==!1&&(this._o.bound&&l(o,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),f(this.el,"is-hidden"),this._v=!1,I!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var I=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),I.keyboardInput&&l(o,"keydown",this._onKeyChange),I.field&&(l(I.field,"change",this._onInputChange),I.bound&&(l(I.trigger,"click",this._onInputClick),l(I.trigger,"focus",this._onInputFocus),l(I.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},ge})})(sG);var W8e=sG.exports;const U9=IT(W8e);function Kf(t){"@babel/helpers - typeof";return Kf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kf(t)}function G8e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function B9(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Y8e(n.key),n)}}function z8e(t,e,r){return e&&B9(t.prototype,e),r&&B9(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Y8e(t){var e=K8e(t,"string");return Kf(e)==="symbol"?e:String(e)}function K8e(t,e){if(Kf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Kf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function ca(){return typeof Reflect<"u"&&Reflect.get?ca=Reflect.get.bind():ca=function(e,r,n){var i=X8e(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},ca.apply(this,arguments)}function X8e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Yi(t),t!==null););return t}function q8e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&V5(t,e)}function V5(t,e){return V5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},V5(t,e)}function Q8e(t){var e=e3e();return function(){var n=Yi(t),i;if(e){var o=Yi(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Z8e(this,i)}}function Z8e(t,e){if(e&&(Kf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return J8e(t)}function J8e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function e3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yi(t){return Yi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yi(t)}var lG="date",V9="dateEditor",uG=function(t){q8e(r,t);var e=Q8e(r);function r(n){var i;return G8e(this,r),i=e.call(this,n),i.defaultDateFormat="DD/MM/YYYY",i.isCellEdited=!1,i.parentDestroyed=!1,i.$datePicker=null,i}return z8e(r,[{key:"init",value:function(){var i=this;if(typeof se!="function")throw new Error("You need to include moment.js to your project.");if(typeof U9!="function")throw new Error("You need to include Pikaday to your project.");ca(Yi(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){i.parentDestroyed=!0,i.destroyElements()})}},{key:"createElements",value:function(){ca(Yi(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),le(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var i=new hr(this);i.addEventListener(this.datePicker,"mousedown",function(o){return o.stopPropagation()})}},{key:"destroyElements",value:function(){var i=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),i&&i.removeChild(this.datePicker)}},{key:"prepare",value:function(i,o,a,s,l,u){ca(Yi(r.prototype),"prepare",this).call(this,i,o,a,s,l,u)}},{key:"open",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=this.hot.getShortcutManager(),a=o.getContext("editor");ca(Yi(r.prototype),"open",this).call(this),this.showDatepicker(i),a.addShortcut({keys:[["Enter"]],callback:function(l){l.stopPropagation()},group:V9})}},{key:"close",value:function(){var i,o=this;this._opened=!1,(i=this.$datePicker)!==null&&i!==void 0&&i.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){o.instance._refreshBorders()});var a=this.hot.getShortcutManager(),s=a.getContext("editor");s.removeShortcutsByGroup(V9),ca(Yi(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(i){var a=this.originalValue;a!==void 0&&this.setValue(a)}ca(Yi(r.prototype),"finishEditing",this).call(this,i,o)}},{key:"showDatepicker",value:function(i){var o=this.TD.getBoundingClientRect(),a=this.cellProperties.dateFormat||this.defaultDateFormat,s=this.instance.view.isMouseDown(),l=i?ZH(i.keyCode):!1,u;this.datePicker.style.display="block",this.$datePicker=new U9(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+o.top+ur(this.TD),"px");var c=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?c=o.right-Ut(this.datePicker):c=o.left,this.datePickerStyle.left="".concat(c,"px"),this.originalValue?(u=this.originalValue,se(u,a,!0).isValid()&&this.$datePicker.setMoment(se(u,a),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!l&&!s&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,se(u,a,!0).isValid()&&this.$datePicker.setMoment(se(u,a),!0),!l&&!s&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var i=this,o=this.TEXTAREA,a={};this.cellProperties&&this.cellProperties.datePickerConfig&&V2(a,this.cellProperties.datePickerConfig);var s=a.onSelect,l=a.onClose;return a.field=o,a.trigger=o,a.container=this.datePicker,a.bound=!1,a.format=a.format||this.defaultDateFormat,a.reposition=a.reposition||!1,a.isRTL=!1,a.onSelect=function(u){var c=u;isNaN(c.getTime())||(c=se(c).format(i.cellProperties.dateFormat||i.defaultDateFormat)),i.setValue(c),i.hideDatepicker(),s&&s()},a.onClose=function(){i.parentDestroyed||i.finishEditing(!1),l&&l()},a}}],[{key:"EDITOR_TYPE",get:function(){return lG}}]),r}(Fu);function Xf(t){"@babel/helpers - typeof";return Xf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xf(t)}function t3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j9(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n3e(n.key),n)}}function r3e(t,e,r){return e&&j9(t.prototype,e),r&&j9(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function n3e(t){var e=i3e(t,"string");return Xf(e)==="symbol"?e:String(e)}function i3e(t,e){if(Xf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Xf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function p0(){return typeof Reflect<"u"&&Reflect.get?p0=Reflect.get.bind():p0=function(e,r,n){var i=o3e(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},p0.apply(this,arguments)}function o3e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=qf(t),t!==null););return t}function a3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&j5(t,e)}function j5(t,e){return j5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},j5(t,e)}function s3e(t){var e=c3e();return function(){var n=qf(t),i;if(e){var o=qf(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return l3e(this,i)}}function l3e(t,e){if(e&&(Xf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return u3e(t)}function u3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qf(t){return qf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qf(t)}var f3e="dropdown",MI=function(t){a3e(r,t);var e=s3e(r);function r(){return t3e(this,r),e.apply(this,arguments)}return r3e(r,[{key:"prepare",value:function(i,o,a,s,l,u){p0(qf(r.prototype),"prepare",this).call(this,i,o,a,s,l,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return f3e}}]),r}(PI);Ne.getSingleton().add("beforeValidate",function(t,e,r){var n=this.getCellMeta(e,this.propToCol(r));n.editor===MI&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function Qf(t){"@babel/helpers - typeof";return Qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qf(t)}function h3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d3e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,m3e(n.key),n)}}function p3e(t,e,r){return r&&d3e(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function m3e(t){var e=v3e(t,"string");return Qf(e)==="symbol"?e:String(e)}function v3e(t,e){if(Qf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Qf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function g3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&W5(t,e)}function W5(t,e){return W5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},W5(t,e)}function y3e(t){var e=S3e();return function(){var n=o2(t),i;if(e){var o=o2(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return b3e(this,i)}}function b3e(t,e){if(e&&(Qf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w3e(t)}function w3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function o2(t){return o2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},o2(t)}var R3e="numeric",cG=function(t){g3e(r,t);var e=y3e(r);function r(){return h3e(this,r),e.apply(this,arguments)}return p3e(r,null,[{key:"EDITOR_TYPE",get:function(){return R3e}}]),r}(Fu);function Zf(t){"@babel/helpers - typeof";return Zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zf(t)}function E3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function W9(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,O3e(n.key),n)}}function C3e(t,e,r){return e&&W9(t.prototype,e),r&&W9(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function O3e(t){var e=T3e(t,"string");return Zf(e)==="symbol"?e:String(e)}function T3e(t,e){if(Zf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Zf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function m0(){return typeof Reflect<"u"&&Reflect.get?m0=Reflect.get.bind():m0=function(e,r,n){var i=_3e(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},m0.apply(this,arguments)}function _3e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Jf(t),t!==null););return t}function A3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&G5(t,e)}function G5(t,e){return G5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},G5(t,e)}function I3e(t){var e=M3e();return function(){var n=Jf(t),i;if(e){var o=Jf(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return N3e(this,i)}}function N3e(t,e){if(e&&(Zf(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P3e(t)}function P3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function M3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jf(t){return Jf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jf(t)}var k3e="password",fG=function(t){A3e(r,t);var e=I3e(r);function r(){return E3e(this,r),e.apply(this,arguments)}return C3e(r,[{key:"createElements",value:function(){m0(Jf(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,$o(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return k3e}}]),r}(Fu);function Ou(t){"@babel/helpers - typeof";return Ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ou(t)}function x3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function G9(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,L3e(n.key),n)}}function $3e(t,e,r){return e&&G9(t.prototype,e),r&&G9(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function L3e(t){var e=D3e(t,"string");return Ou(e)==="symbol"?e:String(e)}function D3e(t,e){if(Ou(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function v0(){return typeof Reflect<"u"&&Reflect.get?v0=Reflect.get.bind():v0=function(e,r,n){var i=F3e(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},v0.apply(this,arguments)}function F3e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=eh(t),t!==null););return t}function H3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&z5(t,e)}function z5(t,e){return z5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},z5(t,e)}function U3e(t){var e=j3e();return function(){var n=eh(t),i;if(e){var o=eh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return B3e(this,i)}}function B3e(t,e){if(e&&(Ou(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return V3e(t)}function V3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function j3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function eh(t){return eh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},eh(t)}var Y6="ht_editor_visible",z9="selectEditor",W3e="select",G3e=function(t){H3e(r,t);var e=U3e(r);function r(){return x3e(this,r),e.apply(this,arguments)}return $3e(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),le(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(i){this.select.value=i}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",Xe(this.select,Y6)&&qe(this.select,Y6),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var i=this;this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){return i.refreshDimensions()}),this.addHook("afterRowResize",function(){return i.refreshDimensions()})}},{key:"prepare",value:function(i,o,a,s,l,u){var c=this;v0(eh(r.prototype),"prepare",this).call(this,i,o,a,s,l,u);var f=this.cellProperties.selectOptions,h;typeof f=="function"?h=this.prepareOptions(f(this.row,this.col,this.prop)):h=this.prepareOptions(f),$o(this.select),ut(h,function(d,p){var m=c.hot.rootDocument.createElement("OPTION");m.value=p,Ed(m,d),c.select.appendChild(m)})}},{key:"prepareOptions",value:function(i){var o={};if(Array.isArray(i))for(var a=0,s=i.length;a<s;a++)o[i[a]]=i[a];else Ou(i)==="object"&&(o=i);return o}},{key:"refreshValue",value:function(){var i=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===Wr.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var i=this.getEditedCellRect(),o=i.top,a=i.start,s=i.width,l=i.height,u=this.select.style;u.height="".concat(l,"px"),u.width="".concat(s,"px"),u.top="".concat(o,"px"),u[this.hot.isRtl()?"right":"left"]="".concat(a,"px"),u.margin="0px",le(this.select,Y6)}}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),a=o.getContext("editor"),s={group:z9};this.isInFullEditMode()!==!1&&a.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var u=i.select.selectedIndex-1;u>=0&&(i.select[u].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var u=i.select.selectedIndex+1;u<=i.select.length-1&&(i.select[u].selected=!0)}}],s)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),o=i.getContext("editor");o.removeShortcutsByGroup(z9)}}],[{key:"EDITOR_TYPE",get:function(){return W3e}}]),r}(_d);function th(t){"@babel/helpers - typeof";return th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},th(t)}function z3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y9(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,K3e(n.key),n)}}function Y3e(t,e,r){return e&&Y9(t.prototype,e),r&&Y9(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function K3e(t){var e=X3e(t,"string");return th(e)==="symbol"?e:String(e)}function X3e(t,e){if(th(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function g0(){return typeof Reflect<"u"&&Reflect.get?g0=Reflect.get.bind():g0=function(e,r,n){var i=q3e(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},g0.apply(this,arguments)}function q3e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=rh(t),t!==null););return t}function Q3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Y5(t,e)}function Y5(t,e){return Y5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Y5(t,e)}function Z3e(t){var e=tMe();return function(){var n=rh(t),i;if(e){var o=rh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return J3e(this,i)}}function J3e(t,e){if(e&&(th(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eMe(t)}function eMe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rh(t){return rh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rh(t)}var rMe="time",hG=function(t){Q3e(r,t);var e=Z3e(r);function r(){return z3e(this,r),e.apply(this,arguments)}return Y3e(r,[{key:"prepare",value:function(i,o,a,s,l,u){g0(rh(r.prototype),"prepare",this).call(this,i,o,a,s,l,u),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return rMe}}]),r}(Fu);function nMe(){ri(_d),ri(PI),ri(aG),ri(uG),ri(MI),ri(NI),ri(cG),ri(fG),ri(G3e),ri(Fu),ri(hG)}var iMe="html";function kI(t,e,r,n,i,o,a){zg.apply(this,[t,e,r,n,i,o,a]),Ed(e,o??"",!1)}kI.RENDERER_TYPE=iMe;var oMe="autocomplete";function Nd(t,e,r,n,i,o,a){var s=t.rootDocument,l=a.allowHtml?kI:Qs,u=s.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(s.createTextNode("▼")),l.apply(this,[t,e,r,n,i,o,a]),e.firstChild||e.appendChild(s.createTextNode(" ")),e.insertBefore(u,e.firstChild),le(e,"htAutocomplete"),!t.acArrowListener){var c=new hr(t);t.acArrowListener=function(f){Xe(f.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(r,n),e)},c.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",function(){c.destroy()})}}Nd.RENDERER_TYPE=oMe;var K9=new WeakMap,X9=new WeakMap,aMe="htBadValue",nh="data-row",ih="data-col",sMe="checkboxRenderer",dG="checkbox";Ne.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,r){var n=e.label,i=e.type,o=e.row,a=e.column,s=e.prop;if(i===dG){if(n){var l=n.value,u=n.property,c=r;if(l)c=typeof l=="function"?l(o,a,s,r):l;else if(u){var f=this.getDataAtRowProp(o,u);c=f!==null?f:r}t=c}return t}});function xI(t,e,r,n,i,o,a){var s=t.rootDocument;zg.apply(this,[t,e,r,n,i,o,a]),lMe(t);var l=uMe(s),u=a.label,c=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),$o(e),o===a.checkedTemplate||Ar(o).toLocaleLowerCase(a.locale)===Ar(a.checkedTemplate).toLocaleLowerCase(a.locale)?l.checked=!0:o===a.uncheckedTemplate||Ar(o).toLocaleLowerCase(a.locale)===Ar(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?l.checked=!1:Br(o)?le(l,"noValue"):(l.style.display="none",le(l,aMe),c=!0),l.setAttribute(nh,r),l.setAttribute(ih,n),!c&&u){var f="";if(u.value)f=typeof u.value=="function"?u.value.call(this,r,n,i,o):u.value;else if(u.property){var h=t.getDataAtRowProp(r,u.property);f=h!==null?h:""}var d=cMe(s,f,u.separated!==!0);u.position==="before"?u.separated?(e.appendChild(d),e.appendChild(l)):(d.appendChild(l),l=d):(!u.position||u.position==="after")&&(u.separated?(e.appendChild(l),e.appendChild(d)):(d.insertBefore(l,d.firstChild),l=d))}(!u||u&&!u.separated)&&e.appendChild(l),c&&e.appendChild(s.createTextNode("#bad-value#")),K9.has(t)||(K9.set(t,!0),p());function p(){var S=t.getShortcutManager(),R=S.getContext("grid"),E={group:sMe};R.addShortcuts([{keys:[["space"]],callback:function(){return m(),!y()}},{keys:[["enter"]],callback:function(){return m(),!y()},runOnlyIf:function(){return t.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return m(!0),!y()},relativeToGroup:Ip,position:"before"}],E)}function m(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=t.getSelectedRange();if(R)for(var E=0;E<R.length;E++){for(var O=R[E].getTopStartCorner(),A=O.row,B=O.col,j=R[E].getBottomEndCorner(),J=j.row,Y=j.col,q=[],ee=A;ee<=J;ee+=1)for(var ae=B;ae<=Y;ae+=1){var ne=t.getCellMeta(ee,ae);if(ne.type!=="checkbox")return;if(ne.readOnly!==!0){typeof ne.checkedTemplate>"u"&&(ne.checkedTemplate=!0),typeof ne.uncheckedTemplate>"u"&&(ne.uncheckedTemplate=!1);var ue=t.getDataAtCell(ee,ae);S===!1?[ne.checkedTemplate,ne.checkedTemplate.toString()].includes(ue)?q.push([ee,ae,ne.uncheckedTemplate]):[ne.uncheckedTemplate,ne.uncheckedTemplate.toString(),null,void 0].includes(ue)&&q.push([ee,ae,ne.checkedTemplate]):q.push([ee,ae,ne.uncheckedTemplate])}}q.length>0&&t.setDataAtCell(q)}}function y(){var S=t.getSelectedRange();if(S){for(var R=0;R<S.length;R++)for(var E=S[R].getTopStartCorner(),O=S[R].getBottomEndCorner(),A=E.row;A<=O.row;A++)for(var B=E.col;B<=O.col;B++){var j=t.getCellMeta(A,B);if(j.type!=="checkbox")return!1;var J=t.getCell(A,B);if(J==null)return!0;var Y=J.querySelectorAll("input[type=checkbox]");if(Y.length>0&&!j.readOnly)return!0}return!1}}}xI.RENDERER_TYPE=dG;function lMe(t){var e=X9.get(t);if(!e){var r=t.rootElement;e=new hr(t),e.addEventListener(r,"click",function(n){return hMe(n,t)}),e.addEventListener(r,"mouseup",function(n){return fMe(n,t)}),e.addEventListener(r,"change",function(n){return dMe(n,t)}),X9.set(t,e)}return e}function uMe(t){var e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function cMe(t,e,r){var n=t.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(t.createTextNode(e)),n.cloneNode(!0)}function fMe(t,e){var r=t.target;$I(r)&&(!r.hasAttribute(nh)||!r.hasAttribute(ih)||setTimeout(e.listen,10))}function hMe(t,e){var r=t.target;if($I(r)&&!(!r.hasAttribute(nh)||!r.hasAttribute(ih))){var n=parseInt(r.getAttribute(nh),10),i=parseInt(r.getAttribute(ih),10),o=e.getCellMeta(n,i);o.readOnly&&t.preventDefault()}}function dMe(t,e){var r=t.target;if($I(r)&&!(!r.hasAttribute(nh)||!r.hasAttribute(ih))){var n=parseInt(r.getAttribute(nh),10),i=parseInt(r.getAttribute(ih),10),o=e.getCellMeta(n,i);if(!o.readOnly){var a=null;t.target.checked?a=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:a=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(n,i,a)}}}function $I(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}function n1(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pG={exports:{}};(function(t,e){(function(r){t.exports=r()})(function(){return function r(n,i,o){function a(u,c){if(!i[u]){if(!n[u]){var f=typeof n1=="function"&&n1;if(!c&&f)return f(u,!0);if(s)return s(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=i[u]={exports:{}};n[u][0].call(d.exports,function(p){return a(n[u][1][p]||p)},d,d.exports,r,n,i,o)}return i[u].exports}for(var s=typeof n1=="function"&&n1,l=0;l<o.length;l++)a(o[l]);return a}({1:[function(r,n,i){(function(o){var a,s=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",f=c+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,p=9007199254740991,m=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],y=1e7,S=1e9;function R(Y){var q=0|Y;return 0<Y||Y===q?q:q-1}function E(Y){for(var q,ee,ae=1,ne=Y.length,ue=Y[0]+"";ae<ne;){for(q=Y[ae++]+"",ee=d-q.length;ee--;q="0"+q);ue+=q}for(ne=ue.length;ue.charCodeAt(--ne)===48;);return ue.slice(0,ne+1||1)}function O(Y,q){var ee,ae,ne=Y.c,ue=q.c,me=Y.s,Re=q.s,ge=Y.e,I=q.e;if(!me||!Re)return null;if(ee=ne&&!ne[0],ae=ue&&!ue[0],ee||ae)return ee?ae?0:-Re:me;if(me!=Re)return me;if(ee=me<0,ae=ge==I,!ne||!ue)return ae?0:!ne^ee?1:-1;if(!ae)return I<ge^ee?1:-1;for(Re=(ge=ne.length)<(I=ue.length)?ge:I,me=0;me<Re;me++)if(ne[me]!=ue[me])return ne[me]>ue[me]^ee?1:-1;return ge==I?0:I<ge^ee?1:-1}function A(Y,q,ee,ae){if(Y<q||ee<Y||Y!==(Y<0?l(Y):u(Y)))throw Error(c+(ae||"Argument")+(typeof Y=="number"?Y<q||ee<Y?" out of range: ":" not an integer: ":" not a primitive number: ")+String(Y))}function B(Y){var q=Y.c.length-1;return R(Y.e/d)==q&&Y.c[q]%2!=0}function j(Y,q){return(1<Y.length?Y.charAt(0)+"."+Y.slice(1):Y)+(q<0?"e":"e+")+q}function J(Y,q,ee){var ae,ne;if(q<0){for(ne=ee+".";++q;ne+=ee);Y=ne+Y}else if(++q>(ae=Y.length)){for(ne=ee,q-=ae;--q;ne+=ee);Y+=ne}else q<ae&&(Y=Y.slice(0,q)+"."+Y.slice(q));return Y}(a=function Y(q){var ee,ae,ne,ue,me,Re,ge,I,v,b,w=re.prototype={constructor:re,toString:null,valueOf:null},_=new re(1),M=20,L=4,H=-7,Z=21,te=-1e7,ie=1e7,oe=!1,ve=1,ke=0,pe={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},Ce="0123456789abcdefghijklmnopqrstuvwxyz";function re(T,k){var $,W,F,K,V,U,X,z,Q=this;if(!(Q instanceof re))return new re(T,k);if(k==null){if(T instanceof re)return Q.s=T.s,Q.e=T.e,void(Q.c=(T=T.c)?T.slice():T);if((U=typeof T=="number")&&0*T==0){if(Q.s=1/T<0?(T=-T,-1):1,T===~~T){for(K=0,V=T;10<=V;V/=10,K++);return Q.e=K,void(Q.c=[T])}z=String(T)}else{if(z=String(T),!s.test(z))return ne(Q,z,U);Q.s=z.charCodeAt(0)==45?(z=z.slice(1),-1):1}-1<(K=z.indexOf("."))&&(z=z.replace(".","")),0<(V=z.search(/e/i))?(K<0&&(K=V),K+=+z.slice(V+1),z=z.substring(0,V)):K<0&&(K=z.length)}else{if(A(k,2,Ce.length,"Base"),z=String(T),k==10)return je(Q=new re(T instanceof re?T:z),M+Q.e+1,L);if(U=typeof T=="number"){if(0*T!=0)return ne(Q,z,U,k);if(Q.s=1/T<0?(z=z.slice(1),-1):1,re.DEBUG&&15<z.replace(/^0\.0*|\./,"").length)throw Error(f+T);U=!1}else Q.s=z.charCodeAt(0)===45?(z=z.slice(1),-1):1;for($=Ce.slice(0,k),K=V=0,X=z.length;V<X;V++)if($.indexOf(W=z.charAt(V))<0){if(W=="."){if(K<V){K=X;continue}}else if(!F&&(z==z.toUpperCase()&&(z=z.toLowerCase())||z==z.toLowerCase()&&(z=z.toUpperCase()))){F=!0,V=-1,K=0;continue}return ne(Q,String(T),U,k)}-1<(K=(z=ae(z,k,10,Q.s)).indexOf("."))?z=z.replace(".",""):K=z.length}for(V=0;z.charCodeAt(V)===48;V++);for(X=z.length;z.charCodeAt(--X)===48;);if(z=z.slice(V,++X)){if(X-=V,U&&re.DEBUG&&15<X&&(p<T||T!==u(T)))throw Error(f+Q.s*T);if(ie<(K=K-V-1))Q.c=Q.e=null;else if(K<te)Q.c=[Q.e=0];else{if(Q.e=K,Q.c=[],V=(K+1)%d,K<0&&(V+=d),V<X){for(V&&Q.c.push(+z.slice(0,V)),X-=d;V<X;)Q.c.push(+z.slice(V,V+=d));z=z.slice(V),V=d-z.length}else V-=X;for(;V--;z+="0");Q.c.push(+z)}}else Q.c=[Q.e=0]}function Ve(T,k,$,W){var F,K,V,U,X;if($==null?$=L:A($,0,8),!T.c)return T.toString();if(F=T.c[0],V=T.e,k==null)X=E(T.c),X=W==1||W==2&&(V<=H||Z<=V)?j(X,V):J(X,V,"0");else if(K=(T=je(new re(T),k,$)).e,U=(X=E(T.c)).length,W==1||W==2&&(k<=K||K<=H)){for(;U<k;X+="0",U++);X=j(X,K)}else if(k-=V,X=J(X,K,"0"),U<K+1){if(0<--k)for(X+=".";k--;X+="0");}else if(0<(k+=K-U))for(K+1==U&&(X+=".");k--;X+="0");return T.s<0&&F?"-"+X:X}function Ze(T,k){for(var $,W=1,F=new re(T[0]);W<T.length;W++){if(!($=new re(T[W])).s){F=$;break}k.call(F,$)&&(F=$)}return F}function Ge(T,k,$){for(var W=1,F=k.length;!k[--F];k.pop());for(F=k[0];10<=F;F/=10,W++);return($=W+$*d-1)>ie?T.c=T.e=null:T.c=$<te?[T.e=0]:(T.e=$,k),T}function je(T,k,$,W){var F,K,V,U,X,z,Q,de=T.c,Ee=m;if(de){e:{for(F=1,U=de[0];10<=U;U/=10,F++);if((K=k-F)<0)K+=d,V=k,Q=(X=de[z=0])/Ee[F-V-1]%10|0;else if((z=l((K+1)/d))>=de.length){if(!W)break e;for(;de.length<=z;de.push(0));X=Q=0,V=(K%=d)-d+(F=1)}else{for(X=U=de[z],F=1;10<=U;U/=10,F++);Q=(V=(K%=d)-d+F)<0?0:X/Ee[F-V-1]%10|0}if(W=W||k<0||de[z+1]!=null||(V<0?X:X%Ee[F-V-1]),W=$<4?(Q||W)&&($==0||$==(T.s<0?3:2)):5<Q||Q==5&&($==4||W||$==6&&(0<K?0<V?X/Ee[F-V]:0:de[z-1])%10&1||$==(T.s<0?8:7)),k<1||!de[0])return de.length=0,W?(k-=T.e+1,de[0]=Ee[(d-k%d)%d],T.e=-k||0):de[0]=T.e=0,T;if(K==0?(de.length=z,U=1,z--):(de.length=z+1,U=Ee[d-K],de[z]=0<V?u(X/Ee[F-V]%Ee[V])*U:0),W)for(;;){if(z==0){for(K=1,V=de[0];10<=V;V/=10,K++);for(V=de[0]+=U,U=1;10<=V;V/=10,U++);K!=U&&(T.e++,de[0]==h&&(de[0]=1));break}if(de[z]+=U,de[z]!=h)break;de[z--]=0,U=1}for(K=de.length;de[--K]===0;de.pop());}T.e>ie?T.c=T.e=null:T.e<te&&(T.c=[T.e=0])}return T}function ze(T){var k,$=T.e;return $===null?T.toString():(k=E(T.c),k=$<=H||Z<=$?j(k,$):J(k,$,"0"),T.s<0?"-"+k:k)}return re.clone=Y,re.ROUND_UP=0,re.ROUND_DOWN=1,re.ROUND_CEIL=2,re.ROUND_FLOOR=3,re.ROUND_HALF_UP=4,re.ROUND_HALF_DOWN=5,re.ROUND_HALF_EVEN=6,re.ROUND_HALF_CEIL=7,re.ROUND_HALF_FLOOR=8,re.EUCLID=9,re.config=re.set=function(T){var k,$;if(T!=null){if(typeof T!="object")throw Error(c+"Object expected: "+T);if(T.hasOwnProperty(k="DECIMAL_PLACES")&&(A($=T[k],0,S,k),M=$),T.hasOwnProperty(k="ROUNDING_MODE")&&(A($=T[k],0,8,k),L=$),T.hasOwnProperty(k="EXPONENTIAL_AT")&&(($=T[k])&&$.pop?(A($[0],-S,0,k),A($[1],0,S,k),H=$[0],Z=$[1]):(A($,-S,S,k),H=-(Z=$<0?-$:$))),T.hasOwnProperty(k="RANGE"))if(($=T[k])&&$.pop)A($[0],-S,-1,k),A($[1],1,S,k),te=$[0],ie=$[1];else{if(A($,-S,S,k),!$)throw Error(c+k+" cannot be zero: "+$);te=-(ie=$<0?-$:$)}if(T.hasOwnProperty(k="CRYPTO")){if(($=T[k])!==!!$)throw Error(c+k+" not true or false: "+$);if($){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw oe=!$,Error(c+"crypto unavailable");oe=$}else oe=$}if(T.hasOwnProperty(k="MODULO_MODE")&&(A($=T[k],0,9,k),ve=$),T.hasOwnProperty(k="POW_PRECISION")&&(A($=T[k],0,S,k),ke=$),T.hasOwnProperty(k="FORMAT")){if(typeof($=T[k])!="object")throw Error(c+k+" not an object: "+$);pe=$}if(T.hasOwnProperty(k="ALPHABET")){if(typeof($=T[k])!="string"||/^.$|[+-.\s]|(.).*\1/.test($))throw Error(c+k+" invalid: "+$);Ce=$}}return{DECIMAL_PLACES:M,ROUNDING_MODE:L,EXPONENTIAL_AT:[H,Z],RANGE:[te,ie],CRYPTO:oe,MODULO_MODE:ve,POW_PRECISION:ke,FORMAT:pe,ALPHABET:Ce}},re.isBigNumber=function(T){return T instanceof re||T&&T._isBigNumber===!0||!1},re.maximum=re.max=function(){return Ze(arguments,w.lt)},re.minimum=re.min=function(){return Ze(arguments,w.gt)},re.random=(ue=9007199254740992,me=Math.random()*ue&2097151?function(){return u(Math.random()*ue)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(T){var k,$,W,F,K,V=0,U=[],X=new re(_);if(T==null?T=M:A(T,0,S),F=l(T/d),oe)if(crypto.getRandomValues){for(k=crypto.getRandomValues(new Uint32Array(F*=2));V<F;)9e15<=(K=131072*k[V]+(k[V+1]>>>11))?($=crypto.getRandomValues(new Uint32Array(2)),k[V]=$[0],k[V+1]=$[1]):(U.push(K%1e14),V+=2);V=F/2}else{if(!crypto.randomBytes)throw oe=!1,Error(c+"crypto unavailable");for(k=crypto.randomBytes(F*=7);V<F;)9e15<=(K=281474976710656*(31&k[V])+1099511627776*k[V+1]+4294967296*k[V+2]+16777216*k[V+3]+(k[V+4]<<16)+(k[V+5]<<8)+k[V+6])?crypto.randomBytes(7).copy(k,V):(U.push(K%1e14),V+=7);V=F/7}if(!oe)for(;V<F;)(K=me())<9e15&&(U[V++]=K%1e14);for(F=U[--V],T%=d,F&&T&&(K=m[d-T],U[V]=u(F/K)*K);U[V]===0;U.pop(),V--);if(V<0)U=[W=0];else{for(W=-1;U[0]===0;U.splice(0,1),W-=d);for(V=1,K=U[0];10<=K;K/=10,V++);V<d&&(W-=d-V)}return X.e=W,X.c=U,X}),re.sum=function(){for(var T=1,k=arguments,$=new re(k[0]);T<k.length;)$=$.plus(k[T++]);return $},ae=function(){var T="0123456789";function k($,W,F,K){for(var V,U,X=[0],z=0,Q=$.length;z<Q;){for(U=X.length;U--;X[U]*=W);for(X[0]+=K.indexOf($.charAt(z++)),V=0;V<X.length;V++)X[V]>F-1&&(X[V+1]==null&&(X[V+1]=0),X[V+1]+=X[V]/F|0,X[V]%=F)}return X.reverse()}return function($,W,F,K,V){var U,X,z,Q,de,Ee,Fe,ct,dt=$.indexOf("."),Ft=M,Je=L;for(0<=dt&&(Q=ke,ke=0,$=$.replace(".",""),Ee=(ct=new re(W)).pow($.length-dt),ke=Q,ct.c=k(J(E(Ee.c),Ee.e,"0"),10,F,T),ct.e=ct.c.length),z=Q=(Fe=k($,W,F,V?(U=Ce,T):(U=T,Ce))).length;Fe[--Q]==0;Fe.pop());if(!Fe[0])return U.charAt(0);if(dt<0?--z:(Ee.c=Fe,Ee.e=z,Ee.s=K,Fe=(Ee=ee(Ee,ct,Ft,Je,F)).c,de=Ee.r,z=Ee.e),dt=Fe[X=z+Ft+1],Q=F/2,de=de||X<0||Fe[X+1]!=null,de=Je<4?(dt!=null||de)&&(Je==0||Je==(Ee.s<0?3:2)):Q<dt||dt==Q&&(Je==4||de||Je==6&&1&Fe[X-1]||Je==(Ee.s<0?8:7)),X<1||!Fe[0])$=de?J(U.charAt(1),-Ft,U.charAt(0)):U.charAt(0);else{if(Fe.length=X,de)for(--F;++Fe[--X]>F;)Fe[X]=0,X||(++z,Fe=[1].concat(Fe));for(Q=Fe.length;!Fe[--Q];);for(dt=0,$="";dt<=Q;$+=U.charAt(Fe[dt++]));$=J($,z,U.charAt(0))}return $}}(),ee=function(){function T(W,F,K){var V,U,X,z,Q=0,de=W.length,Ee=F%y,Fe=F/y|0;for(W=W.slice();de--;)Q=((U=Ee*(X=W[de]%y)+(V=Fe*X+(z=W[de]/y|0)*Ee)%y*y+Q)/K|0)+(V/y|0)+Fe*z,W[de]=U%K;return Q&&(W=[Q].concat(W)),W}function k(W,F,K,V){var U,X;if(K!=V)X=V<K?1:-1;else for(U=X=0;U<K;U++)if(W[U]!=F[U]){X=W[U]>F[U]?1:-1;break}return X}function $(W,F,K,V){for(var U=0;K--;)W[K]-=U,U=W[K]<F[K]?1:0,W[K]=U*V+W[K]-F[K];for(;!W[0]&&1<W.length;W.splice(0,1));}return function(W,F,K,V,U){var X,z,Q,de,Ee,Fe,ct,dt,Ft,Je,xe,Ot,Tt,yt,er,_t,pr,Gt=W.s==F.s?1:-1,At=W.c,wt=F.c;if(!(At&&At[0]&&wt&&wt[0]))return new re(W.s&&F.s&&(At?!wt||At[0]!=wt[0]:wt)?At&&At[0]==0||!wt?0*Gt:Gt/0:NaN);for(Ft=(dt=new re(Gt)).c=[],Gt=K+(z=W.e-F.e)+1,U||(U=h,z=R(W.e/d)-R(F.e/d),Gt=Gt/d|0),Q=0;wt[Q]==(At[Q]||0);Q++);if(wt[Q]>(At[Q]||0)&&z--,Gt<0)Ft.push(1),de=!0;else{for(yt=At.length,_t=wt.length,Gt+=2,1<(Ee=u(U/(wt[Q=0]+1)))&&(wt=T(wt,Ee,U),At=T(At,Ee,U),_t=wt.length,yt=At.length),Tt=_t,xe=(Je=At.slice(0,_t)).length;xe<_t;Je[xe++]=0);pr=wt.slice(),pr=[0].concat(pr),er=wt[0],wt[1]>=U/2&&er++;do{if(Ee=0,(X=k(wt,Je,_t,xe))<0){if(Ot=Je[0],_t!=xe&&(Ot=Ot*U+(Je[1]||0)),1<(Ee=u(Ot/er)))for(U<=Ee&&(Ee=U-1),ct=(Fe=T(wt,Ee,U)).length,xe=Je.length;k(Fe,Je,ct,xe)==1;)Ee--,$(Fe,_t<ct?pr:wt,ct,U),ct=Fe.length,X=1;else Ee==0&&(X=Ee=1),ct=(Fe=wt.slice()).length;if(ct<xe&&(Fe=[0].concat(Fe)),$(Je,Fe,xe,U),xe=Je.length,X==-1)for(;k(wt,Je,_t,xe)<1;)Ee++,$(Je,_t<xe?pr:wt,xe,U),xe=Je.length}else X===0&&(Ee++,Je=[0]);Ft[Q++]=Ee,Je[0]?Je[xe++]=At[Tt]||0:(Je=[At[Tt]],xe=1)}while((Tt++<yt||Je[0]!=null)&&Gt--);de=Je[0]!=null,Ft[0]||Ft.splice(0,1)}if(U==h){for(Q=1,Gt=Ft[0];10<=Gt;Gt/=10,Q++);je(dt,K+(dt.e=Q+z*d-1)+1,V,de)}else dt.e=z,dt.r=+de;return dt}}(),Re=/^(-?)0([xbo])(?=\w[\w.]*$)/i,ge=/^([^.]+)\.$/,I=/^\.([^.]+)$/,v=/^-?(Infinity|NaN)$/,b=/^\s*\+(?=[\w.])|^\s+|\s+$/g,ne=function(T,k,$,W){var F,K=$?k:k.replace(b,"");if(v.test(K))T.s=isNaN(K)?null:K<0?-1:1,T.c=T.e=null;else{if(!$&&(K=K.replace(Re,function(V,U,X){return F=(X=X.toLowerCase())=="x"?16:X=="b"?2:8,W&&W!=F?V:U}),W&&(F=W,K=K.replace(ge,"$1").replace(I,"0.$1")),k!=K))return new re(K,F);if(re.DEBUG)throw Error(c+"Not a"+(W?" base "+W:"")+" number: "+k);T.c=T.e=T.s=null}},w.absoluteValue=w.abs=function(){var T=new re(this);return T.s<0&&(T.s=1),T},w.comparedTo=function(T,k){return O(this,new re(T,k))},w.decimalPlaces=w.dp=function(T,k){var $,W,F;if(T!=null)return A(T,0,S),k==null?k=L:A(k,0,8),je(new re(this),T+this.e+1,k);if(!($=this.c))return null;if(W=((F=$.length-1)-R(this.e/d))*d,F=$[F])for(;F%10==0;F/=10,W--);return W<0&&(W=0),W},w.dividedBy=w.div=function(T,k){return ee(this,new re(T,k),M,L)},w.dividedToIntegerBy=w.idiv=function(T,k){return ee(this,new re(T,k),0,1)},w.exponentiatedBy=w.pow=function(T,k){var $,W,F,K,V,U,X,z,Q=this;if((T=new re(T)).c&&!T.isInteger())throw Error(c+"Exponent not an integer: "+ze(T));if(k!=null&&(k=new re(k)),V=14<T.e,!Q.c||!Q.c[0]||Q.c[0]==1&&!Q.e&&Q.c.length==1||!T.c||!T.c[0])return z=new re(Math.pow(+ze(Q),V?2-B(T):+ze(T))),k?z.mod(k):z;if(U=T.s<0,k){if(k.c?!k.c[0]:!k.s)return new re(NaN);(W=!U&&Q.isInteger()&&k.isInteger())&&(Q=Q.mod(k))}else{if(9<T.e&&(0<Q.e||Q.e<-1||(Q.e==0?1<Q.c[0]||V&&24e7<=Q.c[1]:Q.c[0]<8e13||V&&Q.c[0]<=9999975e7)))return K=Q.s<0&&B(T)?-0:0,-1<Q.e&&(K=1/K),new re(U?1/K:K);ke&&(K=l(ke/d+2))}for(X=V?($=new re(.5),U&&(T.s=1),B(T)):(F=Math.abs(+ze(T)))%2,z=new re(_);;){if(X){if(!(z=z.times(Q)).c)break;K?z.c.length>K&&(z.c.length=K):W&&(z=z.mod(k))}if(F){if((F=u(F/2))===0)break;X=F%2}else if(je(T=T.times($),T.e+1,1),14<T.e)X=B(T);else{if((F=+ze(T))==0)break;X=F%2}Q=Q.times(Q),K?Q.c&&Q.c.length>K&&(Q.c.length=K):W&&(Q=Q.mod(k))}return W?z:(U&&(z=_.div(z)),k?z.mod(k):K?je(z,ke,L,void 0):z)},w.integerValue=function(T){var k=new re(this);return T==null?T=L:A(T,0,8),je(k,k.e+1,T)},w.isEqualTo=w.eq=function(T,k){return O(this,new re(T,k))===0},w.isFinite=function(){return!!this.c},w.isGreaterThan=w.gt=function(T,k){return 0<O(this,new re(T,k))},w.isGreaterThanOrEqualTo=w.gte=function(T,k){return(k=O(this,new re(T,k)))===1||k===0},w.isInteger=function(){return!!this.c&&R(this.e/d)>this.c.length-2},w.isLessThan=w.lt=function(T,k){return O(this,new re(T,k))<0},w.isLessThanOrEqualTo=w.lte=function(T,k){return(k=O(this,new re(T,k)))===-1||k===0},w.isNaN=function(){return!this.s},w.isNegative=function(){return this.s<0},w.isPositive=function(){return 0<this.s},w.isZero=function(){return!!this.c&&this.c[0]==0},w.minus=function(T,k){var $,W,F,K,V=this,U=V.s;if(k=(T=new re(T,k)).s,!U||!k)return new re(NaN);if(U!=k)return T.s=-k,V.plus(T);var X=V.e/d,z=T.e/d,Q=V.c,de=T.c;if(!X||!z){if(!Q||!de)return Q?(T.s=-k,T):new re(de?V:NaN);if(!Q[0]||!de[0])return de[0]?(T.s=-k,T):new re(Q[0]?V:L==3?-0:0)}if(X=R(X),z=R(z),Q=Q.slice(),U=X-z){for((F=(K=U<0)?(U=-U,Q):(z=X,de)).reverse(),k=U;k--;F.push(0));F.reverse()}else for(W=(K=(U=Q.length)<(k=de.length))?U:k,U=k=0;k<W;k++)if(Q[k]!=de[k]){K=Q[k]<de[k];break}if(K&&(F=Q,Q=de,de=F,T.s=-T.s),0<(k=(W=de.length)-($=Q.length)))for(;k--;Q[$++]=0);for(k=h-1;U<W;){if(Q[--W]<de[W]){for($=W;$&&!Q[--$];Q[$]=k);--Q[$],Q[W]+=h}Q[W]-=de[W]}for(;Q[0]==0;Q.splice(0,1),--z);return Q[0]?Ge(T,Q,z):(T.s=L==3?-1:1,T.c=[T.e=0],T)},w.modulo=w.mod=function(T,k){var $,W,F=this;return T=new re(T,k),!F.c||!T.s||T.c&&!T.c[0]?new re(NaN):!T.c||F.c&&!F.c[0]?new re(F):(ve==9?(W=T.s,T.s=1,$=ee(F,T,0,3),T.s=W,$.s*=W):$=ee(F,T,0,ve),(T=F.minus($.times(T))).c[0]||ve!=1||(T.s=F.s),T)},w.multipliedBy=w.times=function(T,k){var $,W,F,K,V,U,X,z,Q,de,Ee,Fe,ct,dt,Ft,Je=this,xe=Je.c,Ot=(T=new re(T,k)).c;if(!(xe&&Ot&&xe[0]&&Ot[0]))return!Je.s||!T.s||xe&&!xe[0]&&!Ot||Ot&&!Ot[0]&&!xe?T.c=T.e=T.s=null:(T.s*=Je.s,xe&&Ot?(T.c=[0],T.e=0):T.c=T.e=null),T;for(W=R(Je.e/d)+R(T.e/d),T.s*=Je.s,(X=xe.length)<(de=Ot.length)&&(ct=xe,xe=Ot,Ot=ct,F=X,X=de,de=F),F=X+de,ct=[];F--;ct.push(0));for(dt=h,Ft=y,F=de;0<=--F;){for($=0,Ee=Ot[F]%Ft,Fe=Ot[F]/Ft|0,K=F+(V=X);F<K;)$=((z=Ee*(z=xe[--V]%Ft)+(U=Fe*z+(Q=xe[V]/Ft|0)*Ee)%Ft*Ft+ct[K]+$)/dt|0)+(U/Ft|0)+Fe*Q,ct[K--]=z%dt;ct[K]=$}return $?++W:ct.splice(0,1),Ge(T,ct,W)},w.negated=function(){var T=new re(this);return T.s=-T.s||null,T},w.plus=function(T,k){var $,W=this,F=W.s;if(k=(T=new re(T,k)).s,!F||!k)return new re(NaN);if(F!=k)return T.s=-k,W.minus(T);var K=W.e/d,V=T.e/d,U=W.c,X=T.c;if(!K||!V){if(!U||!X)return new re(F/0);if(!U[0]||!X[0])return X[0]?T:new re(U[0]?W:0*F)}if(K=R(K),V=R(V),U=U.slice(),F=K-V){for(($=0<F?(V=K,X):(F=-F,U)).reverse();F--;$.push(0));$.reverse()}for((F=U.length)-(k=X.length)<0&&($=X,X=U,U=$,k=F),F=0;k;)F=(U[--k]=U[k]+X[k]+F)/h|0,U[k]=h===U[k]?0:U[k]%h;return F&&(U=[F].concat(U),++V),Ge(T,U,V)},w.precision=w.sd=function(T,k){var $,W,F;if(T!=null&&T!==!!T)return A(T,1,S),k==null?k=L:A(k,0,8),je(new re(this),T,k);if(!($=this.c))return null;if(W=(F=$.length-1)*d+1,F=$[F]){for(;F%10==0;F/=10,W--);for(F=$[0];10<=F;F/=10,W++);}return T&&this.e+1>W&&(W=this.e+1),W},w.shiftedBy=function(T){return A(T,-p,p),this.times("1e"+T)},w.squareRoot=w.sqrt=function(){var T,k,$,W,F,K=this,V=K.c,U=K.s,X=K.e,z=M+4,Q=new re("0.5");if(U!==1||!V||!V[0])return new re(!U||U<0&&(!V||V[0])?NaN:V?K:1/0);if(($=(U=Math.sqrt(+ze(K)))==0||U==1/0?(((k=E(V)).length+X)%2==0&&(k+="0"),U=Math.sqrt(+k),X=R((X+1)/2)-(X<0||X%2),new re(k=U==1/0?"1e"+X:(k=U.toExponential()).slice(0,k.indexOf("e")+1)+X)):new re(U+"")).c[0]){for((U=(X=$.e)+z)<3&&(U=0);;)if(F=$,$=Q.times(F.plus(ee(K,F,z,1))),E(F.c).slice(0,U)===(k=E($.c)).slice(0,U)){if($.e<X&&--U,(k=k.slice(U-3,U+1))!="9999"&&(W||k!="4999")){+k&&(+k.slice(1)||k.charAt(0)!="5")||(je($,$.e+M+2,1),T=!$.times($).eq(K));break}if(!W&&(je(F,F.e+M+2,0),F.times(F).eq(K))){$=F;break}z+=4,U+=4,W=1}}return je($,$.e+M+1,L,T)},w.toExponential=function(T,k){return T!=null&&(A(T,0,S),T++),Ve(this,T,k,1)},w.toFixed=function(T,k){return T!=null&&(A(T,0,S),T=T+this.e+1),Ve(this,T,k)},w.toFormat=function(T,k,$){var W;if($==null)T!=null&&k&&typeof k=="object"?($=k,k=null):T&&typeof T=="object"?($=T,T=k=null):$=pe;else if(typeof $!="object")throw Error(c+"Argument not an object: "+$);if(W=this.toFixed(T,k),this.c){var F,K=W.split("."),V=+$.groupSize,U=+$.secondaryGroupSize,X=$.groupSeparator||"",z=K[0],Q=K[1],de=this.s<0,Ee=de?z.slice(1):z,Fe=Ee.length;if(U&&(F=V,V=U,Fe-=U=F),0<V&&0<Fe){for(F=Fe%V||V,z=Ee.substr(0,F);F<Fe;F+=V)z+=X+Ee.substr(F,V);0<U&&(z+=X+Ee.slice(F)),de&&(z="-"+z)}W=Q?z+($.decimalSeparator||"")+((U=+$.fractionGroupSize)?Q.replace(new RegExp("\\d{"+U+"}\\B","g"),"$&"+($.fractionGroupSeparator||"")):Q):z}return($.prefix||"")+W+($.suffix||"")},w.toFraction=function(T){var k,$,W,F,K,V,U,X,z,Q,de,Ee,Fe=this,ct=Fe.c;if(T!=null&&(!(U=new re(T)).isInteger()&&(U.c||U.s!==1)||U.lt(_)))throw Error(c+"Argument "+(U.isInteger()?"out of range: ":"not an integer: ")+ze(U));if(!ct)return new re(Fe);for(k=new re(_),z=$=new re(_),W=X=new re(_),Ee=E(ct),K=k.e=Ee.length-Fe.e-1,k.c[0]=m[(V=K%d)<0?d+V:V],T=!T||0<U.comparedTo(k)?0<K?k:z:U,V=ie,ie=1/0,U=new re(Ee),X.c[0]=0;Q=ee(U,k,0,1),(F=$.plus(Q.times(W))).comparedTo(T)!=1;)$=W,W=F,z=X.plus(Q.times(F=z)),X=F,k=U.minus(Q.times(F=k)),U=F;return F=ee(T.minus($),W,0,1),X=X.plus(F.times(z)),$=$.plus(F.times(W)),X.s=z.s=Fe.s,de=ee(z,W,K*=2,L).minus(Fe).abs().comparedTo(ee(X,$,K,L).minus(Fe).abs())<1?[z,W]:[X,$],ie=V,de},w.toNumber=function(){return+ze(this)},w.toPrecision=function(T,k){return T!=null&&A(T,1,S),Ve(this,T,k,2)},w.toString=function(T){var k,$=this,W=$.s,F=$.e;return F===null?W?(k="Infinity",W<0&&(k="-"+k)):k="NaN":(k=T==null?F<=H||Z<=F?j(E($.c),F):J(E($.c),F,"0"):T===10?J(E(($=je(new re($),M+F+1,L)).c),$.e,"0"):(A(T,2,Ce.length,"Base"),ae(J(E($.c),F,"0"),10,T,W,!0)),W<0&&$.c[0]&&(k="-"+k)),k},w.valueOf=w.toJSON=function(){return ze(this)},w._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(w[Symbol.toStringTag]="BigNumber",w[Symbol.for("nodejs.util.inspect.custom")]=w.valueOf),q!=null&&re.set(q),re}()).default=a.BigNumber=a,n!==void 0&&n.exports?n.exports=a:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=a)})(this)},{}],2:[function(r,n,i){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var a=o%10;return~~(o%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,i){function o(R,E){return function(O){if(Array.isArray(O))return O}(R)||function(O,A){var B=[],j=!0,J=!1,Y=void 0;try{for(var q,ee=O[Symbol.iterator]();!(j=(q=ee.next()).done)&&(B.push(q.value),!A||B.length!==A);j=!0);}catch(ae){J=!0,Y=ae}finally{try{j||ee.return==null||ee.return()}finally{if(J)throw Y}}return B}(R,E)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=r("./globalState"),s=r("./validating"),l=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},f={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(R){var E=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},O=2<arguments.length?arguments[2]:void 0;if(typeof E=="string"&&(E=l.parseFormat(E)),!s.validateFormat(E))return"ERROR: invalid format";var A=E.prefix||"",B=E.postfix||"",j=function(J,Y,q){switch(Y.output){case"currency":return Y=S(Y,a.currentCurrencyDefaultFormat()),function(Ce,re,Ve){var Ze=Ve.currentCurrency(),Ge=Object.assign({},f,re),je=void 0,ze="",T=!!Ge.totalLength||!!Ge.forceAverage||Ge.average,k=re.currencyPosition||Ze.position,$=re.currencySymbol||Ze.symbol;Ge.spaceSeparated&&(ze=" "),k==="infix"&&(je=ze+$+ze);var W=y({instance:Ce,providedFormat:re,state:Ve,decimalSeparator:je});return k==="prefix"&&(W=Ce._value<0&&Ge.negative==="sign"?"-".concat(ze).concat($).concat(W.slice(1)):$+ze+W),k&&k!=="postfix"||(W=W+(ze=T?"":ze)+$),W}(J,Y,a);case"percent":return Y=S(Y,a.currentPercentageDefaultFormat()),function(Ce,re,Ve,Ze){var Ge=re.prefixSymbol,je=y({instance:Ze(100*Ce._value),providedFormat:re,state:Ve}),ze=Object.assign({},f,re);return Ge?"%".concat(ze.spaceSeparated?" ":"").concat(je):"".concat(je).concat(ze.spaceSeparated?" ":"","%")}(J,Y,a,q);case"byte":return Y=S(Y,a.currentByteDefaultFormat()),_=J,L=a,H=q,Z=(M=Y).base||"binary",te=c[Z],ie=d(_._value,te.suffixes,te.scale),oe=ie.value,ve=ie.suffix,ke=y({instance:H(oe),providedFormat:M,state:L,defaults:L.currentByteDefaultFormat()}),pe=L.currentAbbreviations(),"".concat(ke).concat(pe.spaced?" ":"").concat(ve);case"time":return Y=S(Y,a.currentTimeDefaultFormat()),I=J,v=Math.floor(I._value/60/60),b=Math.floor((I._value-60*v*60)/60),w=Math.round(I._value-60*v*60-60*b),"".concat(v,":").concat(b<10?"0":"").concat(b,":").concat(w<10?"0":"").concat(w);case"ordinal":return Y=S(Y,a.currentOrdinalDefaultFormat()),ee=J,ae=Y,ue=(ne=a).currentOrdinal(),me=Object.assign({},f,ae),Re=y({instance:ee,providedFormat:ae,state:ne}),ge=ue(ee._value),"".concat(Re).concat(me.spaceSeparated?" ":"").concat(ge);case"number":default:return y({instance:J,providedFormat:Y,numbro:q})}var ee,ae,ne,ue,me,Re,ge,I,v,b,w,_,M,L,H,Z,te,ie,oe,ve,ke,pe}(R,E,O);return j=(j=A+j)+B}function d(R,E,O){var A=E[0],B=Math.abs(R);if(O<=B){for(var j=1;j<E.length;++j){var J=Math.pow(O,j),Y=Math.pow(O,j+1);if(J<=B&&B<Y){A=E[j],R/=J;break}}A===E[0]&&(R/=Math.pow(O,E.length-1),A=E[E.length-1])}return{value:R,suffix:A}}function p(R){for(var E="",O=0;O<R;O++)E+="0";return E}function m(R,E){return R.toString().indexOf("e")!==-1?function(O,A){var B=O.toString(),j=o(B.split("e"),2),J=j[0],Y=j[1],q=o(J.split("."),2),ee=q[0],ae=q[1],ne=ae===void 0?"":ae;if(0<+Y)B=ee+ne+p(Y-ne.length);else{var ue=".";ue=+ee<0?"-0".concat(ue):"0".concat(ue);var me=(p(-Y-1)+Math.abs(ee)+ne).substr(0,A);me.length<A&&(me+=p(A-me.length)),B=ue+me}return 0<+Y&&0<A&&(B+=".".concat(p(A))),B}(R,E):(Math.round(+"".concat(R,"e+").concat(E))/Math.pow(10,E)).toFixed(E)}function y(R){var E=R.instance,O=R.providedFormat,A=R.state,B=A===void 0?a:A,j=R.decimalSeparator,J=R.defaults,Y=J===void 0?B.currentDefaults():J,q=E._value;if(q===0&&B.hasZeroFormat())return B.getZeroFormat();if(!isFinite(q))return q.toString();var ee,ae,ne,ue,me,Re,ge,I,v=Object.assign({},f,Y,O),b=v.totalLength,w=b?0:v.characteristic,_=v.optionalCharacteristic,M=v.forceAverage,L=!!b||!!M||v.average,H=b?-1:L&&O.mantissa===void 0?0:v.mantissa,Z=!b&&(O.optionalMantissa===void 0?H===-1:v.optionalMantissa),te=v.trimMantissa,ie=v.thousandSeparated,oe=v.spaceSeparated,ve=v.negative,ke=v.forceSign,pe=v.exponential,Ce="";if(L){var re=function(T){var k=T.value,$=T.forceAverage,W=T.abbreviations,F=T.spaceSeparated,K=F!==void 0&&F,V=T.totalLength,U=V===void 0?0:V,X="",z=Math.abs(k),Q=-1;if(z>=Math.pow(10,12)&&!$||$==="trillion"?(X=W.trillion,k/=Math.pow(10,12)):z<Math.pow(10,12)&&z>=Math.pow(10,9)&&!$||$==="billion"?(X=W.billion,k/=Math.pow(10,9)):z<Math.pow(10,9)&&z>=Math.pow(10,6)&&!$||$==="million"?(X=W.million,k/=Math.pow(10,6)):(z<Math.pow(10,6)&&z>=Math.pow(10,3)&&!$||$==="thousand")&&(X=W.thousand,k/=Math.pow(10,3)),X&&(X=(K?" ":"")+X),U){var de=k.toString().split(".")[0];Q=Math.max(U-de.length,0)}return{value:k,abbreviation:X,mantissaPrecision:Q}}({value:q,forceAverage:M,abbreviations:B.currentAbbreviations(),spaceSeparated:oe,totalLength:b});q=re.value,Ce+=re.abbreviation,b&&(H=re.mantissaPrecision)}if(pe){var Ve=(ae=(ee={value:q,characteristicPrecision:w}).value,ne=ee.characteristicPrecision,ue=ne===void 0?0:ne,me=o(ae.toExponential().split("e"),2),Re=me[0],ge=me[1],I=+Re,ue&&1<ue&&(I*=Math.pow(10,ue-1),ge=0<=(ge=+ge-(ue-1))?"+".concat(ge):ge),{value:I,abbreviation:"e".concat(ge)});q=Ve.value,Ce=Ve.abbreviation+Ce}var Ze,Ge,je,ze=function(T,k,$,W,F){if(W===-1)return T;var K=m(k,W),V=o(K.toString().split("."),2),U=V[0],X=V[1],z=X===void 0?"":X;if(z.match(/^0+$/)&&($||F))return U;var Q=z.match(/0+$/);return F&&Q?"".concat(U,".").concat(z.toString().slice(0,Q.index)):K.toString()}(q.toString(),q,Z,H,te);return ze=function(T,k,$,W,F){var K=W.currentDelimiters(),V=K.thousands;F=F||K.decimal;var U=K.thousandsSize||3,X=T.toString(),z=X.split(".")[0],Q=X.split(".")[1];return $&&(k<0&&(z=z.slice(1)),function(de,Ee){for(var Fe=[],ct=0,dt=de;0<dt;dt--)ct===Ee&&(Fe.unshift(dt),ct=0),ct++;return Fe}(z.length,U).forEach(function(de,Ee){z=z.slice(0,de+Ee)+V+z.slice(de+Ee)}),k<0&&(z="-".concat(z))),X=Q?z+F+Q:z}(ze=function(T,k,$,W){var F=T,K=o(F.toString().split("."),2),V=K[0],U=K[1];if(V.match(/^-?0$/)&&$)return U?"".concat(V.replace("0",""),".").concat(U):V.replace("0","");if(V.length<W)for(var X=W-V.length,z=0;z<X;z++)F="0".concat(F);return F.toString()}(ze,0,_,w),q,ie,B,j),(L||pe)&&(ze=ze+Ce),(ke||q<0)&&(Ze=ze,je=ve,ze=(Ge=q)===0?Ze:+Ze==0?Ze.replace("-",""):0<Ge?"+".concat(Ze):je==="sign"?Ze:"(".concat(Ze.replace("-",""),")")),ze}function S(R,E){if(!R)return E;var O=Object.keys(R);return O.length===1&&O[0]==="output"?E:R}n.exports=function(R){return{format:function(){for(var E=arguments.length,O=new Array(E),A=0;A<E;A++)O[A]=arguments[A];return h.apply(void 0,O.concat([R]))},getByteUnit:function(){for(var E=arguments.length,O=new Array(E),A=0;A<E;A++)O[A]=arguments[A];return(function(B){var j=c.general;return d(B._value,j.suffixes,j.scale).suffix}).apply(void 0,O.concat([R]))},getBinaryByteUnit:function(){for(var E=arguments.length,O=new Array(E),A=0;A<E;A++)O[A]=arguments[A];return(function(B){var j=c.binary;return d(B._value,j.suffixes,j.scale).suffix}).apply(void 0,O.concat([R]))},getDecimalByteUnit:function(){for(var E=arguments.length,O=new Array(E),A=0;A<E;A++)O[A]=arguments[A];return(function(B){var j=c.decimal;return d(B._value,j.suffixes,j.scale).suffix}).apply(void 0,O.concat([R]))},formatOrDefault:S}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,i){var o=r("./en-US"),a=r("./validating"),s=r("./parsing"),l={},u=void 0,c={},f=null,h={};function d(m){u=m}function p(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return p().currency},l.currentAbbreviations=function(){return p().abbreviations},l.currentDelimiters=function(){return p().delimiters},l.currentOrdinal=function(){return p().ordinal},l.currentDefaults=function(){return Object.assign({},p().defaults,h)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().timeFormat)},l.setDefaults=function(m){m=s.parseFormat(m),a.validateFormat(m)&&(h=m)},l.getZeroFormat=function(){return f},l.setZeroFormat=function(m){return f=typeof m=="string"?m:null},l.hasZeroFormat=function(){return f!==null},l.languageData=function(m){if(m){if(c[m])return c[m];throw new Error('Unknown tag "'.concat(m,'"'))}return p()},l.registerLanguage=function(m){var y=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(m))throw new Error("Invalid language data");c[m.languageTag]=m,y&&d(m.languageTag)},l.setLanguage=function(m){var y=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!c[m]){var S=m.split("-")[0],R=Object.keys(c).find(function(E){return E.split("-")[0]===S});return c[R]?void d(R):void d(y)}d(m)},l.registerLanguage(o),u=o.languageTag,n.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,i){n.exports=function(o){return{loadLanguagesInNode:function(a){return s=o,void a.forEach(function(l){var u=void 0;try{u=r("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&s.registerLanguage(u)});var s}}}},{}],6:[function(r,n,i){var o=r("bignumber.js");function a(s,l,u){var c=new o(s._value),f=l;return u.isNumbro(l)&&(f=l._value),f=new o(f),s._value=c.minus(f).toNumber(),s}n.exports=function(s){return{add:function(l,u){return f=u,h=s,d=new o((c=l)._value),p=f,h.isNumbro(f)&&(p=f._value),p=new o(p),c._value=d.plus(p).toNumber(),c;var c,f,h,d,p},subtract:function(l,u){return a(l,u,s)},multiply:function(l,u){return f=u,h=s,d=new o((c=l)._value),p=f,h.isNumbro(f)&&(p=f._value),p=new o(p),c._value=d.times(p).toNumber(),c;var c,f,h,d,p},divide:function(l,u){return f=u,h=s,d=new o((c=l)._value),p=f,h.isNumbro(f)&&(p=f._value),p=new o(p),c._value=d.dividedBy(p).toNumber(),c;var c,f,h,d,p},set:function(l,u){return c=l,h=f=u,s.isNumbro(f)&&(h=f._value),c._value=h,c;var c,f,h},difference:function(l,u){return c=u,a(h=(f=s)(l._value),c,f),Math.abs(h._value);var c,f,h}}}},{"bignumber.js":1}],7:[function(r,n,i){function o(y,S){for(var R=0;R<S.length;R++){var E=S[R];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(y,E.key,E)}}var a=r("./globalState"),s=r("./validating"),l=r("./loading")(m),u=r("./unformatting"),c=r("./formatting")(m),f=r("./manipulating")(m),h=r("./parsing"),d=function(){function y(E){(function(O,A){if(!(O instanceof A))throw new TypeError("Cannot call a class as a function")})(this,y),this._value=E}var S,R;return S=y,(R=[{key:"clone",value:function(){return m(this._value)}},{key:"format",value:function(){var E=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,E)}},{key:"formatCurrency",value:function(E){return typeof E=="string"&&(E=h.parseFormat(E)),(E=c.formatOrDefault(E,a.currentCurrencyDefaultFormat())).output="currency",c.format(this,E)}},{key:"formatTime",value:function(){var E=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return E.output="time",c.format(this,E)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(E){return f.difference(this,E)}},{key:"add",value:function(E){return f.add(this,E)}},{key:"subtract",value:function(E){return f.subtract(this,E)}},{key:"multiply",value:function(E){return f.multiply(this,E)}},{key:"divide",value:function(E){return f.divide(this,E)}},{key:"set",value:function(E){return f.set(this,p(E))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(S.prototype,R),y}();function p(y){var S=y;return m.isNumbro(y)?S=y._value:typeof y=="string"?S=m.unformat(y):isNaN(y)&&(S=NaN),S}function m(y){return new d(p(y))}m.version="2.1.2",m.isNumbro=function(y){return y instanceof d},m.language=a.currentLanguage,m.registerLanguage=a.registerLanguage,m.setLanguage=a.setLanguage,m.languages=a.languages,m.languageData=a.languageData,m.zeroFormat=a.setZeroFormat,m.defaultFormat=a.currentDefaults,m.setDefaults=a.setDefaults,m.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,m.validate=s.validate,m.loadLanguagesInNode=l.loadLanguagesInNode,m.unformat=u.unformat,n.exports=m},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,i){n.exports={parseFormat:function(o){var a,s,l,u,c,f,h,d,p,m,y,S,R,E,O,A,B,j,J,Y,q=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(s=q,o=(l=(a=o).match(/^{([^}]*)}/))?(s.prefix=l[1],a.slice(l[0].length)):a,c=q,function(ee,ae){if(ee.indexOf("$")===-1){if(ee.indexOf("%")===-1)return ee.indexOf("bd")!==-1?(ae.output="byte",ae.base="general"):ee.indexOf("b")!==-1?(ae.output="byte",ae.base="binary"):ee.indexOf("d")!==-1?(ae.output="byte",ae.base="decimal"):ee.indexOf(":")===-1?ee.indexOf("o")!==-1&&(ae.output="ordinal"):ae.output="time";ae.output="percent"}else ae.output="currency"}(o=(f=(u=o).match(/{([^}]*)}$/))?(c.postfix=f[1],u.slice(0,-f[0].length)):u,q),h=q,(d=o.match(/[1-9]+[0-9]*/))&&(h.totalLength=+d[0]),p=q,(m=o.split(".")[0].match(/0+/))&&(p.characteristic=m[0].length),function(ee,ae){if(ee.indexOf(".")!==-1){var ne=ee.split(".")[0];ae.optionalCharacteristic=ne.indexOf("0")===-1}}(o,q),y=q,o.indexOf("a")!==-1&&(y.average=!0),R=q,(S=o).indexOf("K")!==-1?R.forceAverage="thousand":S.indexOf("M")!==-1?R.forceAverage="million":S.indexOf("B")!==-1?R.forceAverage="billion":S.indexOf("T")!==-1&&(R.forceAverage="trillion"),function(ee,ae){var ne=ee.split(".")[1];if(ne){var ue=ne.match(/0+/);ue&&(ae.mantissa=ue[0].length)}}(o,q),O=q,(E=o).match(/\[\.]/)?O.optionalMantissa=!0:E.match(/\./)&&(O.optionalMantissa=!1),A=q,o.indexOf(",")!==-1&&(A.thousandSeparated=!0),B=q,o.indexOf(" ")!==-1&&(B.spaceSeparated=!0),J=q,(j=o).match(/^\+?\([^)]*\)$/)&&(J.negative="parenthesis"),j.match(/^\+?-/)&&(J.negative="sign"),Y=q,o.match(/^\+/)&&(Y.forceSign=!0),q)}}},{}],9:[function(r,n,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function s(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",f=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,p=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===h?0:function m(y,S){var R=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",E=3<arguments.length?arguments[3]:void 0,O=4<arguments.length?arguments[4]:void 0,A=5<arguments.length?arguments[5]:void 0,B=6<arguments.length?arguments[6]:void 0;if(!isNaN(+y))return+y;var j="",J=y.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(J!==y)return-1*m(J,S,R,E,O,A,B);for(var Y=0;Y<o.length;Y++){var q=o[Y];if((j=y.replace(q.key,""))!==y)return m(j,S,R,E,O,A,B)*q.factor}if((j=y.replace("%",""))!==y)return m(j,S,R,E,O,A,B)/100;var ee=parseFloat(y);if(!isNaN(ee)){var ae=E(ee);if(ae&&ae!=="."&&(j=y.replace(new RegExp("".concat(a(ae),"$")),""))!==y)return m(j,S,R,E,O,A,B);var ne={};Object.keys(A).forEach(function(b){ne[A[b]]=b});for(var ue=Object.keys(ne).sort().reverse(),me=ue.length,Re=0;Re<me;Re++){var ge=ue[Re],I=ne[ge];if((j=y.replace(ge,""))!==y){var v=void 0;switch(I){case"thousand":v=Math.pow(10,3);break;case"million":v=Math.pow(10,6);break;case"billion":v=Math.pow(10,9);break;case"trillion":v=Math.pow(10,12)}return m(j,S,R,E,O,A,B)*v}}}}(function(m,y){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",R=m.replace(S,"");return R=(R=R.replace(new RegExp("([0-9])".concat(a(y.thousands),"([0-9])"),"g"),"$1$2")).replace(y.decimal,".")}(l,u,c),u,c,f,h,d,p)}n.exports={unformat:function(l,u){var c,f,h,d=r("./globalState"),p=d.currentDelimiters(),m=d.currentCurrency().symbol,y=d.currentOrdinal(),S=d.getZeroFormat(),R=d.currentAbbreviations(),E=void 0;if(typeof l=="string")E=function(O,A){if(!O.indexOf(":")||A.thousands===":")return!1;var B=O.split(":");if(B.length!==3)return!1;var j=+B[0],J=+B[1],Y=+B[2];return!isNaN(j)&&!isNaN(J)&&!isNaN(Y)}(l,p)?(c=l.split(":"),f=+c[0],h=+c[1],+c[2]+60*h+3600*f):s(l,p,m,y,S,R,u);else{if(typeof l!="number")return;E=l}if(E!==void 0)return E}}},{"./globalState":4}],10:[function(r,n,i){function o(p){return function(m){if(Array.isArray(m)){for(var y=0,S=new Array(m.length);y<m.length;y++)S[y]=m[y];return S}}(p)||function(m){if(Symbol.iterator in Object(m)||Object.prototype.toString.call(m)==="[object Arguments]")return Array.from(m)}(p)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(p){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(p)}var s=r("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(p,m){return m.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(p){return p.output==="byte"}},characteristic:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(p){return 0<=p},message:"value must be positive"},{restriction:function(p,m){return!m.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(p,m){return m.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(p){return p.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function f(p){return!!s.unformat(p)}function h(p,m,y){var S=3<arguments.length&&arguments[3]!==void 0&&arguments[3],R=Object.keys(p).map(function(E){if(!m[E])return console.error("".concat(y," Invalid key: ").concat(E)),!1;var O=p[E],A=m[E];if(typeof A=="string"&&(A={type:A}),A.type==="format"){if(!h(O,u,"[Validate ".concat(E,"]"),!0))return!1}else if(a(O)!==A.type)return console.error("".concat(y," ").concat(E,' type mismatched: "').concat(A.type,'" expected, "').concat(a(O),'" provided')),!1;if(A.restrictions&&A.restrictions.length)for(var B=A.restrictions.length,j=0;j<B;j++){var J=A.restrictions[j],Y=J.restriction,q=J.message;if(!Y(O,p))return console.error("".concat(y," ").concat(E," invalid value: ").concat(q)),!1}return A.restriction&&!A.restriction(O,p)?(console.error("".concat(y," ").concat(E," invalid value: ").concat(A.message)),!1):A.validValues&&A.validValues.indexOf(O)===-1?(console.error("".concat(y," ").concat(E," invalid value: must be among ").concat(JSON.stringify(A.validValues),', "').concat(O,'" provided')),!1):!(A.children&&!h(O,A.children,"[Validate ".concat(E,"]")))});return S||R.push.apply(R,o(Object.keys(m).map(function(E){var O=m[E];if(typeof O=="string"&&(O={type:O}),O.mandatory){var A=O.mandatory;if(typeof A=="function"&&(A=A(p)),A&&p[E]===void 0)return console.error("".concat(y,' Missing mandatory key "').concat(E,'"')),!1}return!0}))),R.reduce(function(E,O){return E&&O},!0)}function d(p){return h(p,u,"[Validate format]")}n.exports={validate:function(p,m){var y=f(p),S=d(m);return y&&S},validateFormat:d,validateInput:f,validateLanguage:function(p){return h(p,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(pG);var pMe=pG.exports;const pl=IT(pMe);var mMe="numeric";function LI(t,e,r,n,i,o,a){var s=o;if(Ln(s)){var l=a.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,f=a.className||"",h=f.length?f.split(" "):[];if(typeof u<"u"&&!pl.languages()[u]){var d=u.replace("-",""),p=pl.allLanguages?pl.allLanguages[u]:pl[d];p&&pl.registerLanguage(p)}pl.setLanguage(u),s=pl(s).format(c||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),e.dir="ltr"}Qs(t,e,r,n,i,s,a)}LI.RENDERER_TYPE=mMe;var vMe="password";function DI(t,e,r,n,i,o,a){Qs.apply(this,[t,e,r,n,i,o,a]);var s=a.hashLength||e.innerHTML.length,l=a.hashSymbol||"*",u="";De(s-1,function(){u+=l}),Ed(e,u)}DI.RENDERER_TYPE=vMe;var gMe="time";function FI(t,e,r,n,i,o,a){Qs.apply(this,[t,e,r,n,i,o,a]),e.dir="ltr"}FI.RENDERER_TYPE=gMe;function yMe(){na(Nd),na(zg),na(xI),na(kI),na(LI),na(DI),na(Qs),na(FI)}var bMe="autocomplete";function Hw(t,e){var r=t;if(r==null&&(r=""),this.allowEmpty&&r===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,q9(r,e)):q9(r,e)(this.source):e(!0)}Hw.VALIDATOR_TYPE=bMe;function q9(t,e){var r=t;return function(n){for(var i=!1,o=0,a=n.length;o<a;o++)if(r===n[o]){i=!0;break}e(i)}}var wMe=Object.is||function(e,r){return e===r?e!==0||1/e===1/r:e!=e&&r!=r},SMe=Lr,RMe=H2,EMe=Rr,CMe=ro,OMe=Yn,Q9=wMe,Z9=Dr,TMe=Nu,_Me=U2;RMe("search",function(t,e,r){return[function(i){var o=OMe(this),a=CMe(i)?void 0:TMe(i,t);return a?SMe(a,i,o):new RegExp(i)[t](Z9(o))},function(n){var i=EMe(this),o=Z9(n),a=r(e,i,o);if(a.done)return a.value;var s=i.lastIndex;Q9(s,0)||(i.lastIndex=0);var l=_Me(i,o);return Q9(i.lastIndex,s)||(i.lastIndex=s),l===null?-1:l.index}]});function AMe(t){var e=new Date(t);return isNaN(new Date("".concat(t,"T00:00")).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}var IMe="date";function HI(t,e){var r=rU(lG,this.instance),n=t,i=!0;n==null&&(n="");var o=se(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=se(new Date(n)).isValid()||o;if(this.allowEmpty&&n===""&&(a=!0,o=!0),a||(i=!1),!a&&o&&(i=!0),a&&!o)if(this.correctFormat===!0){var s=NMe(n,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,s,"dateValidator"),i=!0}else i=!1;e(i)}HI.VALIDATOR_TYPE=IMe;function NMe(t,e){var r=se(AMe(t)),n=se(t,e),i=t.search(/[A-z]/g)>-1,o;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||i?o=r:o=n,o.format(e)}var PMe="numeric";function UI(t,e){var r=t;r==null&&(r=""),this.allowEmpty&&r===""?e(!0):e(r===""?!1:Ln(t))}UI.VALIDATOR_TYPE=PMe;var MMe=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],kMe="time";function BI(t,e){var r=this.timeFormat||"h:mm:ss a",n=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;var o=/^\d{1,2}$/.test(i);o&&(i+=":00");var a=se(i,MMe,!0).isValid()?se(i):se(i,r),s=a.isValid(),l=se(i,r,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(s=!0,l=!0),s||(n=!1),!s&&l&&(n=!0),s&&!l)if(this.correctFormat===!0){var u=a.format(r),c=this.instance.toVisualRow(this.row),f=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,f,u,"timeValidator"),n=!0}else n=!1;e(n)}BI.VALIDATOR_TYPE=kMe;function xMe(){mp(Hw),mp(HI),mp(UI),mp(BI)}var $Me="autocomplete",LMe={CELL_TYPE:$Me,editor:PI,renderer:Nd,validator:Hw},DMe="checkbox",FMe={CELL_TYPE:DMe,editor:aG,renderer:xI},HMe="date",UMe={CELL_TYPE:HMe,editor:uG,renderer:Nd,validator:HI},BMe="dropdown",VMe={CELL_TYPE:BMe,editor:MI,renderer:Nd,validator:Hw},jMe="handsontable",WMe={CELL_TYPE:jMe,editor:NI,renderer:Nd},GMe="numeric",zMe={CELL_TYPE:GMe,editor:cG,renderer:LI,validator:UI,dataType:"number"},YMe="password",KMe={CELL_TYPE:YMe,editor:fG,renderer:DI,copyable:!1},XMe="time",qMe={CELL_TYPE:XMe,editor:hG,renderer:FI,validator:BI};function QMe(){bo(LMe),bo(FMe),bo(UMe),bo(VMe),bo(WMe),bo(zMe),bo(KMe),bo(YB),bo(qMe)}var ZMe=L2,JMe=XH;ZMe("WeakSet",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},JMe);function Ev(t){"@babel/helpers - typeof";return Ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ev(t)}function e9e(t,e){return i9e(t)||n9e(t,e)||r9e(t,e)||t9e()}function t9e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r9e(t,e){if(t){if(typeof t=="string")return J9(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return J9(t,e)}}function J9(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function n9e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function i9e(t){if(Array.isArray(t))return t}function o9e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ek(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s9e(n.key),n)}}function a9e(t,e,r){return e&&ek(t.prototype,e),r&&ek(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function s9e(t){var e=l9e(t,"string");return Ev(e)==="symbol"?e:String(e)}function l9e(t,e){if(Ev(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Ev(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function u9e(t,e){c9e(t,e),e.add(t)}function c9e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f9e(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}var tk=new Map([["plugin",Qve],["cell-type",DB],["editor",tU],["renderer",mU],["validator",vU]]),h9e="base",ml=new WeakMap,K6=[],ho=null,rk=new WeakSet,xt=function(){function t(e){var r=this;o9e(this,t),u9e(this,rk),Ka(this,"hot",e,{writable:!1}),ml.set(this,{hooks:{}}),ho=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return a9e(t,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,i=Array.isArray(n)?n:[];if(i.length>0){var o=[];if(i.forEach(function(u){var c=u.split(":"),f=e9e(c,2),h=f[0],d=f[1];if(!tk.has(h))throw new Error('Unknown plugin dependency type "'.concat(h,'" was found.'));tk.get(h)(d)||o.push(" - ".concat(d," (").concat(h,")"))}),o.length>0){var a=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(o.join(`
`),`
`)].join("");K6.push(a)}}ho||(ho=pU()),ho.indexOf("UndoRedo")>=0&&ho.splice(ho.indexOf("UndoRedo"),1),ho.indexOf(this.pluginName)>=0&&ho.splice(ho.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var s=ho.length===0;if(s){if(K6.length>0){var l=["".concat(K6.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(l)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){ml.get(this).hooks[r]=ml.get(this).hooks[r]||[];var i=ml.get(this).hooks[r];this.hot.addHook(r,n),i.push(n),ml.get(this).hooks[r]=i}},{key:"removeHooks",value:function(r){var n=this;D(ml.get(this).hooks[r]||[],function(i){n.hot.removeHook(r,i)})}},{key:"clearHooks",value:function(){var r=this,n=ml.get(this).hooks;ut(n,function(i,o){return r.removeHooks(o)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){D(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=f9e(this,rk,d9e).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),ut(this,function(n,i){i!=="hot"&&(r[i]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return h9e}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),t}();function d9e(t){if(!t)return!1;var e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(var r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function Cv(t){"@babel/helpers - typeof";return Cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cv(t)}function p9e(t,e){return y9e(t)||g9e(t,e)||v9e(t,e)||m9e()}function m9e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v9e(t,e){if(t){if(typeof t=="string")return nk(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nk(t,e)}}function nk(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function g9e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function y9e(t){if(Array.isArray(t))return t}function b9e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w9e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,R9e(n.key),n)}}function S9e(t,e,r){return e&&w9e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function R9e(t){var e=E9e(t,"string");return Cv(e)==="symbol"?e:String(e)}function E9e(t,e){if(Cv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Cv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var C9e=function(){function t(e){b9e(this,t),this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return S9e(t,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={row:r};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={col:r};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),D(this.rows,function(n){r(n.row,ur(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),D(this.columns,function(n){var i=n.table.getBoundingClientRect(),o=i.width;r(n.col,Math.ceil(o))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(i){D(i.strings,function(o){n.appendChild(r.createColElement(o.col))})}),n}},{key:"createRow",value:function(r){var n=this,i=this.hot.rootDocument,o=i.createDocumentFragment(),a=i.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,a),o.appendChild(a)),this.samples.forEach(function(s){D(s.strings,function(l){var u=l.col,c=n.hot.getCellMeta(r,u);c.col=u,c.row=r;var f=n.hot.getCellRenderer(c),h=i.createElement("td");h.setAttribute("ghost-table",1),f(n.hot,h,r,u,n.hot.colToProp(u),l.value,c),o.appendChild(h)})}),o}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,i=n.createDocumentFragment(),o=[];if(this.hot.hasRowHeaders()){var a=n.createElement("th");o.push([-1,a]),i.appendChild(a)}this.samples.forEach(function(s){D(s.strings,function(l){var u=l.col,c=n.createElement("th");o.push([u,c]),i.appendChild(c)})}),this.table.tHead.appendChild(i),D(o,function(s){var l=p9e(s,2),u=l[0],c=l[1];r.hot.view.appendColHeader(u,c)})}},{key:"createCol",value:function(r){var n=this,i=this.hot.rootDocument,o=i.createDocumentFragment();return this.samples.forEach(function(a){D(a.strings,function(s){var l=s.row,u=n.hot.getCellMeta(l,r);u.col=r,u.row=l;var c=n.hot.getCellRenderer(u),f=i.createElement("td"),h=i.createElement("tr");f.setAttribute("ghost-table",1),c(n.hot,f,l,r,n.hot.colToProp(r),s.value,u),h.appendChild(f),o.appendChild(h)})}),o}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),o=n.createElement("table"),a=n.createElement("thead"),s=n.createElement("tbody"),l=n.createElement("colgroup"),u=n.createElement("tr"),c=n.createElement("th");return this.isVertical()&&o.appendChild(l),this.isHorizontal()&&(u.appendChild(c),a.appendChild(u),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(a),this.isVertical()&&s.appendChild(u),o.appendChild(s),le(o,r),i.appendChild(o),{fragment:i,table:o,tHead:a,tBody:s,colGroup:l,tr:u,th:c}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),o=n.createElement("div"),a="htGhostTable htAutoSize ".concat(r.trim());return le(o,a),i.appendChild(o),{fragment:i,container:o}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),t}();const mG=C9e;function Ov(t){"@babel/helpers - typeof";return Ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ov(t)}function O9e(t,e,r){return e=vG(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T9e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ik(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vG(n.key),n)}}function _9e(t,e,r){return e&&ik(t.prototype,e),r&&ik(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function vG(t){var e=A9e(t,"string");return Ov(e)==="symbol"?e:String(e)}function A9e(t,e){if(Ov(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ov(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var I9e=function(){function t(e){T9e(this,t),this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1}return _9e(t,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:t.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,i){var o=this,a=new Map,s=typeof i=="number"?{from:i,to:i}:i,l=s.from,u=s.to;return De(l,u,function(c){var f=o.generateSample(r,n,c);a.set(c,f)}),a}},{key:"generateSample",value:function(r,n,i){var o=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var a=new Map,s=r==="row"?"col":"row",l=[];return De(n.from,n.to,function(u){var c=r==="row"?o.dataFactory(i,u):o.dataFactory(u,i),f=c.value,h=c.bundleSeed,d=typeof h=="string"&&h.length>0,p;d?p=h:lt(f)?p="".concat(Object.keys(f).length):Array.isArray(f)?p="".concat(f.length):p="".concat(Ar(f).length),a.has(p)||a.set(p,{needed:o.getSampleCount(),strings:[]});var m=a.get(p);if(m.needed){var y=l.indexOf(f)>-1;(!y||o.allowDuplicates||d)&&(m.strings.push(O9e({value:f},s,u)),l.push(f),m.needed-=1)}}),a}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),t}();const gG=I9e;function oh(t){"@babel/helpers - typeof";return oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oh(t)}function ok(t,e){return k9e(t)||M9e(t,e)||P9e(t,e)||N9e()}function N9e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P9e(t,e){if(t){if(typeof t=="string")return ak(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ak(t,e)}}function ak(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function M9e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function k9e(t){if(Array.isArray(t))return t}function x9e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,L9e(n.key),n)}}function $9e(t,e,r){return e&&sk(t.prototype,e),r&&sk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function L9e(t){var e=D9e(t,"string");return oh(e)==="symbol"?e:String(e)}function D9e(t,e){if(oh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Ml(){return typeof Reflect<"u"&&Reflect.get?Ml=Reflect.get.bind():Ml=function(e,r,n){var i=F9e(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Ml.apply(this,arguments)}function F9e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=pa(t),t!==null););return t}function H9e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&K5(t,e)}function K5(t,e){return K5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},K5(t,e)}function U9e(t){var e=V9e();return function(){var n=pa(t),i;if(e){var o=pa(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return B9e(this,i)}}function B9e(t,e){if(e&&(oh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yG(t)}function yG(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function V9e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pa(t){return pa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pa(t)}Ne.getSingleton().register("modifyAutoColumnSizeSeed");var Zd="autoColumnSize",j9e=10,X6=new WeakMap,W9e="autoColumnSize",G9e=function(t){H9e(r,t);var e=U9e(r);function r(n){var i;return x9e(this,r),i=e.call(this,n),X6.set(yG(i),{cachedColumnHeaders:[]}),i.ghostTable=new mG(i.hot),i.samplesGenerator=new gG(function(o,a){var s=i.hot.getCellMeta(o,a),l="";s.spanned||(l=i.hot.getDataAtCell(o,a));var u="";return i.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=i.hot.runHooks("modifyAutoColumnSizeSeed",u,s,l)),{value:l,bundleSeed:u}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredColumns=0,i.columnWidthsMap=new qs,i.hot.columnIndexMapper.registerMap(W9e,i.columnWidthsMap),i.addHook("beforeColumnResize",function(o,a,s){return i.onBeforeColumnResize(o,a,s)}),i}return $9e(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[Zd]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[Zd];o&&o.useHeaders!==null&&o.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",o.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeChangeRender",function(a){return i.onBeforeChange(a)}),this.addHook("afterFormulasValuesUpdate",function(a){return i.onAfterFormulasValuesUpdate(a)}),this.addHook("beforeViewRender",function(a){return i.onBeforeViewRender(a)}),this.addHook("modifyColWidth",function(a,s){return i.getColumnWidth(s,a)}),this.addHook("afterInit",function(){return i.onAfterInit()}),Ml(pa(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var i=this.findColumnsWhereHeaderWasChanged();i.length&&(this.clearCache(i),this.calculateVisibleColumnsWidth()),Ml(pa(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=this;Ml(pa(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(o,a,s){return i.onBeforeColumnResize(o,a,s)})}},{key:"calculateVisibleColumnsWidth",value:function(){var i=this.hot.countRows();if(i){var o=this.hot.renderCall,a=this.getFirstVisibleColumn(),s=this.getLastVisibleColumn();a===-1||s===-1||this.calculateColumnsWidth({from:a,to:s},void 0,o)}}},{key:"calculateColumnsWidth",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof o=="number"?{from:o,to:o}:o,u=typeof a=="number"?{from:a,to:a}:a;De(l.from,l.to,function(c){var f=i.hot.toPhysicalColumn(c);if(f===null&&(f=c),s||i.columnWidthsMap.getValueAtIndex(f)===null&&!i.hot._getColWidthFromSettings(f)){var h=i.samplesGenerator.generateColumnSamples(c,u);D(h,function(d){var p=ok(d,2),m=p[0],y=p[1];return i.ghostTable.addColumn(m,y)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){i.ghostTable.getWidths(function(c,f){var h=i.hot.toPhysicalColumn(c);i.columnWidthsMap.setValueAtIndex(h,f)})},!0),this.measuredColumns=l.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=0,s=this.hot.countCols()-1,l=null;this.inProgress=!0;var u=function f(){if(!i.hot){H0(l),i.inProgress=!1;return}i.calculateColumnsWidth({from:a,to:Math.min(a+r.CALCULATION_STEP,s)},o),a=a+r.CALCULATION_STEP+1,a<s?l=R_(f):(H0(l),i.inProgress=!1,i.hot.view.adjustElementsSize())},c=this.getSyncCalculationLimit();this.firstCalculation&&c>=0&&(this.calculateColumnsWidth({from:0,to:c},o),this.firstCalculation=!1,a=c+1),a<s?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[Zd],o=i&&wr(i,"samplingRatio")?i.samplingRatio:void 0,a=i&&wr(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;o&&!isNaN(o)&&this.samplesGenerator.setSampleCount(parseInt(o,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[Zd],o=r.SYNC_CALCULATION_LIMIT,a=this.hot.countCols()-1;return lt(i)&&(o=i.syncLimit,HH(o)?o=sU(a,o):o>>=0),Math.min(o,a)}},{key:"getColumnWidth",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=o;return s===void 0&&(s=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(i)),a&&typeof s=="number"&&(s=Math.max(s,eA.DEFAULT_WIDTH))),s}},{key:"getFirstVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var o=i.wtTable.getFirstVisibleColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}if(i.wtViewport.columnsRenderCalculator){var a=i.wtTable.getFirstRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"getLastVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var o=i.wtTable.getLastVisibleColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}if(i.wtViewport.columnsRenderCalculator){var a=i.wtTable.getLastRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var i=this.hot.getColHeader(),o=X6.get(this),a=o.cachedColumnHeaders,s=gn(i,function(l,u,c){var f=a.length;return(f-1<c||a[c]!==u)&&l.push(c),f-1<c?a.push(u):a[c]=u,l},[]);return s}},{key:"clearCache",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];o.length?this.hot.batchExecution(function(){D(o,function(a){i.columnWidthsMap.setValueAtIndex(a,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!_i(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){i.hot&&i.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(i){var o=this,a=st(i,function(s){var l=ok(s,2),u=l[1];return o.hot.toPhysicalColumn(o.hot.propToCol(u))});this.clearCache(Array.from(new Set(a)))}},{key:"onBeforeColumnResize",value:function(i,o,a){var s=i;return a&&(this.calculateColumnsWidth(o,void 0,!0),s=this.getColumnWidth(o,void 0,!1)),s}},{key:"onAfterInit",value:function(){X6.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(i){var o=_i(i,function(s){var l;return Ae((l=s.address)===null||l===void 0?void 0:l.col)}),a=st(o,function(s){return s.address.col});this.clearCache(Array.from(new Set(a)))}},{key:"destroy",value:function(){this.ghostTable.clean(),Ml(pa(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Zd}},{key:"PLUGIN_PRIORITY",get:function(){return j9e}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(xt),kl={horizontal:"horizontal",vertical:"vertical"};function z9e(t,e,r,n){var i=r.length,o=r?r[0].length:0,a=[],s=e.row-t.row,l=e.col-t.col;if(["down","up"].indexOf(n)!==-1){for(var u=[],c=0;c<l;c++){var f=parseInt(r[0][c],10),h=parseInt(r[i-1][c],10),d=(n==="down"?h-f:f-h)/(i-1)||0;u.push(d)}a.push(u)}if(["right","left"].indexOf(n)!==-1)for(var p=0;p<s;p++){var m=parseInt(r[p][0],10),y=parseInt(r[p][o-1],10),S=(n==="right"?y-m:m-y)/(o-1)||0;a.push([S])}return a}function Y9e(t,e,r){var n,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",n=r(e[0],e[1]),i=r(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",n=r(e[0],t[3]+1),i=r(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",n=r(e[0],e[1]),i=r(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",n=r(t[2]+1,e[1]),i=r(e[2],e[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:n,endOfDragCoords:i}}function K9e(t){var e={};return t===!0?(e.directions=Object.keys(kl),e.autoInsertRow=!0):lt(t)?(Ae(t.autoInsertRow)?t.direction===kl.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Ae(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(kl)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function ah(t){"@babel/helpers - typeof";return ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ah(t)}function X9e(t){return Z9e(t)||Q9e(t)||bG(t)||q9e()}function q9e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Q9e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Z9e(t){if(Array.isArray(t))return X5(t)}function J9e(t,e){return rke(t)||tke(t,e)||bG(t,e)||eke()}function eke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bG(t,e){if(t){if(typeof t=="string")return X5(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return X5(t,e)}}function X5(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function tke(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function rke(t){if(Array.isArray(t))return t}function nke(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,oke(n.key),n)}}function ike(t,e,r){return e&&lk(t.prototype,e),r&&lk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function oke(t){var e=ake(t,"string");return ah(e)==="symbol"?e:String(e)}function ake(t,e){if(ah(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function xl(){return typeof Reflect<"u"&&Reflect.get?xl=Reflect.get.bind():xl=function(e,r,n){var i=ske(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},xl.apply(this,arguments)}function ske(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ma(t),t!==null););return t}function lke(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&q5(t,e)}function q5(t,e){return q5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},q5(t,e)}function uke(t){var e=fke();return function(){var n=ma(t),i;if(e){var o=ma(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return cke(this,i)}}function cke(t,e){if(e&&(ah(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wG(t)}function wG(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fke(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ma(t){return ma=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ma(t)}Ne.getSingleton().register("modifyAutofillRange");Ne.getSingleton().register("beforeAutofill");Ne.getSingleton().register("afterAutofill");var uk="autofill",hke=20,dke=["fillHandle"],pke="insert_row_below",mke=200,vke=function(t){lke(r,t);var e=uke(r);function r(n){var i;return nke(this,r),i=e.call(this,n),i.eventManager=new hr(wG(i)),i.addingStarted=!1,i.mouseDownOnCellCorner=!1,i.mouseDragOutside=!1,i.handleDraggedCells=0,i.directions=[],i.autoInsertRow=!1,i}return ike(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(o){return i.onAfterCellCornerMouseDown(o)}),this.addHook("afterOnCellCornerDblClick",function(o){return i.onCellCornerDblClick(o)}),this.addHook("beforeOnCellMouseOver",function(o,a){return i.onBeforeCellMouseOver(a)}),xl(ma(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),xl(ma(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),xl(ma(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var i=this,o=this.hot.getSelectedRangeLast(),a=o.getTopStartCorner(),s=a.row,l=a.col,u=o.getBottomEndCorner(),c=u.row,f=u.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:s,startCol:l,endRow:c,endCol:f}]),d=[],p=[],m=[];return D(h,function(y){for(var S=y.startRow;S<=y.endRow;S+=1)d.indexOf(S)===-1&&d.push(S);for(var R=y.startCol;R<=y.endCol;R+=1)p.indexOf(R)===-1&&p.push(R)}),D(d,function(y){var S=[];D(p,function(R){S.push(i.hot.getCopyableData(y,R))}),m.push(S)}),m}},{key:"fillIn",value:function(){var i=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var o=this.hot.selection.highlight.getFill().getVisualCorners(),a=J9e(o,4),s=a[0],l=a[1],u=a[2],c=a[3],f=this.hot.getSelectedRangeLast(),h=f.getTopStartCorner(),d=f.getBottomEndCorner();this.resetSelectionOfDraggedArea();var p=[h.row,h.col,d.row,d.col],m=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,s),Math.min(h.col,l),Math.max(d.row,u),Math.max(d.col,c)],p),y=Y9e(p,m,function(I,v){return i.hot._createCellCoords(I,v)}),S=y.directionOfDrag,R=y.startOfDragCoords,E=y.endOfDragCoords;if(R&&R.row>-1&&R.col>-1){var O=this.getSelectionData(),A=f.clone(),B=this.hot._createCellRange(R,R,E),j=this.hot.runHooks("beforeAutofill",O,A,B,S);if(j===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var J=z9e(R,E,O,S),Y=j,q=j;if(["up","left"].indexOf(S)>-1&&!(q.length===1&&q[0].length===0))if(Y=[],S==="up")for(var ee=E.row-R.row+1,ae=ee%q.length,ne=0;ne<ee;ne++)Y.push(q[(ne+(q.length-ae))%q.length]);else for(var ue=E.col-R.col+1,me=ue%q[0].length,Re=0;Re<q.length;Re++){Y.push([]);for(var ge=0;ge<ue;ge++)Y[Re].push(q[Re][(ge+(q[Re].length-me))%q[Re].length])}this.hot.populateFromArray(R.row,R.col,Y,E.row,E.col,"".concat(this.pluginName,".fill"),null,S,J),this.setSelection(m),this.hot.runHooks("afterAutofill",Y,A,B,S),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(i){return i.row<0&&(i.row=0),i.col<0&&(i.col=0),i}},{key:"getCoordsOfDragAndDropBorders",value:function(i){var o=this.hot.getSelectedRangeLast(),a=o.getBottomEndCorner(),s=i;if(this.directions.includes(kl.vertical)&&this.directions.includes(kl.horizontal)){var l=o.getTopStartCorner();(a.col<=i.col||l.col>=i.col)&&(s=this.hot._createCellCoords(a.row,i.col)),(a.row<i.row||l.row>i.row)&&(s=this.hot._createCellCoords(i.row,a.col))}else if(this.directions.includes(kl.vertical))s=this.hot._createCellCoords(i.row,a.col);else if(this.directions.includes(kl.horizontal))s=this.hot._createCellCoords(a.row,i.col);else return;return this.reduceSelectionAreaIfNeeded(s)}},{key:"showBorder",value:function(i){var o=this.getCoordsOfDragAndDropBorders(i);o&&this.redrawBorders(o)}},{key:"addRow",value:function(){var i=this;this.hot._registerTimeout(function(){i.hot.alter(pke,void 0,1,"".concat(i.pluginName,".fill")),i.addingStarted=!1},mke)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var i=this.hot.getSelectedLast(),o=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.countRows();i[2]<a-1&&o[2]===a-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(i){for(var o=this.hot.getData(),a=this.hot.countRows(),s,l=i[2]+1;l<a;l++){for(var u=i[1];u<=i[3];u++){var c=o[l][u];if(c)return-1}var f=o[l][i[1]-1],h=o[l][i[3]+1];(f||h)&&(s=l)}return s}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(i,o){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(i[0],i[1])).add(this.hot._createCellCoords(o,i[3])).commit()}},{key:"setSelection",value:function(i){var o;(o=this.hot).selectCell.apply(o,X9e(st(i,function(a){return Math.max(a,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var i=this.hot.getSelectedLast(),o=this.getIndexOfLastAdjacentFilledInRow(i);return o===-1||o===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(i,o),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(i){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(i).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(i){var o=this.hot.rootDocument.documentElement,a=xr(this.hot.table).top-(this.hot.rootWindow.pageYOffset||o.scrollTop)+ur(this.hot.table),s=xr(this.hot.table).left-(this.hot.rootWindow.pageXOffset||o.scrollLeft)+Ut(this.hot.table);return i.clientY>a&&i.clientX<=s}},{key:"registerEvents",value:function(){var i=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(o,"mousemove",function(a){return i.onMouseMove(a)})}},{key:"onCellCornerDblClick",value:function(){var i=this.selectAdjacent();i&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(i){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(i),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(i){var o=this.getIfMouseWasDraggedOutside(i);this.addingStarted===!1&&this.handleDraggedCells>0&&o?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var i=K9e(this.hot.getSettings().fillHandle);this.directions=i.directions,this.autoInsertRow=i.autoInsertRow}},{key:"destroy",value:function(){xl(ma(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return uk}},{key:"PLUGIN_PRIORITY",get:function(){return hke}},{key:"SETTING_KEYS",get:function(){return[uk].concat(dke)}}]),r}(xt);function sh(t){"@babel/helpers - typeof";return sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sh(t)}function gke(t,e){return Ske(t)||wke(t,e)||bke(t,e)||yke()}function yke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bke(t,e){if(t){if(typeof t=="string")return ck(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ck(t,e)}}function ck(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function wke(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function Ske(t){if(Array.isArray(t))return t}function Rke(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Cke(n.key),n)}}function Eke(t,e,r){return e&&fk(t.prototype,e),r&&fk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Cke(t){var e=Oke(t,"string");return sh(e)==="symbol"?e:String(e)}function Oke(t,e){if(sh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Zc(){return typeof Reflect<"u"&&Reflect.get?Zc=Reflect.get.bind():Zc=function(e,r,n){var i=Tke(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Zc.apply(this,arguments)}function Tke(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=xs(t),t!==null););return t}function _ke(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Q5(t,e)}function Q5(t,e){return Q5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Q5(t,e)}function Ake(t){var e=Pke();return function(){var n=xs(t),i;if(e){var o=xs(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ike(this,i)}}function Ike(t,e){if(e&&(sh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nke(t)}function Nke(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Pke(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xs(t){return xs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xs(t)}var i1="autoRowSize",Mke=40,kke="autoRowSize",xke=function(t){_ke(r,t);var e=Ake(r);function r(n){var i;return Rke(this,r),i=e.call(this,n),i.rowHeightsMap=void 0,i.headerHeight=null,i.ghostTable=new mG(i.hot),i.samplesGenerator=new gG(function(o,a){var s;return o>=0?s=i.hot.getDataAtCell(o,a):o===-1&&(s=i.hot.getColHeader(a)),{value:s}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredRows=0,i.rowHeightsMap=new qs,i.hot.rowIndexMapper.registerMap(kke,i.rowHeightsMap),i.addHook("beforeRowResize",function(o,a,s){return i.onBeforeRowResize(o,a,s)}),i}return Eke(r,[{key:"isEnabled",value:function(){var i=this.hot.getSettings()[i1];return i===!0||lt(i)}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeChangeRender",function(o){return i.onBeforeChange(o)}),this.addHook("beforeColumnResize",function(){return i.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(o){return i.onBeforeViewRender(o)}),this.addHook("modifyRowHeight",function(o,a){return i.getRowHeight(a,o)}),this.addHook("modifyColumnHeaderHeight",function(){return i.getColumnHeaderHeight()}),Zc(xs(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this;this.headerHeight=null,Zc(xs(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(o,a,s){return i.onBeforeRowResize(o,a,s)})}},{key:"calculateRowsHeight",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof o=="number"?{from:o,to:o}:o,u=typeof a=="number"?{from:a,to:a}:a;if(this.hot.getColHeader(0)!==null){var c=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(c.get(-1))}De(l.from,l.to,function(f){if(s||i.rowHeightsMap.getValueAtIndex(f)===null){var h=i.samplesGenerator.generateRowSamples(f,u);D(h,function(d){var p=gke(d,2),m=p[0],y=p[1];return i.ghostTable.addRow(m,y)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){i.ghostTable.getHeights(function(f,h){f<0?i.headerHeight=h:i.rowHeightsMap.setValueAtIndex(i.hot.toPhysicalRow(f),h)})},!0),this.measuredRows=l.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=0,s=this.hot.countRows()-1,l=null;this.inProgress=!0;var u=function f(){if(!i.hot){H0(l),i.inProgress=!1;return}i.calculateRowsHeight({from:a,to:Math.min(a+r.CALCULATION_STEP,s)},o),a=a+r.CALCULATION_STEP+1,a<s?l=R_(f):(H0(l),i.inProgress=!1,i.hot.view.adjustElementsSize(!0),i.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&i.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},c=this.getSyncCalculationLimit();this.firstCalculation&&c>=0&&(this.calculateRowsHeight({from:0,to:c},o),this.firstCalculation=!1,a=c+1),a<s?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[i1],o=i&&wr(i,"samplingRatio")?i.samplingRatio:void 0,a=i&&wr(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;o&&!isNaN(o)&&this.samplesGenerator.setSampleCount(parseInt(o,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllRowsHeight",value:function(){rm(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[i1],o=r.SYNC_CALCULATION_LIMIT,a=this.hot.countRows()-1;return lt(i)&&(o=i.syncLimit,HH(o)?o=sU(a,o):o>>=0),Math.min(o,a)}},{key:"getRowHeight",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=i<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(i)),s=o;return a!==null&&a>(o||0)&&(s=a),s}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var i=this.hot.view._wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getFirstVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var i=this.hot.view._wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getLastVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(i){var o=this,a=typeof i=="number"?{from:i,to:i}:i,s=a.from,l=a.to;this.hot.batchExecution(function(){De(Math.min(s,l),Math.max(s,l),function(u){o.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!_i(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){var i=this.hot.renderCall,o=this.hot.getSettings().fixedRowsBottom,a=this.getFirstVisibleRow(),s=this.getLastVisibleRow();if(!(a===-1||s===-1)){if(this.calculateRowsHeight({from:a,to:s},void 0,i),o){var l=this.hot.countRows()-1;this.calculateRowsHeight({from:l-o,to:l})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(i,o){this.clearCacheByRange({from:i,to:o}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(i,o,a){var s=i;return a&&(this.calculateRowsHeight(o,void 0,!0),s=this.getRowHeight(o)),s}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){i.hot&&i.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(i){var o=null;i.length===1?o=i[0][0]:i.length>1&&(o={from:i[0][0],to:i[i.length-1][0]}),o!==null&&this.clearCacheByRange(o)}},{key:"destroy",value:function(){this.ghostTable.clean(),Zc(xs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return i1}},{key:"PLUGIN_PRIORITY",get:function(){return Mke}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(xt);function lh(t){"@babel/helpers - typeof";return lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lh(t)}function $ke(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Lke(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Fke(n.key),n)}}function Dke(t,e,r){return e&&Lke(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fke(t){var e=Hke(t,"string");return lh(e)==="symbol"?e:String(e)}function Hke(t,e){if(lh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function jp(){return typeof Reflect<"u"&&Reflect.get?jp=Reflect.get.bind():jp=function(e,r,n){var i=Uke(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},jp.apply(this,arguments)}function Uke(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Tu(t),t!==null););return t}function Bke(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Z5(t,e)}function Z5(t,e){return Z5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Z5(t,e)}function Vke(t){var e=Gke();return function(){var n=Tu(t),i;if(e){var o=Tu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return jke(this,i)}}function jke(t,e){if(e&&(lh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wke(t)}function Wke(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gke(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tu(t){return Tu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tu(t)}var SG=dB("physicallyIndexed"),zke=SG.getListWithInsertedItems,Yke=SG.getListWithRemovedItems,Kke=function(t){Bke(r,t);var e=Vke(r);function r(){return $ke(this,r),e.call(this,function(n){return n})}return Dke(r,[{key:"insert",value:function(i,o){var a=gA(this.indexedValues,o);this.indexedValues=zke(a,i,o,this.initValueOrFn),jp(Tu(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){var o=Yke(this.indexedValues,i);this.indexedValues=vA(o,i),jp(Tu(r.prototype),"remove",this).call(this,i)}}]),r}(Du);const Xke=Kke;function uh(t){"@babel/helpers - typeof";return uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uh(t)}function qke(t){return exe(t)||Jke(t)||Zke(t)||Qke()}function Qke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zke(t,e){if(t){if(typeof t=="string")return J5(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return J5(t,e)}}function Jke(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function exe(t){if(Array.isArray(t))return J5(t)}function J5(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function txe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rxe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ixe(n.key),n)}}function nxe(t,e,r){return e&&rxe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function ixe(t){var e=oxe(t,"string");return uh(e)==="symbol"?e:String(e)}function oxe(t,e){if(uh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Wp(){return typeof Reflect<"u"&&Reflect.get?Wp=Reflect.get.bind():Wp=function(e,r,n){var i=axe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Wp.apply(this,arguments)}function axe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=_u(t),t!==null););return t}function sxe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eO(t,e)}function eO(t,e){return eO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},eO(t,e)}function lxe(t){var e=fxe();return function(){var n=_u(t),i;if(e){var o=_u(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return uxe(this,i)}}function uxe(t,e){if(e&&(uh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cxe(t)}function cxe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fxe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _u(t){return _u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_u(t)}var RG=dB("physicallyIndexed"),hxe=RG.getListWithInsertedItems,dxe=RG.getListWithRemovedItems,pxe=function(t){sxe(r,t);var e=lxe(r);function r(){return txe(this,r),e.call(this,function(n){return n})}return nxe(r,[{key:"insert",value:function(i,o){var a=this;this.indexedValues=hxe(this.indexedValues,i,o,function(s,l){return a.getNextValue(l)}),Wp(_u(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=dxe(this.indexedValues,i),Wp(_u(r.prototype),"remove",this).call(this,i)}},{key:"getNextValue",value:function(i){return Math.max.apply(Math,qke(this.getValues()))+1+i}}]),r}(Du);const mxe=pxe;function ch(t){"@babel/helpers - typeof";return ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ch(t)}function vxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yxe(n.key),n)}}function gxe(t,e,r){return e&&hk(t.prototype,e),r&&hk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function yxe(t){var e=bxe(t,"string");return ch(e)==="symbol"?e:String(e)}function bxe(t,e){if(ch(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Jc(){return typeof Reflect<"u"&&Reflect.get?Jc=Reflect.get.bind():Jc=function(e,r,n){var i=wxe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Jc.apply(this,arguments)}function wxe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=$s(t),t!==null););return t}function Sxe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tO(t,e)}function tO(t,e){return tO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},tO(t,e)}function Rxe(t){var e=Oxe();return function(){var n=$s(t),i;if(e){var o=$s(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Exe(this,i)}}function Exe(t,e){if(e&&(ch(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cxe(t)}function Cxe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Oxe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $s(t){return $s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$s(t)}var q6="bindRowsWithHeaders",Txe=210,_xe="loose",Axe=new Map([["loose",Xke],["strict",mxe]]),Ixe=function(t){Sxe(r,t);var e=Rxe(r);function r(n){var i;return vxe(this,r),i=e.call(this,n),i.headerIndexes=null,i}return gxe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[q6]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[q6];typeof o!="string"&&(o=_xe);var a=Axe.get(o);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new a),this.addHook("modifyRowHeader",function(s){return i.onModifyRowHeader(s)}),Jc($s(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),Jc($s(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(i){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(i))}},{key:"destroy",value:function(){Jc($s(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return q6}},{key:"PLUGIN_PRIORITY",get:function(){return Txe}}]),r}(xt);function fh(t){"@babel/helpers - typeof";return fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fh(t)}function dk(t){return kxe(t)||Mxe(t)||Pxe(t)||Nxe()}function Nxe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pxe(t,e){if(t){if(typeof t=="string")return rO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rO(t,e)}}function Mxe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function kxe(t){if(Array.isArray(t))return rO(t)}function rO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function xxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,EG(n.key),n)}}function $xe(t,e,r){return e&&pk(t.prototype,e),r&&pk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function $l(){return typeof Reflect<"u"&&Reflect.get?$l=Reflect.get.bind():$l=function(e,r,n){var i=Lxe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},$l.apply(this,arguments)}function Lxe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=va(t),t!==null););return t}function Dxe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nO(t,e)}function nO(t,e){return nO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},nO(t,e)}function Fxe(t){var e=Uxe();return function(){var n=va(t),i;if(e){var o=va(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Hxe(this,i)}}function Hxe(t,e){if(e&&(fh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xc(t)}function xc(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Uxe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function va(t){return va=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},va(t)}function Bxe(t,e,r){Vxe(t,e),e.set(t,r)}function Vxe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Q6(t,e,r){return e=EG(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EG(t){var e=jxe(t,"string");return fh(e)==="symbol"?e:String(e)}function jxe(t,e){if(fh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mk(t,e){var r=CG(t,e,"get");return Wxe(t,r)}function Wxe(t,e){return e.get?e.get.call(t):e.value}function Z6(t,e,r){var n=CG(t,e,"set");return Gxe(t,n,r),r}function CG(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function Gxe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var J6="collapsibleColumns",zxe=290,Yxe=["nestedHeaders"],sc="collapsibleIndicator",vk=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),lc=new WeakMap,Kxe=function(t){Dxe(r,t);var e=Fxe(r);function r(){var n;xxe(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),Q6(xc(n),"nestedHeadersPlugin",null),Q6(xc(n),"eventManager",new hr(xc(n))),Q6(xc(n),"headerStateManager",null),Bxe(xc(n),lc,{writable:!0,value:null}),n}return $xe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[J6]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings(),a=o.nestedHeaders;a||Dt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Z6(this,lc,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("afterGetColHeader",function(){return i.onAfterGetColHeader.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(s,l,u){return i.onBeforeOnCellMouseDown(s,l,u)}),$l(va(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var i=this.hot.getSettings(),o=i.collapsibleColumns;typeof o=="boolean"?this.headerStateManager.mapState(function(a){return{collapsible:a.origColspan>1}}):Array.isArray(o)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(o))}$l(va(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Z6(this,lc,null),this.nestedHeadersPlugin=null,this.clearButtons(),$l(va(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var i=this.hot.view._wt.getSetting("columnHeaders").length,o=this.hot.view._wt.wtTable.THEAD,a=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,l=function(c){c&&c.parentNode.removeChild(c)};De(0,i-1,function(u){var c=o.childNodes[u],f=a.childNodes[u],h=s?s.childNodes[u]:null;De(0,c.childNodes.length-1,function(d){var p=c.childNodes[d].querySelector(".".concat(sc));l(p),f&&f.childNodes[d]&&(p=f.childNodes[d].querySelector(".".concat(sc)),l(p)),s&&h&&h.childNodes[d]&&(p=h.childNodes[d].querySelector(".".concat(sc)),l(p))})})}}},{key:"expandSection",value:function(i){this.toggleCollapsibleSection([i],"expand")}},{key:"collapseSection",value:function(i){this.toggleCollapsibleSection([i],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(i){var o=this,a=this.headerStateManager.mapNodes(function(s){var l=s.collapsible,u=s.origColspan,c=s.headerLevel,f=s.columnIndex,h=s.isCollapsed;if(l===!0&&u>1&&(h&&i==="expand"||!h&&i==="collapse"))return{row:o.headerStateManager.levelToRowCoords(c),col:f}});this.toggleCollapsibleSection(a,i)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(i,o){var a=this;if(!vk.has(o))throw new Error("Unsupported action is passed (".concat(o,")."));if(Array.isArray(i)){var s=_i(i,function(y){var S=y.row;return S<0}),l=s.length>0;D(s,function(y){var S,R=y.row,E=y.col,O=(S=a.headerStateManager.getHeaderSettings(R,E))!==null&&S!==void 0?S:{},A=O.collapsible,B=O.isCollapsed;if(!A||B&&o==="collapse"||!B&&o==="expand")return l=!1,!1});var u=[],c=[];l&&D(s,function(y){var S=y.row,R=y.col,E=a.headerStateManager.triggerNodeModification(o,S,R),O=E.colspanCompensation,A=E.affectedColumns,B=E.rollbackModification;O>0&&(c.push.apply(c,dk(A)),u.push(B))});var f=this.getCollapsedColumns(),h=[];o==="collapse"?h=UF([].concat(dk(f),c)):o==="expand"&&(h=_i(f,function(y){return!c.includes(y)}));var d=vk.get(o),p=this.hot.runHooks(d.beforeHook,f,h,l);if(p===!1){D(u,function(y){y()});return}this.hot.batchExecution(function(){D(c,function(y){mk(a,lc).setValueAtIndex(a.hot.toPhysicalColumn(y),d.hideColumn)})},!0);var m=this.getCollapsedColumns().length!==f.length;this.hot.runHooks(d.afterHook,f,h,l,m),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return mk(this,lc).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(i,o,a){var s,l=(s=this.headerStateManager.getHeaderSettings(a,i))!==null&&s!==void 0?s:{},u=l.collapsible,c=l.origColspan,f=l.isCollapsed,h=u&&c>1&&i>=this.hot.getSettings().fixedColumnsStart,d=o.querySelector(".".concat(sc));if(h)d||(d=this.hot.rootDocument.createElement("div"),le(d,sc),o.querySelector("div:first-child").appendChild(d)),qe(d,["collapsed","expanded"]),f?(le(d,"collapsed"),hu(d,"+")):(le(d,"expanded"),hu(d,"-"));else{var p;(p=d)===null||p===void 0||p.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(i,o){Xe(i.target,sc)&&(Xe(i.target,"expanded")?(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([o],"collapse")):Xe(i.target,"collapsed")&&(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([o],"expand")),Lo(i))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,o){o||this.updatePlugin()}},{key:"destroy",value:function(){Z6(this,lc,null),$l(va(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return J6}},{key:"PLUGIN_PRIORITY",get:function(){return zxe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[J6].concat(Yxe)}}]),r}(xt);function Tv(t){"@babel/helpers - typeof";return Tv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tv(t)}function gk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Xxe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gk(Object(r),!0).forEach(function(n){qxe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gk(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qxe(t,e,r){return e=OG(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yk(t,e){return e$e(t)||Jxe(t,e)||Zxe(t,e)||Qxe()}function Qxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zxe(t,e){if(t){if(typeof t=="string")return bk(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bk(t,e)}}function bk(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Jxe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function e$e(t){if(Array.isArray(t))return t}function t$e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r$e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,OG(n.key),n)}}function n$e(t,e,r){return e&&r$e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function OG(t){var e=i$e(t,"string");return Tv(e)==="symbol"?e:String(e)}function i$e(t,e){if(Tv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Tv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var o$e=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],a$e=!1,s$e=!0,l$e=!0,u$e=function(){function t(e,r){t$e(this,t),this.hot=e,this.sortingStates=new aw,this.sortEmptyCells=a$e,this.indicator=s$e,this.headerAction=l$e,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return n$e(t,[{key:"updateAllColumnsProperties",value:function(r){var n=this;lt(r)&&ut(r,function(i,o){o$e.includes(o)&&(n[o]=i)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var i=yk(n,1),o=i[0];return o===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return lt(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(i){var o=yk(i,2),a=o[0],s=o[1];return Xxe({column:r.hot.toVisualColumn(a)},s)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(Ae(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),t}(),a2="asc",s2="desc",c$e="colHeader";function f$e(t){if(lt(t)===!1)return!1;var e=t.column,r=t.sortOrder;return Number.isInteger(e)&&[a2,s2].includes(r)}function h$e(t){if(t.some(function(r){return f$e(r)===!1}))return!1;var e=t.map(function(r){var n=r.column;return n});return new Set(e).size===e.length}function wk(t){if(t!==s2)return t===a2?s2:a2}function Sk(t){var e=t.querySelector(".".concat(c$e));return e}function Rk(t,e){if(t<0||!e.parentNode)return!1;var r=e.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(e.parentNode)-r.length;return n===-1}function iO(t,e,r){return t===-1&&e>=0&&pu(r)===!1}var d$e="ascending",p$e="descending",TG="indicatorDisabled",_G="columnSorting",AG="sortAction",IG=new Map([[a2,d$e],[s2,p$e]]);function m$e(t,e,r,n){var i=[_G];if(n&&i.push(AG),r===!1)return i.push(TG),i;var o=t.getSortOrderOfColumn(e);return Ae(o)&&i.push(IG.get(o)),i}function v$e(){return Array.from(IG.values()).concat(AG,TG,_G)}function NG(t,e,r){var n=e.locale;return function(i,o){var a=r.sortEmptyCells;return typeof i=="string"&&(i=i.toLocaleLowerCase(n)),typeof o=="string"&&(o=o.toLocaleLowerCase(n)),i===o?Mo:Br(i)?Br(o)?Mo:a&&t==="asc"?sr:lr:Br(o)?a&&t==="asc"?lr:sr:isNaN(i)&&!isNaN(o)?t==="asc"?lr:sr:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?sr:lr:i>o?t==="asc"?lr:sr:Mo}}var PG="default";function g$e(t,e,r){return function(n,i){var o=parseFloat(n),a=parseFloat(i),s=r.sortEmptyCells;if(o===a||isNaN(o)&&isNaN(a))return Mo;if(s){if(Br(n))return t==="asc"?sr:lr;if(Br(i))return t==="asc"?lr:sr}return isNaN(o)?lr:isNaN(a)?sr:o<a?t==="asc"?sr:lr:o>a?t==="asc"?lr:sr:Mo}}var y$e="numeric";function b$e(t,e,r){var n=e.checkedTemplate,i=e.uncheckedTemplate,o=r.sortEmptyCells;return function(a,s){var l=Br(a),u=Br(s),c=l?i:a,f=u?i:s,h=c===i||c===n,d=f===i||f===n;if(o===!1){if(l&&u===!1)return lr;if(l===!1&&u)return sr}return h===!1&&d?t==="asc"?sr:lr:h&&d===!1?t==="asc"?lr:sr:h===!1&&d===!1?NG(t,e,r)(a,s):c===i&&f===n?t==="asc"?sr:lr:c===n&&f===i?t==="asc"?lr:sr:Mo}}var w$e="checkbox";function S$e(t,e,r){return function(n,i){var o=r.sortEmptyCells;if(n===i)return Mo;if(Br(n))return Br(i)?Mo:o&&t==="asc"?sr:lr;if(Br(i))return o&&t==="asc"?lr:sr;var a=e.dateFormat,s=se(n,a),l=se(i,a);return s.isValid()?l.isValid()?l.isAfter(s)?t==="asc"?sr:lr:l.isBefore(s)?t==="asc"?lr:sr:Mo:sr:lr}}var R$e="date",VI=$i("sorting.compareFunctionFactory"),Uw=VI.register,Ek=VI.getItem,E$e=VI.hasItem,MG=$i("sorting.mainSortComparator"),kG=MG.register,C$e=MG.getItem;function xG(t){return E$e(t)?Ek(t):Ek(PG)}Uw(y$e,g$e);Uw(w$e,b$e);Uw(R$e,S$e);Uw(PG,NG);var Mo=0,sr=-1,lr=1;function O$e(t,e){for(var r=C$e(e),n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];t.sort(r.apply(void 0,i))}function Ck(t){return I$e(t)||A$e(t)||_$e(t)||T$e()}function T$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _$e(t,e){if(t){if(typeof t=="string")return Ok(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ok(t,e)}}function Ok(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function A$e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function I$e(t){if(Array.isArray(t))return t}function N$e(t,e){return function(r,n){var i=Ck(r),o=i.slice(1),a=Ck(n),s=a.slice(1);return function(u){var c=t[u],f=e[u],h=o[u],d=s[u],p=f.columnSorting,m=p.compareFunctionFactory?p.compareFunctionFactory:xG(f.type),y=m(c,f,p)(h,d);return y}(0)}}function hh(t){"@babel/helpers - typeof";return hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hh(t)}var P$e=["column"],M$e=["column"];function uc(t){return L$e(t)||$$e(t)||x$e(t)||k$e()}function k$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x$e(t,e){if(t){if(typeof t=="string")return oO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oO(t,e)}}function $$e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function L$e(t){if(Array.isArray(t))return oO(t)}function oO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Tk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function _k(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Tk(Object(r),!0).forEach(function(n){D$e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Tk(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function D$e(t,e,r){return e=$G(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ak(t,e){if(t==null)return{};var r=F$e(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function F$e(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function H$e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ik(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$G(n.key),n)}}function U$e(t,e,r){return e&&Ik(t.prototype,e),r&&Ik(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function $G(t){var e=B$e(t,"string");return hh(e)==="symbol"?e:String(e)}function B$e(t,e){if(hh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Ll(){return typeof Reflect<"u"&&Reflect.get?Ll=Reflect.get.bind():Ll=function(e,r,n){var i=V$e(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Ll.apply(this,arguments)}function V$e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ga(t),t!==null););return t}function j$e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&aO(t,e)}function aO(t,e){return aO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},aO(t,e)}function W$e(t){var e=Y$e();return function(){var n=ga(t),i;if(e){var o=ga(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return G$e(this,i)}}function G$e(t,e){if(e&&(hh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return z$e(t)}function z$e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Y$e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ga(t){return ga=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ga(t)}var sO="columnSorting",K$e=50,Nk="append",X$e="replace";kG(sO,N$e);Ne.getSingleton().register("beforeColumnSort");Ne.getSingleton().register("afterColumnSort");var LG=function(t){j$e(r,t);var e=W$e(r);function r(n){var i;return H$e(this,r),i=e.call(this,n),i.columnStatesManager=null,i.columnMetaCache=null,i.pluginKey=sO,i.indexesSequenceCache=null,i}return U$e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnStatesManager=new u$e(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new qs(function(o){var a=i.hot.toVisualColumn(o);return a===null&&(a=o),i.getMergedPluginSettings(a)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(o,a){return i.onAfterGetColHeader(o,a)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(o,a){return i.onAfterOnCellMouseDown(o,a)}),this.addHook("afterInit",function(){return i.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.hot.view&&this.loadOrSortBySettings(),Ll(ga(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this,o=function(s,l){var u=Sk(l);Rk(s,l)===!1||u===null||i.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",o),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("afterGetColHeader",o)}),this.hot.batchExecution(function(){i.indexesSequenceCache!==null&&(i.hot.rowIndexMapper.setIndexesSequence(i.indexesSequenceCache.getValues()),i.hot.rowIndexMapper.unregisterMap(i.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,Ll(ga(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){var o=this.getSortConfig(),a=this.getNormalizedSortConfigs(i),s=this.areValidSortConfigs(a),l=this.hot.runHooks("beforeColumnSort",o,a,s);l!==!1&&(o.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new pB),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),s&&(this.columnStatesManager.setSortStates(a),this.sortByPresetSortStates(a),this.saveAllSortSettings(a)),this.hot.runHooks("afterColumnSort",o,s?a:o,s),s&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(i){return Ae(i)?this.columnStatesManager.getColumnSortState(i):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(i){var o=this.getNormalizedSortConfigs(i);this.areValidSortConfigs(o)&&this.columnStatesManager.setSortStates(o)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i.slice(0,1):[i]}},{key:"areValidSortConfigs",value:function(i){var o=this.hot.countCols();return h$e(i)&&i.every(function(a){var s=a.column;return s<=o&&s>=0})}},{key:"saveAllSortSettings",value:function(i){var o=this,a=this.columnStatesManager.getAllColumnsProperties(),s=function(u){var c=u.column,f=Ak(u,P$e);return _k({column:o.hot.toPhysicalColumn(c)},f)};a.initialConfig=st(i,s),this.hot.runHooks("persistentStateSave","columnSorting",a)}},{key:"getAllSavedSortSettings",value:function(){var i=this,o={};this.hot.runHooks("persistentStateLoad","columnSorting",o);var a=o.value,s=function(u){var c=u.column,f=Ak(u,M$e);return _k({column:i.hot.toVisualColumn(c)},f)};return Ae(a)&&Array.isArray(a.initialConfig)&&(a.initialConfig=st(a.initialConfig,s)),a}},{key:"getColumnNextConfig",value:function(i){var o=this.columnStatesManager.getSortOrderOfColumn(i);if(Ae(o)){var a=wk(o);return Ae(a)?{column:i,sortOrder:a}:void 0}var s=this.hot.countCols();if(Number.isInteger(i)&&i>=0&&i<s)return{column:i,sortOrder:wk()}}},{key:"getNextSortConfig",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Nk,a=this.columnStatesManager.getIndexOfColumnInSortQueue(i),s=a!==-1,l=this.getSortConfig(),u=this.getColumnNextConfig(i);if(s){if(zt(u))return[].concat(uc(l.slice(0,a)),uc(l.slice(a+1)));if(o===Nk)return[].concat(uc(l.slice(0,a)),uc(l.slice(a+1)),[u]);if(o===X$e)return[].concat(uc(l.slice(0,a)),[u],uc(l.slice(a+1)))}return Ae(u)?l.concat(u):l}},{key:"getPluginColumnConfig",value:function(i){if(lt(i)){var o=i[this.pluginKey];if(lt(o))return o}return{}}},{key:"getMergedPluginSettings",value:function(i){var o=this.hot.getSettings()[this.pluginKey],a=this.columnStatesManager.getAllColumnsProperties(),s=this.hot.getCellMeta(0,i),l=Object.getPrototypeOf(s);return Array.isArray(l.columns)?Object.assign(a,o,this.getPluginColumnConfig(l.columns[i])):Xt(l.columns)?Object.assign(a,o,this.getPluginColumnConfig(l.columns(i))):Object.assign(a,o)}},{key:"getFirstCellSettings",value:function(i){var o=this.hot.getCellMeta(0,i),a=Object.create(o);return a[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(i)),a}},{key:"getNumberOfRowsToSort",value:function(i){var o=this.hot.getSettings();return o.maxRows<=i?o.maxRows:i-o.minSpareRows}},{key:"sortByPresetSortStates",value:function(i){var o=this;if(i.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var a=[],s=this.hot.countRows(),l=function(y){return st(i,function(S){return o.hot.getDataAtCell(y,S.column)})},u=0;u<this.getNumberOfRowsToSort(s);u+=1)a.push([this.hot.toPhysicalRow(u)].concat(l(u)));var c=st(a,function(m){return m[0]});O$e(a,this.pluginKey,st(i,function(m){return m.sortOrder}),st(i,function(m){return o.getFirstCellSettings(m.column)}));for(var f=a.length;f<s;f+=1)a.push([f].concat(l(f)));var h=st(a,function(m){return m[0]}),d=new Map(st(c,function(m,y){return[m,h[y]]})),p=st(this.hot.rowIndexMapper.getIndexesSequence(),function(m){return d.has(m)?d.get(m):m});this.hot.rowIndexMapper.setIndexesSequence(p)}},{key:"loadOrSortBySettings",value:function(){var i=this.getAllSavedSortSettings();if(lt(i))this.sortBySettings(i);else{var o=this.hot.getSettings()[this.pluginKey];this.sortBySettings(o)}}},{key:"sortBySettings",value:function(i){if(lt(i)){this.columnStatesManager.updateAllColumnsProperties(i);var o=i.initialConfig;(Array.isArray(o)||lt(o))&&this.sort(o)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(i,o){var a=Sk(o);if(!(Rk(i,o)===!1||a===null)){var s=this.getFirstCellSettings(i)[this.pluginKey],l=s.indicator,u=s.headerAction;this.updateHeaderClasses(a,this.columnStatesManager,i,l,u)}}},{key:"updateHeaderClasses",value:function(i){if(qe(i,v$e()),this.enabled!==!1){for(var o=arguments.length,a=new Array(o>1?o-1:0),s=1;s<o;s++)a[s-1]=arguments[s];le(i,m$e.apply(void 0,a))}}},{key:"onUpdateSettings",value:function(i){Ll(ga(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Ae(i[this.pluginKey])&&this.sortBySettings(i[this.pluginKey])}},{key:"onAfterLoadData",value:function(i){i===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(i,o){var a=this.getFirstCellSettings(o)[this.pluginKey],s=a.headerAction;return s&&i.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a,s){iO(o.row,o.col,i)!==!1&&this.wasClickableHeaderClicked(i,o.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,o){iO(o.row,o.col,i)!==!1&&this.wasClickableHeaderClicked(i,o.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(o.col)),this.sort(this.getColumnNextConfig(o.col)))}},{key:"destroy",value:function(){var i;(i=this.columnStatesManager)===null||i===void 0||i.destroy(),Ll(ga(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return sO}},{key:"PLUGIN_PRIORITY",get:function(){return K$e}}]),r}(xt),q$e=Ye,jI=rt,Q$e=Ks,Z$e=dF,J$e=T_,Pk=nt,eLe=RangeError,DG=String,FG=Math.floor,lO=jI(J$e),Mk=jI("".slice),Jd=jI(1 .toFixed),Bc=function(t,e,r){return e===0?r:e%2===1?Bc(t,e-1,r*t):Bc(t*t,e/2,r)},tLe=function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e},cc=function(t,e,r){for(var n=-1,i=r;++n<6;)i+=e*t[n],t[n]=i%1e7,i=FG(i/1e7)},eR=function(t,e){for(var r=6,n=0;--r>=0;)n+=t[r],t[r]=FG(n/e),n=n%e*1e7},kk=function(t){for(var e=6,r="";--e>=0;)if(r!==""||e===0||t[e]!==0){var n=DG(t[e]);r=r===""?n:r+lO("0",7-n.length)+n}return r},rLe=Pk(function(){return Jd(8e-5,3)!=="0.000"||Jd(.9,0)!=="1"||Jd(1.255,2)!=="1.25"||Jd(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!Pk(function(){Jd({})});q$e({target:"Number",proto:!0,forced:rLe},{toFixed:function(e){var r=Z$e(this),n=Q$e(e),i=[0,0,0,0,0,0],o="",a="0",s,l,u,c;if(n<0||n>20)throw eLe("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return DG(r);if(r<0&&(o="-",r=-r),r>1e-21)if(s=tLe(r*Bc(2,69,1))-69,l=s<0?r*Bc(2,-s,1):r/Bc(2,s,1),l*=4503599627370496,s=52-s,s>0){for(cc(i,0,l),u=n;u>=7;)cc(i,1e7,0),u-=7;for(cc(i,Bc(10,u,1),0),u=s-1;u>=23;)eR(i,1<<23),u-=23;eR(i,1<<u),cc(i,1,1),eR(i,2),a=kk(i)}else cc(i,0,l),cc(i,1<<-s,0),a=kk(i)+lO("0",n);return n>0?(c=a.length,a=o+(c<=n?"0."+lO("0",n-c)+a:Mk(a,0,c-n)+"."+Mk(a,c-n))):a=o+a,a}});function _v(t){"@babel/helpers - typeof";return _v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_v(t)}function nLe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iLe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,aLe(n.key),n)}}function oLe(t,e,r){return e&&iLe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function aLe(t){var e=sLe(t,"string");return _v(e)==="symbol"?e:String(e)}function sLe(t,e){if(_v(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(_v(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var lLe=function(){function t(e,r){nLe(this,t),this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return oLe(t,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,i=[],o=r;if(!o&&typeof this.settings=="function"){this.settingsType="function";return}return o||(o=this.settings),D(o,function(a){var s={};n.assignSetting(a,s,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(a,s,"reversedRowCoords",!1),n.assignSetting(a,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,s,"sourceColumn",a.destinationColumn),n.assignSetting(a,s,"type","sum"),n.assignSetting(a,s,"forceNumeric",!1),n.assignSetting(a,s,"suppressDataTypeErrors",!0),n.assignSetting(a,s,"suppressDataTypeErrors",!0),n.assignSetting(a,s,"customFunction",null),n.assignSetting(a,s,"readOnly",!0),n.assignSetting(a,s,"roundFloat",!1),i.push(s)}),i}},{key:"assignSetting",value:function(r,n,i,o){if(i==="ranges"&&r[i]===void 0){n[i]=o;return}else if(i==="ranges"&&r[i].length===0)return;if(r[i]===void 0){if(o instanceof Error)throw o;n[i]=o}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-r[i]-1:n[i]=r[i]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,i){if(this.settingsType==="function"){var o=r.indexOf("row")>-1?"row":"col",a=this.getAllEndpoints();D(a,function(s){o==="row"&&s.destinationRow>=n&&(r==="insert_row"?s.alterRowOffset=i:r==="remove_row"&&(s.alterRowOffset=-1*i)),o==="col"&&s.destinationColumn>=n&&(r==="insert_col"?s.alterColumnOffset=i:r==="remove_col"&&(s.alterColumnOffset=-1*i))}),this.resetAllEndpoints(a,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,i,o,a){var s=this,l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function m(){return s.hot.removeHook("beforeViewRender",m),s.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var c=r.indexOf("row")>-1?"row":"col",f=r.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=r.indexOf("move_row")===0,p=n;D(h,function(m){c==="row"&&m.destinationRow>=p&&(m.alterRowOffset=f*i),c==="col"&&m.destinationColumn>=p&&(m.alterColumnOffset=f*i)}),this.resetAllEndpoints(h,!d),d?D(h,function(m){s.extendEndpointRanges(m,p,o[0],o.length),s.recreatePhysicalRanges(m),s.clearOffsetInformation(m)}):D(h,function(m){s.shiftEndpointCoordinates(m,p)}),l&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,i,o){D(r.ranges,function(a){a[1]&&(n>=a[0]&&n<=a[1]?i>a[1]?a[1]+=o:i<a[0]&&(a[0]-=o):i>=a[0]&&i<=a[1]&&(a[1]-=o,n<=a[0]&&(a[0]+=1,a[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,i=r.ranges,o=[],a=[];D(i,function(s){var l=[];if(s[1])for(var u=s[0];u<=s[1];u++)l.push(n.hot.toPhysicalRow(u));else l.push(n.hot.toPhysicalRow(s[0]));a.push(l)}),D(a,function(s){var l=[];D(s,function(u,c){c===0?l.push(u):s[c]!==s[c-1]+1&&(l.push(s[c-1]),o.push(l),l=[],l.push(u)),c===s.length-1&&(l.push(u),o.push(l))})}),r.ranges=o}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,D(r.ranges,function(i){D(i,function(o,a){o>=n&&(i[a]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=n.some(function(a){var s=a.alterRowOffset||0,l=a.alterColumnOffset||0;return a.destinationRow+s>=r.hot.countRows()||a.destinationColumn+l>=r.hot.countCols()});o||(this.cellsToSetCache=[],D(n,function(a){r.resetEndpointValue(a,i)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],D(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,i=[];this.cellsToSetCache=[],D(r,function(o,a,s){"".concat(o[2]||"")!=="".concat(o[3])&&D(n.getAllEndpoints(),function(l,u){n.hot.propToCol(s[a][1])===l.sourceColumn&&i.indexOf(u)===-1&&i.push(u)})}),D(i,function(o){n.refreshEndpoint(n.getEndpoint(o))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=r.alterRowOffset||0,o=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?i:0)),this.hot.toVisualColumn(r.destinationColumn+(n?o:0)),""])}},{key:"setEndpointValue",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var a=this.hot.toVisualRow(r.destinationRow);if(a!==null){var s=this.hot.getCellMeta(a,r.destinationColumn);(n==="init"||s.readOnly!==r.readOnly)&&(s.readOnly=r.readOnly,s.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),i?this.hot.setDataAtCell(o,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([o,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){Dt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),t}();const uLe=lLe;function tR(t){return t==null||isNaN(t)}function dh(t){"@babel/helpers - typeof";return dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dh(t)}var xk;function cLe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function fLe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $k(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dLe(n.key),n)}}function hLe(t,e,r){return e&&$k(t.prototype,e),r&&$k(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function dLe(t){var e=pLe(t,"string");return dh(e)==="symbol"?e:String(e)}function pLe(t,e){if(dh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function y0(){return typeof Reflect<"u"&&Reflect.get?y0=Reflect.get.bind():y0=function(e,r,n){var i=mLe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},y0.apply(this,arguments)}function mLe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ph(t),t!==null););return t}function vLe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&uO(t,e)}function uO(t,e){return uO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},uO(t,e)}function gLe(t){var e=wLe();return function(){var n=ph(t),i;if(e){var o=ph(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return yLe(this,i)}}function yLe(t,e){if(e&&(dh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bLe(t)}function bLe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ph(t){return ph=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ph(t)}var rR="columnSummary",SLe=220,RLe=function(t){vLe(r,t);var e=gLe(r);function r(n){var i;return fLe(this,r),i=e.call(this,n),i.endpoints=null,i}return hLe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[rR]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.settings=this.hot.getSettings()[rR],this.endpoints=new uLe(this,this.settings),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeCreateRow",function(o,a,s){return i.endpoints.resetSetupBeforeStructureAlteration("insert_row",o,a,null,s)}),this.addHook("beforeCreateCol",function(o,a,s){return i.endpoints.resetSetupBeforeStructureAlteration("insert_col",o,a,null,s)}),this.addHook("beforeRemoveRow",function(){for(var o,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(o=i.endpoints).resetSetupBeforeStructureAlteration.apply(o,["remove_row"].concat(s))}),this.addHook("beforeRemoveCol",function(){for(var o,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(o=i.endpoints).resetSetupBeforeStructureAlteration.apply(o,["remove_col"].concat(s))}),this.addHook("afterCreateRow",function(o,a,s){return i.endpoints.resetSetupAfterStructureAlteration("insert_row",o,a,null,s)}),this.addHook("afterCreateCol",function(o,a,s){return i.endpoints.resetSetupAfterStructureAlteration("insert_col",o,a,null,s)}),this.addHook("afterRemoveRow",function(){for(var o,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(o=i.endpoints).resetSetupAfterStructureAlteration.apply(o,["remove_row"].concat(s))}),this.addHook("afterRemoveCol",function(){for(var o,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(o=i.endpoints).resetSetupAfterStructureAlteration.apply(o,["remove_col"].concat(s))}),this.addHook("afterRowMove",function(){return i.onAfterRowMove.apply(i,arguments)}),y0(ph(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(i){switch(i.type.toLowerCase()){case"sum":i.result=this.calculateSum(i);break;case"min":i.result=this.calculateMinMax(i,i.type);break;case"max":i.result=this.calculateMinMax(i,i.type);break;case"count":i.result=this.countEntries(i);break;case"average":i.result=this.calculateAverage(i);break;case"custom":i.result=i.customFunction.call(this,i);break}}},{key:"calculateSum",value:function(i){var o=this,a=0;return ut(i.ranges,function(s){a+=o.getPartialSum(s,i.sourceColumn)}),a}},{key:"getPartialSum",value:function(i,o){var a=0,s=i[1]||i[0],l=null,u=0;do{if(l=this.getCellValue(s,o),l=tR(l)?null:l,l!==null){var c=("".concat(l).split(".")[1]||[]).length||1;c>u&&(u=c)}a+=l||0,s-=1}while(s>=i[0]);return Math.round(a*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(i,o){var a=this,s=null;return ut(i.ranges,function(l){var u=a.getPartialMinMax(l,i.sourceColumn,o);if(s===null&&u!==null&&(s=u),u!==null)switch(o){case"min":s=Math.min(s,u);break;case"max":s=Math.max(s,u);break}}),s===null?"Not enough data":s}},{key:"getPartialMinMax",value:function(i,o,a){var s=null,l=i[1]||i[0],u;do{if(u=this.getCellValue(l,o),u=tR(u)?null:u,s===null)s=u;else if(u!==null)switch(a){case"min":s=Math.min(s,u);break;case"max":s=Math.max(s,u);break}l-=1}while(l>=i[0]);return s}},{key:"countEmpty",value:function(i,o){var a,s=0,l=i[1]||i[0];do a=this.getCellValue(l,o),a=tR(a)?null:a,a===null&&(s+=1),l-=1;while(l>=i[0]);return s}},{key:"countEntries",value:function(i){var o=this,a=0,s=i.ranges;return ut(s,function(l){var u=l[1]===void 0?1:l[1]-l[0]+1,c=o.countEmpty(l,i.sourceColumn);a+=u,a-=c}),a}},{key:"calculateAverage",value:function(i){var o=this.calculateSum(i),a=this.countEntries(i);return o/a}},{key:"getCellValue",value:function(i,o){var a=this.hot.toVisualRow(i),s=this.hot.toVisualColumn(o),l=this.hot.getSourceDataAtCell(i,o),u="";if(a!==null&&s!==null&&(u=this.hot.getCellMeta(a,s).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof l=="string"&&(l=l.replace(/,/,".")),l=parseFloat(l)),isNaN(l)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(kt(xk||(xk=cLe(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),i,o));return l}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(i,o){i&&o!=="ColumnSummary.reset"&&o!=="ColumnSummary.set"&&o!=="loadData"&&this.endpoints.refreshChangedEndpoints(i)}},{key:"onAfterRowMove",value:function(i,o){this.endpoints.resetSetupBeforeStructureAlteration("move_row",i[0],i.length,i,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",o,i.length,i,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return rR}},{key:"PLUGIN_PRIORITY",get:function(){return SLe}}]),r}(xt);function Av(t){"@babel/helpers - typeof";return Av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Av(t)}function ELe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Lk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,OLe(n.key),n)}}function CLe(t,e,r){return e&&Lk(t.prototype,e),r&&Lk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function OLe(t){var e=TLe(t,"string");return Av(e)==="symbol"?e:String(e)}function TLe(t,e){if(Av(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Av(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var _Le=function(){function t(e,r){ELe(this,t),this.rootDocument=e,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return CLe(t,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var i=this.getInputElement();i.style.width="".concat(r,"px"),i.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:Ut(this.getInputElement()),height:ur(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),le(this.container,t.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),le(r,t.CLASS_EDITOR),le(n,t.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(t.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),t}();const ALe=_Le;var at="---------";function ILe(){return{name:at}}function NLe(t){return st(t,function(e){return{start:e.getTopStartCorner(),end:e.getBottomEndCorner()}})}function o1(t){return Xe(t,"htSeparator")}function PLe(t){return Xe(t,"htSubmenu")}function a1(t){return Xe(t,"htDisabled")}function s1(t){return Xe(t,"htSelectionDisabled")}function Bu(t){var e=t.getSelected();return!e||e[0]<0?null:e}function MLe(t,e){if(t.indexOf(e)!==-1)return t;var r=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(e)}function kLe(t,e){if(t.indexOf(e)!==-1)return t;var r=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(e)}function vl(t,e){var r={};return D(t,function(n){n.forAll(function(i,o){i>=0&&o>=0&&(r[i]||(r[i]=[]),r[i][o]=e(i,o))})}),r}function hs(t,e,r,n,i){D(t,function(o){o.forAll(function(a,s){a>=0&&s>=0&&xLe(a,s,e,r,n,i)})})}function xLe(t,e,r,n,i,o){var a=i(t,e),s=n;a.className&&(r==="vertical"?s=MLe(a.className,n):s=kLe(a.className,n)),o(t,e,"className",s)}function Eo(t,e){var r=!1;return Array.isArray(t)&&D(t,function(n){return n.forAll(function(i,o){if(i>=0&&o>=0&&e(i,o))return r=!0,!1}),r}),r}function la(t){return'<span class="selected">'.concat("✓","</span>").concat(t)}function $Le(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function HG(t,e){for(var r=t.slice(0),n=0;n<r.length&&r[n].name===e;)r.shift();return r}function LLe(t,e){var r=t.slice(0);return r.reverse(),r=HG(r,e),r.reverse(),r}function DLe(t){var e=[];return D(t,function(r,n){n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function FLe(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:at,r=t.slice(0);return r=HG(r,e),r=LLe(r,e),r=DLe(r),r}function Iv(t){"@babel/helpers - typeof";return Iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Iv(t)}function HLe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ULe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,VLe(n.key),n)}}function BLe(t,e,r){return e&&ULe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function VLe(t){var e=jLe(t,"string");return Iv(e)==="symbol"?e:String(e)}function jLe(t,e){if(Iv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Iv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var WLe=250,GLe=250,UG=function(){function t(e){HLe(this,t),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}return BLe(t,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},GLe)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:WLe;this.showDebounced=WH(function(i){r.wasLastActionShow&&r.runLocalHooks("show",i.from.row,i.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),t}();Kt(UG,Xn);const zLe=UG;function mh(t){"@babel/helpers - typeof";return mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mh(t)}function nR(t,e,r){return e=BG(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YLe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,BG(n.key),n)}}function KLe(t,e,r){return e&&Dk(t.prototype,e),r&&Dk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function BG(t){var e=XLe(t,"string");return mh(e)==="symbol"?e:String(e)}function XLe(t,e){if(mh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dl(){return typeof Reflect<"u"&&Reflect.get?Dl=Reflect.get.bind():Dl=function(e,r,n){var i=qLe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Dl.apply(this,arguments)}function qLe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ya(t),t!==null););return t}function QLe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cO(t,e)}function cO(t,e){return cO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},cO(t,e)}function ZLe(t){var e=eDe();return function(){var n=ya(t),i;if(e){var o=ya(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return JLe(this,i)}}function JLe(t,e){if(e&&(mh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VG(t)}function VG(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function eDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ya(t){return ya=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ya(t)}var iR="comments",tDe=60,l1=new WeakMap,po="comment",fc="value",Fk="style",u1="readOnly",rDe=function(t){QLe(r,t);var e=ZLe(r);function r(n){var i;return YLe(this,r),i=e.call(this,n),i.editor=null,i.displaySwitch=null,i.eventManager=null,i.range={},i.preventEditorAutoSwitch=!1,l1.set(VG(i),{tempEditorDimensions:{},cellBelowCursor:null}),i}return KLe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[iR]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.editor||(this.editor=new ALe(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new hr(this)),this.displaySwitch||(this.displaySwitch=new zLe(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(o){return i.addToContextMenu(o)}),this.addHook("afterRenderer",function(o,a,s,l,u,c){return i.onAfterRenderer(o,c)}),this.addHook("afterScrollHorizontally",function(){return i.hide()}),this.addHook("afterScrollVertically",function(){return i.hide()}),this.addHook("afterBeginEditing",function(){return i.hide()}),this.displaySwitch.addLocalHook("hide",function(){return i.hide()}),this.displaySwitch.addLocalHook("show",function(o,a){return i.showAtCell(o,a)}),this.registerListeners(),Dl(ya(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Dl(ya(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){Dl(ya(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var i=this,o=this.hot.rootDocument;this.eventManager.addEventListener(o,"mouseover",function(a){return i.onMouseOver(a)}),this.eventManager.addEventListener(o,"mousedown",function(a){return i.onMouseDown(a)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return i.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(a){return i.onEditorMouseDown(a)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(a){return i.onEditorMouseUp(a)})}},{key:"setRange",value:function(i){this.range=i}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(i){var o=su(i.target,"TD","TBODY");return!!(o&&Xe(o,"htCommentCell")&&su(o,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(i){return this.editor.getInputElement()===i.target}},{key:"setComment",value:function(i){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.editor.getValue(),a="";i!=null?a=i:o!=null&&(a=o);var s=this.range.from.row,l=this.range.from.col;this.updateCommentMeta(s,l,nR({},fc,a)),this.hot.render()}},{key:"setCommentAtCell",value:function(i,o,a){this.setRange({from:this.hot._createCellCoords(i,o)}),this.setComment(a)}},{key:"removeComment",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,po),i&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(i,o)}),this.removeComment(a)}},{key:"getComment",value:function(){var i=this.range.from.row,o=this.range.from.col;return this.getCommentMeta(i,o,fc)}},{key:"getCommentAtCell",value:function(i,o){return this.getCommentMeta(i,o,fc)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.range.from,o=i.row,a=i.col;if(o<0||o>this.hot.countSourceRows()-1||a<0||a>this.hot.countSourceCols()-1)return!1;var s=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(s[po]?s[po][fc]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(i,o){return this.setRange({from:this.hot._createCellCoords(i,o)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var i,o,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!a&&(!this.range.from||!this.editor.isVisible()))){var s=this.hot,l=s.rowIndexMapper,u=s.columnIndexMapper,c=this.range.from,f=c.row,h=c.col,d=l.getRenderableFromVisualIndex(f),p=u.getRenderableFromVisualIndex(h),m=d===null;this.editor.setPosition(0,0),d===null&&(d=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,-1))),p===null&&(p=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,-1)));var y=d===null,S=p===null;d=(i=d)!==null&&i!==void 0?i:0,p=(o=p)!==null&&o!==void 0?o:0;var R=this.hot,E=R.rootWindow,O=R.view._wt,A=O.wtTable,B=O.getCell({row:d,col:p},!0),j=this.getCommentMeta(f,h,Fk);j?this.editor.setSize(j.width,j.height):this.editor.resetSize();var J=S?0:A.getStretchedColumnWidth(p),Y=m&&!y?ur(B):0,q=B.getBoundingClientRect(),ee=q.left,ae=q.top,ne=q.width,ue=q.height,me=this.editor.getSize(),Re=me.width,ge=me.height,I=this.hot.rootWindow,v=I.innerWidth,b=I.innerHeight,w=this.hot.rootDocument.documentElement,_=ee+E.scrollX+J,M=ae+E.scrollY+Y;this.hot.isRtl()&&(_-=Re+J),this.hot.isLtr()&&ee+ne+Re>v?_=ee+E.scrollX-Re-1:this.hot.isRtl()&&_<-(w.scrollWidth-w.clientWidth)&&(_=ee+E.scrollX+J+1),ae+ge>b&&(M-=ge-ue+1),this.editor.setPosition(_,M),this.editor.setReadOnlyState(this.getCommentMeta(f,h,u1))}}},{key:"checkSelectionCommentsConsistency",value:function(){var i=this.hot.getSelectedRangeLast();if(!i)return!1;var o=!1,a=i.getTopStartCorner();return this.getCommentMeta(a.row,a.col,fc)&&(o=!0),o}},{key:"updateCommentMeta",value:function(i,o,a){var s=this.hot.getCellMeta(i,o)[po],l;s?(l=An(s),V2(l,a)):l=a,this.hot.setCellMeta(i,o,po,l)}},{key:"getCommentMeta",value:function(i,o,a){var s=this.hot.getCellMeta(i,o);if(s[po])return s[po][a]}},{key:"onMouseDown",value:function(i){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(i)){var o=su(i.target,"TD","TBODY"),a=null;o&&(a=this.hot.getCoords(o)),(!o||this.range.from&&a&&(this.range.from.row!==a.row||this.range.from.col!==a.col))&&this.hide()}}},{key:"onMouseOver",value:function(i){var o=l1.get(this),a=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||Xe(i.target,"wtBorder")||o.cellBelowCursor===i.target||!this.editor))if(o.cellBelowCursor=a.elementFromPoint(i.clientX,i.clientY),this.targetIsCellWithComment(i)){var s=this.hot._createCellRange(this.hot.getCoords(i.target));this.displaySwitch.show(s)}else lu(i.target,a)&&!this.targetIsCommentTextArea(i)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(i,o){o[po]&&o[po][fc]&&le(i,o.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(i){var o=l1.get(this);o.tempEditorDimensions={width:Ut(i.target),height:ur(i.target)}}},{key:"onEditorMouseUp",value:function(i){var o=l1.get(this),a=Ut(i.target),s=ur(i.target);(a!==o.tempEditorDimensions.width+1||s!==o.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,nR({},Fk,{width:a,height:s}))}},{key:"onContextMenuAddComment",value:function(){var i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:i.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var i=this,o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,o.forAll(function(a,s){a>=0&&s>=0&&i.removeCommentAtCell(a,s,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var i=this,o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,o.forAll(function(a,s){if(a>=0&&s>=0){var l=!!i.getCommentMeta(a,s,u1);i.updateCommentMeta(a,s,nR({},u1,!l))}})}},{key:"addToContextMenu",value:function(i){var o=this,a=function(){return o.hot.rowIndexMapper.getRenderableIndexesLength()>0&&o.hot.columnIndexMapper.getRenderableIndexesLength()>0};i.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return o.checkSelectionCommentsConsistency()?o.hot.getTranslatedPhrase(UA):o.hot.getTranslatedPhrase(HA)},callback:function(){return o.onContextMenuAddComment()},disabled:function(){return a()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(BA)},callback:function(){return o.onContextMenuRemoveComment()},disabled:function(){return a()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var l=this,u=this.getTranslatedPhrase(VA),c=Eo(this.getSelectedRangeLast(),function(f,h){var d=l.getCellMeta(f,h)[po];if(d&&(d=d[u1]),d)return!0});return c&&(u=la(u)),u},callback:function(){return o.onContextMenuMakeReadOnly()},disabled:function(){return a()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner())||!o.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var i=this.hot.getSettings()[iR];if(lt(i))return i.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),Dl(ya(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return iR}},{key:"PLUGIN_PRIORITY",get:function(){return tDe}}]),r}(xt);function Nv(t){"@babel/helpers - typeof";return Nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nv(t)}function nDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iDe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,aDe(n.key),n)}}function oDe(t,e,r){return e&&iDe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function aDe(t){var e=sDe(t,"string");return Nv(e)==="symbol"?e:String(e)}function sDe(t,e){if(Nv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Nv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var lDe=function(){function t(e){nDe(this,t),this.hot=e,this.commands={},this.commonCallback=null}return oDe(t,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];var s=r.split(":"),l=s[0],u=s.length===2?s[1]:null,c=this.commands[l];if(!c)throw new Error("Menu command '".concat(l,"' not exists."));if(u&&c.submenu&&(c=uDe(u,c.submenu.items)),c.disabled!==!0&&!(typeof c.disabled=="function"&&c.disabled.call(this.hot)===!0)&&!wr(c,"submenu")){var f=[];typeof c.callback=="function"&&f.push(c.callback),typeof this.commonCallback=="function"&&f.push(this.commonCallback),o.unshift(s.join(":")),D(f,function(h){return h.apply(n.hot,o)})}}}]),t}();function uDe(t,e){var r;return D(e,function(n){var i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}const jG=lDe;var Si="alignment";function cDe(){return{key:Si,name:function(){return this.getTranslatedPhrase(jA)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(Si,":left"),name:function(){var e=this,r=this.getTranslatedPhrase(WA),n=Eo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htLeft")!==-1)return!0});return n&&(r=la(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=vl(r,function(a,s){return e.getCellMeta(a,s).className}),i="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",n,r,i,o),hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(Si,":center"),name:function(){var e=this,r=this.getTranslatedPhrase(GA),n=Eo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htCenter")!==-1)return!0});return n&&(r=la(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=vl(r,function(a,s){return e.getCellMeta(a,s).className}),i="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",n,r,i,o),hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(Si,":right"),name:function(){var e=this,r=this.getTranslatedPhrase(zA),n=Eo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htRight")!==-1)return!0});return n&&(r=la(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=vl(r,function(a,s){return e.getCellMeta(a,s).className}),i="horizontal",o="htRight";this.runHooks("beforeCellAlignment",n,r,i,o),hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(Si,":justify"),name:function(){var e=this,r=this.getTranslatedPhrase(YA),n=Eo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htJustify")!==-1)return!0});return n&&(r=la(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=vl(r,function(a,s){return e.getCellMeta(a,s).className}),i="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",n,r,i,o),hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{name:at},{key:"".concat(Si,":top"),name:function(){var e=this,r=this.getTranslatedPhrase(KA),n=Eo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htTop")!==-1)return!0});return n&&(r=la(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=vl(r,function(a,s){return e.getCellMeta(a,s).className}),i="vertical",o="htTop";this.runHooks("beforeCellAlignment",n,r,i,o),hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(Si,":middle"),name:function(){var e=this,r=this.getTranslatedPhrase(XA),n=Eo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htMiddle")!==-1)return!0});return n&&(r=la(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=vl(r,function(a,s){return e.getCellMeta(a,s).className}),i="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",n,r,i,o),hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(Si,":bottom"),name:function(){var e=this,r=this.getTranslatedPhrase(qA),n=Eo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htBottom")!==-1)return!0});return n&&(r=la(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=vl(r,function(a,s){return e.getCellMeta(a,s).className}),i="vertical",o="htBottom";this.runHooks("beforeCellAlignment",n,r,i,o),hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1}]}}}var Bw="clear_column";function fDe(){return{key:Bw,name:function(){return this.getTranslatedPhrase(IA)},callback:function(e,r){var n=r[0].start.col,i=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),i,"ContextMenu.clearColumn")},disabled:function(){var e=Bu(this);return e?!this.selection.isSelectedByColumnHeader():!0}}}var Jg="col_left";function hDe(){return{key:Jg,name:function(){return this.getTranslatedPhrase(RA)},callback:function(){var e=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,e.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=Bu(this);if(!e)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var ey="col_right";function dDe(){return{key:ey,name:function(){return this.getTranslatedPhrase(EA)},callback:function(){var e=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,e.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=Bu(this);return e?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var ty="make_read_only";function pDe(){return{key:ty,name:function(){var e=this,r=this.getTranslatedPhrase(AA),n=Eo(this.getSelectedRange(),function(i,o){return e.getCellMeta(i,o).readOnly});return n&&(r=la(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=Eo(r,function(i,o){return e.getCellMeta(i,o).readOnly});D(r,function(i){i.forAll(function(o,a){o>=0&&a>=0&&e.setCellMeta(o,a,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var Vw="redo";function mDe(){return{key:Vw,name:function(){return this.getTranslatedPhrase(_A)},callback:function(){this.redo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function vDe(t,e){return wDe(t)||bDe(t,e)||yDe(t,e)||gDe()}function gDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yDe(t,e){if(t){if(typeof t=="string")return Hk(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Hk(t,e)}}function Hk(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function bDe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function wDe(t){if(Array.isArray(t))return t}var ry="remove_col";function SDe(){return{key:ry,name:function(){var e=this.getSelected(),r=0;if(e)if(e.length>1)r=1;else{var n=vDe(e[0],4),i=n[1],o=n[3];i-o!==0&&(r=1)}return this.getTranslatedPhrase(OA,r)},callback:function(){this.alter("remove_col",P5e(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=Bu(this);if(!e)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function RDe(t,e){return TDe(t)||ODe(t,e)||CDe(t,e)||EDe()}function EDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CDe(t,e){if(t){if(typeof t=="string")return Uk(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Uk(t,e)}}function Uk(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ODe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function TDe(t){if(Array.isArray(t))return t}var jw="remove_row";function _De(){return{key:jw,name:function(){var e=this.getSelected(),r=0;if(e)if(e.length>1)r=1;else{var n=RDe(e[0],3),i=n[0],o=n[2];i-o!==0&&(r=1)}return this.getTranslatedPhrase(CA,r)},callback:function(){this.alter("remove_row",M5e(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var e=Bu(this);if(!e)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var Ww="row_above";function ADe(){return{key:Ww,name:function(){return this.getTranslatedPhrase(wA)},callback:function(){var e=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",e.row,1,"ContextMenu.rowAbove")},disabled:function(){var e=Bu(this);if(!e)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var Gw="row_below";function IDe(){return{key:Gw,name:function(){return this.getTranslatedPhrase(SA)},callback:function(){var e=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",e.row,1,"ContextMenu.rowBelow")},disabled:function(){var e=Bu(this);return e?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var Pv="no_items";function NDe(){return{key:Pv,name:function(){return this.getTranslatedPhrase(bA)},disabled:!0,isCommand:!1}}var zw="undo";function PDe(){return{key:zw,name:function(){return this.getTranslatedPhrase(TA)},callback:function(){this.undo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function Mv(t){"@babel/helpers - typeof";return Mv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mv(t)}var Sn;function Qn(t,e,r){return e=MDe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MDe(t){var e=kDe(t,"string");return Mv(e)==="symbol"?e:String(e)}function kDe(t,e){if(Mv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Mv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xDe=[Ww,Gw,Jg,ey,Bw,jw,ry,zw,Vw,ty,Si,at,Pv],$De=(Sn={},Qn(Sn,at,ILe),Qn(Sn,Pv,NDe),Qn(Sn,Ww,ADe),Qn(Sn,Gw,IDe),Qn(Sn,Jg,hDe),Qn(Sn,ey,dDe),Qn(Sn,Bw,fDe),Qn(Sn,jw,_De),Qn(Sn,ry,SDe),Qn(Sn,zw,PDe),Qn(Sn,Vw,mDe),Qn(Sn,ty,pDe),Qn(Sn,Si,cDe),Sn);function WG(){var t={};return ut($De,function(e,r){t[r]=e()}),t}function kv(t){"@babel/helpers - typeof";return kv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kv(t)}function LDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function DDe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,HDe(n.key),n)}}function FDe(t,e,r){return e&&DDe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function HDe(t){var e=UDe(t,"string");return kv(e)==="symbol"?e:String(e)}function UDe(t,e){if(kv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(kv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var BDe=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;LDe(this,t),this.hot=e,this.predefinedItems=WG(),this.defaultOrderPattern=r}return FDe(t,[{key:"setPredefinedItems",value:function(r){var n=this,i={};this.defaultOrderPattern.length=0,ut(r,function(o,a){var s="";o.name===at?(i[at]=o,s=at):isNaN(parseInt(a,10))?(o.key=o.key===void 0?a:o.key,i[a]=o,s=o.key):(i[o.key]=o,s=o.key),n.defaultOrderPattern.push(s)}),this.predefinedItems=i}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return VDe(r,this.defaultOrderPattern,this.predefinedItems)}}]),t}();function VDe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),lt(i)?ut(i,function(o,a){var s=r[typeof o=="string"?o:a];s||(s=o),lt(o)?$r(s,o):typeof s=="string"&&(s={name:s}),s.key===void 0&&(s.key=a),n.push(s)}):D(i,function(o,a){var s=r[o];!s&&xDe.indexOf(o)>=0||(s||(s={name:o,key:"".concat(a)}),lt(o)&&$r(s,o),s.key===void 0&&(s.key=a),n.push(s))}),n}const GG=BDe;function xv(t){"@babel/helpers - typeof";return xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xv(t)}function jDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WDe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,zDe(n.key),n)}}function GDe(t,e,r){return e&&WDe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function zDe(t){var e=YDe(t,"string");return xv(e)==="symbol"?e:String(e)}function YDe(t,e){if(xv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(xv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var KDe=function(){function t(e,r){jDe(this,t);var n=nm(r),i=ff(r),o,a,s,l,u,c;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),s=parseInt(e.left,10),u=e.height||0,c=e.width||0,a=o,l=s,o+=n,s+=i):this.type==="event"&&(o=parseInt(e.pageY,10),s=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,a=o-n,l=s-i),this.top=o,this.topRelative=a,this.left=s,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}return GDe(t,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),t}();const XDe=KDe;function $v(t){"@babel/helpers - typeof";return $v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$v(t)}function Bk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Vk(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Bk(Object(r),!0).forEach(function(n){qDe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Bk(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qDe(t,e,r){return e=zG(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ZDe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,zG(n.key),n)}}function JDe(t,e,r){return e&&ZDe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function zG(t){var e=eFe(t,"string");return $v(e)==="symbol"?e:String(e)}function eFe(t,e){if($v(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if($v(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jk=215,YG="menu",tFe=YG,KG=function(){function t(e,r){QDe(this,t),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:jk,container:this.hot.rootDocument.documentElement},this.eventManager=new hr(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return JDe(t,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(i){return r.onDocumentMouseDown(i)}),this.eventManager.addEventListener(n.document,"contextmenu",function(i){return r.onDocumentContextMenu(i)}),n=K0(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=WH(function(d){return r.openSubMenu(d)},300),i=this.options.minWidth||jk,o=!1,a=_i(this.menuItems,function(d){return d.key===Pv&&(o=!0),$Le(d,r.hot)});if(a.length<1&&!o)a.push(WG()[Pv]);else if(a.length===0)return;a=FLe(a,at);var s=!1,l={data:a,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(p){return Ae(p)&&p<i?i:p},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(p,m,y,S,R,E){return r.menuItemRenderer(p,m,y,S,R,E)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(p,m){r.isAllSubMenusClosed()?n(m.row):r.openSubMenu(m.row)},rowHeights:function(p){return a[p].name===at?1:23},afterOnCellContextMenu:function(p){p.preventDefault(),jP()&&s&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(p){r.hasSelectedItem()&&(s=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(p))},afterOnCellMouseUp:function(p){(!jP()||!pu(p))&&s&&r.hasSelectedItem()&&(Ao()||jF()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new V7(this.container,l),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var u=this.hotMenu.getShortcutManager(),c=u.addContext(tFe),f={group:YG},h=Vk(Vk({},f),{},{runOnlyIf:function(p){return Q0(p.target)===!1||r.container.contains(p.target)===!1}});u.setActiveContextName("menu"),c.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var p=r.hotMenu.getSelectedLast();r.keyEvent=!0,p?r.selectNextCell(p[0],p[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var p=r.hotMenu.getSelectedLast();r.keyEvent=!0,p?r.selectPrevCell(p[0],p[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var p=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,p){var m=r.openSubMenu(p[0]);m&&m.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var p=r.hotMenu.getSelectedLast();r.keyEvent=!0,p&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(p){var m=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow(m[0]).submenu||(r.executeCommand(p),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var p=r.hotMenu.getSelectedLast();r.keyEvent=!0,p?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var p=r.hotMenu.getSelectedLast();r.keyEvent=!0,p?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!PLe(n))return!1;var i=this.hotMenu.getSourceDataAtRow(r),o=new t(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(i.submenu.items),o.open(),o.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=o,o}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),i=this.hotSubMenus[n.key];i&&(i.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;D(this.hotMenu.getData(),function(n,i){return r.closeSubMenu(i)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var i=this.hot.getSelectedRange(),o=i?NLe(i):[];this.runLocalHooks("executeCommand",n.key,o,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,o,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,i=r.name,o=r.disabled,a=r.submenu,s=o===!0||typeof o=="function"&&o.call(this.hot)===!0;return n===!1||i===at||s===!0||a}},{key:"setPosition",value:function(r){var n=new XDe(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var i=this.parentMenu.container.getBoundingClientRect(),o=i.right;n+=r.cellWidth+o-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var i=this.parentMenu.container.getBoundingClientRect(),o=i.left;n-=r.left-o}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);o1(r)||a1(r)||s1(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);o1(n)||a1(n)||s1(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var i=r+1,o=i<this.hotMenu.countRows()?this.hotMenu.getCell(i,n):null;o&&(o1(o)||a1(o)||s1(o)?this.selectNextCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"selectPrevCell",value:function(r,n){var i=r-1,o=i>=0?this.hotMenu.getCell(i,n):null;o&&(o1(o)||a1(o)||s1(o)?this.selectPrevCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"menuItemRenderer",value:function(r,n,i,o,a,s){var l=this,u=r.getSourceDataAtRow(i),c=this.hot.rootDocument.createElement("div"),f=function(S){return wr(S,"submenu")},h=function(S){return new RegExp(at,"i").test(S.name)},d=function(S){return S.disabled===!0||typeof S.disabled=="function"&&S.disabled.call(l.hot)===!0},p=function(S){return S.disableSelection},m=s;typeof m=="function"&&(m=m.call(this.hot)),$o(n),le(c,"htItemWrapper"),n.appendChild(c),h(u)?le(n,"htSeparator"):typeof u.renderer=="function"?(le(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,c,i,o,a,m))):Ed(c,m),d(u)?(le(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):p(u)?(le(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):f(u)?(le(n,"htSubmenu"),p(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(i,o,void 0,void 0,!1,!1)})):(qe(n,["htSubmenu","htDisabled"]),p(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(i,o,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,i=r,o;return i&&(Xt(i)&&(i=i.call(this.hot),i===null||zt(i)?i="":i=i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i="".concat(this.options.className,"Sub_").concat(i),o=n.querySelector(".".concat(this.options.className,".").concat(i))),o||(o=n.createElement("div"),le(o,"htMenu ".concat(this.options.className)),i&&le(o,i),this.options.container.appendChild(o)),o}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,i=r.hider.style,o=r.holder.style,a=parseInt(i.width,10),s=gn(n,function(l,u){return l+(u.name===at?1:26)},0);o.width="".concat(a+3,"px"),o.height="".concat(s+3,"px"),i.height=o.height}},{key:"onAfterSelection",value:function(r,n,i,o,a){this.keyEvent===!1&&(a.value=!0)}},{key:"onDocumentMouseDown",value:function(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!lu(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!lu(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){this.isOpened()&&Xe(r.target,"htCore")&&lu(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),t}();Kt(KG,Xn);const WI=KG;function vh(t){"@babel/helpers - typeof";return vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vh(t)}function rFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,iFe(n.key),n)}}function nFe(t,e,r){return e&&Wk(t.prototype,e),r&&Wk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function iFe(t){var e=oFe(t,"string");return vh(e)==="symbol"?e:String(e)}function oFe(t,e){if(vh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Fl(){return typeof Reflect<"u"&&Reflect.get?Fl=Reflect.get.bind():Fl=function(e,r,n){var i=aFe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Fl.apply(this,arguments)}function aFe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ba(t),t!==null););return t}function sFe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fO(t,e)}function fO(t,e){return fO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},fO(t,e)}function lFe(t){var e=cFe();return function(){var n=ba(t),i;if(e){var o=ba(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return uFe(this,i)}}function uFe(t,e){if(e&&(vh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XG(t)}function XG(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ba(t){return ba=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ba(t)}var c1="contextMenu",fFe=70;Ne.getSingleton().register("afterContextMenuDefaultOptions");Ne.getSingleton().register("beforeContextMenuShow");Ne.getSingleton().register("afterContextMenuShow");Ne.getSingleton().register("afterContextMenuHide");Ne.getSingleton().register("afterContextMenuExecute");var qG=function(t){sFe(r,t);var e=lFe(r);function r(n){var i;return rFe(this,r),i=e.call(this,n),i.eventManager=new hr(XG(i)),i.commandExecutor=new jG(i.hot),i.itemsFactory=null,i.menu=null,i}return nFe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[c1]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[c1];typeof o.callback=="function"&&this.commandExecutor.setCommonCallback(o.callback),this.menu=new WI(this.hot,{className:"htContextMenu",keepInViewport:!0,container:o.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var a,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return(a=i.executeCommand).call.apply(a,[i].concat(l))}),this.addHook("afterOnCellContextMenu",function(a){return i.onAfterOnCellContextMenu(a)}),Fl(ba(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Fl(ba(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),Fl(ba(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(i){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var o=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),u=l.top,c=l.left;o=u-nm(i.view),a=c-ff(i.view)}else o=-1*nm(this.menu.hotMenu.rootWindow),a=-1*ff(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(i.pageY,10)+o,left:parseInt(i.pageX,10)+a})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(i){var o;this.itemsFactory===null&&this.prepareMenuItems();for(var a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];(o=this.commandExecutor).execute.apply(o,[i].concat(s))}},{key:"prepareMenuItems",value:function(){var i=this;this.itemsFactory=new GG(this.hot,r.DEFAULT_ITEMS);var o=this.hot.getSettings()[c1],a={items:this.itemsFactory.getItems(o)};this.hot.runHooks("afterContextMenuDefaultOptions",a),this.itemsFactory.setPredefinedItems(a.items);var s=this.itemsFactory.getItems(o);this.hot.runHooks("beforeContextMenuSetItems",s),this.menu.setMenuItems(s),D(s,function(l){return i.commandExecutor.registerCommand(l.key,l)})}},{key:"onAfterOnCellContextMenu",value:function(i){var o=this.hot.getSettings(),a=o.rowHeaders,s=o.colHeaders;function l(c){return c.nodeName==="TD"||c.parentNode.nodeName==="TD"}var u=i.target;this.close(),!Xe(u,"handsontableInput")&&(i.preventDefault(),i.stopPropagation(),!(!(a||s)&&!l(u)&&!(Xe(u,"current")&&Xe(u,"wtBorder")))&&this.open(i))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Fl(ba(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return c1}},{key:"PLUGIN_PRIORITY",get:function(){return fFe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[Ww,Gw,at,Jg,ey,at,jw,ry,at,zw,Vw,at,ty,at,Si]}}]),r}(xt);qG.SEPARATOR={name:at};function hFe(t){return{key:"copy",name:function(){return this.getTranslatedPhrase(NA)},callback:function(){t.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function dFe(t){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(kA,n)},callback:function(){t.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function pFe(t){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(MA,n)},callback:function(){t.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function mFe(t){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(PA,n)},callback:function(){t.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function vFe(t){return{key:"cut",name:function(){return this.getTranslatedPhrase(xA)},callback:function(){t.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Lv(t){"@babel/helpers - typeof";return Lv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lv(t)}function gFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yFe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wFe(n.key),n)}}function bFe(t,e,r){return e&&yFe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function wFe(t){var e=SFe(t,"string");return Lv(e)==="symbol"?e:String(e)}function SFe(t,e){if(Lv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Lv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var RFe=function(){function t(){gFe(this,t),this.data={}}return bFe(t,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),t}();function EFe(t,e,r){return Object.defineProperty(t,"prototype",{writable:!1}),t}function CFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var OFe=EFe(function t(){CFe(this,t),this.clipboardData=new RFe});function Dv(t){"@babel/helpers - typeof";return Dv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dv(t)}function TFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _Fe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,IFe(n.key),n)}}function AFe(t,e,r){return e&&_Fe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function IFe(t){var e=NFe(t,"string");return Dv(e)==="symbol"?e:String(e)}function NFe(t,e){if(Dv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Dv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var GI=function(){function t(e){TFe(this,t),this.rootDocument=e.defaultView?e:e.ownerDocument,this.mainElement=null,this.eventManager=new hr(this),this.listenersCount=new WeakSet,this.container=e}return AFe(t,[{key:"useSecondaryElement",value:function(){var r=kFe(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),Gk(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),Gk(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",Ao()||dpe(this.mainElement)}}]),t}();Kt(GI,Xn);var l2=new WeakMap;function PFe(t){var e=new GI(t),r=l2.get(t);return r=isNaN(r)?0:r,l2.set(t,r+1),e}function MFe(t){t.eventManager.clear()}var oR=function(e,r){return function(n){return r.runLocalHooks(e,n)}};function Gk(t,e,r){t.addEventListener(e,"copy",oR("copy",r)),t.addEventListener(e,"cut",oR("cut",r)),t.addEventListener(e,"paste",oR("paste",r))}var u2=new WeakMap;function kFe(t){var e=u2.get(t);if(e)return e.parentElement||t.appendChild(e),e;var r=t.defaultView?t:t.ownerDocument,n=r.createElement("textarea");return u2.set(t,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",t.appendChild(n),n}function zk(t){if(t instanceof GI){var e=l2.get(t.container);if(e=isNaN(e)?0:e,e>0&&(e-=1),MFe(t),e<=0){e=0;var r=u2.get(t.container);r&&r.parentNode&&(r.parentNode.removeChild(r),u2.delete(t.container)),t.mainElement=null}l2.set(t.container,e)}}function Fv(t){"@babel/helpers - typeof";return Fv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fv(t)}function xFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $Fe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,DFe(n.key),n)}}function LFe(t,e,r){return e&&$Fe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function DFe(t){var e=FFe(t,"string");return Fv(e)==="symbol"?e:String(e)}function FFe(t,e){if(Fv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Fv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Yk(t,e){QG(t,e),e.add(t)}function hc(t,e,r){QG(t,e),e.set(t,r)}function QG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f1(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}function Cn(t,e){var r=ZG(t,e,"get");return HFe(t,r)}function HFe(t,e){return e.get?e.get.call(t):e.value}function dc(t,e,r){var n=ZG(t,e,"set");return UFe(t,n,r),r}function ZG(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function UFe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var is=new WeakMap,aR=new WeakMap,ep=new WeakMap,hO=new WeakMap,dO=new WeakMap,tp=new WeakMap,h1=new WeakSet,Kk=new WeakSet,BFe=function(){function t(e){var r=e.countRows,n=e.countColumns,i=e.rowsLimit,o=e.columnsLimit,a=e.countColumnHeaders;xFe(this,t),Yk(this,Kk),Yk(this,h1),hc(this,is,{writable:!0,value:void 0}),hc(this,aR,{writable:!0,value:void 0}),hc(this,ep,{writable:!0,value:void 0}),hc(this,hO,{writable:!0,value:void 0}),hc(this,dO,{writable:!0,value:void 0}),hc(this,tp,{writable:!0,value:void 0}),dc(this,aR,r),dc(this,ep,n),dc(this,hO,i),dc(this,dO,o),dc(this,tp,a)}return LFe(t,[{key:"setSelectedRange",value:function(r){dc(this,is,r)}},{key:"getCellsRange",value:function(){if(Cn(this,aR).call(this)===0||Cn(this,ep).call(this)===0)return null;var r=Cn(this,is).getTopStartCorner(),n=r.row,i=r.col,o=Cn(this,is).getBottomEndCorner(),a=o.row,s=o.col,l=f1(this,Kk,VFe).call(this,n,a),u=f1(this,h1,sR).call(this,i,s),c=a!==l||s!==u;return{isRangeTrimmed:c,startRow:n,startCol:i,endRow:l,endCol:u}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(Cn(this,ep).call(this)===0||Cn(this,tp).call(this)===0)return null;var r=Cn(this,is).getTopStartCorner(),n=r.col,i=Cn(this,is).getBottomEndCorner(),o=i.col,a=f1(this,h1,sR).call(this,n,o),s=o!==a;return{isRangeTrimmed:s,startRow:-1,startCol:n,endRow:-1,endCol:a}}},{key:"getAllColumnHeadersRange",value:function(){if(Cn(this,ep).call(this)===0||Cn(this,tp).call(this)===0)return null;var r=Cn(this,is).getTopStartCorner(),n=r.col,i=Cn(this,is).getBottomEndCorner(),o=i.col,a=f1(this,h1,sR).call(this,n,o),s=o!==a;return{isRangeTrimmed:s,startRow:-Cn(this,tp).call(this),startCol:n,endRow:-1,endCol:a}}}]),t}();function sR(t,e){return Math.min(e,Math.max(t+Cn(this,dO).call(this)-1,t))}function VFe(t,e){return Math.min(e,Math.max(t+Cn(this,hO).call(this)-1,t))}function JG(t){var e=[],r=[];return D(t,function(n){var i=Math.min(n.startRow,n.endRow),o=Math.max(n.startRow,n.endRow);De(i,o,function(l){e.indexOf(l)===-1&&e.push(l)});var a=Math.min(n.startCol,n.endCol),s=Math.max(n.startCol,n.endCol);De(a,s,function(l){r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function jFe(t,e){return YFe(t)||zFe(t,e)||GFe(t,e)||WFe()}function WFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GFe(t,e){if(t){if(typeof t=="string")return Xk(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xk(t,e)}}function Xk(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function zFe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function YFe(t){if(Array.isArray(t))return t}function Au(t){"@babel/helpers - typeof";return Au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Au(t)}function KFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tz(n.key),n)}}function XFe(t,e,r){return e&&qk(t.prototype,e),r&&qk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Hl(){return typeof Reflect<"u"&&Reflect.get?Hl=Reflect.get.bind():Hl=function(e,r,n){var i=qFe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Hl.apply(this,arguments)}function qFe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=wa(t),t!==null););return t}function QFe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pO(t,e)}function pO(t,e){return pO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},pO(t,e)}function ZFe(t){var e=eHe();return function(){var n=wa(t),i;if(e){var o=wa(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return JFe(this,i)}}function JFe(t,e){if(e&&(Au(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return En(t)}function En(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function eHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wa(t){return wa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wa(t)}function tHe(t,e){ez(t,e),e.add(t)}function gl(t,e,r){ez(t,e),e.set(t,r)}function ez(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pc(t,e,r){return e=tz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tz(t){var e=rHe(t,"string");return Au(e)==="symbol"?e:String(e)}function rHe(t,e){if(Au(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nHe(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}function Zn(t,e){var r=rz(t,e,"get");return iHe(t,r)}function iHe(t,e){return e.get?e.get.call(t):e.value}function Qo(t,e,r){var n=rz(t,e,"set");return oHe(t,n,r),r}function rz(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function oHe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}Ne.getSingleton().register("afterCopyLimit");Ne.getSingleton().register("modifyCopyableRange");Ne.getSingleton().register("beforeCut");Ne.getSingleton().register("afterCut");Ne.getSingleton().register("beforePaste");Ne.getSingleton().register("afterPaste");Ne.getSingleton().register("beforeCopy");Ne.getSingleton().register("afterCopy");var d1="copyPaste",aHe=80,sHe=["fragmentSelection"],Qk=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),lR=new WeakMap,uR=new WeakMap,cR=new WeakMap,mc=new WeakMap,p1=new WeakMap,m1=new WeakMap,vc=new WeakMap,Zk=new WeakSet,lHe=function(t){QFe(r,t);var e=ZFe(r);function r(){var n;KFe(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),tHe(En(n),Zk),pc(En(n),"columnsLimit",1/0),pc(En(n),"rowsLimit",1/0),pc(En(n),"pasteMode","overwrite"),pc(En(n),"uiContainer",n.hot.rootDocument.body),gl(En(n),lR,{writable:!0,value:!1}),gl(En(n),uR,{writable:!0,value:!1}),gl(En(n),cR,{writable:!0,value:!1}),gl(En(n),mc,{writable:!0,value:"cells-only"}),gl(En(n),p1,{writable:!0,value:!1}),gl(En(n),m1,{writable:!0,value:!1}),gl(En(n),vc,{writable:!0,value:new BFe({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),pc(En(n),"copyableRanges",[]),pc(En(n),"focusableElement",void 0),n}return XFe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[d1]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings(),a=o[d1];if(Au(a)==="object"){var s,l;this.pasteMode=(s=a.pasteMode)!==null&&s!==void 0?s:this.pasteMode,this.rowsLimit=isNaN(a.rowsLimit)?this.rowsLimit:a.rowsLimit,this.columnsLimit=isNaN(a.columnsLimit)?this.columnsLimit:a.columnsLimit,Qo(this,lR,!!a.copyColumnHeaders),Qo(this,uR,!!a.copyColumnGroupHeaders),Qo(this,cR,!!a.copyColumnHeadersOnly),this.uiContainer=(l=a.uiContainer)!==null&&l!==void 0?l:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(u){return i.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return i.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return i.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return i.onBeforeKeyDown()}),this.focusableElement=PFe(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return i.onCopy(u)}).addLocalHook("cut",function(u){return i.onCut(u)}).addLocalHook("paste",function(u){return i.onPaste(u)}),Hl(wa(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),Hl(wa(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&zk(this.focusableElement),Hl(wa(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Qo(this,mc,i),Qo(this,p1,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){Qo(this,m1,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(i){return Mp(this.getRangedData(i))}},{key:"getRangedData",value:function(i){var o=this,a=[],s=JG(i),l=s.rows,u=s.columns;return D(l,function(c){var f=[];D(u,function(h){c<0?f.push(o.hot.getColHeader(h,c)):f.push(o.hot.getCopyableData(c,h))}),a.push(f)}),a}},{key:"paste",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i;if(!(!i&&!o)){var a=new OFe;i&&a.clipboardData.setData("text/plain",i),o&&a.clipboardData.setData("text/html",o),this.getOrCreateFocusableElement(),this.onPaste(a)}}},{key:"setCopyableText",value:function(){var i=this.hot.getSelectedRangeLast();if(i){Zn(this,vc).setSelectedRange(i);var o=new Map([["headers",null],["cells",null]]);Zn(this,mc)==="column-headers-only"?o.set("headers",Zn(this,vc).getMostBottomColumnHeadersRange()):(Zn(this,mc)==="with-column-headers"?o.set("headers",Zn(this,vc).getMostBottomColumnHeadersRange()):Zn(this,mc)==="with-column-group-headers"&&o.set("headers",Zn(this,vc).getAllColumnHeadersRange()),o.set("cells",Zn(this,vc).getCellsRange())),this.copyableRanges=Array.from(o.values()).filter(function(f){return f!==null}).map(function(f){var h=f.startRow,d=f.startCol,p=f.endRow,m=f.endCol;return{startRow:h,startCol:d,endRow:p,endCol:m}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var a=o.get("cells");if(a!==null&&a.isRangeTrimmed){var s=a.startRow,l=a.startCol,u=a.endRow,c=a.endCol;this.hot.runHooks("afterCopyLimit",u-s+1,c-l+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var i,o=(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.TEXTAREA;o?this.focusableElement.setFocusableElement(o):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var i;return(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.isOpened()}},{key:"populateValues",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(i.length){for(var a=i.length,s=i[0].length,l=[],u=o.getTopStartCorner(),c=u.row,f=u.col,h=o.getBottomEndCorner(),d=h.row,p=h.col,m=c,y=f,S=c,R=f;l.length<a||m<=d;){var E=this.hot.getCellMeta(m,f),O=E.skipRowOnPaste,A=E.visualRow;if(m=A+1,O!==!0){S=A,y=f;for(var B=[],j=l.length%a;B.length<s||y<=p;){var J=this.hot.getCellMeta(c,y),Y=J.skipColumnOnPaste,q=J.visualCol;if(y=q+1,Y!==!0){R=q;var ee=B.length%s;B.push(i[j][ee])}}l.push(B)}}return this.hot.populateFromArray(c,f,l,void 0,void 0,"CopyPaste.paste",this.pasteMode),[c,f,S,R]}}},{key:"onCopy",value:function(i){if(!(!this.hot.isListening()&&!Zn(this,p1)||this.isEditorOpened())){this.setCopyableText(),Qo(this,p1,!1);var o=this.getRangedData(this.copyableRanges),a=nHe(this,Zk,uHe).call(this,this.copyableRanges),s=!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,a);if(s){var l=Mp(o);if(i&&i.clipboardData){var u=$8(o,this.hot.rootDocument);i.clipboardData.setData("text/plain",l),i.clipboardData.setData("text/html",[Qk,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,a)}Qo(this,mc,"cells-only"),i.preventDefault()}}},{key:"onCut",value:function(i){if(!(!this.hot.isListening()&&!Zn(this,m1)||this.isEditorOpened())){this.setCopyableText(),Qo(this,m1,!1);var o=this.getRangedData(this.copyableRanges),a=!!this.hot.runHooks("beforeCut",o,this.copyableRanges);if(a){var s=Mp(o);if(i&&i.clipboardData){var l=$8(o,this.hot.rootDocument);i.clipboardData.setData("text/plain",s),i.clipboardData.setData("text/html",[Qk,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}i.preventDefault()}}},{key:"onPaste",value:function(i){if(!(!this.hot.isListening()||this.isEditorOpened())){i&&i.preventDefault&&i.preventDefault();var o;if(i&&typeof i.clipboardData<"u"){var a=Y_(i.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(a&&/(<table)|(<TABLE)/g.test(a)){var s=ove(a,this.hot.rootDocument);o=s.data}else o=i.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=eOe(o)),!(o&&o.length===0)&&this.hot.runHooks("beforePaste",o,this.copyableRanges)!==!1){var l=this.populateValues(o),u=jFe(l,4),c=u[0],f=u[1],h=u[2],d=u[3];this.hot.selectCell(c,f,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:"---------"},hFe(this)),Zn(this,lR)&&i.items.push(mFe(this)),Zn(this,uR)&&i.items.push(pFe(this)),Zn(this,cR)&&i.items.push(dFe(this)),i.items.push(vFe(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&upe())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var i=this.hot.rootDocument.activeElement,o=this.hot.getActiveEditor();!o||i!==this.focusableElement.getFocusableElement()&&i!==o.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(zk(this.focusableElement),this.focusableElement=null),Hl(wa(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return d1}},{key:"SETTING_KEYS",get:function(){return[d1].concat(sHe)}},{key:"PLUGIN_PRIORITY",get:function(){return aHe}}]),r}(xt);function uHe(t){for(var e=JG(t),r=e.rows,n=0,i=0;i<r.length&&!(r[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function nz(t,e){return"border_row".concat(t,"col").concat(e)}function Sp(){return{width:1,color:"#000"}}function Sa(){return{hide:!0}}function cHe(){return{width:1,color:"#000",cornerVisible:!1}}function fR(t){if(Ae(t.start)||Ae(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(Ae(t.end)||Ae(t.right)){var r;t.end=(r=t.end)!==null&&r!==void 0?r:t.right}return delete t.left,delete t.right,t}function rp(t){return Ae(t.start)&&(t.left=t.start),Ae(t.end)&&(t.right=t.end),t}function hR(t,e){return{id:nz(t,e),border:cHe(),row:t,col:e,top:Sa(),bottom:Sa(),start:Sa(),end:Sa()}}function fHe(t,e){return wr(e,"border")&&e.border&&(t.border=e.border),wr(e,"top")&&Ae(e.top)&&(e.top?(lt(e.top)||(e.top=Sp()),t.top=e.top):(e.top=Sa(),t.top=e.top)),wr(e,"bottom")&&Ae(e.bottom)&&(e.bottom?(lt(e.bottom)||(e.bottom=Sp()),t.bottom=e.bottom):(e.bottom=Sa(),t.bottom=e.bottom)),wr(e,"start")&&Ae(e.start)&&(e.start?(lt(e.start)||(e.start=Sp()),t.start=e.start):(e.start=Sa(),t.start=e.start)),wr(e,"end")&&Ae(e.end)&&(e.end?(lt(e.end)||(e.end=Sp()),t.end=e.end):(e.end=Sa(),t.end=e.end)),t}function Ga(t,e){var r=!1;return D(t.getSelectedRange(),function(n){n.forAll(function(i,o){if(!(i<0||o<0)){var a=t.getCellMeta(i,o).borders;if(a)if(e){if(!wr(a[e],"hide")||a[e].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function Yw(t){return'<span class="selected">'.concat("✓","</span>").concat(t)}function hHe(t){return t.some(function(e){return Ae(e.left)||Ae(e.right)})}function dHe(t){return t.some(function(e){return Ae(e.start)||Ae(e.end)})}var pHe=new Map([["left","start"],["right","end"]]);function mHe(t){var e;return(e=pHe.get(t))!==null&&e!==void 0?e:t}function vHe(t){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(e7),n=Ga(this,"bottom");return n&&(r=Yw(r)),r},callback:function(r,n){var i=Ga(this,"bottom");t.prepareBorder(n,"bottom",i)}}}function gHe(t){var e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(t7),i=Ga(this,e);return i&&(n=Yw(n)),n},callback:function(n,i){var o=Ga(this,e);t.prepareBorder(i,e,o)}}}function yHe(t){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(r7)},callback:function(r,n){t.prepareBorder(n,"noBorders")},disabled:function(){return!Ga(this)}}}function bHe(t){var e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(JA),i=Ga(this,e);return i&&(n=Yw(n)),n},callback:function(n,i){var o=Ga(this,e);t.prepareBorder(i,e,o)}}}function wHe(t){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(ZA),n=Ga(this,"top");return n&&(r=Yw(r)),r},callback:function(r,n){var i=Ga(this,"top");t.prepareBorder(n,"top",i)}}}function gh(t){"@babel/helpers - typeof";return gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gh(t)}function Jk(t,e){return CHe(t)||EHe(t,e)||RHe(t,e)||SHe()}function SHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RHe(t,e){if(t){if(typeof t=="string")return ex(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ex(t,e)}}function ex(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function EHe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function CHe(t){if(Array.isArray(t))return t}function OHe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,oz(n.key),n)}}function THe(t,e,r){return e&&tx(t.prototype,e),r&&tx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ul(){return typeof Reflect<"u"&&Reflect.get?Ul=Reflect.get.bind():Ul=function(e,r,n){var i=_He(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Ul.apply(this,arguments)}function _He(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ra(t),t!==null););return t}function AHe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mO(t,e)}function mO(t,e){return mO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mO(t,e)}function IHe(t){var e=PHe();return function(){var n=Ra(t),i;if(e){var o=Ra(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return NHe(this,i)}}function NHe(t,e){if(e&&(gh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iz(t)}function iz(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function PHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ra(t){return Ra=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ra(t)}function MHe(t,e,r){return e=oz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oz(t){var e=kHe(t,"string");return gh(e)==="symbol"?e:String(e)}function kHe(t,e){if(gh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var v1="customBorders",xHe=90,$He=function(t){AHe(r,t);var e=IHe(r);function r(){var n;OHe(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),MHe(iz(n),"savedBorders",[]),n}return THe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[v1]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(o){return i.onAfterContextMenuDefaultOptions(o)}),this.addHook("init",function(){return i.onAfterInit()}),Ul(Ra(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),Ul(Ra(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),Ul(Ra(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(i,o){var a=this,s=["top","bottom","start","end"],l=null;o&&(this.checkSettingsCohesion([o]),s=Object.keys(o),l=fR(o));var u=Lf(i),c=ev(u);D(i,function(f){for(var h=c(f),d=Jk(h,4),p=d[0],m=d[1],y=d[2],S=d[3],R=function(A){for(var B=function(Y){D(s,function(q){a.prepareBorderFromCustomAdded(A,Y,l,mHe(q))})},j=m;j<=S;j+=1)B(j)},E=p;E<=y;E+=1)R(E)}),this.hot.view.render()}},{key:"getBorders",value:function(i){var o=this;if(!Array.isArray(i))return this.savedBorders;var a=Lf(i),s=ev(a),l=[];return D(i,function(u){for(var c=s(u),f=Jk(c,4),h=f[0],d=f[1],p=f[2],m=f[3],y=function(E){for(var O=function(j){D(o.savedBorders,function(J){J.row===E&&J.col===j&&l.push(rp(J))})},A=d;A<=m;A+=1)O(A)},S=h;S<=p;S+=1)y(S)}),l}},{key:"clearBorders",value:function(i){var o=this;i?this.setBorders(i):(D(this.savedBorders,function(a){o.clearBordersFromSelectionSettings(a.id),o.clearNullCellRange(),o.hot.removeCellMeta(a.row,a.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(i,o){var a=this.checkSavedBorders(i);a||this.savedBorders.push(i);var s=this.hot._createCellRange(this.hot._createCellCoords(i.row,i.col)),l=this.checkCustomSelections(i,s,o);l||this.hot.selection.highlight.addCustomSelection({border:i,visualCellRange:s})}},{key:"prepareBorderFromCustomAdded",value:function(i,o,a,s){var l=this.hot.countRows(),u=this.hot.countCols();if(!(i>=l||o>=u)){var c=hR(i,o);a&&(c=fHe(c,a),D(this.hot.selection.highlight.customSelections,function(f){if(c.id===f.settings.id)return Object.assign(f.settings,a),c.id=f.settings.id,c.top=f.settings.top,c.bottom=f.settings.bottom,c.start=f.settings.start,c.end=f.settings.end,!1})),this.hot.setCellMeta(i,o,"borders",rp(c)),this.insertBorderIntoSettings(c,s)}}},{key:"prepareBorderFromCustomAddedRange",value:function(i,o){var a=this,s=Math.min(i.to.row,this.hot.countRows()-1),l=Math.min(i.to.col,this.hot.countCols()-1);De(i.from.row,s,function(u){De(i.from.col,l,function(c){var f=hR(u,c),h=0;u===i.from.row&&wr(o,"top")&&(h+=1,f.top=o.top),u===i.to.row&&wr(o,"bottom")&&(h+=1,f.bottom=o.bottom),c===i.from.col&&wr(o,"start")&&(h+=1,f.start=o.start),c===i.to.col&&wr(o,"end")&&(h+=1,f.end=o.end),h>0&&(a.hot.setCellMeta(u,c,"borders",rp(f)),a.insertBorderIntoSettings(f))})})}},{key:"removeAllBorders",value:function(i,o){var a=nz(i,o);this.spliceBorder(a),this.clearBordersFromSelectionSettings(a),this.clearNullCellRange(),this.hot.removeCellMeta(i,o,"borders")}},{key:"setBorder",value:function(i,o,a,s){var l=this.hot.getCellMeta(i,o).borders;if(!l||l.border===void 0?l=hR(i,o):l=fR(l),s){l[a]=Sa();var u=this.countHide(l);if(u===4)this.removeAllBorders(i,o);else{var c=this.checkCustomSelectionsFromContextMenu(l,a,s);c||this.insertBorderIntoSettings(l),this.hot.setCellMeta(i,o,"borders",rp(l))}}else{l[a]=Sp();var f=this.checkCustomSelectionsFromContextMenu(l,a,s);f||this.insertBorderIntoSettings(l),this.hot.setCellMeta(i,o,"borders",rp(l))}}},{key:"prepareBorder",value:function(i,o,a){var s=this;D(i,function(l){var u=l.start,c=l.end;if(u.row===c.row&&u.col===c.col)o==="noBorders"?s.removeAllBorders(u.row,u.col):s.setBorder(u.row,u.col,o,a);else switch(o){case"noBorders":De(u.col,c.col,function(f){De(u.row,c.row,function(h){s.removeAllBorders(h,f)})});break;case"top":De(u.col,c.col,function(f){s.setBorder(u.row,f,o,a)});break;case"bottom":De(u.col,c.col,function(f){s.setBorder(c.row,f,o,a)});break;case"start":De(u.row,c.row,function(f){s.setBorder(f,u.col,o,a)});break;case"end":De(u.row,c.row,function(f){s.setBorder(f,c.col,o,a)});break}})}},{key:"createCustomBorders",value:function(i){var o=this;D(i,function(a){var s=fR(a);a.range?o.prepareBorderFromCustomAddedRange(a.range,s):o.prepareBorderFromCustomAdded(a.row,a.col,s)})}},{key:"countHide",value:function(i){var o=i.top,a=i.bottom,s=i.start,l=i.end,u=[o,a,s,l];return gn(u,function(c,f){var h=c;return f&&f.hide&&(h+=1),h},0)}},{key:"clearBordersFromSelectionSettings",value:function(i){var o=st(this.hot.selection.highlight.customSelections,function(a){return a.settings.id}).indexOf(i);o>-1&&this.hot.selection.highlight.customSelections[o].clear()}},{key:"clearNullCellRange",value:function(){var i=this;D(this.hot.selection.highlight.customSelections,function(o,a){if(o.cellRange===null)return i.hot.selection.highlight.customSelections[a].destroy(),i.hot.selection.highlight.customSelections.splice(a,1),!1})}},{key:"hideBorders",value:function(){var i=this;D(this.savedBorders,function(o){i.clearBordersFromSelectionSettings(o.id),i.clearNullCellRange()})}},{key:"spliceBorder",value:function(i){var o=st(this.savedBorders,function(a){return a.id}).indexOf(i);o>-1&&this.savedBorders.splice(o,1)}},{key:"checkSavedBorders",value:function(i){var o=this,a=!1,s=this.countHide(i);return s===4?(this.spliceBorder(i.id),a=!0):D(this.savedBorders,function(l,u){if(i.id===l.id)return o.savedBorders[u]=i,a=!0,!1}),a}},{key:"checkCustomSelectionsFromContextMenu",value:function(i,o,a){var s=!1;return D(this.hot.selection.highlight.customSelections,function(l){if(i.id===l.settings.id)return ut(l.instanceBorders,function(u){u.toggleHiddenClass(o,a)}),s=!0,!1}),s}},{key:"checkCustomSelections",value:function(i,o,a){var s=this.countHide(i),l=!1;return s===4?(this.removeAllBorders(i.row,i.col),l=!0):D(this.hot.selection.highlight.customSelections,function(u){if(i.id===u.settings.id)return u.visualCellRange=o,u.commit(),a&&ut(u.instanceBorders,function(c){c.changeBorderStyle(a,i)}),l=!0,!1}),l}},{key:"changeBorderSettings",value:function(){var i=this.hot.getSettings()[v1];if(Array.isArray(i)){var o=An(i);this.checkSettingsCohesion(o),o.length||(this.savedBorders=o),this.createCustomBorders(o)}else i!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(i){var o=hHe(i),a=dHe(i);if(o&&a)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&o)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(i){this.hot.getSettings()[v1]&&i.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(QA)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[wHe(this),bHe(this),vHe(this),gHe(this),yHe(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){Ul(Ra(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return v1}},{key:"PLUGIN_PRIORITY",get:function(){return xHe}}]),r}(xt);function yh(t){"@babel/helpers - typeof";return yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yh(t)}function LHe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,FHe(n.key),n)}}function DHe(t,e,r){return e&&rx(t.prototype,e),r&&rx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function FHe(t){var e=HHe(t,"string");return yh(e)==="symbol"?e:String(e)}function HHe(t,e){if(yh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Bl(){return typeof Reflect<"u"&&Reflect.get?Bl=Reflect.get.bind():Bl=function(e,r,n){var i=UHe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Bl.apply(this,arguments)}function UHe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ea(t),t!==null););return t}function BHe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vO(t,e)}function vO(t,e){return vO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vO(t,e)}function VHe(t){var e=WHe();return function(){var n=Ea(t),i;if(e){var o=Ea(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return jHe(this,i)}}function jHe(t,e){if(e&&(yh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return az(t)}function az(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function WHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ea(t){return Ea=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ea(t)}var nx="dragToScroll",GHe=100,zHe=function(t){BHe(r,t);var e=VHe(r);function r(n){var i;return LHe(this,r),i=e.call(this,n),i.eventManager=new hr(az(i)),i.boundaries=null,i.callback=null,i.listening=!1,i}return DHe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[nx]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(o){return i.setupListening(o)}),this.addHook("afterOnCellCornerMouseDown",function(o){return i.setupListening(o)}),this.registerEvents(),Bl(Ea(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Bl(Ea(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),Bl(Ea(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(i){this.boundaries=i}},{key:"setCallback",value:function(i){this.callback=i}},{key:"check",value:function(i,o){var a=0,s=0;o<this.boundaries.top?s=o-this.boundaries.top:o>this.boundaries.bottom&&(s=o-this.boundaries.bottom),i<this.boundaries.left?a=i-this.boundaries.left:i>this.boundaries.right&&(a=i-this.boundaries.right),this.callback(a,s)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var i=this,o=this.hot.rootWindow,a=o;a;)this.eventManager.addEventListener(a.document,"contextmenu",function(){return i.unlisten()}),this.eventManager.addEventListener(a.document,"mouseup",function(){return i.unlisten()}),this.eventManager.addEventListener(a.document,"mousemove",function(s){return i.onMouseMove(s)}),a=K0(a)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(i){if(!pu(i)){var o=this.hot.view._wt.wtTable.holder;o!==this.hot.rootWindow&&(this.setBoundaries(o.getBoundingClientRect()),this.setCallback(function(a,s){a<0?o.scrollLeft-=50:a>0&&(o.scrollLeft+=50),s<0?o.scrollTop-=20:s>0&&(o.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(i){this.isListening()&&this.check(i.clientX,i.clientY)}},{key:"destroy",value:function(){Bl(Ea(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return nx}},{key:"PLUGIN_PRIORITY",get:function(){return GHe}}]),r}(xt);function bh(t){"@babel/helpers - typeof";return bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bh(t)}function YHe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ix(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,XHe(n.key),n)}}function KHe(t,e,r){return e&&ix(t.prototype,e),r&&ix(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function XHe(t){var e=qHe(t,"string");return bh(e)==="symbol"?e:String(e)}function qHe(t,e){if(bh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Vl(){return typeof Reflect<"u"&&Reflect.get?Vl=Reflect.get.bind():Vl=function(e,r,n){var i=QHe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Vl.apply(this,arguments)}function QHe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ca(t),t!==null););return t}function ZHe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gO(t,e)}function gO(t,e){return gO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},gO(t,e)}function JHe(t){var e=tUe();return function(){var n=Ca(t),i;if(e){var o=Ca(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return eUe(this,i)}}function eUe(t,e){if(e&&(bh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sz(t)}function sz(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ca(t){return Ca=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ca(t)}Ne.getSingleton().register("afterDropdownMenuDefaultOptions");Ne.getSingleton().register("beforeDropdownMenuShow");Ne.getSingleton().register("afterDropdownMenuShow");Ne.getSingleton().register("afterDropdownMenuHide");Ne.getSingleton().register("afterDropdownMenuExecute");var dR="dropdownMenu",rUe=230,pR="changeType",lz=function(t){ZHe(r,t);var e=JHe(r);function r(n){var i;return YHe(this,r),i=e.call(this,n),i.eventManager=new hr(sz(i)),i.commandExecutor=new jG(i.hot),i.itemsFactory=null,i.menu=null,i.hot.addHook("afterGetColHeader",function(o,a){return i.onAfterGetColHeader(o,a)}),i}return KHe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[dR]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.itemsFactory=new GG(this.hot,r.DEFAULT_ITEMS);var o=this.hot.getSettings()[dR],a={items:this.itemsFactory.getItems(o)};this.registerEvents(),typeof o.callback=="function"&&this.commandExecutor.setCommonCallback(o.callback),Vl(Ca(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){i.hot.runHooks("afterDropdownMenuDefaultOptions",a),i.itemsFactory.setPredefinedItems(a.items);var s=i.itemsFactory.getItems(o);i.menu&&i.menu.destroy(),i.menu=new WI(i.hot,{className:"htDropdownMenu",keepInViewport:!0,container:o.uiContainer||i.hot.rootDocument.body}),i.hot.runHooks("beforeDropdownMenuSetItems",s),i.menu.setMenuItems(s),i.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),i.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),i.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),i.menu.addLocalHook("executeCommand",function(){for(var l,u=arguments.length,c=new Array(u),f=0;f<u;f++)c[f]=arguments[f];return(l=i.executeCommand).call.apply(l,[i].concat(c))}),D(s,function(l){return i.commandExecutor.registerCommand(l.key,l)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Vl(Ca(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),Vl(Ca(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(o){return i.onTableClick(o)})}},{key:"open",value:function(i){this.menu&&(this.menu.open(),i.width&&this.menu.setOffset("left",i.width),this.menu.setPosition(i))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(i){for(var o,a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];(o=this.commandExecutor).execute.apply(o,[i].concat(s))}},{key:"setListening",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(i?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(i){if(i.stopPropagation(),Xe(i.target,pR)&&!this.menu.isOpened()){var o=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),u=l.top,c=l.left;o=u,a=c}var f=i.target.getBoundingClientRect();this.open({left:f.left+a,top:f.top+i.target.offsetHeight+3+o,width:f.width,height:f.height})}}},{key:"onAfterGetColHeader",value:function(i,o){var a=o.parentNode;if(a){var s=a.parentNode.childNodes,l=Array.prototype.indexOf.call(s,a);if(!(i<0||l!==s.length-1)){var u=o.querySelector(".".concat(pR));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var c=this.hot.rootDocument.createElement("button");c.className=pR,c.type="button",c.onclick=function(){return!1},o.firstChild.insertBefore(c,o.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Vl(Ca(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return dR}},{key:"PLUGIN_PRIORITY",get:function(){return rUe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[Jg,ey,at,ry,at,Bw,at,ty,at,Si]}}]),r}(xt);lz.SEPARATOR={name:at};function Hv(t){"@babel/helpers - typeof";return Hv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hv(t)}function nUe(t,e){return sUe(t)||aUe(t,e)||oUe(t,e)||iUe()}function iUe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oUe(t,e){if(t){if(typeof t=="string")return ox(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ox(t,e)}}function ox(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function aUe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function sUe(t){if(Array.isArray(t))return t}function lUe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function uUe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fUe(n.key),n)}}function cUe(t,e,r){return e&&uUe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function fUe(t){var e=hUe(t,"string");return Hv(e)==="symbol"?e:String(e)}function hUe(t,e){if(Hv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Hv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var dUe=function(){function t(e){lUe(this,t),this.hot=e,this.options={}}return cUe(t,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),i=n.startRow,o=n.startCol,a=n.endRow,s=n.endCol,l=this.options,u=[];return De(i,a,function(c){var f=[];!l.exportHiddenRows&&r._isHiddenRow(c)||(De(o,s,function(h){!l.exportHiddenColumns&&r._isHiddenColumn(h)||f.push(r.hot.getDataAtCell(c,h))}),u.push(f))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var i=this._getDataRange(),o=i.startRow,a=i.endRow,s=this.hot.getRowHeader();De(o,a,function(l){!r.options.exportHiddenRows&&r._isHiddenRow(l)||n.push(s[l])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var i=this._getDataRange(),o=i.startCol,a=i.endCol,s=this.hot.getColHeader();De(o,a,function(l){!r.options.exportHiddenColumns&&r._isHiddenColumn(l)||n.push(s[l])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,i=nUe(this.options.range,4),o=i[0],a=o===void 0?0:o,s=i[1],l=s===void 0?0:s,u=i[2],c=u===void 0?n:u,f=i[3],h=f===void 0?r:f;return a=Math.max(a,0),l=Math.max(l,0),c=Math.min(c,n),h=Math.min(h,r),{startRow:a,startCol:l,endRow:c,endCol:h}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),t}();const pUe=dUe;function Uv(t){"@babel/helpers - typeof";return Uv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uv(t)}function mUe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ax(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gUe(n.key),n)}}function vUe(t,e,r){return e&&ax(t.prototype,e),r&&ax(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function gUe(t){var e=yUe(t,"string");return Uv(e)==="symbol"?e:String(e)}function yUe(t,e){if(Uv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Uv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var bUe=function(){function t(e,r){mUe(this,t),this.dataProvider=e,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return vUe(t,[{key:"_mergeOptions",value:function(r){var n=Bn(this.constructor.DEFAULT_OPTIONS),i=new Date;return n=$r(Bn(t.DEFAULT_OPTIONS),n),n=$r(n,r),n.filename=UH(n.filename,{YYYY:i.getFullYear(),MM:"".concat(i.getMonth()+1).padStart(2,"0"),DD:"".concat(i.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),t}();const wUe=bUe;function wh(t){"@babel/helpers - typeof";return wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wh(t)}function SUe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,EUe(n.key),n)}}function RUe(t,e,r){return e&&sx(t.prototype,e),r&&sx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function EUe(t){var e=CUe(t,"string");return wh(e)==="symbol"?e:String(e)}function CUe(t,e){if(wh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function OUe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yO(t,e)}function yO(t,e){return yO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yO(t,e)}function TUe(t){var e=IUe();return function(){var n=c2(t),i;if(e){var o=c2(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _Ue(this,i)}}function _Ue(t,e){if(e&&(wh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AUe(t)}function AUe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function IUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function c2(t){return c2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},c2(t)}var NUe="\r",PUe='"',MUe=`
`,kUe=function(t){OUe(r,t);var e=TUe(r);function r(){return SUe(this,r),e.apply(this,arguments)}return RUe(r,[{key:"export",value:function(){var i=this,o=this.options,a=this.dataProvider.getData(),s=this.dataProvider.getColumnHeaders(),l=s.length>0,u=this.dataProvider.getRowHeaders(),c=u.length>0,f=o.bom?"\uFEFF":"";return l&&(s=st(s,function(h){return i._escapeCell(h,!0)}),c&&(f+=o.columnDelimiter),f+=s.join(o.columnDelimiter),f+=o.rowDelimiter),D(a,function(h,d){d>0&&(f+=o.rowDelimiter),c&&(f+=i._escapeCell(u[d])+o.columnDelimiter),f+=h.map(function(p){return i._escapeCell(p)}).join(o.columnDelimiter)}),f}},{key:"_escapeCell",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=Ar(i);return a!==""&&(o||a.indexOf(NUe)>=0||a.indexOf(PUe)>=0||a.indexOf(MUe)>=0||a.indexOf(this.options.columnDelimiter)>=0)&&(a=a.replace(new RegExp('"',"g"),'""'),a='"'.concat(a,'"')),a}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(wUe);const xUe=kUe;function Bv(t){"@babel/helpers - typeof";return Bv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bv(t)}function $Ue(t,e,r){return e=LUe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LUe(t){var e=DUe(t,"string");return Bv(e)==="symbol"?e:String(e)}function DUe(t,e){if(Bv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Bv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var FUe="csv",bO=$Ue({},FUe,xUe);function HUe(t,e,r){return typeof bO[t]=="function"?new bO[t](e,r):null}function Sh(t){"@babel/helpers - typeof";return Sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sh(t)}function UUe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,VUe(n.key),n)}}function BUe(t,e,r){return e&&lx(t.prototype,e),r&&lx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function VUe(t){var e=jUe(t,"string");return Sh(e)==="symbol"?e:String(e)}function jUe(t,e){if(Sh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function WUe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wO(t,e)}function wO(t,e){return wO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},wO(t,e)}function GUe(t){var e=KUe();return function(){var n=f2(t),i;if(e){var o=f2(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return zUe(this,i)}}function zUe(t,e){if(e&&(Sh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YUe(t)}function YUe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function KUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function f2(t){return f2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},f2(t)}var XUe="exportFile",qUe=240,QUe=function(t){WUe(r,t);var e=GUe(r);function r(){return UUe(this,r),e.apply(this,arguments)}return BUe(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(i,o).export()}},{key:"exportAsBlob",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(i,o))}},{key:"downloadFile",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.hot,s=a.rootDocument,l=a.rootWindow,u=this._createTypeFormatter(i,o),c=this._createBlob(u),f=l.URL||l.webkitURL,h=s.createElement("a"),d="".concat(u.options.filename,".").concat(u.options.fileExtension);if(h.download!==void 0){var p=f.createObjectURL(c);h.style.display="none",h.setAttribute("href",p),h.setAttribute("download",d),s.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),s.body.removeChild(h),setTimeout(function(){f.revokeObjectURL(p)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(c,d)}},{key:"_createTypeFormatter",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!bO[i])throw new Error('Export format type "'.concat(i,'" is not supported.'));return HUe(i,new pUe(this.hot),o)}},{key:"_createBlob",value:function(i){var o=null;return typeof Blob<"u"&&(o=new Blob([i.export()],{type:"".concat(i.options.mimeType,";charset=").concat(i.options.encoding)})),o}}],[{key:"PLUGIN_KEY",get:function(){return XUe}},{key:"PLUGIN_PRIORITY",get:function(){return qUe}}]),r}(xt);function Vv(t){"@babel/helpers - typeof";return Vv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vv(t)}function ZUe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function JUe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tBe(n.key),n)}}function eBe(t,e,r){return e&&JUe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function tBe(t){var e=rBe(t,"string");return Vv(e)==="symbol"?e:String(e)}function rBe(t,e){if(Vv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Vv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var uz=function(){function t(e,r){var n=r.id,i=r.stateless,o=i===void 0?!0:i;ZUe(this,t),this.hot=e,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=o?null:this.hot.columnIndexMapper.registerMap(this.stateId,new aw)}return eBe(t,[{key:"reset",value:function(){D(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),D(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),t}();Kt(uz,Xn);const Kw=uz;var jv={};function Gs(t,e){if(!jv[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));var r=jv[t],n=r.condition,i=r.descriptor,o=e;return i.inputValuesDecorator&&(o=i.inputValuesDecorator(o)),function(a){return n.apply(a.meta.instance,[].concat([a],[o]))}}function jl(t){if(!jv[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));return jv[t].descriptor}function Pr(t,e,r){r.key=t,jv[t]={condition:e,descriptor:r}}var zr="none";function nBe(){return!0}Pr(zr,nBe,{name:sw,inputsCount:0,showOperators:!1});var Gp="empty";function iBe(t){return Br(t.value)}Pr(Gp,iBe,{name:u7,inputsCount:0,showOperators:!0});var b0="not_empty";function oBe(t,e){return!Gs(Gp,e)(t)}Pr(b0,oBe,{name:c7,inputsCount:0,showOperators:!0});function aBe(t,e){return cBe(t)||uBe(t,e)||lBe(t,e)||sBe()}function sBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lBe(t,e){if(t){if(typeof t=="string")return ux(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ux(t,e)}}function ux(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function uBe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function cBe(t){if(Array.isArray(t))return t}var zp="eq";function fBe(t,e){var r=aBe(e,1),n=r[0];return Ar(t.value).toLocaleLowerCase(t.meta.locale)===Ar(n)}Pr(zp,fBe,{name:f7,inputsCount:1,showOperators:!0});var w0="neq";function hBe(t,e){return!Gs(zp,e)(t)}Pr(w0,hBe,{name:h7,inputsCount:1,showOperators:!0});function dBe(t,e){return gBe(t)||vBe(t,e)||mBe(t,e)||pBe()}function pBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mBe(t,e){if(t){if(typeof t=="string")return cx(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cx(t,e)}}function cx(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function vBe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function gBe(t){if(Array.isArray(t))return t}var cz="gt";function yBe(t,e){var r=dBe(e,1),n=r[0],i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>i}Pr(cz,yBe,{name:g7,inputsCount:1,showOperators:!0});function bBe(t,e){return EBe(t)||RBe(t,e)||SBe(t,e)||wBe()}function wBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SBe(t,e){if(t){if(typeof t=="string")return fx(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fx(t,e)}}function fx(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function RBe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function EBe(t){if(Array.isArray(t))return t}var fz="gte";function CBe(t,e){var r=bBe(e,1),n=r[0],i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>=i}Pr(fz,CBe,{name:y7,inputsCount:1,showOperators:!0});function OBe(t,e){return IBe(t)||ABe(t,e)||_Be(t,e)||TBe()}function TBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Be(t,e){if(t){if(typeof t=="string")return hx(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hx(t,e)}}function hx(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ABe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function IBe(t){if(Array.isArray(t))return t}var hz="lt";function NBe(t,e){var r=OBe(e,1),n=r[0],i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<i}Pr(hz,NBe,{name:b7,inputsCount:1,showOperators:!0});function PBe(t,e){return $Be(t)||xBe(t,e)||kBe(t,e)||MBe()}function MBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kBe(t,e){if(t){if(typeof t=="string")return dx(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dx(t,e)}}function dx(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function xBe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function $Be(t){if(Array.isArray(t))return t}var dz="lte";function LBe(t,e){var r=PBe(e,1),n=r[0],i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<=i}Pr(dz,LBe,{name:w7,inputsCount:1,showOperators:!0});function DBe(t,e){return BBe(t)||UBe(t,e)||HBe(t,e)||FBe()}function FBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HBe(t,e){if(t){if(typeof t=="string")return px(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return px(t,e)}}function px(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function UBe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function BBe(t){if(Array.isArray(t))return t}var zI="date_after";function VBe(t,e){var r=DBe(e,1),n=r[0],i=se(t.value,t.meta.dateFormat),o=se(n,t.meta.dateFormat);return!i.isValid()||!o.isValid()?!1:i.diff(o)>=0}Pr(zI,VBe,{name:E7,inputsCount:1,showOperators:!0});function jBe(t,e){return YBe(t)||zBe(t,e)||GBe(t,e)||WBe()}function WBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GBe(t,e){if(t){if(typeof t=="string")return mx(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mx(t,e)}}function mx(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function zBe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function YBe(t){if(Array.isArray(t))return t}var YI="date_before";function KBe(t,e){var r=jBe(e,1),n=r[0],i=se(t.value,t.meta.dateFormat),o=se(n,t.meta.dateFormat);return!i.isValid()||!o.isValid()?!1:i.diff(o)<=0}Pr(YI,KBe,{name:C7,inputsCount:1,showOperators:!0});function XBe(t,e){return JBe(t)||ZBe(t,e)||QBe(t,e)||qBe()}function qBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QBe(t,e){if(t){if(typeof t=="string")return vx(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vx(t,e)}}function vx(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ZBe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function JBe(t){if(Array.isArray(t))return t}var h2="between";function eVe(t,e){var r=XBe(e,2),n=r[0],i=r[1],o=n,a=i;if(t.meta.type==="numeric"){var s=parseFloat(o,10),l=parseFloat(a,10);o=Math.min(s,l),a=Math.max(s,l)}else if(t.meta.type==="date"){var u=Gs(YI,[a]),c=Gs(zI,[o]);return u(t)&&c(t)}return t.value>=o&&t.value<=a}Pr(h2,eVe,{name:S7,inputsCount:2,showOperators:!0});var pz="not_between";function tVe(t,e){return!Gs(h2,e)(t)}Pr(pz,tVe,{name:R7,inputsCount:2,showOperators:!0});function rVe(t,e){return aVe(t)||oVe(t,e)||iVe(t,e)||nVe()}function nVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iVe(t,e){if(t){if(typeof t=="string")return gx(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gx(t,e)}}function gx(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function oVe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function aVe(t){if(Array.isArray(t))return t}var mz="begins_with";function sVe(t,e){var r=rVe(e,1),n=r[0];return Ar(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Ar(n))}Pr(mz,sVe,{name:d7,inputsCount:1,showOperators:!0});var lVe=Ye,vz=rt,uVe=Ho.f,cVe=ku,yx=Dr,fVe=y_,hVe=Yn,dVe=b_,bx=vz("".endsWith),pVe=vz("".slice),mVe=Math.min,gz=dVe("endsWith"),vVe=!gz&&!!function(){var t=uVe(String.prototype,"endsWith");return t&&!t.writable}();lVe({target:"String",proto:!0,forced:!vVe&&!gz},{endsWith:function(e){var r=yx(hVe(this));fVe(e);var n=arguments.length>1?arguments[1]:void 0,i=r.length,o=n===void 0?i:mVe(cVe(n),i),a=yx(e);return bx?bx(r,a,o):pVe(r,o-a.length,o)===a}});function gVe(t,e){return SVe(t)||wVe(t,e)||bVe(t,e)||yVe()}function yVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bVe(t,e){if(t){if(typeof t=="string")return wx(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wx(t,e)}}function wx(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function wVe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function SVe(t){if(Array.isArray(t))return t}var yz="ends_with";function RVe(t,e){var r=gVe(e,1),n=r[0];return Ar(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Ar(n))}Pr(yz,RVe,{name:p7,inputsCount:1,showOperators:!0});function EVe(t,e){return _Ve(t)||TVe(t,e)||OVe(t,e)||CVe()}function CVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OVe(t,e){if(t){if(typeof t=="string")return Sx(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sx(t,e)}}function Sx(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function TVe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function _Ve(t){if(Array.isArray(t))return t}var KI="contains";function AVe(t,e){var r=EVe(e,1),n=r[0];return Ar(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Ar(n))>=0}Pr(KI,AVe,{name:m7,inputsCount:1,showOperators:!0});var bz="not_contains";function IVe(t,e){return!Gs(KI,e)(t)}Pr(bz,IVe,{name:v7,inputsCount:1,showOperators:!0});var wz="date_tomorrow";function NVe(t){var e=se(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(se().subtract(-1,"days").startOf("day"),"d"):!1}Pr(wz,NVe,{name:T7,inputsCount:0});var Sz="date_today";function PVe(t){var e=se(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(se().startOf("day"),"d"):!1}Pr(Sz,PVe,{name:O7,inputsCount:0});var Rz="date_yesterday";function MVe(t){var e=se(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(se().subtract(1,"days").startOf("day"),"d"):!1}Pr(Rz,MVe,{name:_7,inputsCount:0});ule();function kVe(t,e){var r=t;return r===""&&(r="(".concat(e,")")),r}var SO=new Set([1]).has(1),xVe=SO&&typeof Array.from=="function";function ny(t){var e=t;return SO&&(e=new Set(e)),function(r){var n;return SO?n=e.has(r):n=!!~e.indexOf(r),n}}function Ez(t){return t??""}function RO(t){var e=t;return xVe?e=Array.from(new Set(e)):e=UF(e),e=e.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),e}function Rx(t,e,r,n){var i=[],o=t===e,a;return o||(a=ny(e)),D(t,function(s){var l=!1;(o||a(s))&&(l=!0);var u={checked:l,value:s,visualValue:kVe(s,r)};n&&n(u),i.push(u)}),i}function Cz(t,e){return FVe(t)||DVe(t,e)||LVe(t,e)||$Ve()}function $Ve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LVe(t,e){if(t){if(typeof t=="string")return Ex(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ex(t,e)}}function Ex(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function DVe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function FVe(t){if(Array.isArray(t))return t}var Wl="by_value";function HVe(t,e){var r=Cz(e,1),n=r[0];return n(t.value)}Pr(Wl,HVe,{name:"By value",inputsCount:0,inputValuesDecorator:function(e){var r=Cz(e,1),n=r[0];return[ny(n)]},showOperators:!1});var Wv={};function UVe(t){if(!Wv[t])throw Error('Operation with id "'.concat(t,'" does not exist.'));var e=Wv[t].func;return function(r,n){return e(r,n)}}function BVe(t){return Wv[t].name}function XI(t,e,r){Wv[t]={name:e,func:r}}var Ls="conjunction",VVe=N7;function jVe(t,e){return t.every(function(r){return r.func(e)})}XI(Ls,VVe,jVe);var d2="disjunction",WVe=lw;function GVe(t,e){return t.some(function(r){return r.func(e)})}XI(d2,WVe,GVe);var qI="disjunctionWithExtraCondition",zVe=lw;function YVe(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(function(r){return r.func(e)})&&t[t.length-1].func(e)}XI(qI,zVe,YVe);function Gv(t){"@babel/helpers - typeof";return Gv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gv(t)}var np;function mR(t,e,r){return e=KVe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KVe(t){var e=XVe(t,"string");return Gv(e)==="symbol"?e:String(e)}function XVe(t,e){if(Gv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Gv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var qVe="numeric",Oz="text",QVe="date",Cx=(np={},mR(np,qVe,[zr,at,Gp,b0,at,zp,w0,at,cz,fz,hz,dz,h2,pz]),mR(np,Oz,[zr,at,Gp,b0,at,zp,w0,at,mz,yz,at,KI,bz]),mR(np,QVe,[zr,at,Gp,b0,at,zp,w0,at,YI,zI,h2,at,wz,Sz,Rz]),np);function ZVe(t){var e=[],r=t;return Cx[r]||(r=Oz),D(Cx[r],function(n){var i;n===at?i={name:at}:i=Bn(jl(n)),e.push(i)}),e}function zv(t){"@babel/helpers - typeof";return zv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zv(t)}function JVe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ox(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tje(n.key),n)}}function eje(t,e,r){return e&&Ox(t.prototype,e),r&&Ox(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function tje(t){var e=rje(t,"string");return zv(e)==="symbol"?e:String(e)}function rje(t,e){if(zv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(zv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var vR="built",gR="building",Tx=["click","input","keydown","keypress","keyup","focus","blur","change"],Tz=function(){function t(e,r){JVe(this,t),this.hot=e,this.eventManager=new hr(this),this.options=$r(t.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return eje(t,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===gR?this._element:this.buildState===vR?(this.update(),this._element):(this.buildState=gR,this.build(),this.buildState=vR,this._element)}},{key:"isBuilt",value:function(){return this.buildState===vR}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(Nn)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(a,s){r.eventManager.addEventListener(a,s,function(l){return r.runLocalHooks(s,l,r)})};if(this.buildState||(this.buildState=gR),this.options.className&&le(this._element,this.options.className),this.options.children.length)D(this.options.children,function(o){return r._element.appendChild(o.element)});else if(this.options.wrapIt){var i=this.hot.rootDocument.createElement(this.options.tagName);ut(this.options,function(o,a){i[a]!==void 0&&a!=="className"&&a!=="tagName"&&a!=="children"&&(i[a]=r.translateIfPossible(o))}),this._element.appendChild(i),D(Tx,function(o){return n(i,o)})}else D(Tx,function(o){return n(r._element,o)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return Bn({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),t}();Kt(Tz,Xn);const Ds=Tz;function Rh(t){"@babel/helpers - typeof";return Rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rh(t)}function nje(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _x(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,oje(n.key),n)}}function ije(t,e,r){return e&&_x(t.prototype,e),r&&_x(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function oje(t){var e=aje(t,"string");return Rh(e)==="symbol"?e:String(e)}function aje(t,e){if(Rh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function S0(){return typeof Reflect<"u"&&Reflect.get?S0=Reflect.get.bind():S0=function(e,r,n){var i=sje(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},S0.apply(this,arguments)}function sje(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Eh(t),t!==null););return t}function lje(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&EO(t,e)}function EO(t,e){return EO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},EO(t,e)}function uje(t){var e=fje();return function(){var n=Eh(t),i;if(e){var o=Eh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return cje(this,i)}}function cje(t,e){if(e&&(Rh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _z(t)}function _z(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eh(t){return Eh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eh(t)}var g1=new WeakMap,hje=function(t){lje(r,t);var e=uje(r);function r(n,i){var o;return nje(this,r),o=e.call(this,n,$r(r.DEFAULTS,i)),g1.set(_z(o),{}),o.registerHooks(),o}return ije(r,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()}),this.addLocalHook("keyup",function(o){return i.onKeyup(o)})}},{key:"build",value:function(){S0(Eh(r.prototype),"build",this).call(this);var i=g1.get(this),o=this.hot.rootDocument.createElement("div");i.input=this._element.firstChild,le(this._element,"htUIInput"),le(o,"htUIInputIcon"),this._element.appendChild(o),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i=g1.get(this).input;i.type=this.options.type,i.placeholder=this.translateIfPossible(this.options.placeholder),i.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&g1.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(i){this.options.value=i.target.value}}],[{key:"DEFAULTS",get:function(){return Bn({placeholder:"",type:"text",tagName:"input"})}}]),r}(Ds);const ef=hje;function Ch(t){"@babel/helpers - typeof";return Ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ch(t)}function dje(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ax(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mje(n.key),n)}}function pje(t,e,r){return e&&Ax(t.prototype,e),r&&Ax(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function mje(t){var e=vje(t,"string");return Ch(e)==="symbol"?e:String(e)}function vje(t,e){if(Ch(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function tf(){return typeof Reflect<"u"&&Reflect.get?tf=Reflect.get.bind():tf=function(e,r,n){var i=gje(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},tf.apply(this,arguments)}function gje(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Fs(t),t!==null););return t}function yje(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&CO(t,e)}function CO(t,e){return CO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},CO(t,e)}function bje(t){var e=Sje();return function(){var n=Fs(t),i;if(e){var o=Fs(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return wje(this,i)}}function wje(t,e){if(e&&(Ch(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Az(t)}function Az(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Sje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fs(t){return Fs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fs(t)}var y1=new WeakMap,Rje=function(t){yje(r,t);var e=bje(r);function r(n,i){var o;return dje(this,r),o=e.call(this,n,$r(r.DEFAULTS,i)),y1.set(Az(o),{}),o.menu=null,o.items=[],o.registerHooks(),o}return pje(r,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()})}},{key:"setItems",value:function(i){this.items=this.translateNames(i),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(i){var o=this;return D(i,function(a){a.name=o.translateIfPossible(a.name)}),i}},{key:"build",value:function(){var i=this;tf(Fs(r.prototype),"build",this).call(this),this.menu=new WI(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var o=new Ds(this.hot,{className:"htUISelectCaption"}),a=new Ds(this.hot,{className:"htUISelectDropdown"}),s=y1.get(this);s.caption=o,s.captionElement=o.element,s.dropdown=a,D([o,a],function(l){return i._element.appendChild(l.element)}),this.menu.addLocalHook("select",function(l){return i.onMenuSelect(l)}),this.menu.addLocalHook("afterClose",function(){return i.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i;this.options.value?i=this.options.value.name:i=this.menu.hot.getTranslatedPhrase(sw),y1.get(this).captionElement.textContent=i,tf(Fs(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var i=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?i.left-5:i.left-31,top:i.top-1,width:i.width,height:i.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(i){i.name!==at&&(this.options.value=i,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var i=y1.get(this),o=i.caption,a=i.dropdown;o&&o.destroy(),a&&a.destroy(),tf(Fs(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return Bn({className:"htUISelect",wrapIt:!1})}}]),r}(Ds);const Ix=Rje;function Oh(t){"@babel/helpers - typeof";return Oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oh(t)}function Eje(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cje(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Tje(n.key),n)}}function Oje(t,e,r){return e&&Cje(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Tje(t){var e=_je(t,"string");return Oh(e)==="symbol"?e:String(e)}function _je(t,e){if(Oh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function R0(){return typeof Reflect<"u"&&Reflect.get?R0=Reflect.get.bind():R0=function(e,r,n){var i=Aje(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},R0.apply(this,arguments)}function Aje(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Th(t),t!==null););return t}function Ije(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&OO(t,e)}function OO(t,e){return OO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},OO(t,e)}function Nje(t){var e=kje();return function(){var n=Th(t),i;if(e){var o=Th(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Pje(this,i)}}function Pje(t,e){if(e&&(Oh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mje(t)}function Mje(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Th(t){return Th=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Th(t)}var xje=function(t){Ije(r,t);var e=Nje(r);function r(n,i){var o;return Eje(this,r),o=e.call(this,n,{id:i.id,stateless:!1}),o.name=i.name,o.addSeparator=i.addSeparator,o.elements.push(new Ix(o.hot,{menuContainer:i.menuContainer})),o.elements.push(new ef(o.hot,{placeholder:L7})),o.elements.push(new ef(o.hot,{placeholder:D7})),o.registerHooks(),o}return Oje(r,[{key:"registerHooks",value:function(){var i=this;this.getSelectElement().addLocalHook("select",function(o){return i.onConditionSelect(o)}),this.getSelectElement().addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),D(this.getInputElements(),function(o){o.addLocalHook("keydown",function(a){return i.onInputKeyDown(a)})})}},{key:"setState",value:function(i){var o=this;if(this.reset(),!!i){var a=Bn(i.command);a.name.startsWith(dr)&&(a.name=this.hot.getTranslatedPhrase(a.name)),this.getSelectElement().setValue(a),D(i.args,function(s,l){if(l>a.inputsCount-1)return!1;var u=o.getInputElement(l);u.setValue(s),u[a.inputsCount>l?"show":"hide"](),l||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var i=this.getSelectElement().getValue()||jl(zr),o=[];return D(this.getInputElements(),function(a,s){i.inputsCount>s&&o.push(a.getValue())}),{command:i,args:o}}},{key:"updateState",value:function(i,o){var a=jl(i?i.name:zr);this.state.setValueAtIndex(o,{command:a,args:i?i.args:[]}),i||D(this.getInputElements(),function(s){return s.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof Ix})[0]}},{key:"getInputElement",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[i]}},{key:"getInputElements",value:function(){return this.elements.filter(function(i){return i instanceof ef})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(a,s,l,u,c,f){le(s.parentNode,"htFiltersMenuCondition"),i.addSeparator&&le(s.parentNode,"border");var h=i.hot.rootDocument.createElement("div");return le(h,"htFiltersMenuLabel"),h.textContent=f,s.appendChild(h),s.parentNode.hasAttribute("ghost-table")||D(i.elements,function(d){return s.appendChild(d.element)}),s}}}},{key:"reset",value:function(){var i=this.hot.getPlugin("filters").getSelectedColumn(),o=[jl(zr)];if(i!==null){var a=i.visualIndex;o=ZVe(this.hot.getDataType(0,a,this.hot.countRows(),a))}D(this.getInputElements(),function(s){return s.hide()}),this.getSelectElement().setItems(o),R0(Th(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(o[0])}},{key:"onConditionSelect",value:function(i){D(this.getInputElements(),function(o,a){o[i.inputsCount>a?"show":"hide"](),a===0&&setTimeout(function(){return o.focus()},10)}),this.runLocalHooks("change",i)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(i){om(i.keyCode,"ENTER")?(this.runLocalHooks("accept"),Lo(i)):om(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Lo(i))}}]),r}(Kw);const yR=xje;function _h(t){"@babel/helpers - typeof";return _h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_h(t)}function $je(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Nx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Dje(n.key),n)}}function Lje(t,e,r){return e&&Nx(t.prototype,e),r&&Nx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Dje(t){var e=Fje(t,"string");return _h(e)==="symbol"?e:String(e)}function Fje(t,e){if(_h(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(_h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function E0(){return typeof Reflect<"u"&&Reflect.get?E0=Reflect.get.bind():E0=function(e,r,n){var i=Hje(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},E0.apply(this,arguments)}function Hje(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ah(t),t!==null););return t}function Uje(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&TO(t,e)}function TO(t,e){return TO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TO(t,e)}function Bje(t){var e=jje();return function(){var n=Ah(t),i;if(e){var o=Ah(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Vje(this,i)}}function Vje(t,e){if(e&&(_h(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Iz(t)}function Iz(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function jje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ah(t){return Ah=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ah(t)}var b1=new WeakMap,Wje=function(t){Uje(r,t);var e=Bje(r);function r(n,i){var o;return $je(this,r),o=e.call(this,n,$r(r.DEFAULTS,i)),b1.set(Iz(o),{}),o}return Lje(r,[{key:"build",value:function(){E0(Ah(r.prototype),"build",this).call(this);var i=b1.get(this);i.input=this._element.firstChild;var o=this.hot.rootDocument.createElement("label");o.textContent=this.translateIfPossible(this.options.label.textContent),o.htmlFor=this.translateIfPossible(this.options.label.htmlFor),i.label=o,this._element.appendChild(o),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i=b1.get(this);i.input.checked=this.options.checked,i.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=i,this.update()}},{key:"focus",value:function(){this.isBuilt()&&b1.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return Bn({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(Ds);const Px=Wje;function Ih(t){"@babel/helpers - typeof";return Ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ih(t)}var Mx;function Gje(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function zje(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yje(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Xje(n.key),n)}}function Kje(t,e,r){return e&&Yje(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Xje(t){var e=qje(t,"string");return Ih(e)==="symbol"?e:String(e)}function qje(t,e){if(Ih(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Qje(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_O(t,e)}function _O(t,e){return _O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_O(t,e)}function Zje(t){var e=tWe();return function(){var n=p2(t),i;if(e){var o=p2(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Jje(this,i)}}function Jje(t,e){if(e&&(Ih(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eWe(t)}function eWe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function p2(t){return p2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},p2(t)}var kx=0,rWe=function(t){Qje(r,t);var e=Zje(r);function r(n,i){var o;return zje(this,r),o=e.call(this,n,{id:i.id,stateless:!1}),o.name=i.name,o.buildOperatorsElement(),o}return Kje(r,[{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(a,s){return le(s.parentNode,"htFiltersMenuOperators"),s.parentNode.hasAttribute("ghost-table")||D(i.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"buildOperatorsElement",value:function(){var i=this,o=[Ls,d2];D(o,function(a){var s=new Px(i.hot,{name:"operator",label:{htmlFor:a,textContent:BVe(a)},value:a,checked:a===o[kx],id:a});s.addLocalHook("change",function(l){return i.onRadioInputChange(l)}),i.elements.push(s)})}},{key:"setChecked",value:function(i){if(this.elements.length<i)throw Error(kt(Mx||(Mx=Gje(["Radio button with index "," doesn't exist."])),i));D(this.elements,function(o,a){o.setChecked(a===i)})}},{key:"getActiveOperationId",value:function(){var i=this.elements.find(function(o){return o instanceof Px&&o.isChecked()});return i?i.getValue():Ls}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(i){this.reset(),i&&this.getActiveOperationId()!==i&&D(this.elements,function(o){o.setChecked(o.getValue()===i)})}},{key:"updateState",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ls,o=arguments.length>1?arguments[1]:void 0,a=i;a===qI&&(a=d2),this.state.setValueAtIndex(o,a)}},{key:"reset",value:function(){this.setChecked(kx)}},{key:"onRadioInputChange",value:function(i){this.setState(i.target.value)}}]),r}(Kw);const nWe=rWe;var iWe=rt,oWe=Yn,xx=Dr,aWe=/"/g,sWe=iWe("".replace),lWe=function(t,e,r,n){var i=xx(oWe(t)),o="<"+e;return r!==""&&(o+=" "+r+'="'+sWe(xx(n),aWe,"&quot;")+'"'),o+">"+i+"</"+e+">"},uWe=nt,cWe=function(t){return uWe(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})},fWe=Ye,hWe=lWe,dWe=cWe;fWe({target:"String",proto:!0,forced:dWe("link")},{link:function(e){return hWe(this,"a","href",e)}});function Nh(t){"@babel/helpers - typeof";return Nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nh(t)}function pWe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $x(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vWe(n.key),n)}}function mWe(t,e,r){return e&&$x(t.prototype,e),r&&$x(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function vWe(t){var e=gWe(t,"string");return Nh(e)==="symbol"?e:String(e)}function gWe(t,e){if(Nh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function C0(){return typeof Reflect<"u"&&Reflect.get?C0=Reflect.get.bind():C0=function(e,r,n){var i=yWe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},C0.apply(this,arguments)}function yWe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ph(t),t!==null););return t}function bWe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&AO(t,e)}function AO(t,e){return AO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},AO(t,e)}function wWe(t){var e=RWe();return function(){var n=Ph(t),i;if(e){var o=Ph(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return SWe(this,i)}}function SWe(t,e){if(e&&(Nh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nz(t)}function Nz(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function RWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ph(t){return Ph=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ph(t)}var bR=new WeakMap,EWe=function(t){bWe(r,t);var e=wWe(r);function r(n,i){var o;return pWe(this,r),o=e.call(this,n,$r(r.DEFAULTS,i)),bR.set(Nz(o),{}),o}return mWe(r,[{key:"build",value:function(){C0(Ph(r.prototype),"build",this).call(this);var i=bR.get(this);i.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(bR.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return Bn({href:"#",tagName:"a"})}}]),r}(Ds);const Lx=EWe;function Mh(t){"@babel/helpers - typeof";return Mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mh(t)}function Dx(t){return _We(t)||TWe(t)||OWe(t)||CWe()}function CWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OWe(t,e){if(t){if(typeof t=="string")return IO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IO(t,e)}}function TWe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function _We(t){if(Array.isArray(t))return IO(t)}function IO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function AWe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,NWe(n.key),n)}}function IWe(t,e,r){return e&&Fx(t.prototype,e),r&&Fx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function NWe(t){var e=PWe(t,"string");return Mh(e)==="symbol"?e:String(e)}function PWe(t,e){if(Mh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function rf(){return typeof Reflect<"u"&&Reflect.get?rf=Reflect.get.bind():rf=function(e,r,n){var i=MWe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},rf.apply(this,arguments)}function MWe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Hs(t),t!==null););return t}function kWe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&NO(t,e)}function NO(t,e){return NO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},NO(t,e)}function xWe(t){var e=LWe();return function(){var n=Hs(t),i;if(e){var o=Hs(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return $We(this,i)}}function $We(t,e){if(e&&(Mh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pz(t)}function Pz(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function LWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hs(t){return Hs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hs(t)}var DWe=new WeakMap,FWe="multipleSelect.itemBox",HWe=function(t){kWe(r,t);var e=xWe(r);function r(n,i){var o;return AWe(this,r),o=e.call(this,n,$r(r.DEFAULTS,i)),DWe.set(Pz(o),{}),o.searchInput=new ef(o.hot,{placeholder:$7,className:"htUIMultipleSelectSearch"}),o.selectAllUI=new Lx(o.hot,{textContent:P7,className:"htUISelectAll"}),o.clearAllUI=new Lx(o.hot,{textContent:M7,className:"htUIClearAll"}),o.items=[],o.itemsBox=null,o.registerHooks(),o}return IWe(r,[{key:"registerHooks",value:function(){var i=this;this.searchInput.addLocalHook("keydown",function(o){return i.onInputKeyDown(o)}),this.searchInput.addLocalHook("input",function(o){return i.onInput(o)}),this.selectAllUI.addLocalHook("click",function(o){return i.onSelectAllClick(o)}),this.clearAllUI.addLocalHook("click",function(o){return i.onClearAllClick(o)})}},{key:"setItems",value:function(i){this.items=i,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(i){this.locale=i}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return Dx(this.items)}},{key:"getValue",value:function(){return BWe(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var i=this;rf(Hs(r.prototype),"build",this).call(this);var o=this.hot.rootDocument,a=o.createElement("div"),s=new Ds(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(s.element),this._element.appendChild(a);var l=function(c){if(i._element){i.itemsBox&&i.itemsBox.destroy(),le(c,"htUIMultipleSelectHot"),i.itemsBox=new i.hot.constructor(c,{data:i.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(p,m,y,S,R,E){p.title=E.instance.getDataAtRowProp(m,E.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return i.itemsBox.container.scrollWidth-Xr(o)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:i.hot.isRtl()?"rtl":"ltr"}),i.itemsBox.init();var f=i.itemsBox.getShortcutManager(),h=f.getContext("grid");h.addShortcut({keys:[["Escape"]],callback:function(p){i.runLocalHooks("keydown",p,i)},group:FWe})}};l(a),setTimeout(function(){return l(a)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(UWe(this.items,this.options.value)),rf(Hs(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,rf(Hs(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(i){var o=this,a=i.target.value.toLocaleLowerCase(this.getLocale()),s;a===""?s=Dx(this.items):s=_i(this.items,function(l){return"".concat(l.value).toLocaleLowerCase(o.getLocale()).indexOf(a)>=0}),this.itemsBox.loadData(s)}},{key:"onInputKeyDown",value:function(i){this.runLocalHooks("keydown",i,this);var o=GH(om,i.keyCode);o("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(Lo(i),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(i){var o=[];i.preventDefault(),D(this.itemsBox.getSourceData(),function(a,s){a.checked=!0,o.push(c3(a,s)[0])}),this.itemsBox.setSourceDataAtCell(o)}},{key:"onClearAllClick",value:function(i){var o=[];i.preventDefault(),D(this.itemsBox.getSourceData(),function(a,s){a.checked=!1,o.push(c3(a,s)[0])}),this.itemsBox.setSourceDataAtCell(o)}}],[{key:"DEFAULTS",get:function(){return Bn({className:"htUIMultipleSelect",value:[]})}}]),r}(Ds);const Hx=HWe;function UWe(t,e){var r=ny(e);return st(t,function(n){return n.checked=r(n.value),n})}function BWe(t){var e=[];return D(t,function(r){r.checked&&e.push(r.value)}),e}function kh(t){"@babel/helpers - typeof";return kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kh(t)}function VWe(t,e){return zWe(t)||GWe(t,e)||WWe(t,e)||jWe()}function jWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WWe(t,e){if(t){if(typeof t=="string")return Ux(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ux(t,e)}}function Ux(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function GWe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function zWe(t){if(Array.isArray(t))return t}function YWe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function KWe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qWe(n.key),n)}}function XWe(t,e,r){return e&&KWe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function qWe(t){var e=QWe(t,"string");return kh(e)==="symbol"?e:String(e)}function QWe(t,e){if(kh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function O0(){return typeof Reflect<"u"&&Reflect.get?O0=Reflect.get.bind():O0=function(e,r,n){var i=ZWe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},O0.apply(this,arguments)}function ZWe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=xh(t),t!==null););return t}function JWe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&PO(t,e)}function PO(t,e){return PO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},PO(t,e)}function eGe(t){var e=nGe();return function(){var n=xh(t),i;if(e){var o=xh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return tGe(this,i)}}function tGe(t,e){if(e&&(kh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rGe(t)}function rGe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xh(t){return xh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xh(t)}var iGe=function(t){JWe(r,t);var e=eGe(r);function r(n,i){var o;return YWe(this,r),o=e.call(this,n,{id:i.id,stateless:!1}),o.name=i.name,o.elements.push(new Hx(o.hot)),o.registerHooks(),o}return XWe(r,[{key:"registerHooks",value:function(){var i=this;this.getMultipleSelectElement().addLocalHook("keydown",function(o){return i.onInputKeyDown(o)})}},{key:"setState",value:function(i){if(this.reset(),i&&i.command.key===Wl){var o=this.getMultipleSelectElement();o.setItems(i.itemsSnapshot),o.setValue(i.args[0]),o.setLocale(i.locale)}}},{key:"getState",value:function(){var i=this.getMultipleSelectElement(),o=i.getItems();return{command:{key:i.isSelectedAllValues()||!o.length?zr:Wl},args:[i.getValue()],itemsSnapshot:o}}},{key:"updateState",value:function(i){var o=this,a=function(l,u,c,f,h){var d=_i(u,function(B){return B.name===Wl}),p=VWe(d,1),m=p[0],y={},S=o.hot.getTranslatedPhrase(Ab);if(m){var R=RO(st(f(l,h),function(B){return B.value}));c&&(m.args[0]=c);var E=[],O=Rx(R,m.args[0],S,function(B){B.checked&&E.push(B.value)}),A=i.editedConditionStack.column;y.locale=o.hot.getCellMeta(0,A).locale,y.args=[E],y.command=jl(Wl),y.itemsSnapshot=O}else y.args=[],y.command=jl(zr);o.state.setValueAtIndex(l,y)};a(i.editedConditionStack.column,i.editedConditionStack.conditions,i.conditionArgsChange,i.filteredRowsFactory),i.dependentConditionStacks.length&&a(i.dependentConditionStacks[0].column,i.dependentConditionStacks[0].conditions,i.conditionArgsChange,i.filteredRowsFactory,i.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof Hx})[0]}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(a,s,l,u,c,f){le(s.parentNode,"htFiltersMenuValue");var h=i.hot.rootDocument.createElement("div");return le(h,"htFiltersMenuLabel"),h.textContent=f,s.appendChild(h),s.parentNode.hasAttribute("ghost-table")||D(i.elements,function(d){return s.appendChild(d.element)}),s}}}},{key:"reset",value:function(){var i=this.hot.getTranslatedPhrase(Ab),o=RO(this._getColumnVisibleValues()),a=Rx(o,o,i);this.getMultipleSelectElement().setItems(a),O0(xh(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(o);var s=this.hot.getPlugin("filters").getSelectedColumn();s!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s.visualIndex).locale)}},{key:"onInputKeyDown",value:function(i){om(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Lo(i))}},{key:"_getColumnVisibleValues",value:function(){var i=this.hot.getPlugin("filters").getSelectedColumn();return i===null?[]:st(this.hot.getDataAtCol(i.visualIndex),function(o){return Ez(o)})}}]),r}(Kw);const oGe=iGe;function $h(t){"@babel/helpers - typeof";return $h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$h(t)}function aGe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lGe(n.key),n)}}function sGe(t,e,r){return e&&Bx(t.prototype,e),r&&Bx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function lGe(t){var e=uGe(t,"string");return $h(e)==="symbol"?e:String(e)}function uGe(t,e){if($h(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if($h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function cGe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&MO(t,e)}function MO(t,e){return MO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},MO(t,e)}function fGe(t){var e=pGe();return function(){var n=m2(t),i;if(e){var o=m2(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return hGe(this,i)}}function hGe(t,e){if(e&&($h(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dGe(t)}function dGe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function m2(t){return m2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},m2(t)}var mGe=function(t){cGe(r,t);var e=fGe(r);function r(n,i){var o;return aGe(this,r),o=e.call(this,n,{id:i.id,stateless:!0}),o.name=i.name,o.elements.push(new ef(o.hot,{type:"button",value:k7,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),o.elements.push(new ef(o.hot,{type:"button",value:x7,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),o.registerHooks(),o}return sGe(r,[{key:"registerHooks",value:function(){var i=this;D(this.elements,function(o){o.addLocalHook("click",function(a,s){return i.onButtonClick(a,s)})})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(a,s){return le(s.parentNode,"htFiltersMenuActionBar"),s.parentNode.hasAttribute("ghost-table")||D(i.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(i,o){o.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(Kw);const vGe=mGe;function Yv(t){"@babel/helpers - typeof";return Yv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yv(t)}var Vx,jx;function Wx(t,e){return wGe(t)||bGe(t,e)||yGe(t,e)||gGe()}function gGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yGe(t,e){if(t){if(typeof t=="string")return Gx(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Gx(t,e)}}function Gx(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function bGe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function wGe(t){if(Array.isArray(t))return t}function zx(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function SGe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function RGe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,CGe(n.key),n)}}function EGe(t,e,r){return e&&RGe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function CGe(t){var e=OGe(t,"string");return Yv(e)==="symbol"?e:String(e)}function OGe(t,e){if(Yv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Yv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Yx="ConditionCollection.filteringStates",Mz=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;SGe(this,t),this.hot=e,this.isMapRegistrable=r,this.filteringStates=new aw,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(Yx,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return EGe(t,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var i,o=this.filteringStates.getValueAtIndex(n),a=(i=o==null?void 0:o.conditions)!==null&&i!==void 0?i:[],s=o==null?void 0:o.operation;return this.isMatchInConditions(a,r,s)}},{key:"isMatchInConditions",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ls;return r.length?UVe(i)(r,n):!0}},{key:"addCondition",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ls,o=arguments.length>3?arguments[3]:void 0,a=this.hot.getCellMeta(0,r).locale,s=st(n.args,function(f){return typeof f=="string"?f.toLocaleLowerCase(a):f}),l=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==i)throw Error(kt(Vx||(Vx=zx(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(zt(Wv[i]))throw new Error(kt(jx||(jx=zx(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),i));var c=this.getConditions(r);c.length===0?this.filteringStates.setValueAtIndex(r,{operation:i,conditions:[{name:l,args:s,func:Gs(l,s)}]},o):c.push({name:l,args:s,func:Gs(l,s)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(r))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=Wx(r,1),i=n[0];return i})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return gn(this.filteringStates.getEntries(),function(r,n){var i=Wx(n,2),o=i[0],a=i[1],s=a.operation,l=a.conditions;return r.push({column:o,operation:s,conditions:st(l,function(u){var c=u.name,f=u.args;return{name:c,args:f}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),D(r,function(i){D(i.conditions,function(o){return n.addCondition(i.column,o)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var i=this.getConditions(r);return n?i.some(function(o){return o.name===n}):i.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(Yx),this.filteringStates=null,this.clearLocalHooks()}}]),t}();Kt(Mz,Xn);const kz=Mz;function Kv(t){"@babel/helpers - typeof";return Kv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kv(t)}function TGe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _Ge(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,IGe(n.key),n)}}function AGe(t,e,r){return e&&_Ge(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function IGe(t){var e=NGe(t,"string");return Kv(e)==="symbol"?e:String(e)}function NGe(t,e){if(Kv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Kv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var PGe=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};TGe(this,t),this.conditionCollection=e,this.columnDataFactory=r}return AGe(t,[{key:"filter",value:function(){var r=this,n=[];return D(this.conditionCollection.getFilteredColumns(),function(i,o){var a=r.columnDataFactory(i);o&&(a=r._getIntersectData(a,n)),n=r.filterByColumn(i,a)}),n}},{key:"filterByColumn",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=[];return D(i,function(a){a!==void 0&&n.conditionCollection.isMatch(a,r)&&o.push(a)}),o}},{key:"_getIntersectData",value:function(r,n){var i=[];return D(n,function(o){var a=o.meta.visualRow;r[a]!==void 0&&(i[a]=r[a])}),i}}]),t}();const xz=PGe;function Xv(t){"@babel/helpers - typeof";return Xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xv(t)}function MGe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kGe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$Ge(n.key),n)}}function xGe(t,e,r){return e&&kGe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function $Ge(t){var e=LGe(t,"string");return Xv(e)==="symbol"?e:String(e)}function LGe(t,e){if(Xv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Xv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var $z=function(){function t(e,r){var n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};MGe(this,t),this.hot=e,this.conditionCollection=r,this.columnDataFactory=i,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(o){return n._onConditionBeforeModify(o)}),this.conditionCollection.addLocalHook("afterRemove",function(o){return n.updateStatesAtColumn(o)}),this.conditionCollection.addLocalHook("afterAdd",function(o){return n.updateStatesAtColumn(o)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return xGe(t,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,D(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var i=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var o=this.conditionCollection.exportAllConditions(),a=this.conditionCollection.getColumnStackPosition(r);a===-1&&(a=this.latestEditedColumnPosition);var s=o.slice(0,a),l=o.slice(a);l.length&&l[0].column===r&&l.shift();var u=mpe(function(f,h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],p=new kz(i.hot,!1),m=[].concat(f,d);p.importAllConditions(m);var y=i.columnDataFactory(h),S;p.isEmpty()?S=y:S=new xz(p,function(E){return i.columnDataFactory(E)}).filter(),S=st(S,function(E){return E.meta.visualRow});var R=ny(S);return p.destroy(),_i(y,function(E){return R(E.meta.visualRow)})})(s),c=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:c},dependentConditionStacks:l,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;D(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),ut(this,function(n,i){r[i]=null})}}]),t}();Kt($z,Xn);const DGe=$z;function Lh(t){"@babel/helpers - typeof";return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lh(t)}var Kx;function FGe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function HGe(t,e){return jGe(t)||VGe(t,e)||BGe(t,e)||UGe()}function UGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BGe(t,e){if(t){if(typeof t=="string")return Xx(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xx(t,e)}}function Xx(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function VGe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function jGe(t){if(Array.isArray(t))return t}function WGe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,zGe(n.key),n)}}function GGe(t,e,r){return e&&qx(t.prototype,e),r&&qx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function zGe(t){var e=YGe(t,"string");return Lh(e)==="symbol"?e:String(e)}function YGe(t,e){if(Lh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function nf(){return typeof Reflect<"u"&&Reflect.get?nf=Reflect.get.bind():nf=function(e,r,n){var i=KGe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},nf.apply(this,arguments)}function KGe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Us(t),t!==null););return t}function XGe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kO(t,e)}function kO(t,e){return kO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},kO(t,e)}function qGe(t){var e=ZGe();return function(){var n=Us(t),i;if(e){var o=Us(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return QGe(this,i)}}function QGe(t,e){if(e&&(Lh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lz(t)}function Lz(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ZGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Us(t){return Us=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Us(t)}var Qx="filters",JGe=250,eze=function(t){XGe(r,t);var e=qGe(r);function r(n){var i;return WGe(this,r),i=e.call(this,n),i.eventManager=new hr(Lz(i)),i.dropdownMenuPlugin=null,i.conditionCollection=null,i.conditionUpdateObserver=null,i.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),i.filtersRowsMap=null,i.hot.addHook("afterGetColHeader",function(o,a){return i.onAfterGetColHeader(o,a)}),i}return GGe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Qx]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new jg),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var o=this.hot.getSettings().dropdownMenu,a=o&&o.uiContainer||this.hot.rootDocument.body,s=function(d){return d.addLocalHook("accept",function(){return i.onActionBarSubmit("accept")}),d.addLocalHook("cancel",function(){return i.onActionBarSubmit("cancel")}),d.addLocalHook("change",function(p){return i.onComponentChange(d,p)}),d},l=function(){return"".concat(i.hot.getTranslatedPhrase(A7),":")},u=function(){return"".concat(i.hot.getTranslatedPhrase(I7),":")};if(!this.components.get("filter_by_condition")){var c=new yR(this.hot,{id:"filter_by_condition",name:l,addSeparator:!1,menuContainer:a});c.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition",s(c))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new nWe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var f=new yR(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:a});f.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition2",s(f))}this.components.get("filter_by_value")||this.components.set("filter_by_value",s(new oGe(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",s(new vGe(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new kz(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new DGe(this.hot,this.conditionCollection,function(h){return i.getDataMapAtColumn(h)}),this.conditionUpdateObserver.addLocalHook("update",function(h){return i.updateComponents(h)})),this.components.forEach(function(h){return h.show()}),this.addHook("beforeDropdownMenuSetItems",function(h){return i.onBeforeDropdownMenuSetItems(h)}),this.addHook("afterDropdownMenuDefaultOptions",function(h){return i.onAfterDropdownMenuDefaultOptions(h)}),this.addHook("afterDropdownMenuShow",function(){return i.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return i.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(h){return i.onAfterChange(h)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),nf(Us(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this;if(this.enabled){var o;(o=this.dropdownMenuPlugin)!==null&&o!==void 0&&o.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(a,s){a.destroy(),i.components.set(s,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}nf(Us(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(i,o,a){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ls,l=this.hot.toPhysicalColumn(i);this.conditionCollection.addCondition(l,{command:{key:o},args:a},s)}},{key:"removeConditions",value:function(i){var o=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(o)}},{key:"clearConditions",value:function(i){if(i===void 0)this.conditionCollection.clean();else{var o=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(o)}}},{key:"filter",value:function(){var i=this,o=this._createDataFilter(),a=!this.conditionCollection.isEmpty(),s=[],l=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",l);if(u!==!1)if(a){var c=[];this.hot.batchExecution(function(){i.filtersRowsMap.clear(),s=st(o.filter(),function(h){return h.meta.visualRow});var f=ny(s);De(i.hot.countSourceRows()-1,function(h){f(h)||c.push(h)}),D(c,function(h){i.filtersRowsMap.setValueAtIndex(h,!0)})},!0),s.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",l),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var i,o=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return o?{visualIndex:o.col,physicalIndex:this.hot.toPhysicalColumn(o.col)}:null}},{key:"clearColumnSelection",value:function(){var i=this.getSelectedColumn();i!==null&&this.hot.selectCell(0,i.visualIndex)}},{key:"getDataMapAtColumn",value:function(i){var o=this,a=this.hot.toVisualColumn(i),s=[];return D(this.hot.getSourceDataAtCol(a),function(l,u){var c,f=o.hot.getCellMeta(u,a),h=f.row,d=f.col,p=f.visualCol,m=f.visualRow,y=f.type,S=f.instance,R=f.dateFormat,E=f.locale,O=(c=o.hot.getDataAtCell(o.hot.toVisualRow(u),a))!==null&&c!==void 0?c:l;s.push({meta:{row:h,col:d,visualCol:p,visualRow:m,type:y,instance:S,dateFormat:R,locale:E},value:Ez(O)})}),s}},{key:"onAfterChange",value:function(i){var o=this;i&&D(i,function(a){var s=HGe(a,2),l=s[1],u=o.hot.propToCol(l);o.conditionCollection.hasConditions(u)&&o.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(i){var o=this.hot.getDataAtCol(i),a=RO(o);this.conditionUpdateObserver.updateStatesAtColumn(i,a)}},{key:"restoreComponents",value:function(i){var o,a=(o=this.getSelectedColumn())===null||o===void 0?void 0:o.physicalIndex;i.forEach(function(s){s.isHidden()||s.restoreState(a)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var i=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){i.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(i){i.items.push({name:at}),this.components.forEach(function(o){i.items.push(o.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(i,o,a,s){var l=i;return l===d2&&o.command.key!==zr&&a.command.key!==zr&&s.command.key!==zr?l=qI:s.command.key!==zr&&(o.command.key===zr||a.command.key===zr)&&(l=Ls),l}},{key:"onActionBarSubmit",value:function(i){var o;if(i==="accept"){var a=this.getSelectedColumn();if(a===null){var s;(s=this.dropdownMenuPlugin)===null||s===void 0||s.close();return}var l=a.physicalIndex,u=this.components.get("filter_by_condition").getState(),c=this.components.get("filter_by_condition2").getState(),f=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),u,c,f);this.conditionUpdateObserver.groupChanges();var d=this.conditionCollection.getColumnStackPosition(l);d===-1&&(d=void 0),this.conditionCollection.removeConditions(l),u.command.key!==zr&&(this.conditionCollection.addCondition(l,u,h,d),c.command.key!==zr&&this.conditionCollection.addCondition(l,c,h,d)),f.command.key!==zr&&this.conditionCollection.addCondition(l,f,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(function(p){return p.saveState(l)}),this.filtersRowsMap.clear(),this.filter()}(o=this.dropdownMenuPlugin)===null||o===void 0||o.close()}},{key:"onComponentChange",value:function(i,o){this.updateDependentComponentsVisibility(),i.constructor===yR&&!o.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var i=this.components.get("filter_by_condition"),o=i.getState(),a=o.command,s=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];a.showOperators?this.showComponents.apply(this,s):this.hideComponents.apply(this,s)}},{key:"onAfterGetColHeader",value:function(i,o){var a=this.hot.toPhysicalColumn(i);this.enabled&&this.conditionCollection.hasConditions(a)?le(o,"htFiltersActive"):qe(o,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new xz(o,function(a){return i.getDataMapAtColumn(a)})}},{key:"updateComponents",value:function(i){var o;if((o=this.dropdownMenuPlugin)!==null&&o!==void 0&&o.enabled){var a=i.editedConditionStack,s=a.conditions,l=a.column,u=s.filter(function(h){return h.name===Wl}),c=s.filter(function(h){return h.name!==Wl});if(u.length>=2||c.length>=3)Dt(kt(Kx||(Kx=FGe([`The filter conditions have been applied properly, but couldn’t be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldn’t be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var f=this.conditionCollection.getOperation(l);this.components.get("filter_by_condition").updateState(c[0],l),this.components.get("filter_by_condition2").updateState(c[1],l),this.components.get("filter_operators").updateState(f,l),this.components.get("filter_by_value").updateState(i)}}}},{key:"getIndexesOfComponents",value:function(){var i=[];if(!this.dropdownMenuPlugin)return i;for(var o=this.dropdownMenuPlugin.menu,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return D(s,function(u){D(o.menuItems,function(c,f){c.key===u.getMenuItemDescriptor().key&&i.push(f)})}),i}},{key:"changeComponentsVisibility",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var o=this.dropdownMenuPlugin.menu,a=o.hotMenu,s=a.getPlugin("hiddenRows"),l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];var f=this.getIndexesOfComponents.apply(this,u);i?s.showRows(f):s.hideRows(f),a.render()}}},{key:"hideComponents",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!1].concat(o))}},{key:"showComponents",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!0].concat(o))}},{key:"destroy",value:function(){var i=this;this.enabled&&(this.components.forEach(function(o,a){o!==null&&(o.destroy(),i.components.set(a,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),nf(Us(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Qx}},{key:"PLUGIN_PRIORITY",get:function(){return JGe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(xt);function qv(t){"@babel/helpers - typeof";return qv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qv(t)}function Zx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Yp(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Zx(Object(r),!0).forEach(function(n){tze(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function tze(t,e,r){return e=rze(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rze(t){var e=nze(t,"string");return qv(e)==="symbol"?e:String(e)}function nze(t,e){if(qv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(qv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Dz="internal-use-in-handsontable",xO={licenseKey:Dz,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function Fz(t){var e,r;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[hn])===null||e===void 0||(r=e.language)===null||r===void 0?void 0:r.langCode}}function Hz(t){return Object.keys(t).reduce(function(e,r){return r!=="hyperformula"&&(e[r]=t[r]),e},{})}function ize(t){var e,r=t[hn],n=Hz(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=Fz(t);return Yp(Yp(Yp({},xO),n),i)}function oze(t){var e,r=t[hn],n=Hz(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=Fz(t);return Yp(Yp({},n),i)}function aze(t,e){return Object.keys(e).some(function(r){return e[r]!==void 0&&e[r]!==t[r]})}var Jx;function sze(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function $O(t){"@babel/helpers - typeof";return $O=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$O(t)}function Xw(){var t="engine_relationship",e=$i(hn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function QI(){var t="shared_engine_usage",e=$i(hn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function lze(t){var e=t.getSettings(),r=e[hn],n=r==null?void 0:r.engine;if(r===!0||zt(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var i;return uze((i=n.hyperformula)!==null&&i!==void 0?i:n,e,t)}else if($O(n)==="object"&&zt(n.hyperformula)){var o=Xw(),a=QI().get(n);return o.has(n)||o.set(n,[]),o.get(n).push(t),a&&a.push(t.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:Dz}),(n.getConfig().leapYear1900!==xO.leapYear1900||C_(n.getConfig().nullDate,xO.nullDate)===!1)&&Dt(kt(Jx||(Jx=sze(["If you use HyperFormula with Handsontable, keep the default `leapYear1900` and `nullDate` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."],["If you use HyperFormula with Handsontable, keep the default \\`leapYear1900\\` and \\`nullDate\\` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."])))),n}return null}function uze(t,e,r){var n=e[hn],i=ize(e),o=Xw(),a=QI();cze(t,n.functions),fze(t,n.language);var s=t.buildEmpty(i);return o.set(s,[r]),a.set(s,[r.guid]),hze(s,n.namedExpressions),s.on("sheetAdded",function(){s.rebuildAndRecalculate()}),s.on("sheetRemoved",function(){s.rebuildAndRecalculate()}),s}function e$(t){var e,r=Xw(),n=r.size===0?[]:Array.from((e=r.get(t))!==null&&e!==void 0?e:[]);return new Map(n.map(function(i){return[i.getPlugin("formulas").sheetId,i]}))}function t$(t,e){if(t){var r=Xw(),n=r.get(t),i=QI(),o=i.get(t);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),n.length===0&&r.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function cze(t,e){e&&e.forEach(function(r){var n=r.name,i=r.plugin,o=r.translations;try{t.registerFunction(n,i,o)}catch(a){Dt(a.message)}})}function fze(t,e){if(e){var r=e.langCode;try{t.registerLanguage(r,e)}catch(n){Dt(n.message)}}}function hze(t,e){e&&(t.suspendEvaluation(),e.forEach(function(r){var n=r.name,i=r.expression,o=r.scope,a=r.options;try{t.addNamedExpression(n,i,o,a)}catch(s){Dt(s.message)}}),t.resumeEvaluation())}function dze(t,e){return(zt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}var Uz="DD/MM/YYYY";function Bz(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function pze(t){return Bz(t)?t.substr(1):t}function mze(t){return typeof t=="string"&&t.startsWith("=")}function wR(t,e){return typeof t=="string"&&e==="date"}function r$(t,e){return se(t,e,!0).isValid()}function n$(t,e){return se(t,e,!0).format(Uz)}function vze(t,e){return se(t,Uz,!0).format(e)}function i$(t,e){var r=-1,n=new Date(Date.UTC(0,0,t+r));return se(n).format(e)}function Qv(t){"@babel/helpers - typeof";return Qv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qv(t)}function gze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yze(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wze(n.key),n)}}function bze(t,e,r){return e&&yze(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function wze(t){var e=Sze(t,"string");return Qv(e)==="symbol"?e:String(e)}function Sze(t,e){if(Qv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Qv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function yl(t,e,r){Rze(t,e),e.set(t,r)}function Rze(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qt(t,e){var r=Vz(t,e,"get");return Eze(t,r)}function Eze(t,e){return e.get?e.get.call(t):e.value}function os(t,e,r){var n=Vz(t,e,"set");return Cze(t,n,r),r}function Vz(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function Cze(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var ip=new WeakMap,as=new WeakMap,Jn=new WeakMap,w1=new WeakMap,SR=new WeakMap,RR=new WeakMap,S1=new WeakMap,Oze=function(){function t(e,r,n){gze(this,t),yl(this,ip,{writable:!0,value:void 0}),yl(this,as,{writable:!0,value:void 0}),yl(this,Jn,{writable:!0,value:void 0}),yl(this,w1,{writable:!0,value:[]}),yl(this,SR,{writable:!0,value:[]}),yl(this,RR,{writable:!0,value:void 0}),yl(this,S1,{writable:!0,value:[]}),os(this,ip,e),os(this,as,r),os(this,Jn,n)}return bze(t,[{key:"setRemovedHfIndexes",value:function(r){var n=this;return os(this,S1,r.map(function(i){var o=Qt(n,as).getVisualFromPhysicalIndex(i);return n.getHfIndexFromVisualIndex(o)})),Qt(this,S1)}},{key:"getRemovedHfIndexes",value:function(){return Qt(this,S1)}},{key:"getHfIndexFromVisualIndex",value:function(r){var n=Qt(this,as).getIndexesSequence(),i=Qt(this,as).getNotTrimmedIndexes();return n.indexOf(i[r])}},{key:"syncMoves",value:function(r){var n=this,i=1,o="move".concat(Qi(Qt(this,ip)),"s");Qt(this,Jn).getEngine().batch(function(){r.forEach(function(a){var s=a.from!==a.to,l=a.from+1!==a.to;s&&l&&Qt(n,Jn).getEngine()[o](Qt(n,Jn).getSheetId(),a.from,i,a.to)})})}},{key:"storeMovesInformation",value:function(r,n,i){var o=this;i!==!1&&(os(this,SR,r.map(function(a){return o.getHfIndexFromVisualIndex(a)})),os(this,RR,this.getHfIndexFromVisualIndex(n)))}},{key:"getMoveLine",value:function(r,n){var i=Qt(this,as).getNumberOfIndexes(),o=Array.from(Array(i).keys()).filter(function(s){return r.includes(s)===!1});if(n===0){var a;return(a=o[n])!==null&&a!==void 0?a:0}return o[n-1]+1}},{key:"getInitiallyCalculatedMoves",value:function(r,n){var i=this.getMoveLine(r,n),o=[];return r.forEach(function(a){var s={from:a,to:i};o.forEach(function(l){var u=l.from>l.to,c=l.to<=s.from,f=l.from>s.from;f&&c&&u&&(s.from+=1)}),s.from>=i&&(i+=1),o.push(s)}),o}},{key:"adjustedCalculatedMoves",value:function(r){return r.forEach(function(n,i){var o=r.slice(i+1);o.forEach(function(a){var s=a.from<a.to;a.from>n.from&&s&&(a.from-=1)})}),r}},{key:"calculateAndSyncMoves",value:function(r,n){var i=this;if(!Qt(this,Jn).isPerformingUndoRedo()&&!(r===!1||n===!1)){var o=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(Qt(this,SR),Qt(this,RR)));Qt(this,Jn).getSheetId()===null?Qt(this,Jn).getPostponeAction(function(){return i.syncMoves(o)}):this.syncMoves(o)}}},{key:"getIndexesChangeSyncMethod",value:function(){var r=this,n="set".concat(Qi(Qt(this,ip)),"Order");return function(i){if(!Qt(r,Jn).isPerformingUndoRedo()){var o=Qt(r,as).getIndexesSequence();if(i==="update"){var a=Qt(r,w1).map(function(f){return o.indexOf(f)}),s=Qt(r,Jn).getEngine().getSheetDimensions(Qt(r,Jn).getSheetId()),l;Qt(r,ip)==="row"?l=s.height:l=s.width;for(var u=a.length,c=u;c<l;c+=1)a.push(c);Qt(r,Jn).getEngine()[n](Qt(r,Jn).getSheetId(),a)}os(r,w1,o)}}}},{key:"init",value:function(){os(this,w1,Qt(this,as).getIndexesSequence())}}]),t}();const o$=Oze;function Zv(t){"@babel/helpers - typeof";return Zv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zv(t)}function Tze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _ze(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ize(n.key),n)}}function Aze(t,e,r){return e&&_ze(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ize(t){var e=Nze(t,"string");return Zv(e)==="symbol"?e:String(e)}function Nze(t,e){if(Zv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Zv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function bl(t,e,r){Pze(t,e),e.set(t,r)}function Pze(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zo(t,e){var r=jz(t,e,"get");return Mze(t,r)}function Mze(t,e){return e.get?e.get.call(t):e.value}function wl(t,e,r){var n=jz(t,e,"set");return kze(t,n,r),r}function jz(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function kze(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var R1=new WeakMap,E1=new WeakMap,ER=new WeakMap,CR=new WeakMap,OR=new WeakMap,TR=new WeakMap,_R=new WeakMap,xze=function(){function t(e,r,n){Tze(this,t),bl(this,R1,{writable:!0,value:void 0}),bl(this,E1,{writable:!0,value:void 0}),bl(this,ER,{writable:!0,value:void 0}),bl(this,CR,{writable:!0,value:!1}),bl(this,OR,{writable:!0,value:!1}),bl(this,TR,{writable:!0,value:null}),bl(this,_R,{writable:!0,value:null}),wl(this,R1,new o$("row",e,this)),wl(this,E1,new o$("column",r,this)),wl(this,ER,n)}return Aze(t,[{key:"getForAxis",value:function(r){return r==="row"?Zo(this,R1):Zo(this,E1)}},{key:"setPerformUndo",value:function(r){wl(this,CR,r)}},{key:"setPerformRedo",value:function(r){wl(this,OR,r)}},{key:"isPerformingUndoRedo",value:function(){return Zo(this,CR)||Zo(this,OR)}},{key:"getSheetId",value:function(){return Zo(this,_R)}},{key:"getEngine",value:function(){return Zo(this,TR)}},{key:"getPostponeAction",value:function(){return Zo(this,ER)}},{key:"setupSyncEndpoint",value:function(r,n){wl(this,TR,r),wl(this,_R,n),Zo(this,R1).init(),Zo(this,E1).init()}}]),t}();const $ze=xze;function Lze(t){return Hze(t)||Fze(t)||Wz(t)||Dze()}function Dze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fze(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Hze(t){if(Array.isArray(t))return LO(t)}function zs(t){"@babel/helpers - typeof";return zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zs(t)}function gc(t,e){return Vze(t)||Bze(t,e)||Wz(t,e)||Uze()}function Uze(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wz(t,e){if(t){if(typeof t=="string")return LO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LO(t,e)}}function LO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Bze(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function Vze(t){if(Array.isArray(t))return t}function jze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Gz(n.key),n)}}function Wze(t,e,r){return e&&a$(t.prototype,e),r&&a$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gl(){return typeof Reflect<"u"&&Reflect.get?Gl=Reflect.get.bind():Gl=function(e,r,n){var i=Gze(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Gl.apply(this,arguments)}function Gze(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Oa(t),t!==null););return t}function zze(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&DO(t,e)}function DO(t,e){return DO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},DO(t,e)}function Yze(t){var e=Xze();return function(){var n=Oa(t),i;if(e){var o=Oa(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Kze(this,i)}}function Kze(t,e){if(e&&(zs(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wo(t)}function wo(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oa(t){return Oa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Oa(t)}function yc(t,e,r){return e=Gz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gz(t){var e=qze(t,"string");return zs(e)==="symbol"?e:String(e)}function qze(t,e){if(zs(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AR(t,e,r){Qze(t,e),e.set(t,r)}function Qze(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ss(t,e,r){var n=zz(t,e,"set");return Zze(t,n,r),r}function Zze(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function bc(t,e){var r=zz(t,e,"get");return Jze(t,r)}function zz(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function Jze(t,e){return e.get?e.get.call(t):e.value}var hn="formulas",eYe=["maxRows","maxColumns","language"],tYe=260;Ne.getSingleton().register("afterNamedExpressionAdded");Ne.getSingleton().register("afterNamedExpressionRemoved");Ne.getSingleton().register("afterSheetAdded");Ne.getSingleton().register("afterSheetRemoved");Ne.getSingleton().register("afterSheetRenamed");Ne.getSingleton().register("afterFormulasValuesUpdate");var wc=function(e){return e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto"},Jo=new WeakMap,IR=new WeakMap,op=new WeakMap,rYe=function(t){zze(r,t);var e=Yze(r);function r(){var n;jze(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),AR(wo(n),Jo,{writable:!0,value:!1}),AR(wo(n),IR,{writable:!0,value:!1}),AR(wo(n),op,{writable:!0,value:[["valuesUpdated",function(){var s;return(s=n).onEngineValuesUpdated.apply(s,arguments)}],["namedExpressionAdded",function(){var s;return(s=n).onEngineNamedExpressionsAdded.apply(s,arguments)}],["namedExpressionRemoved",function(){var s;return(s=n).onEngineNamedExpressionsRemoved.apply(s,arguments)}],["sheetAdded",function(){var s;return(s=n).onEngineSheetAdded.apply(s,arguments)}],["sheetRenamed",function(){var s;return(s=n).onEngineSheetRenamed.apply(s,arguments)}],["sheetRemoved",function(){var s;return(s=n).onEngineSheetRemoved.apply(s,arguments)}]]}),yc(wo(n),"staticRegister",$i("formulas")),yc(wo(n),"engine",null),yc(wo(n),"sheetName",null),yc(wo(n),"indexSyncer",null),yc(wo(n),"rowAxisSyncer",null),yc(wo(n),"columnAxisSyncer",null),n}return Wze(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[hn]}},{key:"enablePlugin",value:function(){var i,o=this;if(!this.enabled){if(this.engine=(i=lze(this.hot))!==null&&i!==void 0?i:this.engine,!this.engine){Dt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var a=this.addSheet(this.sheetName,this.hot.getSourceDataArray());a!==!1&&(this.sheetName=a)}this.addHook("beforeLoadData",function(){return o.onBeforeLoadData.apply(o,arguments)}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeUpdateData",function(){return o.onBeforeLoadData.apply(o,arguments)}),this.addHook("afterUpdateData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("modifyData",function(){return o.onModifyData.apply(o,arguments)}),this.addHook("modifySourceData",function(){return o.onModifySourceData.apply(o,arguments)}),this.addHook("beforeValidate",function(){return o.onBeforeValidate.apply(o,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return o.onAfterSetSourceDataAtCell.apply(o,arguments)}),this.addHook("afterSetDataAtCell",function(){return o.onAfterSetDataAtCell.apply(o,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return o.onAfterSetDataAtCell.apply(o,arguments)}),this.addHook("beforeCreateRow",function(){return o.onBeforeCreateRow.apply(o,arguments)}),this.addHook("beforeCreateCol",function(){return o.onBeforeCreateCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("beforeRemoveCol",function(){return o.onBeforeRemoveCol.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.indexSyncer=new $ze(this.hot.rowIndexMapper,this.hot.columnIndexMapper,function(s){o.hot.addHookOnce("init",function(){s()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",function(s,l,u,c){o.rowAxisSyncer.storeMovesInformation(s,l,c)}),this.hot.addHook("beforeColumnMove",function(s,l,u,c){o.columnAxisSyncer.storeMovesInformation(s,l,c)}),this.hot.addHook("afterRowMove",function(s,l,u,c,f){o.rowAxisSyncer.calculateAndSyncMoves(c,f)}),this.hot.addHook("afterColumnMove",function(s,l,u,c,f){o.columnAxisSyncer.calculateAndSyncMoves(c,f)}),this.hot.addHook("beforeColumnFreeze",function(s,l){o.columnAxisSyncer.storeMovesInformation([s],o.hot.getSettings().fixedColumnsStart,l)}),this.hot.addHook("afterColumnFreeze",function(s,l){o.columnAxisSyncer.calculateAndSyncMoves(l,l)}),this.hot.addHook("beforeColumnUnfreeze",function(s,l){o.columnAxisSyncer.storeMovesInformation([s],o.hot.getSettings().fixedColumnsStart-1,l)}),this.hot.addHook("afterColumnUnfreeze",function(s,l){o.columnAxisSyncer.calculateAndSyncMoves(l,l)}),this.addHook("afterCellMetaReset",function(){return o.onAfterCellMetaReset.apply(o,arguments)}),this.addHook("beforeUndo",function(){o.indexSyncer.setPerformUndo(!0),o.engine.undo()}),this.addHook("beforeRedo",function(){o.indexSyncer.setPerformRedo(!0),o.engine.redo()}),this.addHook("afterUndo",function(){o.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",function(){o.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("beforeAutofill",function(){return o.onBeforeAutofill.apply(o,arguments)}),bc(this,op).forEach(function(s){var l=gc(s,2),u=l[0],c=l[1];return o.engine.on(u,c)}),Gl(Oa(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this;bc(this,op).forEach(function(o){var a=gc(o,2),s=a[0],l=a[1];return i.engine.off(s,l)}),t$(this.engine,this.hot),this.engine=null,Gl(Oa(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(i){var o=oze(this.hot.getSettings());aze(this.engine.getConfig(),o)&&this.engine.updateConfig(o);var a=this.hot.getSettings()[hn];if(Ae(a)&&Ae(a.sheetName)&&a.sheetName!==this.sheetName&&this.switchSheet(a.sheetName),!i.data&&this.sheetName===null){var s=this.hot.getSettings()[hn].sheetName;s&&this.engine.doesSheetExist(s)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(s??void 0,this.hot.getSourceDataArray())}Gl(Oa(r.prototype),"updatePlugin",this).call(this,i)}},{key:"destroy",value:function(){var i=this;bc(this,op).forEach(function(o){var a,s=gc(o,2),l=s[0],u=s[1];return(a=i.engine)===null||a===void 0?void 0:a.off(l,u)}),ss(this,op,null),t$(this.engine,this.hot),this.engine=null,Gl(Oa(r.prototype),"destroy",this).call(this)}},{key:"addSheet",value:function(i,o){if(Ae(o)&&!BSe(o))return Dt("The provided data should be an array of arrays."),!1;if(i!=null&&this.engine.doesSheetExist(i))return Dt("Sheet with the provided name already exists."),!1;try{var a=this.engine.addSheet(i??void 0);return o&&this.engine.setSheetContent(this.engine.getSheetId(a),o),a}catch(s){return Dt(s.message),!1}}},{key:"switchSheet",value:function(i){if(!this.engine.doesSheetExist(i)){q_("The sheet named `".concat(i,"` does not exist, switch aborted."));return}this.sheetName=i;var o=this.engine.getSheetSerialized(this.sheetId);o.length>0&&this.hot.loadData(o,"".concat(Qi(hn),".switchSheet"))}},{key:"getCellType",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(i),l=this.hot.toPhysicalColumn(o);return s!==null&&l!==null?this.engine.getCellType({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o)}):"EMPTY"}},{key:"isFormulaCellType",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o)})}},{key:"renderDependentSheets",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=new Set;i.forEach(function(l){var u,c=l==null||(u=l.address)===null||u===void 0?void 0:u.sheet;c!==void 0&&(s.has(c)||s.add(c))}),e$(this.engine).forEach(function(l,u){if((a||u!==o.sheetId)&&s.has(u)){var c;l.render(),(c=l.view)===null||c===void 0||c.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=function(c){var f,h=(f=c==null?void 0:c.address)!==null&&f!==void 0?f:{},d=h.row,p=h.col,m=h.sheet;return Ae(m)?"".concat(m,":").concat(d,"x").concat(p):""},l=new Set(a.map(function(u){return s(u)}));i.forEach(function(u){var c,f,h=(c=u.address)!==null&&c!==void 0?c:{},d=h.row,p=h.col;if(!(Ae(d)===!1||Ae(p)===!1||d>=o.hot.countRows()||p>=o.hot.countCols())){var m=u==null||(f=u.address)===null||f===void 0?void 0:f.sheet,y=s(u);if(m!==void 0&&!l.has(y)){var S=e$(o.engine).get(m);if(!S)return;S.validateCell(S.getDataAtCell(d,p),S.getCellMeta(d,p),function(){})}}})}},{key:"syncChangeWithEngine",value:function(i,o,a){var s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(s)){Dt("Not possible to set cell data at ".concat(JSON.stringify(s)));return}var l=this.hot.getCellMeta(i,o);return wR(a,l.type)&&(r$(a,l.dateFormat)?a=n$(a,l.dateFormat):mze(a)===!1&&(a="'".concat(a))),this.engine.setCellContents(s,a)}},{key:"onBeforeValidate",value:function(i,o,a){var s=this.hot.propToCol(a);if(this.isFormulaCellType(o,s)){var l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId},u=this.hot.getCellMeta(o,s),c=this.engine.getCellValue(l);return u.type==="date"&&Ln(c)&&(c=i$(c,u.dateFormat)),zs(c)==="object"&&c!==null?c.value:c}return i}},{key:"onBeforeAutofill",value:function(i,o,a){var s=o.getTopStartCorner(),l=s.row,u=s.col,c=o.getBottomEndCorner(),f=c.row,h=c.col,d=a.getTopStartCorner(),p=d.row,m=d.col,y=a.getBottomEndCorner(),S=y.row,R=y.col,E={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(f),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId}},O={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(p),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(m),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(S),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(R),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(O)===!1)return!1;for(var A=this.engine.getFillRangeData(E,O),B=E.start,j=B.row,J=B.col,Y=E.end,q=Y.row,ee=Y.col,ae=q-j+1,ne=ee-J+1,ue=0;ue<A.length;ue+=1)for(var me=0;me<A[ue].length;me+=1){var Re=A[ue][me],ge=ue%ae,I=me%ne,v=this.hot.getCellMeta(ge,I);wR(Re,v.type)&&(Re.startsWith("'")?A[ue][me]=Re.slice(1):this.isFormulaCellType(ge,I,this.sheetId)===!1&&(A[ue][me]=vze(Re,v.dateFormat)))}return A}},{key:"onBeforeLoadData",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";a.includes(Qi(hn))||ss(this,IR,zt(this.hot.getSettings().data))}},{key:"onAfterCellMetaReset",value:function(){var i=this,o=this.hot.getSourceDataArray(),a=!1;o.forEach(function(s,l){s.forEach(function(u,c){var f=i.hot.getCellMeta(l,c),h=f.dateFormat;wR(u,f.type)&&(a=!0,r$(u,h)?o[l][c]=n$(u,h):i.isFormulaCellType(l,c)===!1&&(o[l][c]="'".concat(u)))})}),a===!0&&(ss(this,Jo,!0),this.engine.setSheetContent(this.sheetId,o),ss(this,Jo,!1))}},{key:"onAfterLoadData",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!a.includes(Qi(hn)))if(this.sheetName=dze(this.engine,this.hot.getSettings()[hn].sheetName),bc(this,IR))this.switchSheet(this.sheetName);else{var s=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,s)){ss(this,Jo,!0);var l=this.engine.setSheetContent(this.sheetId,s);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(l),ss(this,Jo,!1)}}}},{key:"onModifyData",value:function(i,o,a,s){if(!(s!=="get"||bc(this,Jo)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(i);if(!(l===null||o===null)){var u=this.isFormulaCellType(l,o);if(!u){var c=this.getCellType(l,o);if(c!=="ARRAY"){Bz(a.value)&&(a.value=pze(a.value));return}}var f={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId},h=this.engine.getCellValue(f),d=this.hot.getCellMeta(l,o);d.type==="date"&&Ln(h)&&(h=i$(h,d.dateFormat));var p=zs(h)==="object"&&h!==null?h.value:h;a.value=p}}}},{key:"onModifySourceData",value:function(i,o,a,s){if(!(s!=="get"||bc(this,Jo)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(i),u=this.hot.propToCol(o);if(!(l===null||u===null)){var c=this.isFormulaCellType(l,u);if(!c){var f=this.getCellType(l,u);if(f!=="ARRAY")return}var h=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(h.width===0&&h.height===0)){var d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};a.value=this.engine.getCellSerialized(d)}}}}},{key:"onAfterSetDataAtCell",value:function(i,o){var a=this;if(!wc(o)){var s=[],l=[],u=this.engine.batch(function(){i.forEach(function(c){var f=gc(c,4),h=f[0],d=f[1],p=f[3],m=a.hot.propToCol(d),y=a.hot.toPhysicalRow(h),S=a.hot.toPhysicalColumn(m),R={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(m),sheet:a.sheetId};y!==null&&S!==null?a.syncChangeWithEngine(h,m,p):s.push([h,m,p]),l.push({address:R})})});s.length&&this.hot.addHookOnce("afterChange",function(){var c=a.engine.batch(function(){s.forEach(function(f){var h=gc(f,3),d=h[0],p=h[1],m=h[2];a.syncChangeWithEngine(d,p,m)})});a.renderDependentSheets(c,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,l)}}},{key:"onAfterSetSourceDataAtCell",value:function(i,o){var a=this;if(!wc(o)){var s=[],l=[];i.forEach(function(u){var c=gc(u,4),f=c[0],h=c[1],d=c[3],p=a.hot.propToCol(h);if(Ln(p)){var m={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(f),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(p),sheet:a.sheetId};if(!a.engine.isItPossibleToSetCellContents(m)){Dt("Not possible to set source cell data at ".concat(JSON.stringify(m)));return}l.push({address:m}),s.push.apply(s,Lze(a.engine.setCellContents(m,d)))}}),this.renderDependentSheets(s),this.validateDependentCells(s,l)}}},{key:"onBeforeCreateRow",value:function(i,o){var a=this.rowAxisSyncer.getHfIndexFromVisualIndex(i);if(i>=this.hot.countRows()&&(a=i),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[a,o]))return!1}},{key:"onBeforeCreateCol",value:function(i,o){var a=this.columnAxisSyncer.getHfIndexFromVisualIndex(i);if(i>=this.hot.countCols()&&(a=i),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[a,o]))return!1}},{key:"onBeforeRemoveRow",value:function(i,o,a){var s=this,l=this.rowAxisSyncer.setRemovedHfIndexes(a),u=l.every(function(c){return s.engine.isItPossibleToRemoveRows(s.sheetId,[c,1])});return u===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(i,o,a){var s=this,l=this.columnAxisSyncer.setRemovedHfIndexes(a),u=l.every(function(c){return s.engine.isItPossibleToRemoveColumns(s.sheetId,[c,1])});return u===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(i,o,a){if(!wc(a)){var s=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(i),o]);this.renderDependentSheets(s)}}},{key:"onAfterCreateCol",value:function(i,o,a){if(!wc(a)){var s=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(i),o]);this.renderDependentSheets(s)}}},{key:"onAfterRemoveRow",value:function(i,o,a,s){var l=this;if(!wc(s)){var u=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),c=this.engine.batch(function(){u.forEach(function(f){l.engine.removeRows(l.sheetId,[f,1])})});this.renderDependentSheets(c)}}},{key:"onAfterRemoveCol",value:function(i,o,a,s){var l=this;if(!wc(s)){var u=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),c=this.engine.batch(function(){u.forEach(function(f){l.engine.removeColumns(l.sheetId,[f,1])})});this.renderDependentSheets(c)}}},{key:"onAfterDetachChild",value:function(i,o,a){var s,l=this;ss(this,Jo,!0);var u=this.hot.getSourceDataArray(a,0,a+(((s=o.__children)===null||s===void 0?void 0:s.length)||0),this.hot.countSourceCols());ss(this,Jo,!1),u.forEach(function(c,f){c.forEach(function(h,d){l.engine.setCellContents({col:d,row:a+f,sheet:l.sheetId},[[h]])})})}},{key:"onEngineValuesUpdated",value:function(i){this.hot.runHooks("afterFormulasValuesUpdate",i)}},{key:"onEngineNamedExpressionsAdded",value:function(i,o){this.hot.runHooks("afterNamedExpressionAdded",i,o)}},{key:"onEngineNamedExpressionsRemoved",value:function(i,o){this.hot.runHooks("afterNamedExpressionRemoved",i,o)}},{key:"onEngineSheetAdded",value:function(i){this.hot.runHooks("afterSheetAdded",i)}},{key:"onEngineSheetRenamed",value:function(i,o){this.hot.runHooks("afterSheetRenamed",i,o)}},{key:"onEngineSheetRemoved",value:function(i,o){this.hot.runHooks("afterSheetRemoved",i,o)}}],[{key:"PLUGIN_KEY",get:function(){return hn}},{key:"PLUGIN_PRIORITY",get:function(){return tYe}},{key:"SETTING_KEYS",get:function(){return[hn].concat(eYe)}}]),r}(xt);function nYe(t,e){return sYe(t)||aYe(t,e)||oYe(t,e)||iYe()}function iYe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oYe(t,e){if(t){if(typeof t=="string")return s$(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s$(t,e)}}function s$(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function aYe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function sYe(t){if(Array.isArray(t))return t}function lYe(t){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var i=nYe(r,4),o=i[1],a=i[3];o-a!==0&&(n=1)}return this.getTranslatedPhrase(o7,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,i=r.to,o=Math.max(Math.min(n.col,i.col),0),a=Math.max(n.col,i.col),s=[],l=o;l<=a;l+=1)s.push(l);t.hideColumns(s);var u=s[s.length-1],c=this.columnIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(c)&&c>=0?this.selectColumns(c):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function C1(t){return hYe(t)||fYe(t)||cYe(t)||uYe()}function uYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cYe(t,e){if(t){if(typeof t=="string")return FO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FO(t,e)}}function fYe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function hYe(t){if(Array.isArray(t))return FO(t)}function FO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function dYe(t){var e=[];return{key:"hidden_columns_show",name:function(){var n=e.length>1?1:0;return this.getTranslatedPhrase(a7,n)},callback:function(){var n,i;if(e.length!==0){var o=e[0],a=e[e.length-1];o=(n=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&n!==void 0?n:0,a=(i=this.columnIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&i!==void 0?i:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0);var s=a-o+1===this.countCols();s||this.selectColumns(o,a)}},disabled:!1,hidden:function(){var n=this,i=st(t.getHiddenColumns(),function(R){return n.toPhysicalColumn(R)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;e.length=0;var o=this.getSelectedRangeLast(),a=o.getTopStartCorner().col,s=o.getBottomEndCorner().col,l=this.columnIndexMapper,u=l.getRenderableFromVisualIndex(a),c=l.getRenderableFromVisualIndex(s),f=l.getNotTrimmedIndexes(),h=[];if(a!==s){var d=s-a+1,p=c-u+1;if(d>p){var m=f.slice(a,s+1);h.push.apply(h,C1(m.filter(function(R){return i.includes(R)})))}}else if(u===0&&u<a)h.push.apply(h,C1(f.slice(0,a)));else if(u===null)h.push.apply(h,C1(f.slice(0,this.countCols())));else{var y=this.countCols()-1,S=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(y,-1));c===S&&y>s&&h.push.apply(h,C1(f.slice(s+1)))}return D(h,function(R){e.push(n.toVisualColumn(R))}),e.length===0}}}function Dh(t){"@babel/helpers - typeof";return Dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dh(t)}function pYe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vYe(n.key),n)}}function mYe(t,e,r){return e&&l$(t.prototype,e),r&&l$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function vYe(t){var e=gYe(t,"string");return Dh(e)==="symbol"?e:String(e)}function gYe(t,e){if(Dh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function zl(){return typeof Reflect<"u"&&Reflect.get?zl=Reflect.get.bind():zl=function(e,r,n){var i=yYe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},zl.apply(this,arguments)}function yYe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ta(t),t!==null););return t}function bYe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&HO(t,e)}function HO(t,e){return HO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},HO(t,e)}function wYe(t){var e=RYe();return function(){var n=Ta(t),i;if(e){var o=Ta(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return SYe(this,i)}}function SYe(t,e){if(e&&(Dh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UO(t)}function UO(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function RYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ta(t){return Ta=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ta(t)}function u$(t,e,r){EYe(t,e),e.set(t,r)}function EYe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ei(t,e){var r=Yz(t,e,"get");return CYe(t,r)}function CYe(t,e){return e.get?e.get.call(t):e.value}function ap(t,e,r){var n=Yz(t,e,"set");return OYe(t,n,r),r}function Yz(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function OYe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}Ne.getSingleton().register("beforeHideColumns");Ne.getSingleton().register("afterHideColumns");Ne.getSingleton().register("beforeUnhideColumns");Ne.getSingleton().register("afterUnhideColumns");var NR="hiddenColumns",TYe=310,mo=new WeakMap,vo=new WeakMap,_Ye=function(t){bYe(r,t);var e=wYe(r);function r(){var n;pYe(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),u$(UO(n),mo,{writable:!0,value:{}}),u$(UO(n),vo,{writable:!0,value:null}),n}return mYe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[NR]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[NR];lt(o)&&(ap(this,mo,o),zt(o.copyPasteEnabled)&&(o.copyPasteEnabled=!0)),ap(this,vo,new ow),ei(this,vo).addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,ei(this,vo)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(a,s,l){return i.onAfterGetCellMeta(a,s,l)}),this.addHook("modifyColWidth",function(a,s){return i.onModifyColWidth(a,s)}),this.addHook("afterGetColHeader",function(){return i.onAfterGetColHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(a){return i.onModifyCopyableRange(a)}),zl(Ta(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),zl(Ta(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),ap(this,mo,{}),zl(Ta(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(i){var o=this,a=this.getHiddenColumns(),s=this.isValidConfig(i),l=a,u=ei(this,vo).getValues().slice(),c=i.length>0;if(s&&c){var f=i.map(function(d){return o.hot.toPhysicalColumn(d)});D(f,function(d){u[d]=!1}),l=gn(u,function(d,p,m){return p&&d.push(o.hot.toVisualColumn(m)),d},[])}var h=this.hot.runHooks("beforeUnhideColumns",a,l,s&&c);h!==!1&&(s&&c&&ei(this,vo).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",a,l,s&&c,s&&l.length<a.length))}},{key:"showColumn",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.showColumns(o)}},{key:"hideColumns",value:function(i){var o=this,a=this.getHiddenColumns(),s=this.isValidConfig(i),l=a;s&&(l=Array.from(new Set(a.concat(i))));var u=this.hot.runHooks("beforeHideColumns",a,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){D(i,function(c){ei(o,vo).setValueAtIndex(o.hot.toPhysicalColumn(c),!0)})},!0),this.hot.runHooks("afterHideColumns",a,l,s,s&&l.length>a.length))}},{key:"hideColumn",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.hideColumns(o)}},{key:"getHiddenColumns",value:function(){var i=this;return st(ei(this,vo).getHiddenIndexes(),function(o){return i.hot.toVisualColumn(o)})}},{key:"isHidden",value:function(i){return ei(this,vo).getValueAtIndex(this.hot.toPhysicalColumn(i))||!1}},{key:"isValidConfig",value:function(i){var o=this.hot.countCols();return Array.isArray(i)&&i.length>0?i.every(function(a){return Number.isInteger(a)&&a>=0&&a<o}):!1}},{key:"resetCellsMeta",value:function(){D(this.hot.getCellsMeta(),function(i){i&&(i.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(i,o){if(this.isHidden(o))return 0;if(ei(this,mo).indicators&&(this.isHidden(o+1)||this.isHidden(o-1))&&typeof i=="number"&&this.hot.hasColHeaders())return i+15}},{key:"onAfterGetCellMeta",value:function(i,o,a){if(ei(this,mo).copyPasteEnabled===!1&&this.isHidden(o)&&(a.skipColumnOnPaste=!0),this.isHidden(o-1))a.className=a.className||"",a.className.indexOf("afterHiddenColumn")===-1&&(a.className+=" afterHiddenColumn");else if(a.className){var s=a.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenColumn");l>-1&&s.splice(l,1),a.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var o=this;if(ei(this,mo).copyPasteEnabled)return i;var a=[],s=function(u,c,f,h){a.push({startRow:u,endRow:c,startCol:f,endCol:h})};return D(i,function(l){var u=!0,c=0;De(l.startCol,l.endCol,function(f){o.isHidden(f)?(u||s(l.startRow,l.endRow,c,f-1),u=!0):(u&&(c=f),f===l.endCol&&s(l.startRow,l.endRow,c,f),u=!1)})}),a}},{key:"onAfterGetColHeader",value:function(i,o){if(!(!ei(this,mo).indicators||i<0)){var a=[];i>=1&&this.isHidden(i-1)&&a.push("afterHiddenColumn"),i<this.hot.countCols()-1&&this.isHidden(i+1)&&a.push("beforeHiddenColumn"),le(o,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:at},lYe(this),dYe(this))}},{key:"onMapInit",value:function(){Array.isArray(ei(this,mo).columns)&&this.hideColumns(ei(this,mo).columns)}},{key:"destroy",value:function(){ap(this,mo,null),ap(this,vo,null),zl(Ta(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return NR}},{key:"PLUGIN_PRIORITY",get:function(){return TYe}}]),r}(xt);function AYe(t,e){return MYe(t)||PYe(t,e)||NYe(t,e)||IYe()}function IYe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NYe(t,e){if(t){if(typeof t=="string")return c$(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c$(t,e)}}function c$(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function PYe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function MYe(t){if(Array.isArray(t))return t}function kYe(t){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var i=AYe(r,3),o=i[0],a=i[2];o-a!==0&&(n=1)}return this.getTranslatedPhrase(s7,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,i=r.to,o=Math.max(Math.min(n.row,i.row),0),a=Math.max(n.row,i.row),s=[],l=o;l<=a;l+=1)s.push(l);t.hideRows(s);var u=s[s.length-1],c=this.rowIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(c)&&c>=0?this.selectRows(c):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function O1(t){return DYe(t)||LYe(t)||$Ye(t)||xYe()}function xYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Ye(t,e){if(t){if(typeof t=="string")return BO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BO(t,e)}}function LYe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function DYe(t){if(Array.isArray(t))return BO(t)}function BO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function FYe(t){var e=[];return{key:"hidden_rows_show",name:function(){var n=e.length>1?1:0;return this.getTranslatedPhrase(l7,n)},callback:function(){var n,i;if(e.length!==0){var o=e[0],a=e[e.length-1];o=(n=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&n!==void 0?n:0,a=(i=this.rowIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&i!==void 0?i:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0);var s=a-o+1===this.countRows();s||this.selectRows(o,a)}},disabled:!1,hidden:function(){var n=this,i=st(t.getHiddenRows(),function(R){return n.toPhysicalRow(R)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;e.length=0;var o=this.getSelectedRangeLast(),a=o.getTopStartCorner().row,s=o.getBottomEndCorner().row,l=this.rowIndexMapper,u=l.getRenderableFromVisualIndex(a),c=l.getRenderableFromVisualIndex(s),f=l.getNotTrimmedIndexes(),h=[];if(a!==s){var d=s-a+1,p=c-u+1;if(d>p){var m=f.slice(a,s+1);h.push.apply(h,O1(m.filter(function(R){return i.includes(R)})))}}else if(u===0&&u<a)h.push.apply(h,O1(f.slice(0,a)));else if(u===null)h.push.apply(h,O1(f.slice(0,this.countRows())));else{var y=this.countRows()-1,S=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(y,-1));c===S&&y>s&&h.push.apply(h,O1(f.slice(s+1)))}return D(h,function(R){e.push(n.toVisualRow(R))}),e.length===0}}}function Fh(t){"@babel/helpers - typeof";return Fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fh(t)}function HYe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,BYe(n.key),n)}}function UYe(t,e,r){return e&&f$(t.prototype,e),r&&f$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function BYe(t){var e=VYe(t,"string");return Fh(e)==="symbol"?e:String(e)}function VYe(t,e){if(Fh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Yl(){return typeof Reflect<"u"&&Reflect.get?Yl=Reflect.get.bind():Yl=function(e,r,n){var i=jYe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Yl.apply(this,arguments)}function jYe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=_a(t),t!==null););return t}function WYe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&VO(t,e)}function VO(t,e){return VO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},VO(t,e)}function GYe(t){var e=YYe();return function(){var n=_a(t),i;if(e){var o=_a(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return zYe(this,i)}}function zYe(t,e){if(e&&(Fh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jO(t)}function jO(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function YYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _a(t){return _a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_a(t)}function h$(t,e,r){KYe(t,e),e.set(t,r)}function KYe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bi(t,e){var r=Kz(t,e,"get");return XYe(t,r)}function XYe(t,e){return e.get?e.get.call(t):e.value}function sp(t,e,r){var n=Kz(t,e,"set");return qYe(t,n,r),r}function Kz(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function qYe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}Ne.getSingleton().register("beforeHideRows");Ne.getSingleton().register("afterHideRows");Ne.getSingleton().register("beforeUnhideRows");Ne.getSingleton().register("afterUnhideRows");var PR="hiddenRows",QYe=320,ea=new WeakMap,go=new WeakMap,ZYe=function(t){WYe(r,t);var e=GYe(r);function r(){var n;HYe(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),h$(jO(n),ea,{writable:!0,value:{}}),h$(jO(n),go,{writable:!0,value:null}),n}return UYe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PR]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[PR];lt(o)&&(sp(this,ea,o),zt(o.copyPasteEnabled)&&(o.copyPasteEnabled=!0)),sp(this,go,new ow),bi(this,go).addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,bi(this,go)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(a,s,l){return i.onAfterGetCellMeta(a,s,l)}),this.addHook("modifyRowHeight",function(a,s){return i.onModifyRowHeight(a,s)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(a){return i.onModifyCopyableRange(a)}),Yl(_a(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Yl(_a(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),sp(this,ea,{}),Yl(_a(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(i){var o=this,a=this.getHiddenRows(),s=this.isValidConfig(i),l=a,u=bi(this,go).getValues().slice(),c=i.length>0;if(s&&c){var f=i.map(function(d){return o.hot.toPhysicalRow(d)});D(f,function(d){u[d]=!1}),l=gn(u,function(d,p,m){return p&&d.push(o.hot.toVisualRow(m)),d},[])}var h=this.hot.runHooks("beforeUnhideRows",a,l,s&&c);h!==!1&&(s&&c&&bi(this,go).setValues(u),this.hot.runHooks("afterUnhideRows",a,l,s&&c,s&&l.length<a.length))}},{key:"showRow",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.showRows(o)}},{key:"hideRows",value:function(i){var o=this,a=this.getHiddenRows(),s=this.isValidConfig(i),l=a;s&&(l=Array.from(new Set(a.concat(i))));var u=this.hot.runHooks("beforeHideRows",a,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){D(i,function(c){bi(o,go).setValueAtIndex(o.hot.toPhysicalRow(c),!0)})},!0),this.hot.runHooks("afterHideRows",a,l,s,s&&l.length>a.length))}},{key:"hideRow",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.hideRows(o)}},{key:"getHiddenRows",value:function(){var i=this;return st(bi(this,go).getHiddenIndexes(),function(o){return i.hot.toVisualRow(o)})}},{key:"isHidden",value:function(i){return bi(this,go).getValueAtIndex(this.hot.toPhysicalRow(i))||!1}},{key:"isValidConfig",value:function(i){var o=this.hot.countRows();return Array.isArray(i)&&i.length>0?i.every(function(a){return Number.isInteger(a)&&a>=0&&a<o}):!1}},{key:"resetCellsMeta",value:function(){D(this.hot.getCellsMeta(),function(i){i&&(i.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(i,o){return this.isHidden(o)?0:i}},{key:"onAfterGetCellMeta",value:function(i,o,a){if(bi(this,ea).copyPasteEnabled===!1&&this.isHidden(i)&&(a.skipRowOnPaste=!0),this.isHidden(i-1))a.className=a.className||"",a.className.indexOf("afterHiddenRow")===-1&&(a.className+=" afterHiddenRow");else if(a.className){var s=a.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenRow");l>-1&&s.splice(l,1),a.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var o=this;if(bi(this,ea).copyPasteEnabled)return i;var a=[],s=function(u,c,f,h){a.push({startRow:u,endRow:c,startCol:f,endCol:h})};return D(i,function(l){var u=!0,c=0;De(l.startRow,l.endRow,function(f){o.isHidden(f)?(u||s(c,f-1,l.startCol,l.endCol),u=!0):(u&&(c=f),f===l.endRow&&s(c,f,l.startCol,l.endCol),u=!1)})}),a}},{key:"onAfterGetRowHeader",value:function(i,o){if(!(!bi(this,ea).indicators||i<0)){var a=[];i>=1&&this.isHidden(i-1)&&a.push("afterHiddenRow"),i<this.hot.countRows()-1&&this.isHidden(i+1)&&a.push("beforeHiddenRow"),le(o,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:at},kYe(this),FYe(this))}},{key:"onMapInit",value:function(){Array.isArray(bi(this,ea).rows)&&this.hideRows(bi(this,ea).rows)}},{key:"destroy",value:function(){sp(this,ea,null),sp(this,go,null),Yl(_a(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PR}},{key:"PLUGIN_PRIORITY",get:function(){return QYe}}]),r}(xt);function JYe(t,e){return nKe(t)||rKe(t,e)||tKe(t,e)||eKe()}function eKe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tKe(t,e){if(t){if(typeof t=="string")return d$(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d$(t,e)}}function d$(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function rKe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function nKe(t){if(Array.isArray(t))return t}function iKe(t){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase($A)},callback:function(r,n){var i=JYe(n,1),o=i[0].start.col;t.freezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function oKe(t,e){return uKe(t)||lKe(t,e)||sKe(t,e)||aKe()}function aKe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sKe(t,e){if(t){if(typeof t=="string")return p$(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p$(t,e)}}function p$(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function lKe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function uKe(t){if(Array.isArray(t))return t}function cKe(t){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(LA)},callback:function(r,n){var i=oKe(n,1),o=i[0].start.col;t.unfreezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Hh(t){"@babel/helpers - typeof";return Hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hh(t)}function fKe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dKe(n.key),n)}}function hKe(t,e,r){return e&&m$(t.prototype,e),r&&m$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function dKe(t){var e=pKe(t,"string");return Hh(e)==="symbol"?e:String(e)}function pKe(t,e){if(Hh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function of(){return typeof Reflect<"u"&&Reflect.get?of=Reflect.get.bind():of=function(e,r,n){var i=mKe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},of.apply(this,arguments)}function mKe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Bs(t),t!==null););return t}function vKe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&WO(t,e)}function WO(t,e){return WO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},WO(t,e)}function gKe(t){var e=bKe();return function(){var n=Bs(t),i;if(e){var o=Bs(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return yKe(this,i)}}function yKe(t,e){if(e&&(Hh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xz(t)}function Xz(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bKe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bs(t){return Bs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bs(t)}Ne.getSingleton().register("beforeColumnFreeze");Ne.getSingleton().register("afterColumnFreeze");Ne.getSingleton().register("beforeColumnUnfreeze");Ne.getSingleton().register("afterColumnUnfreeze");var v$="manualColumnFreeze",wKe=110,lp=new WeakMap,SKe=function(t){vKe(r,t);var e=gKe(r);function r(n){var i;return fKe(this,r),i=e.call(this,n),lp.set(Xz(i),{afterFirstUse:!1}),i}return hKe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[v$]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(o){return i.addContextMenuEntry(o)}),this.addHook("beforeColumnMove",function(o,a){return i.onBeforeColumnMove(o,a)}),of(Bs(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=lp.get(this);i.afterFirstUse=!1,of(Bs(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),of(Bs(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(i){var o=lp.get(this),a=this.hot.getSettings(),s=a.fixedColumnsStart<this.hot.countCols()&&i>a.fixedColumnsStart-1;o.afterFirstUse||(o.afterFirstUse=!0);var l=this.hot.runHooks("beforeColumnFreeze",i,s);l!==!1&&(s&&(this.hot.columnIndexMapper.moveIndexes(i,a.fixedColumnsStart),a._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",i,s))}},{key:"unfreezeColumn",value:function(i){var o=lp.get(this),a=this.hot.getSettings(),s=a.fixedColumnsStart>0&&i<=a.fixedColumnsStart-1;o.afterFirstUse||(o.afterFirstUse=!0);var l=this.hot.runHooks("beforeColumnUnfreeze",i,s);l!==!1&&(s&&(a._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(i,a.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",i,s))}},{key:"addContextMenuEntry",value:function(i){i.items.push({name:"---------"},iKe(this),cKe(this))}},{key:"onBeforeColumnMove",value:function(i,o){var a=lp.get(this);if(a.afterFirstUse){var s=this.hot.getSettings().fixedColumnsStart;if(o<s||i.some(function(l){return l<s}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return v$}},{key:"PLUGIN_PRIORITY",get:function(){return wKe}}]),r}(xt);function Jv(t){"@babel/helpers - typeof";return Jv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jv(t)}function RKe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function EKe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,OKe(n.key),n)}}function CKe(t,e,r){return e&&EKe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function OKe(t){var e=TKe(t,"string");return Jv(e)==="symbol"?e:String(e)}function TKe(t,e){if(Jv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Jv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var MR=0,g$=1,y$=2,Sc="px",_Ke=function(){function t(e){RKe(this,t),this.hot=e,this._element=null,this.state=MR,this.inlineProperty=e.isRtl()?"right":"left"}return CKe(t,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=y$}},{key:"build",value:function(){this.state===MR&&(this._element=this.hot.rootDocument.createElement("div"),this.state=g$)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=MR}},{key:"isAppended",value:function(){return this.state===y$}},{key:"isBuilt",value:function(){return this.state>=g$}},{key:"setPosition",value:function(r,n){Ln(r)&&(this._element.style.top=r+Sc),Ln(n)&&(this._element.style[this.inlineProperty]=n+Sc)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){Ln(r)&&(this._element.style.width=r+Sc),Ln(n)&&(this._element.style.height=n+Sc)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){Ln(r)&&(this._element.style.marginTop=r+Sc),Ln(n)&&(this._element.style["margin".concat(Qi(this.inlineProperty))]=n+Sc)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(Qi(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),t}();const qz=_Ke;function Uh(t){"@babel/helpers - typeof";return Uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uh(t)}function AKe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function IKe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,PKe(n.key),n)}}function NKe(t,e,r){return e&&IKe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function PKe(t){var e=MKe(t,"string");return Uh(e)==="symbol"?e:String(e)}function MKe(t,e){if(Uh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function T0(){return typeof Reflect<"u"&&Reflect.get?T0=Reflect.get.bind():T0=function(e,r,n){var i=kKe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},T0.apply(this,arguments)}function kKe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Bh(t),t!==null););return t}function xKe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&GO(t,e)}function GO(t,e){return GO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},GO(t,e)}function $Ke(t){var e=FKe();return function(){var n=Bh(t),i;if(e){var o=Bh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return LKe(this,i)}}function LKe(t,e){if(e&&(Uh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DKe(t)}function DKe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function FKe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bh(t){return Bh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bh(t)}var HKe="ht__manualColumnMove--backlight",UKe=function(t){xKe(r,t);var e=$Ke(r);function r(){return AKe(this,r),e.apply(this,arguments)}return NKe(r,[{key:"build",value:function(){T0(Bh(r.prototype),"build",this).call(this),le(this._element,HKe)}}]),r}(qz);const BKe=UKe;function Vh(t){"@babel/helpers - typeof";return Vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vh(t)}function VKe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jKe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,GKe(n.key),n)}}function WKe(t,e,r){return e&&jKe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function GKe(t){var e=zKe(t,"string");return Vh(e)==="symbol"?e:String(e)}function zKe(t,e){if(Vh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function _0(){return typeof Reflect<"u"&&Reflect.get?_0=Reflect.get.bind():_0=function(e,r,n){var i=YKe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},_0.apply(this,arguments)}function YKe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=jh(t),t!==null););return t}function KKe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zO(t,e)}function zO(t,e){return zO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},zO(t,e)}function XKe(t){var e=ZKe();return function(){var n=jh(t),i;if(e){var o=jh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return qKe(this,i)}}function qKe(t,e){if(e&&(Vh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QKe(t)}function QKe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ZKe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jh(t){return jh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jh(t)}var JKe="ht__manualColumnMove--guideline",eXe=function(t){KKe(r,t);var e=XKe(r);function r(){return VKe(this,r),e.apply(this,arguments)}return WKe(r,[{key:"build",value:function(){_0(jh(r.prototype),"build",this).call(this),le(this._element,JKe)}}]),r}(qz);const tXe=eXe;function Wh(t){"@babel/helpers - typeof";return Wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wh(t)}function rXe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,iXe(n.key),n)}}function nXe(t,e,r){return e&&b$(t.prototype,e),r&&b$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function iXe(t){var e=oXe(t,"string");return Wh(e)==="symbol"?e:String(e)}function oXe(t,e){if(Wh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Kl(){return typeof Reflect<"u"&&Reflect.get?Kl=Reflect.get.bind():Kl=function(e,r,n){var i=aXe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Kl.apply(this,arguments)}function aXe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Aa(t),t!==null););return t}function sXe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&YO(t,e)}function YO(t,e){return YO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},YO(t,e)}function lXe(t){var e=cXe();return function(){var n=Aa(t),i;if(e){var o=Aa(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return uXe(this,i)}}function uXe(t,e){if(e&&(Wh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KO(t)}function KO(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cXe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Aa(t){return Aa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Aa(t)}Ne.getSingleton().register("beforeColumnMove");Ne.getSingleton().register("afterColumnMove");var kR="manualColumnMove",fXe=120,ls=new WeakMap,w$="ht__manualColumnMove",T1="show-ui",xR="on-moving--columns",$R="after-selection--columns",hXe=function(t){sXe(r,t);var e=lXe(r);function r(n){var i;return rXe(this,r),i=e.call(this,n),ls.set(KO(i),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),i.eventManager=new hr(KO(i)),i.backlight=new BKe(n),i.guideline=new tXe(n),i}return nXe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[kR]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollVertically",function(){return i.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.buildPluginUI(),this.registerEvents(),le(this.hot.rootElement,w$),Kl(Aa(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),Kl(Aa(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){qe(this.hot.rootElement,w$),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),Kl(Aa(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(i,o){return this.moveColumns([i],o)}},{key:"moveColumns",value:function(i,o){var a=ls.get(this),s=a.cachedDropIndex,l=this.isMovePossible(i,o),u=this.hot.runHooks("beforeColumnMove",i,o,s,l);if(a.cachedDropIndex=void 0,u!==!1){l&&this.hot.columnIndexMapper.moveIndexes(i,o);var c=l&&this.isColumnOrderChanged(i,o);return this.hot.runHooks("afterColumnMove",i,o,s,l,c),c}}},{key:"dragColumn",value:function(i,o){return this.dragColumns([i],o)}},{key:"dragColumns",value:function(i,o){var a=this.countFinalIndex(i,o),s=ls.get(this);return s.cachedDropIndex=o,this.moveColumns(i,a)}},{key:"isMovePossible",value:function(i,o){var a=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),s=i.length+o>a,l=o<0,u=i.some(function(f){return f<0}),c=i.some(function(f){return f>=a});return!(s||l||u||c)}},{key:"isColumnOrderChanged",value:function(i,o){return i.some(function(a,s){return a-s!==o})}},{key:"countFinalIndex",value:function(i,o){var a=gn(i,function(s,l){return l<o&&(s+=1),s},0);return o-a}},{key:"getColumnsWidth",value:function(i,o){for(var a=this.hot.columnIndexMapper,s=0,l=i;l<=o;l+=1){var u=a.getRenderableFromVisualIndex(l);l<0?s+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(s+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return s}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[kR];if(Array.isArray(i))this.moveColumns(i,0);else if(i!==void 0){var o=this.persistentStateLoad();o.length&&this.moveColumns(o,0)}}},{key:"isFixedColumnsStart",value:function(i){return i<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",i),i.value?i.value:[]}},{key:"prepareColumnsToMoving",value:function(i,o){var a=[];return De(i,o,function(s){a.push(s)}),a}},{key:"refreshPositions",value:function(){var i=ls.get(this),o=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(i.hoveredColumn)&&o>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1));var a=this.hot.view._wt.wtTable,s=this.hot.view._wt.wtOverlays.scrollableElement,l=typeof s.scrollX=="number"?s.scrollX:s.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,i.hoveredColumn-1),c=a.hider.offsetWidth,f=a.TBODY.offsetLeft,h=this.backlight.getOffset().start,d=this.backlight.getSize().width,p=0,m=0;if(this.hot.isRtl()){var y=this.hot.rootWindow,S=Ut(this.hot.rootElement),R=y.innerWidth-i.rootElementOffset-S;m=y.innerWidth-i.target.eventPageX-R-(s.scrollX===void 0?l:0)}else m=i.target.eventPageX-(i.rootElementOffset-(s.scrollX===void 0?l:0));if(i.hasRowHeaders&&(p=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(i.hoveredColumn)&&(u+=l),u+=p,i.hoveredColumn<0)i.fixedColumnsStart>0?i.target.col=0:i.target.col=o>0?o-1:o;else if(i.target.TD.offsetWidth/2+u<=m){var E=i.hoveredColumn>=i.countCols?i.countCols-1:i.hoveredColumn;i.target.col=E+1,u+=i.target.TD.offsetWidth}else i.target.col=i.hoveredColumn;var O=m,A=u;m+d+h>=c?O=c-d-h:m+h<f+p&&(O=f+p+Math.abs(h)),u>=c-1?A=c-1:A===0?A=1:s.scrollX!==void 0&&i.hoveredColumn<i.fixedColumnsStart&&(A-=i.rootElementOffset<=s.scrollX?i.rootElementOffset:0),this.backlight.setPosition(null,O),this.guideline.setPosition(null,A)}},{key:"registerEvents",value:function(){var i=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mousemove",function(a){return i.onMouseMove(a)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a,s){var l=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),c=this.hot.getSelectedRangeLast(),f=ls.get(this),h=Xe(i.target,"sortAction");if(!c||!u||f.pressed||i.button!==0||h){f.pressed=!1,f.columnsToMove.length=0,qe(this.hot.rootElement,[xR,T1]);return}var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),p=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&p&&(this.guideline.appendTo(l.hider),this.backlight.appendTo(l.hider));var m=c.from,y=c.to,S=Math.min(m.col,y.col),R=Math.max(m.col,y.col);if(o.row<0&&o.col>=S&&o.col<=R){s.column=!0,f.pressed=!0,f.target.eventPageX=i.pageX,f.target.eventOffsetX=i.offsetX,f.hoveredColumn=o.col,f.target.TD=a,f.target.col=o.col,f.columnsToMove=this.prepareColumnsToMoving(S,R),f.hasRowHeaders=!!this.hot.getSettings().rowHeaders,f.countCols=this.hot.countCols(),f.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,f.rootElementOffset=xr(this.hot.rootElement).left;var E=f.hasRowHeaders?-1:0,O=l.holder.scrollTop+l.getColumnHeaderHeight(0)+1,A=o.col<f.fixedColumnsStart,B=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),j=Math.abs(i.offsetX-(this.hot.isRtl()?i.target.offsetWidth:0)),J=this.getColumnsWidth(S,o.col-1)+j,Y=this.getColumnsWidth(E,S-1)+(A?B:0)+J;this.backlight.setPosition(O,Y),this.backlight.setSize(this.getColumnsWidth(S,R),l.hider.offsetHeight-O),this.backlight.setOffset(null,-J),le(this.hot.rootElement,xR)}else qe(this.hot.rootElement,$R),f.pressed=!1,f.columnsToMove.length=0}},{key:"onMouseMove",value:function(i){var o=ls.get(this);if(o.pressed){if(i.target===this.backlight.element){var a=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(a)})}o.target.eventPageX=i.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,o,a,s){var l=this.hot.getSelectedRangeLast(),u=ls.get(this);!l||!u.pressed||(u.columnsToMove.indexOf(o.col)>-1?qe(this.hot.rootElement,T1):le(this.hot.rootElement,T1),s.row=!0,s.column=!0,s.cell=!0,u.hoveredColumn=o.col,u.target.TD=a)}},{key:"onMouseUp",value:function(){var i=ls.get(this),o=i.target.col,a=i.columnsToMove.length;if(i.hoveredColumn=void 0,i.pressed=!1,i.backlightWidth=0,qe(this.hot.rootElement,[xR,T1,$R]),this.hot.selection.isSelectedByColumnHeader()&&le(this.hot.rootElement,$R),!(a<1||o===void 0)){var s=i.columnsToMove[0],l=this.hot.toPhysicalColumn(s),u=this.dragColumns(i.columnsToMove,o);if(i.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var c=this.hot.toVisualColumn(l),f=c+a-1;this.hot.selectColumns(c,f)}}}},{key:"onAfterScrollVertically",value:function(){var i=this.hot.view._wt.wtTable,o=i.getColumnHeaderHeight(0)+1,a=i.holder.scrollTop,s=o+a;this.backlight.setPosition(s),this.backlight.setSize(null,i.hider.offsetHeight-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),Kl(Aa(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return kR}},{key:"PLUGIN_PRIORITY",get:function(){return fXe}}]),r}(xt);function Gh(t){"@babel/helpers - typeof";return Gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gh(t)}function dXe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mXe(n.key),n)}}function pXe(t,e,r){return e&&S$(t.prototype,e),r&&S$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function mXe(t){var e=vXe(t,"string");return Gh(e)==="symbol"?e:String(e)}function vXe(t,e){if(Gh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Xl(){return typeof Reflect<"u"&&Reflect.get?Xl=Reflect.get.bind():Xl=function(e,r,n){var i=gXe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Xl.apply(this,arguments)}function gXe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ia(t),t!==null););return t}function yXe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&XO(t,e)}function XO(t,e){return XO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},XO(t,e)}function bXe(t){var e=SXe();return function(){var n=Ia(t),i;if(e){var o=Ia(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return wXe(this,i)}}function wXe(t,e){if(e&&(Gh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qO(t)}function qO(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function SXe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ia(t){return Ia=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ia(t)}var _1="manualColumnResize",RXe=130,R$="manualColumnWidths",LR=new WeakMap,EXe=function(t){yXe(r,t);var e=bXe(r);function r(n){var i;dXe(this,r),i=e.call(this,n);var o=i.hot.rootDocument;return i.currentTH=null,i.currentCol=null,i.selectedCols=[],i.currentWidth=null,i.newSize=null,i.startY=null,i.startWidth=null,i.startOffset=null,i.handle=o.createElement("DIV"),i.guide=o.createElement("DIV"),i.eventManager=new hr(qO(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.columnWidthsMap=void 0,LR.set(qO(i),{config:void 0}),le(i.handle,"manualColumnResizer"),le(i.guide,"manualColumnResizerGuide"),i}return pXe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[_1]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnWidthsMap=new qs,this.columnWidthsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(o,a){return i.onModifyColWidth(o,a)}),this.addHook("beforeStretchingColumnWidth",function(o,a){return i.onBeforeStretchingColumnWidth(o,a)}),this.addHook("beforeColumnResize",function(o,a,s){return i.onBeforeColumnResize(o,a,s)}),this.bindEvents(),Xl(Ia(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Xl(Ia(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=LR.get(this);i.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),Xl(Ia(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",R$,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",R$,i),i.value}},{key:"setManualSize",value:function(i,o){var a=Math.max(o,20),s=this.hot.toPhysicalColumn(i);return this.columnWidthsMap.setValueAtIndex(s,a),a}},{key:"clearManualSize",value:function(i){var o=this.hot.toPhysicalColumn(i);this.columnWidthsMap.setValueAtIndex(o,null)}},{key:"onMapInit",value:function(){var i=this,o=LR.get(this),a=this.hot.getSettings()[_1],s=this.loadManualColumnWidths();typeof s<"u"?this.hot.batchExecution(function(){s.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0):Array.isArray(a)?(this.hot.batchExecution(function(){a.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0),o.config=a):a===!0&&Array.isArray(o.config)&&this.hot.batchExecution(function(){o.config.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0)}},{key:"setupHandlePosition",value:function(i){var o=this;if(i.parentNode){this.currentTH=i;var a=this.hot.view._wt,s=a.wtTable.getCoords(this.currentTH),l=s.col;if(!(l<0)){var u=ur(this.currentTH),c=this.currentTH.getBoundingClientRect(),f=l<a.getSetting("fixedColumnsStart"),h;f&&(h=a.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),h||(h=a.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.selectedCols=[];var d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){var p=this.hot.getSelectedRange();D(p,function(m){var y=m.getTopStartCorner().col,S=m.getBottomEndCorner().col;De(y,S,function(R){o.selectedCols.includes(R)||o.selectedCols.push(R)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=h.start-6,this.startWidth=parseInt(c.width,10),this.handle.style.top="".concat(h.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt(ur(this.handle),10),o=parseInt(this.handle.style.top,10)+i,a=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);le(this.handle,"active"),le(this.guide,"active"),this.guide.style.top="".concat(o,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(a-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){qe(this.handle,"active"),qe(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(i){return!!su(i,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"onMouseOver",value:function(i){if(!jH(i.target)&&this.checkIfColumnHeader(i.target)){var o=this.getClosestTHParent(i.target);if(!o)return;var a=o.getAttribute("colspan");o&&(a===null||a==="1")&&(this.pressed||this.setupHandlePosition(o))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},a=function(u,c){var f=i.hot.runHooks("beforeColumnResize",i.newSize,u,!0);f!==void 0&&(i.newSize=f),i.hot.getSettings().stretchH==="all"?i.clearManualSize(u):i.setManualSize(u,i.newSize),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,u,!0),c&&o()};if(this.dblclick>=2){var s=this.selectedCols.length;s>1?(D(this.selectedCols,function(l){a(l)}),o()):D(this.selectedCols,function(l){a(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var o=this;Xe(i.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return o.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=i.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(i){var o=this;if(this.pressed){var a=(i.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+a,D(this.selectedCols,function(s){o.newSize=o.setManualSize(s,o.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},a=function(u,c){i.hot.runHooks("beforeColumnResize",i.newSize,u,!1),c&&o(),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var s=this.selectedCols.length;s>1?(D(this.selectedCols,function(l){a(l)}),o()):D(this.selectedCols,function(l){a(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,o=this.hot,a=o.rootWindow,s=o.rootElement;this.eventManager.addEventListener(s,"mouseover",function(l){return i.onMouseOver(l)}),this.eventManager.addEventListener(s,"mousedown",function(l){return i.onMouseDown(l)}),this.eventManager.addEventListener(a,"mousemove",function(l){return i.onMouseMove(l)}),this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyColWidth",value:function(i,o){var a=i;if(this.enabled){var s=this.hot.toPhysicalColumn(o),l=this.columnWidthsMap.getValueAtIndex(s);this.hot.getSettings()[_1]&&l&&(a=l)}return a}},{key:"onBeforeStretchingColumnWidth",value:function(i,o){var a=this.columnWidthsMap.getValueAtIndex(o);return a===null&&(a=i),a}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){Xl(Ia(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return _1}},{key:"PLUGIN_PRIORITY",get:function(){return RXe}}]),r}(xt);function eg(t){"@babel/helpers - typeof";return eg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eg(t)}function CXe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function OXe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_Xe(n.key),n)}}function TXe(t,e,r){return e&&OXe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function _Xe(t){var e=AXe(t,"string");return eg(e)==="symbol"?e:String(e)}function AXe(t,e){if(eg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(eg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var DR=0,E$=1,C$=2,Rc="px",IXe=function(){function t(e){CXe(this,t),this.hot=e,this._element=null,this.state=DR}return TXe(t,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=C$}},{key:"build",value:function(){this.state===DR&&(this._element=this.hot.rootDocument.createElement("div"),this.state=E$)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=DR}},{key:"isAppended",value:function(){return this.state===C$}},{key:"isBuilt",value:function(){return this.state>=E$}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+Rc),n!==void 0&&(this._element.style.left=n+Rc)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+Rc),n&&(this._element.style.height=n+Rc)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+Rc),n&&(this._element.style.marginLeft=n+Rc)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),t}();const Qz=IXe;function zh(t){"@babel/helpers - typeof";return zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zh(t)}function NXe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PXe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,kXe(n.key),n)}}function MXe(t,e,r){return e&&PXe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function kXe(t){var e=xXe(t,"string");return zh(e)==="symbol"?e:String(e)}function xXe(t,e){if(zh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function A0(){return typeof Reflect<"u"&&Reflect.get?A0=Reflect.get.bind():A0=function(e,r,n){var i=$Xe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},A0.apply(this,arguments)}function $Xe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Yh(t),t!==null););return t}function LXe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&QO(t,e)}function QO(t,e){return QO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},QO(t,e)}function DXe(t){var e=UXe();return function(){var n=Yh(t),i;if(e){var o=Yh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return FXe(this,i)}}function FXe(t,e){if(e&&(zh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HXe(t)}function HXe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function UXe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yh(t){return Yh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yh(t)}var BXe="ht__manualRowMove--backlight",VXe=function(t){LXe(r,t);var e=DXe(r);function r(){return NXe(this,r),e.apply(this,arguments)}return MXe(r,[{key:"build",value:function(){A0(Yh(r.prototype),"build",this).call(this),le(this._element,BXe)}}]),r}(Qz);const jXe=VXe;function Kh(t){"@babel/helpers - typeof";return Kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kh(t)}function WXe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function GXe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,YXe(n.key),n)}}function zXe(t,e,r){return e&&GXe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function YXe(t){var e=KXe(t,"string");return Kh(e)==="symbol"?e:String(e)}function KXe(t,e){if(Kh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function I0(){return typeof Reflect<"u"&&Reflect.get?I0=Reflect.get.bind():I0=function(e,r,n){var i=XXe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},I0.apply(this,arguments)}function XXe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Xh(t),t!==null););return t}function qXe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ZO(t,e)}function ZO(t,e){return ZO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ZO(t,e)}function QXe(t){var e=eqe();return function(){var n=Xh(t),i;if(e){var o=Xh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ZXe(this,i)}}function ZXe(t,e){if(e&&(Kh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JXe(t)}function JXe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function eqe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xh(t){return Xh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xh(t)}var tqe="ht__manualRowMove--guideline",rqe=function(t){qXe(r,t);var e=QXe(r);function r(){return WXe(this,r),e.apply(this,arguments)}return zXe(r,[{key:"build",value:function(){I0(Xh(r.prototype),"build",this).call(this),le(this._element,tqe)}}]),r}(Qz);const nqe=rqe;function qh(t){"@babel/helpers - typeof";return qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qh(t)}function iqe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,aqe(n.key),n)}}function oqe(t,e,r){return e&&O$(t.prototype,e),r&&O$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function aqe(t){var e=sqe(t,"string");return qh(e)==="symbol"?e:String(e)}function sqe(t,e){if(qh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function ql(){return typeof Reflect<"u"&&Reflect.get?ql=Reflect.get.bind():ql=function(e,r,n){var i=lqe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},ql.apply(this,arguments)}function lqe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Na(t),t!==null););return t}function uqe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&JO(t,e)}function JO(t,e){return JO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},JO(t,e)}function cqe(t){var e=hqe();return function(){var n=Na(t),i;if(e){var o=Na(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return fqe(this,i)}}function fqe(t,e){if(e&&(qh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eT(t)}function eT(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hqe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Na(t){return Na=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Na(t)}Ne.getSingleton().register("beforeRowMove");Ne.getSingleton().register("afterRowMove");var FR="manualRowMove",dqe=140,us=new WeakMap,T$="ht__manualRowMove",A1="show-ui",HR="on-moving--rows",UR="after-selection--rows",pqe=function(t){uqe(r,t);var e=cqe(r);function r(n){var i;return iqe(this,r),i=e.call(this,n),us.set(eT(i),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),i.eventManager=new hr(eT(i)),i.backlight=new jXe(n),i.guideline=new nqe(n),i}return oqe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[FR]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollHorizontally",function(){return i.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.buildPluginUI(),this.registerEvents(),le(this.hot.rootElement,T$),ql(Na(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),ql(Na(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){qe(this.hot.rootElement,T$),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),ql(Na(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(i,o){return this.moveRows([i],o)}},{key:"moveRows",value:function(i,o){var a=us.get(this),s=a.cachedDropIndex,l=this.isMovePossible(i,o),u=this.hot.runHooks("beforeRowMove",i,o,s,l);if(a.cachedDropIndex=void 0,u!==!1){l&&this.hot.rowIndexMapper.moveIndexes(i,o);var c=l&&this.isRowOrderChanged(i,o);return this.hot.runHooks("afterRowMove",i,o,s,l,c),c}}},{key:"dragRow",value:function(i,o){return this.dragRows([i],o)}},{key:"dragRows",value:function(i,o){var a=this.countFinalIndex(i,o),s=us.get(this);return s.cachedDropIndex=o,this.moveRows(i,a)}},{key:"isMovePossible",value:function(i,o){var a=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),s=i.length+o>a,l=o<0,u=i.some(function(f){return f<0}),c=i.some(function(f){return f>=a});return!(s||l||u||c)}},{key:"isRowOrderChanged",value:function(i,o){return i.some(function(a,s){return a-s!==o})}},{key:"countFinalIndex",value:function(i,o){var a=gn(i,function(s,l){return l<o&&(s+=1),s},0);return o-a}},{key:"getRowsHeight",value:function(i,o){for(var a=this.hot.rowIndexMapper,s=0,l=i;l<=o;l++){var u=a.getRenderableFromVisualIndex(l);u!==null&&(s+=this.hot.view._wt.wtTable.getRowHeight(u)||23)}return s}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[FR];if(Array.isArray(i))this.moveRows(i,0);else if(i!==void 0){var o=this.persistentStateLoad();o.length&&this.moveRows(o,0)}}},{key:"isFixedRowTop",value:function(i){return i<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(i){return i>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualRowMove",i),i.value?i.value:[]}},{key:"prepareRowsToMoving",value:function(){var i=this.hot.getSelectedRangeLast(),o=[];if(!i)return o;var a=i.from,s=i.to,l=Math.min(a.row,s.row),u=Math.max(a.row,s.row);return De(l,u,function(c){o.push(c)}),o}},{key:"refreshPositions",value:function(){var i=us.get(this),o=i.target.coords,a=this.hot.view.getFirstFullyVisibleRow(),s=this.hot.view.getLastFullyVisibleRow(),l=this.hot.countRows();this.isFixedRowTop(o.row)&&a>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(a-1,-1)),this.isFixedRowBottom(o.row)&&s<l&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(s+1,1),void 0,!0);var u=this.hot.view._wt.wtTable,c=i.target.TD,f=this.hot.rootElement,h=xr(f),d=hf(f),p=u.holder.scrollTop,m;this.hot.rootWindow===d?m=d.scrollY:m=d.scrollTop;var y=h.top-m,S=i.target.eventPageY-y+p,R=u.hider.offsetHeight,E=u.TBODY.offsetTop,O=this.backlight.getOffset().top,A=this.backlight.getSize().height,B=c.offsetHeight/2,j=c.offsetHeight,J=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,o.row-1),Y=S>=J+B;this.isFixedRowTop(o.row)&&(J+=u.holder.scrollTop),o.row<0?i.target.row=a>0?a-1:a:Y?(i.target.row=o.row+1,J+=o.row===0?j-1:j):i.target.row=o.row;var q=S,ee=J;S+A+O>=R?q=R-A-O:S+O<E&&(q=E+Math.abs(O)),J>=R-1&&(ee=R-1),this.backlight.setPosition(q),this.guideline.setPosition(ee)}},{key:"registerEvents",value:function(){var i=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mousemove",function(a){return i.onMouseMove(a)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a,s){var l=this.hot.view._wt,u=l.wtTable,c=l.wtViewport,f=this.hot.selection.isSelectedByRowHeader(),h=this.hot.getSelectedRangeLast(),d=us.get(this);if(!h||!f||d.pressed||i.button!==0){d.pressed=!1,d.rowsToMove.length=0,qe(this.hot.rootElement,[HR,A1]);return}var p=this.guideline.isBuilt()&&!this.guideline.isAppended(),m=this.backlight.isBuilt()&&!this.backlight.isAppended();p&&m&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var y=h.from,S=h.to,R=Math.min(y.row,S.row),E=Math.max(y.row,S.row);if(o.col<0&&o.row>=R&&o.row<=E){s.row=!0,d.pressed=!0,d.target.eventPageY=i.pageY,d.target.coords=o,d.target.TD=a,d.rowsToMove=this.prepareRowsToMoving();var O=u.holder.scrollLeft+c.getRowHeaderWidth();this.backlight.setPosition(null,O),this.backlight.setSize(u.hider.offsetWidth-O,this.getRowsHeight(R,E)),this.backlight.setOffset((this.getRowsHeight(R,o.row-1)+i.offsetY)*-1,null),le(this.hot.rootElement,HR),this.refreshPositions()}else qe(this.hot.rootElement,UR),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(i){var o=us.get(this);if(o.pressed){if(i.target===this.backlight.element){var a=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,a)})}o.target.eventPageY=i.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,o,a,s){var l=this.hot.getSelectedRangeLast(),u=us.get(this);!l||!u.pressed||(u.rowsToMove.indexOf(o.row)>-1?qe(this.hot.rootElement,A1):le(this.hot.rootElement,A1),s.row=!0,s.column=!0,s.cell=!0,u.target.coords=o,u.target.TD=a)}},{key:"onMouseUp",value:function(){var i=us.get(this),o=i.target.row,a=i.rowsToMove.length;if(i.pressed=!1,i.backlightHeight=0,qe(this.hot.rootElement,[HR,A1,UR]),this.hot.selection.isSelectedByRowHeader()&&le(this.hot.rootElement,UR),!(a<1||o===void 0)){var s=i.rowsToMove[0],l=this.hot.toPhysicalRow(s),u=this.dragRows(i.rowsToMove,o);if(i.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var c=this.hot.toVisualRow(l),f=c+a-1;this.hot.selectRows(c,f)}}}},{key:"onAfterScrollHorizontally",value:function(){var i=this.hot.view._wt.wtTable,o=this.hot.view._wt.wtViewport.getRowHeaderWidth(),a=i.holder.scrollLeft,s=o+a;this.backlight.setPosition(null,s),this.backlight.setSize(i.hider.offsetWidth-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),ql(Na(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return FR}},{key:"PLUGIN_PRIORITY",get:function(){return dqe}}]),r}(xt);function Qh(t){"@babel/helpers - typeof";return Qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qh(t)}function mqe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gqe(n.key),n)}}function vqe(t,e,r){return e&&_$(t.prototype,e),r&&_$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function gqe(t){var e=yqe(t,"string");return Qh(e)==="symbol"?e:String(e)}function yqe(t,e){if(Qh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Ql(){return typeof Reflect<"u"&&Reflect.get?Ql=Reflect.get.bind():Ql=function(e,r,n){var i=bqe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Ql.apply(this,arguments)}function bqe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Pa(t),t!==null););return t}function wqe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tT(t,e)}function tT(t,e){return tT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},tT(t,e)}function Sqe(t){var e=Eqe();return function(){var n=Pa(t),i;if(e){var o=Pa(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Rqe(this,i)}}function Rqe(t,e){if(e&&(Qh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rT(t)}function rT(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Eqe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pa(t){return Pa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pa(t)}var I1="manualRowResize",Cqe=30,A$="manualRowHeights",BR=new WeakMap,Oqe=function(t){wqe(r,t);var e=Sqe(r);function r(n){var i;mqe(this,r),i=e.call(this,n);var o=i.hot.rootDocument;return i.currentTH=null,i.currentRow=null,i.selectedRows=[],i.currentHeight=null,i.newSize=null,i.startY=null,i.startHeight=null,i.startOffset=null,i.handle=o.createElement("DIV"),i.guide=o.createElement("DIV"),i.eventManager=new hr(rT(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.rowHeightsMap=void 0,BR.set(rT(i),{config:void 0}),le(i.handle,"manualRowResizer"),le(i.guide,"manualRowResizerGuide"),i}return vqe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[I1]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.rowHeightsMap=new qs,this.rowHeightsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(o,a){return i.onModifyRowHeight(o,a)}),this.bindEvents(),Ql(Pa(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ql(Pa(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=BR.get(this);i.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),Ql(Pa(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",A$,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",A$,i),i.value}},{key:"setManualSize",value:function(i,o){var a=this.hot.toPhysicalRow(i),s=Math.max(o,gU.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(a,s),s}},{key:"setupHandlePosition",value:function(i){var o=this;this.currentTH=i;var a=this.hot.view,s=a._wt,l=s.wtTable.getCoords(this.currentTH),u=l.row;if(!(u<0)){var c=Ut(this.currentTH),f=this.currentTH.getBoundingClientRect(),h=u<s.getSetting("fixedRowsTop"),d=u>=a.countNotHiddenRowIndexes(0,1)-s.getSetting("fixedRowsBottom"),p;h?p=s.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col):d&&(p=s.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),p||(p=s.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var m=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&m){var y=this.hot.getSelectedRange();D(y,function(S){var R=S.getTopStartCorner().row,E=S.getBottomStartCorner().row;De(R,E,function(O){o.selectedRows.includes(O)||o.selectedRows.push(O)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=p.top-6,this.startHeight=parseInt(f.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(p.start,"px"),this.handle.style.width="".concat(c,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt(Ut(this.handle),10),o=parseInt(this.handle.style[this.inlineDir],10)+i,a=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);le(this.handle,"active"),le(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(o,"px"),this.guide.style.width="".concat(a-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){qe(this.handle,"active"),qe(this.guide,"active")}},{key:"checkIfRowHeader",value:function(i){var o,a,s=su(i,["TH"],this.hot.rootElement);return s&&((o=i.parentNode)===null||o===void 0||(a=o.parentNode)===null||a===void 0?void 0:a.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"getActualRowHeight",value:function(i){var o=this.hot.view._wt.wtTable.getRowHeight(i);return o!==void 0&&this.newSize<o?o:this.newSize}},{key:"onMouseOver",value:function(i){if(!jH(i.target)&&this.checkIfRowHeader(i.target)){var o=this.getClosestTHParent(i.target);o&&(this.pressed||this.setupHandlePosition(o))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},a=function(u,c){var f=i.hot.runHooks("beforeRowResize",i.getActualRowHeight(u),u,!0);f!==void 0&&(i.newSize=f),i.setManualSize(u,i.newSize),i.hot.runHooks("afterRowResize",i.getActualRowHeight(u),u,!0),c&&o()};if(this.dblclick>=2){var s=this.selectedRows.length;s>1?(D(this.selectedRows,function(l){a(l)}),o()):D(this.selectedRows,function(l){a(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var o=this;Xe(i.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return o.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=i.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(i){var o=this;this.pressed&&(this.currentHeight=this.startHeight+(i.pageY-this.startY),D(this.selectedRows,function(a){o.newSize=o.setManualSize(a,o.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},a=function(u,c){i.hot.runHooks("beforeRowResize",i.getActualRowHeight(u),u,!1),c&&o(),i.saveManualRowHeights(),i.hot.runHooks("afterRowResize",i.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var s=this.selectedRows.length;s>1?(D(this.selectedRows,function(l){a(l)}),o()):D(this.selectedRows,function(l){a(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,o=this.hot,a=o.rootElement,s=o.rootWindow;this.eventManager.addEventListener(a,"mouseover",function(l){return i.onMouseOver(l)}),this.eventManager.addEventListener(a,"mousedown",function(l){return i.onMouseDown(l)}),this.eventManager.addEventListener(s,"mousemove",function(l){return i.onMouseMove(l)}),this.eventManager.addEventListener(s,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyRowHeight",value:function(i,o){var a=i;if(this.enabled){var s=this.hot.toPhysicalRow(o),l=this.rowHeightsMap.getValueAtIndex(s);this.hot.getSettings()[I1]&&l&&(a=l)}return a}},{key:"onMapInit",value:function(){var i=this,o=BR.get(this),a=this.hot.getSettings()[I1],s=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof s<"u"?s.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)}):Array.isArray(a)?(a.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)}),o.config=a):a===!0&&Array.isArray(o.config)&&o.config.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)})},!0)}},{key:"destroy",value:function(){Ql(Pa(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return I1}},{key:"PLUGIN_PRIORITY",get:function(){return Cqe}}]),r}(xt);function tg(t){"@babel/helpers - typeof";return tg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tg(t)}var I$,N$,P$,M$;function N1(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Tqe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Aqe(n.key),n)}}function _qe(t,e,r){return e&&k$(t.prototype,e),r&&k$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Aqe(t){var e=Iqe(t,"string");return tg(e)==="symbol"?e:String(e)}function Iqe(t,e){if(tg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(tg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Nqe=function(){function t(e,r,n,i,o,a){Tqe(this,t),this.row=e,this.col=r,this.rowspan=n,this.colspan=i,this.removed=!1,this.cellCoordsFactory=o,this.cellRangeFactory=a}return _qe(t,[{key:"normalize",value:function(r){var n=r.countRows(),i=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var i=r[0]||r[1],o=n+Math.abs(r[0]||r[1])-1,a=r[0]?"colspan":"rowspan",s=r[0]?"col":"row",l=Math.min(n,o),u=Math.max(n,o),c=this[s],f=this[s]+this[a]-1;if(c>=n&&(this[s]+=i),i>0)n<=f&&n>c&&(this[a]+=i);else if(i<0){if(l<=c&&u>=f)return this.removed=!0,!1;if(c>=l&&c<=u){var h=u-c+1,d=Math.abs(i)-h;this[s]-=d+i,this[a]-=h}else if(c<=l&&f>=u)this[a]+=i;else if(c<=l&&f>=l&&f<u){var p=f-l+1;this[a]-=p}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return kt(I$||(I$=N1(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return kt(N$||(N$=N1(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return kt(P$||(P$=N1(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return kt(M$||(M$=N1(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,i){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=i||r.col+r.colspan-1>=i}}]),t}();const Ro=Nqe;function nT(t,e,r,n){e?e.row===r&&e.col===n?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function rg(t){"@babel/helpers - typeof";return rg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rg(t)}var x$;function Pqe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function $$(t){return $qe(t)||xqe(t)||kqe(t)||Mqe()}function Mqe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kqe(t,e){if(t){if(typeof t=="string")return iT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iT(t,e)}}function xqe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function $qe(t){if(Array.isArray(t))return iT(t)}function iT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Lqe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function L$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Fqe(n.key),n)}}function Dqe(t,e,r){return e&&L$(t.prototype,e),r&&L$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fqe(t){var e=Hqe(t,"string");return rg(e)==="symbol"?e:String(e)}function Hqe(t,e){if(rg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(rg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Uqe=function(){function t(e){Lqe(this,t),this.plugin=e,this.mergedCells=[],this.hot=e.hot}return Dqe(t,[{key:"get",value:function(r,n){var i=this.mergedCells,o=!1;return D(i,function(a){return a.row<=r&&a.row+a.rowspan-1>=r&&a.col<=n&&a.col+a.colspan-1>=n?(o=a,!1):!0}),o}},{key:"getByRange",value:function(r){var n=this.mergedCells,i=!1;return D(n,function(o){return o.row<=r.from.row&&o.row+o.rowspan-1>=r.to.row&&o.col<=r.from.col&&o.col+o.colspan-1>=r.to.col?(i=o,i):!0}),i}},{key:"getWithinRange",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.mergedCells,a=[],s=r;if(!s.includesRange){var l=this.hot._createCellCoords(s.from.row,s.from.col),u=this.hot._createCellCoords(s.to.row,s.to.col);s=this.hot._createCellRange(l,l,u)}return D(o,function(c){var f=n.hot._createCellCoords(c.row,c.col),h=n.hot._createCellCoords(c.row+c.rowspan-1,c.col+c.colspan-1),d=n.hot._createCellRange(f,f,h);i?s.overlaps(d)&&a.push(c):s.includesRange(d)&&a.push(c)}),a.length?a:!1}},{key:"add",value:function(r){var n=this.mergedCells,i=r.row,o=r.col,a=r.rowspan,s=r.colspan,l=new Ro(i,o,a,s,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(i,o),c=this.isOverlapping(l);return!u&&!c?(this.hot&&l.normalize(this.hot),n.push(l),l):(Dt(t.IS_OVERLAPPING_WARNING(l)),!1)}},{key:"remove",value:function(r,n){var i=this.mergedCells,o=this.get(r,n),a=o?this.mergedCells.indexOf(o):-1;return o&&a!==-1?(i.splice(a,1),o):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,i=[],o=[];D(n,function(a){var s=r.hot.getCell(a.row,a.col);s&&i.push([s,r.get(a.row,a.col),a.row,a.col])}),this.mergedCells.length=0,D(i,function(a,s){De(0,a.rowspan-1,function(l){De(0,a.colspan-1,function(u){if(u!==0||l!==0){var c=r.hot.getCell(a.row+l,a.col+u);c&&o.push([c,null,null,null])}})}),i[s][1]=null}),D(i,function(a){nT.apply(void 0,$$(a))}),D(o,function(a){nT.apply(void 0,$$(a))})}},{key:"isOverlapping",value:function(r){var n=this,i=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),o=!1;return D(this.mergedCells,function(a){var s=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(a.row,a.col),n.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1));return s.overlaps(i)?(o=!0,!1):!0}),o}},{key:"isFirstRenderableMergedCell",value:function(r,n){var i=this.get(r,n);return i&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var i=this.get(r,n);if(!i||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var o=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(o,a)}},{key:"shiftCollections",value:function(r,n,i){var o=this,a=[0,0];switch(r){case"right":a[0]+=i;break;case"left":a[0]-=i;break;case"down":a[1]+=i;break;case"up":a[1]-=i;break}D(this.mergedCells,function(s){s.shift(a,n)}),QE(this.mergedCells.length-1,0,function(s){var l=o.mergedCells[s];l&&l.removed&&o.mergedCells.splice(o.mergedCells.indexOf(l),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return kt(x$||(x$=Pqe(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),t}();const Bqe=Uqe;function ng(t){"@babel/helpers - typeof";return ng=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ng(t)}function Sl(t,e){return Gqe(t)||Wqe(t,e)||jqe(t,e)||Vqe()}function Vqe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jqe(t,e){if(t){if(typeof t=="string")return D$(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return D$(t,e)}}function D$(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Wqe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function Gqe(t){if(Array.isArray(t))return t}function zqe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yqe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Xqe(n.key),n)}}function Kqe(t,e,r){return e&&Yqe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Xqe(t){var e=qqe(t,"string");return ng(e)==="symbol"?e:String(e)}function qqe(t,e){if(ng(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(ng(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Qqe=function(){function t(e){zqe(this,t),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return Kqe(t,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var i=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?i="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?i="up":n[1]===r[1]&&n[2]===r[2]?i="right":i="left",i}},{key:"snapDragArea",value:function(r,n,i,o){var a=n.slice(0),s=this.getAutofillSize(r,n,i),l=Sl(r,4),u=l[0],c=l[1],f=l[2],h=l[3],d=["up","down"].indexOf(i)>-1,p=d?f-u+1:h-c+1,m=Math.floor(s/p)*p,y=s-m,S=this.getFarthestCollection(r,n,i,o);if(S){if(i==="down"){var R=S.row+S.rowspan-u-y,E=a[2]+R;E>=this.plugin.hot.countRows()?a[2]-=y:a[2]+=y?R:0}else if(i==="right"){var O=S.col+S.colspan-c-y,A=a[3]+O;A>=this.plugin.hot.countCols()?a[3]-=y:a[3]+=y?O:0}else if(i==="up"){var B=f-y-S.row+1,j=a[0]+B;j<0?a[0]+=y:a[0]-=y?B:0}else if(i==="left"){var J=h-y-S.col+1,Y=a[1]+J;Y<0?a[1]+=y:a[1]-=y?J:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:i,foundMergedCells:o,fillSize:s,dragArea:a,cycleLength:p}),a}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),$r(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,i){var o=Sl(r,4),a=o[0],s=o[1],l=o[2],u=o[3],c=Sl(n,4),f=c[0],h=c[1],d=c[2],p=c[3];switch(i){case"up":return a-f;case"down":return d-l;case"left":return s-h;case"right":return p-u;default:return null}}},{key:"getDragArea",value:function(r,n,i){var o=Sl(r,4),a=o[0],s=o[1],l=o[2],u=o[3],c=Sl(n,4),f=c[0],h=c[1],d=c[2],p=c[3];switch(i){case"up":return[f,h,a-1,u];case"down":return[l+1,s,d,u];case"left":return[f,h,l,s-1];case"right":return[a,u+1,d,p];default:return null}}},{key:"getFarthestCollection",value:function(r,n,i,o){var a=Sl(r,4),s=a[0],l=a[1],u=a[2],c=a[3],f=["up","down"].indexOf(i)>-1,h=f?u:c,d=f?s:l,p=this.getAutofillSize(r,n,i),m=f?u-s+1:c-l+1,y=Math.floor(p/m)*m,S=p-y,R=null,E=null,O=null;switch(i){case"up":R="includesVertically",O=h-S+1;break;case"left":R="includesHorizontally",O=h-S+1;break;case"down":R="includesVertically",O=d+S-1;break;case"right":R="includesHorizontally",O=d+S-1;break}return D(o,function(A){A[R](O)&&A.isFarther(E,i)&&(E=A)}),E}},{key:"recreateAfterDataPopulation",value:function(r){if(this.currentFillData){var n=this.getRangeFromChanges(r),i=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,a=function(h,d){switch(o){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},s=0,l=null,u=1;do for(var c=0;c<i.length;c+=1){if(l=i[c],s=u*this.currentFillData.cycleLength,a(l,s))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:l.row-s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:l.row+s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col-s,colspan:l.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col+s,colspan:l.colspan});break}c===i.length-1&&(u+=1)}while(a(l,s));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,i={min:null,max:null},o={min:null,max:null};return D(r,function(a){var s=a[0],l=n.plugin.hot.propToCol(a[1]);(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s),(o.min===null||l<o.min)&&(o.min=l),(o.max===null||l>o.max)&&(o.max=l)}),{from:{row:i.min,column:o.min},to:{row:i.max,column:o.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,i){var o=this.getDragArea(r,n,i),a=Sl(o,4),s=a[0],l=a[1],u=a[2],c=a[3],f=this.plugin.hot._createCellCoords(s,l),h=this.plugin.hot._createCellCoords(u,c),d=this.plugin.hot._createCellRange(f,f,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),t}();const Zqe=Qqe;function ig(t){"@babel/helpers - typeof";return ig=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ig(t)}function Jqe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eQe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rQe(n.key),n)}}function tQe(t,e,r){return e&&eQe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function rQe(t){var e=nQe(t,"string");return ig(e)==="symbol"?e:String(e)}function nQe(t,e){if(ig(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(ig(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var iQe=function(){function t(e){Jqe(this,t),this.plugin=e,this.hot=e.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return tQe(t,[{key:"snapDelta",value:function(r,n,i){var o=n.to,a=o.row+r.row,s=o.col+r.col;r.row?this.jumpOverMergedCell(r,i,a):r.col&&this.jumpOverMergedCell(r,i,s)}},{key:"jumpOverMergedCell",value:function(r,n,i){var o=r.row||r.col,a=null,s=null,l=null;r.row?(a=n.includesVertically(i),s=n.row,l=n.getLastRow()):r.col&&(a=n.includesHorizontally(i),s=n.col,l=n.getLastColumn()),o!==0&&(o>0?a&&i!==s&&(o+=l-i+1):a&&i!==l&&(o-=i-s+1),r.row?r.row=o:r.col&&(r.col=o))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,i,o){var a=Math.min(i[0],i[2]),s=Math.min(i[1],i[3]),l=Math.max(i[0],i[2]),u=Math.max(i[1],i[3]);if(o!==void 0){var c=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(c){var f=this.plugin.mergedCellsCollection.get(r,n);if(f){var h=f.getLastRow(),d=f.getLastColumn(),p=a<=f.row&&s<=f.col&&l>=h&&u>=d;if(p)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(o);if(this.plugin.selectionCalculations.isMergeCellFullySelected(f,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var i=[];if(!n||!r)return!1;for(var o=0;o<r.rowspan;o+=1)for(var a=0;a<r.colspan;a+=1)i.push(this.hot._createCellCoords(r.row+o,r.col+a));for(var s=0;s<i.length;s+=1){for(var l=[],u=0;u<n.length;u+=1)l[u]=n[u].includes(i[s]);if(!l.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),t}();const oQe=iQe;function aQe(t){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=t.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(FA)}return this.getTranslatedPhrase(DA)},callback:function(){t.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=Ro.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function Zh(t){"@babel/helpers - typeof";return Zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zh(t)}function sQe(t,e){return cQe(t)||uQe(t,e)||Zz(t,e)||lQe()}function lQe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uQe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function cQe(t){if(Array.isArray(t))return t}function fQe(t){return pQe(t)||dQe(t)||Zz(t)||hQe()}function hQe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zz(t,e){if(t){if(typeof t=="string")return oT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oT(t,e)}}function dQe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function pQe(t){if(Array.isArray(t))return oT(t)}function oT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function mQe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function F$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gQe(n.key),n)}}function vQe(t,e,r){return e&&F$(t.prototype,e),r&&F$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function gQe(t){var e=yQe(t,"string");return Zh(e)==="symbol"?e:String(e)}function yQe(t,e){if(Zh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function af(){return typeof Reflect<"u"&&Reflect.get?af=Reflect.get.bind():af=function(e,r,n){var i=bQe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},af.apply(this,arguments)}function bQe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Vs(t),t!==null););return t}function wQe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&aT(t,e)}function aT(t,e){return aT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},aT(t,e)}function SQe(t){var e=EQe();return function(){var n=Vs(t),i;if(e){var o=Vs(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return RQe(this,i)}}function RQe(t,e){if(e&&(Zh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jz(t)}function Jz(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function EQe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vs(t){return Vs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vs(t)}Ne.getSingleton().register("beforeMergeCells");Ne.getSingleton().register("afterMergeCells");Ne.getSingleton().register("beforeUnmergeCells");Ne.getSingleton().register("afterUnmergeCells");var Rp="mergeCells",CQe=150,H$=new WeakMap,U$=Rp,OQe=function(t){wQe(r,t);var e=SQe(r);function r(n){var i;return mQe(this,r),i=e.call(this,n),H$.set(Jz(i),{lastDesiredCoords:null}),i.mergedCellsCollection=null,i.autofillCalculations=null,i.selectionCalculations=null,i}return vQe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Rp]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mergedCellsCollection=new Bqe(this),this.autofillCalculations=new Zqe(this),this.selectionCalculations=new oQe(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("modifyTransformStart",function(){return i.onModifyTransformStart.apply(i,arguments)}),this.addHook("afterModifyTransformStart",function(){return i.onAfterModifyTransformStart.apply(i,arguments)}),this.addHook("modifyTransformEnd",function(){return i.onModifyTransformEnd.apply(i,arguments)}),this.addHook("modifyGetCellCoords",function(){return i.onModifyGetCellCoords.apply(i,arguments)}),this.addHook("beforeSetRangeStart",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeEnd",function(){return i.onBeforeSetRangeEnd.apply(i,arguments)}),this.addHook("afterIsMultipleSelection",function(){return i.onAfterIsMultipleSelection.apply(i,arguments)}),this.addHook("afterRenderer",function(){return i.onAfterRenderer.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.addMergeActionsToContextMenu.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(){return i.onAfterGetCellMeta.apply(i,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return i.onAfterViewportRowCalculatorOverride.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),this.addHook("modifyAutofillRange",function(){return i.onModifyAutofillRange.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeDrawBorders",function(){return i.onBeforeDrawAreaBorders.apply(i,arguments)}),this.addHook("afterDrawSelection",function(){return i.onAfterDrawSelection.apply(i,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return i.onBeforeRemoveCellClassNames.apply(i,arguments)}),this.addHook("beforeUndoStackChange",function(o,a){if(a==="MergeCells")return!1}),this.registerShortcuts(),af(Vs(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),af(Vs(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var i=this.hot.getSettings()[Rp];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(i),af(Vs(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var i=this;if(BF()){var o=[],a=[];this.mergedCellsCollection.mergedCells.forEach(function(s){for(var l=s.row,u=s.rowspan,c=l+1;c<l+u;c++)a.push(c)}),a=fQe(new Set(a)),a.forEach(function(s){var l=i.hot.rowIndexMapper.getRenderableFromVisualIndex(s);i.hot.view._wt.wtOverlays.getOverlays(!0).map(function(u){return(u==null?void 0:u.name)==="master"?u:u.clone.wtTable}).forEach(function(u){var c=u.getRow(l);c&&(c.style.background=im(c,"backgroundColor").replace(")",", 0.99)"),o.push(c))})}),this.hot._registerTimeout(function(){o.forEach(function(s){s.style.background=im(s,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(i){var o=!0;return i?(Ro.containsNegativeValues(i)?(Dt(Ro.NEGATIVE_VALUES_WARNING(i)),o=!1):Ro.isOutOfBounds(i,this.hot.countRows(),this.hot.countCols())?(Dt(Ro.IS_OUT_OF_BOUNDS_WARNING(i)),o=!1):Ro.isSingleCell(i)?(Dt(Ro.IS_SINGLE_CELL(i)),o=!1):Ro.containsZeroSpan(i)&&(Dt(Ro.ZERO_SPAN_WARNING(i)),o=!1),o):!1}},{key:"generateFromSettings",value:function(i){var o=this;if(Array.isArray(i)){var a=[];if(D(i,function(s){if(o.validateSetting(s)){var l=o.hot._createCellCoords(s.row,s.col),u=o.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),c=o.hot._createCellRange(l,l,u);o.mergeRange(c,!0,!0),De(s.row,s.row+s.rowspan-1,function(f){De(s.col,s.col+s.colspan-1,function(h){f===s.row&&h===s.col||a.push([f,h,null])})})}}),a.length===0)return;this.hot.setDataAtCell(a)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return o?!0:this.validateSetting(i)}},{key:"toggleMergeOnSelection",value:function(){var i=this.hot.getSelectedRangeLast();if(i){i.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var o=i.from,a=i.to;this.toggleMerge(i),this.hot.selectCell(o.row,o.col,a.row,a.col,!1)}}},{key:"mergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(i){i.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var o=i.from,a=i.to;this.unmergeRange(i,!0),this.mergeRange(i),this.hot.selectCell(o.row,o.col,a.row,a.col,!1)}}},{key:"unmergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(i){var o=i.from,a=i.to;this.unmergeRange(i,!0),this.hot.selectCell(o.row,o.col,a.row,a.col,!1)}}},{key:"mergeRange",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=i.getTopStartCorner(),u=i.getBottomEndCorner(),c={row:l.row,col:l.col,rowspan:u.row-l.row+1,colspan:u.col-l.col+1},f=[],h=null;if(!this.canMergeRange(c,a))return!1;this.hot.runHooks("beforeMergeCells",i,a),De(0,c.rowspan-1,function(p){De(0,c.colspan-1,function(m){var y=null;f[p]||(f[p]=[]),p===0&&m===0?y=o.hot.getSourceDataAtCell(o.hot.toPhysicalRow(c.row),o.hot.toPhysicalColumn(c.col)):o.hot.setCellMeta(c.row+p,c.col+m,"hidden",!0),f[p][m]=y})}),this.hot.setCellMeta(c.row,c.col,"spanned",!0);var d=this.mergedCellsCollection.add(c);return d?(s?h=[c.row,c.col,f]:this.hot.populateFromArray(c.row,c.col,f,void 0,void 0,this.pluginName),a||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",i,c,a),h):!0}},{key:"unmergeRange",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=this.mergedCellsCollection.getWithinRange(i);s&&(this.hot.runHooks("beforeUnmergeCells",i,a),D(s,function(l){o.mergedCellsCollection.remove(l.row,l.col),De(0,l.rowspan-1,function(u){De(0,l.colspan-1,function(c){o.hot.removeCellMeta(l.row+u,l.col+c,"hidden")})}),o.hot.removeCellMeta(l.row,l.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",i,a),this.hot.render())}},{key:"toggleMerge",value:function(i){var o=this.mergedCellsCollection.get(i.from.row,i.from.col),a=o.row===i.from.row&&o.col===i.from.col&&o.row+o.rowspan-1===i.to.row&&o.col+o.colspan-1===i.to.col;a?this.unmergeRange(i):this.mergeSelection(i)}},{key:"merge",value:function(i,o,a,s){var l=this.hot._createCellCoords(i,o),u=this.hot._createCellCoords(a,s);this.mergeRange(this.hot._createCellRange(l,l,u))}},{key:"unmerge",value:function(i,o,a,s){var l=this.hot._createCellCoords(i,o),u=this.hot._createCellCoords(a,s);this.unmergeRange(this.hot._createCellRange(l,l,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[Rp]),this.hot.render()}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),a=o.getContext("grid");a.addShortcut({keys:[["Control","m"]],callback:function(){i.toggleMerge(i.hot.getSelectedRangeLast()),i.hot.render()},runOnlyIf:function(l){return!l.altKey},group:U$})}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),o=i.getContext("grid");o.removeShortcutsByGroup(U$)}},{key:"onAfterIsMultipleSelection",value:function(i){if(i){for(var o=this.mergedCellsCollection.mergedCells,a=this.hot.getSelectedRangeLast(),s=0;s<o.length;s+=1)if(a.from.row===o[s].row&&a.from.col===o[s].col&&a.to.row===o[s].row+o[s].rowspan-1&&a.to.col===o[s].col+o[s].colspan-1)return!1}return i}},{key:"onModifyTransformStart",value:function(i){var o=H$.get(this),a=this.hot.getSelectedRangeLast(),s={row:i.row,col:i.col},l=null,u=this.hot._createCellCoords(a.highlight.row,a.highlight.col),c=this.mergedCellsCollection.get(u.row,u.col);if(o.lastDesiredCoords||(o.lastDesiredCoords=this.hot._createCellCoords(null,null)),c){var f=this.hot._createCellCoords(c.row,c.col),h=this.hot._createCellCoords(c.row+c.rowspan-1,c.col+c.colspan-1),d=this.hot._createCellRange(f,f,h);d.includes(o.lastDesiredCoords)||(o.lastDesiredCoords=this.hot._createCellCoords(null,null)),s.row=o.lastDesiredCoords.row?o.lastDesiredCoords.row-u.row:s.row,s.col=o.lastDesiredCoords.col?o.lastDesiredCoords.col-u.col:s.col,i.row>0?s.row=c.row+c.rowspan-1-u.row+i.row:i.row<0&&(s.row=u.row-c.row+i.row),i.col>0?s.col=c.col+c.colspan-1-u.col+i.col:i.col<0&&(s.col=u.col-c.col+i.col)}l=this.hot._createCellCoords(a.highlight.row+s.row,a.highlight.col+s.col);var p=this.mergedCellsCollection.get(l.row,l.col);if(p){var m=this.mergedCellsCollection.getFirstRenderableCoords(p.row,p.col);o.lastDesiredCoords=l,s={row:m.row-u.row,col:m.col-u.col}}s.row!==0&&(i.row=s.row),s.col!==0&&(i.col=s.col)}},{key:"onModifyTransformEnd",value:function(i){var o=this,a=this.hot.getSelectedRangeLast(),s=Bn(i),l=this.selectionCalculations.getUpdatedSelectionRange(a,i),u=Bn(s),c=this.mergedCellsCollection.getWithinRange(l,!0);do u=Bn(s),this.selectionCalculations.getUpdatedSelectionRange(a,s),D(c,function(f){o.selectionCalculations.snapDelta(s,a,f)});while(s.row!==u.row||s.col!==u.col);i.row=s.row,i.col=s.col}},{key:"onModifyGetCellCoords",value:function(i,o){if(!(i<0||o<0)){var a=this.mergedCellsCollection.get(i,o);if(a){var s=a.row,l=a.col,u=a.colspan,c=a.rowspan;return[s,l,s+c-1,l+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(i){i.items.push({name:"---------"},aQe(this))}},{key:"onAfterRenderer",value:function(i,o,a){var s=this.mergedCellsCollection.get(o,a),l=lt(s)?Bn(s):void 0;if(lt(l)){var u=this.hot,c=u.rowIndexMapper,f=u.columnIndexMapper,h=l.row,d=l.col,p=l.colspan,m=l.rowspan,y=this.translateMergedCellToRenderable(h,m,d,p),S=sQe(y,2),R=S[0],E=S[1],O=c.getRenderableFromVisualIndex(o),A=f.getRenderableFromVisualIndex(a),B=R-O+1,j=E-A+1;l.row=c.getNearestNotHiddenIndex(l.row,1),l.col=f.getNearestNotHiddenIndex(l.col,1),l.rowspan=Math.min(l.rowspan,B),l.colspan=Math.min(l.colspan,j)}nT(i,l,o,a)}},{key:"onBeforeSetRangeStart",value:function(i){if(this.mergedCellsCollection.isFirstRenderableMergedCell(i.row,i.col)){var o=this.mergedCellsCollection.get(i.row,i.col),a=[o.row,o.col];i.row=a[0],i.col=a[1]}}},{key:"onBeforeSetRangeEnd",value:function(i){var o=this.hot.getSelectedRangeLast();o.highlight=this.hot._createCellCoords(o.highlight.row,o.highlight.col),o.to=i;var a=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{a=!1;for(var s=0;s<this.mergedCellsCollection.mergedCells.length;s+=1){var l=this.mergedCellsCollection.mergedCells[s],u=l.getRange();o.expandByRange(u)&&(i.row=o.to.row,i.col=o.to.col,a=!0)}}while(a)}},{key:"onAfterGetCellMeta",value:function(i,o,a){var s=this.mergedCellsCollection.get(i,o);s&&(s.row!==i||s.col!==o?a.copyable=!1:(a.rowspan=s.rowspan,a.colspan=s.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(i){var o=this.hot.countCols();this.modifyViewportRowStart(i,o),this.modifyViewportRowEnd(i,o)}},{key:"modifyViewportRowStart",value:function(i,o){for(var a=this.hot.rowIndexMapper,s=a.getVisualFromRenderableIndex(i.startRow),l=0;l<o;l+=1){var u=this.mergedCellsCollection.get(s,l);if(lt(u)){var c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.row,1));if(c<i.startRow){i.startRow=c,this.modifyViewportRowStart(i,o);return}}}}},{key:"modifyViewportRowEnd",value:function(i,o){for(var a=this.hot.rowIndexMapper,s=a.getVisualFromRenderableIndex(i.endRow),l=0;l<o;l+=1){var u=this.mergedCellsCollection.get(s,l);if(lt(u)){var c=u.row+u.rowspan-1,f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(c,-1));if(f>i.endRow){i.endRow=f,this.modifyViewportRowEnd(i,o);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){var o=this.hot.countRows();this.modifyViewportColumnStart(i,o),this.modifyViewportColumnEnd(i,o)}},{key:"modifyViewportColumnStart",value:function(i,o){for(var a=this.hot.columnIndexMapper,s=a.getVisualFromRenderableIndex(i.startColumn),l=0;l<o;l+=1){var u=this.mergedCellsCollection.get(l,s);if(lt(u)){var c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.col,1));if(c<i.startColumn){i.startColumn=c,this.modifyViewportColumnStart(i,o);return}}}}},{key:"modifyViewportColumnEnd",value:function(i,o){for(var a=this.hot.columnIndexMapper,s=a.getVisualFromRenderableIndex(i.endColumn),l=0;l<o;l+=1){var u=this.mergedCellsCollection.get(l,s);if(lt(u)){var c=u.col+u.colspan-1,f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(c,-1));if(f>i.endColumn){i.endColumn=f,this.modifyViewportColumnEnd(i,o);return}}}}},{key:"translateMergedCellToRenderable",value:function(i,o,a,s){var l=this.hot,u=l.rowIndexMapper,c=l.columnIndexMapper,f,h;o===0?f=u.getNearestNotHiddenIndex(i,1):f=u.getNearestNotHiddenIndex(i+o-1,-1),s===0?h=c.getNearestNotHiddenIndex(a,1):h=c.getNearestNotHiddenIndex(a+s-1,-1);var d=i>=0?u.getRenderableFromVisualIndex(f):i,p=a>=0?c.getRenderableFromVisualIndex(h):a;return[d,p]}},{key:"onModifyAutofillRange",value:function(i,o){this.autofillCalculations.correctSelectionAreaSize(o);var a=this.autofillCalculations.getDirection(o,i),s=i;if(this.autofillCalculations.dragAreaOverlapsCollections(o,s,a))return s=o,s;var l=this.mergedCellsCollection.getWithinRange({from:{row:o[0],col:o[1]},to:{row:o[2],col:o[3]}});return l&&(s=this.autofillCalculations.snapDragArea(o,s,a,l)),s}},{key:"onAfterCreateCol",value:function(i,o){this.mergedCellsCollection.shiftCollections("right",i,o)}},{key:"onAfterRemoveCol",value:function(i,o){this.mergedCellsCollection.shiftCollections("left",i,o)}},{key:"onAfterCreateRow",value:function(i,o,a){a!=="auto"&&this.mergedCellsCollection.shiftCollections("down",i,o)}},{key:"onAfterRemoveRow",value:function(i,o){this.mergedCellsCollection.shiftCollections("up",i,o)}},{key:"onAfterChange",value:function(i,o){o==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(i)}},{key:"onBeforeDrawAreaBorders",value:function(i,o){if(o&&o==="area"){var a=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getWithinRange(a);D(s,function(l){a.getBottomEndCorner().row===l.getLastRow()&&a.getBottomEndCorner().col===l.getLastColumn()&&(i[2]=l.row,i[3]=l.col)})}}},{key:"onAfterModifyTransformStart",value:function(i,o,a){if(this.enabled){var s=this.mergedCellsCollection.get(i.row,i.col);if(s){var l=o>0,u=o<0,c=a<0,f=a>0,h=s.row+s.rowspan-1===this.hot.countRows()-1,d=s.row===0,p=s.col+s.colspan-1===this.hot.countCols()-1,m=s.col===0;(l&&h||u&&d||f&&p||c&&m)&&(i.row=s.row,i.col=s.col)}}}},{key:"onAfterDrawSelection",value:function(i,o,a,s){if(a)return this.selectionCalculations.getSelectedMergedCellClassName(i,o,a,s)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return Rp}},{key:"PLUGIN_PRIORITY",get:function(){return CQe}}]),r}(xt);function B$(t){return IQe(t)||AQe(t)||_Qe(t)||TQe()}function TQe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Qe(t,e){if(t){if(typeof t=="string")return V$(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return V$(t,e)}}function V$(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function AQe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function IQe(t){if(Array.isArray(t))return t}function NQe(t,e){return function(r,n){var i=B$(r),o=i.slice(1),a=B$(n),s=a.slice(1);return function l(u){var c=t[u],f=e[u],h=o[u],d=s[u],p=f.multiColumnSorting,m=p.compareFunctionFactory?p.compareFunctionFactory:xG(f.type),y=m(c,f,p)(h,d);if(y===Mo){var S=u+1;if(typeof e[S]<"u")return l(S)}return y}(0)}}var j$;function PQe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function W$(){Dt(kt(j$||(j$=PQe(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var eY="sort";function MQe(t,e,r){var n=[];return r===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&n.push("".concat(eY,"-").concat(t.getIndexOfColumnInSortQueue(e)+1)),n}function kQe(t){var e=t.className.split(" "),r=new RegExp("^".concat(eY,"-[0-9]{1,2}$"));return e.filter(function(n){return r.test(n)})}function Jh(t){"@babel/helpers - typeof";return Jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jh(t)}function xQe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function G$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,LQe(n.key),n)}}function $Qe(t,e,r){return e&&G$(t.prototype,e),r&&G$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function LQe(t){var e=DQe(t,"string");return Jh(e)==="symbol"?e:String(e)}function DQe(t,e){if(Jh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function ni(){return typeof Reflect<"u"&&Reflect.get?ni=Reflect.get.bind():ni=function(e,r,n){var i=FQe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},ni.apply(this,arguments)}function FQe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=On(t),t!==null););return t}function HQe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sT(t,e)}function sT(t,e){return sT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sT(t,e)}function UQe(t){var e=jQe();return function(){var n=On(t),i;if(e){var o=On(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return BQe(this,i)}}function BQe(t,e){if(e&&(Jh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VQe(t)}function VQe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function jQe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function On(t){return On=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},On(t)}var lT="multiColumnSorting",WQe=170,GQe="append",z$="columnSorting";kG(lT,NQe);var zQe=function(t){HQe(r,t);var e=UQe(r);function r(n){var i;return xQe(this,r),i=e.call(this,n),i.pluginKey=lT,i}return $Qe(r,[{key:"isEnabled",value:function(){return ni(On(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[z$]&&W$(),ni(On(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){ni(On(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){ni(On(r.prototype),"sort",this).call(this,i)}},{key:"clearSort",value:function(){ni(On(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return ni(On(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(i){return ni(On(r.prototype),"getSortConfig",this).call(this,i)}},{key:"setSortConfig",value:function(i){ni(On(r.prototype),"setSortConfig",this).call(this,i)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i:[i]}},{key:"updateHeaderClasses",value:function(i){for(var o,a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];(o=ni(On(r.prototype),"updateHeaderClasses",this)).call.apply(o,[this,i].concat(s)),qe(i,kQe(i)),this.enabled!==!1&&le(i,MQe.apply(void 0,s))}},{key:"onUpdateSettings",value:function(i){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[z$]&&W$(),ni(On(r.prototype),"onUpdateSettings",this).call(this,i)}},{key:"onAfterOnCellMouseDown",value:function(i,o){iO(o.row,o.col,i)!==!1&&this.wasClickableHeaderClicked(i,o.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(o.col),this.sort(this.getNextSortConfig(o.col,GQe))):this.sort(this.getColumnNextConfig(o.col)))}}],[{key:"PLUGIN_KEY",get:function(){return lT}},{key:"PLUGIN_PRIORITY",get:function(){return WQe}}]),r}(LG);function ed(t){"@babel/helpers - typeof";return ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ed(t)}function YQe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,XQe(n.key),n)}}function KQe(t,e,r){return e&&Y$(t.prototype,e),r&&Y$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function XQe(t){var e=qQe(t,"string");return ed(e)==="symbol"?e:String(e)}function qQe(t,e){if(ed(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function N0(){return typeof Reflect<"u"&&Reflect.get?N0=Reflect.get.bind():N0=function(e,r,n){var i=QQe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},N0.apply(this,arguments)}function QQe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=td(t),t!==null););return t}function ZQe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&uT(t,e)}function uT(t,e){return uT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},uT(t,e)}function JQe(t){var e=rZe();return function(){var n=td(t),i;if(e){var o=td(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return eZe(this,i)}}function eZe(t,e){if(e&&(ed(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tZe(t)}function tZe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rZe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function td(t){return td=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},td(t)}var nZe="multipleSelectionHandles",iZe=160,oZe=function(t){ZQe(r,t);var e=JQe(r);function r(n){var i;return YQe(this,r),i=e.call(this,n),i.dragged=[],i.eventManager=null,i.lastSetCell=null,i}return KQe(r,[{key:"isEnabled",value:function(){return Ao()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new hr(this)),this.registerListeners(),N0(td(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var i=this,o=this,a=this.hot.rootElement;function s(l){if(o.dragged.length===1)return o.dragged.splice(0,o.dragged.length),!0;var u=o.dragged.indexOf(l);if(u===-1)return!1;u===0?o.dragged=o.dragged.slice(0,1):u===1&&(o.dragged=o.dragged.slice(-1))}this.eventManager.addEventListener(a,"touchstart",function(l){var u;if(Xe(l.target,"topSelectionHandle-HitArea"))return u=o.hot.getSelectedRangeLast(),o.dragged.push("top"),o.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},l.preventDefault(),!1;if(Xe(l.target,"bottomSelectionHandle-HitArea"))return u=o.hot.getSelectedRangeLast(),o.dragged.push("bottom"),o.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},l.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchend",function(l){if(Xe(l.target,"topSelectionHandle-HitArea"))return s.call(o,"top"),o.touchStartRange=void 0,l.preventDefault(),!1;if(Xe(l.target,"bottomSelectionHandle-HitArea"))return s.call(o,"bottom"),o.touchStartRange=void 0,l.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchmove",function(l){var u=i.hot.rootDocument,c,f,h,d,p,m;if(o.dragged.length!==0){var y=u.elementFromPoint(l.touches[0].clientX,l.touches[0].clientY);!y||y===o.lastSetCell||((y.nodeName==="TD"||y.nodeName==="TH")&&(c=o.hot.getCoords(y),c.col===-1&&(c.col=0),f=o.hot.getSelectedRangeLast(),h=f.getWidth(),d=f.getHeight(),p=f.getDirection(),h===1&&d===1&&o.hot.selection.setRangeEnd(c),m=o.getCurrentRangeCoords(f,c,o.touchStartRange.direction,p,o.dragged[0]),m.start!==null&&o.hot.selection.setRangeStart(m.start),o.hot.selection.setRangeEnd(m.end),o.lastSetCell=y),l.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(i,o,a,s,l){var u=i.getTopStartCorner(),c=i.getBottomEndCorner(),f=i.getBottomStartCorner(),h=i.getTopEndCorner(),d={start:null,end:null};switch(a){case"NE-SW":switch(s){case"NE-SW":case"NW-SE":l==="top"?d={start:this.hot._createCellCoords(o.row,i.highlight.col),end:this.hot._createCellCoords(f.row,o.col)}:d={start:this.hot._createCellCoords(i.highlight.row,o.col),end:this.hot._createCellCoords(o.row,u.col)};break;case"SE-NW":l==="bottom"&&(d={start:this.hot._createCellCoords(c.row,o.col),end:this.hot._createCellCoords(o.row,u.col)});break}break;case"NW-SE":switch(s){case"NE-SW":l==="top"?d={start:o,end:f}:d.end=o;break;case"NW-SE":l==="top"?d={start:o,end:c}:d.end=o;break;case"SE-NW":l==="top"?d={start:o,end:u}:d.end=o;break;case"SW-NE":l==="top"?d={start:o,end:h}:d.end=o;break}break;case"SW-NE":switch(s){case"NW-SE":l==="bottom"?d={start:this.hot._createCellCoords(o.row,u.col),end:this.hot._createCellCoords(f.row,o.col)}:d={start:this.hot._createCellCoords(u.row,o.col),end:this.hot._createCellCoords(o.row,c.col)};break;case"SW-NE":l==="top"?d={start:this.hot._createCellCoords(i.highlight.row,o.col),end:this.hot._createCellCoords(o.row,c.col)}:d={start:this.hot._createCellCoords(o.row,u.col),end:this.hot._createCellCoords(u.row,o.col)};break;case"SE-NW":l==="bottom"?d={start:this.hot._createCellCoords(o.row,h.col),end:this.hot._createCellCoords(u.row,o.col)}:l==="top"&&(d={start:f,end:o});break}break;case"SE-NW":switch(s){case"NW-SE":case"NE-SW":case"SW-NE":l==="top"&&(d.end=o);break;case"SE-NW":l==="top"?d.end=o:d={start:o,end:u};break}break}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return nZe}},{key:"PLUGIN_PRIORITY",get:function(){return iZe}}]),r}(xt);function cT(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.label,r=e===void 0?"":e,n=t.colspan,i=n===void 0?1:n,o=t.origColspan,a=o===void 0?1:o,s=t.collapsible,l=s===void 0?!1:s,u=t.crossHiddenColumns,c=u===void 0?[]:u,f=t.isCollapsed,h=f===void 0?!1:f,d=t.isHidden,p=d===void 0?!1:d,m=t.isRoot,y=m===void 0?!1:m,S=t.isPlaceholder,R=S===void 0?!1:S;return{label:r,colspan:i,origColspan:a,collapsible:l,isCollapsed:h,crossHiddenColumns:c,isHidden:p,isRoot:y,isPlaceholder:R}}function tY(){return{label:"",isPlaceholder:!0}}function K$(t){return uZe(t)||lZe(t)||sZe(t)||aZe()}function aZe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sZe(t,e){if(t){if(typeof t=="string")return fT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fT(t,e)}}function lZe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function uZe(t){if(Array.isArray(t))return fT(t)}function fT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function cZe(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(e===0)return r;D(t,function(i){var o=[],a=0;r.push(o),D(i,function(s){var l=cT();if(lt(s)){var u=s.label,c=s.colspan;l.label=Ar(u),typeof c=="number"&&c>1&&(l.colspan=c,l.origColspan=c)}else l.label=Ar(s);a+=l.origColspan;var f=!1;if(a>=e&&(l.colspan=l.origColspan-(a-e),l.origColspan=l.colspan,f=!0),o.push(l),l.colspan>1)for(var h=0;h<l.colspan-1;h++)o.push(tY());return!f})});var n=Math.max.apply(Math,K$(st(r,function(i){return i.length})));return D(r,function(i){if(i.length<n){var o=st(new Array(n-i.length),function(){return cT()});i.splice.apply(i,[i.length,0].concat(K$(o)))}}),r}function og(t){"@babel/helpers - typeof";return og=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},og(t)}var fZe=["row","col"];function X$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function hZe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?X$(Object(r),!0).forEach(function(n){dZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):X$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dZe(t,e,r){return e=rY(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pZe(t,e){if(t==null)return{};var r=mZe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function mZe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function vZe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gZe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rY(n.key),n)}}function yZe(t,e,r){return e&&gZe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function rY(t){var e=bZe(t,"string");return og(e)==="symbol"?e:String(e)}function bZe(t,e){if(og(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(og(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VR(t,e,r){wZe(t,e),e.set(t,r)}function wZe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fi(t,e){var r=nY(t,e,"get");return SZe(t,r)}function SZe(t,e){return e.get?e.get.call(t):e.value}function up(t,e,r){var n=nY(t,e,"set");return RZe(t,n,r),r}function nY(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function RZe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var q$=["label","collapsible"],ta=new WeakMap,Rl=new WeakMap,jR=new WeakMap,EZe=function(){function t(){vZe(this,t),VR(this,ta,{writable:!0,value:[]}),VR(this,Rl,{writable:!0,value:0}),VR(this,jR,{writable:!0,value:1/0})}return yZe(t,[{key:"setColumnsLimit",value:function(r){up(this,jR,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];up(this,ta,cZe(r,Fi(this,jR))),up(this,Rl,Fi(this,ta).length)}},{key:"getData",value:function(){return Fi(this,ta)}},{key:"mergeWith",value:function(r){var n=this;D(r,function(i){var o=i.row,a=i.col,s=pZe(i,fZe),l=n.getHeaderSettings(o,a);l!==null&&$r(l,s,q$)})}},{key:"map",value:function(r){D(Fi(this,ta),function(n){D(n,function(i){var o=r(hZe({},i));lt(o)&&$r(i,o,q$)})})}},{key:"getHeaderSettings",value:function(r,n){var i;if(r>=Fi(this,Rl)||r<0)return null;var o=Fi(this,ta)[r];return n>=o.length?null:(i=o[n])!==null&&i!==void 0?i:null}},{key:"getHeadersSettings",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,o=[];if(r>=Fi(this,Rl)||r<0)return o;for(var a=Fi(this,ta)[r],s=0,l=n;l<a.length;l++){var u=a[l];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=u.colspan,o.push(u),u.colspan>1&&(l+=u.colspan-1),s===i)break;if(s>i)throw new Error("The last column settings cannot overlap the other header layers")}return o}},{key:"getLayersCount",value:function(){return Fi(this,Rl)}},{key:"getColumnsCount",value:function(){return Fi(this,Rl)>0?Fi(this,ta)[0].length:0}},{key:"clear",value:function(){up(this,ta,[]),up(this,Rl,0)}}]),t}();function ag(t){"@babel/helpers - typeof";return ag=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ag(t)}function Q$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Z$(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Q$(Object(r),!0).forEach(function(n){P0(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Q$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function CZe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function OZe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,iY(n.key),n)}}function TZe(t,e,r){return e&&OZe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function P0(t,e,r){return e=iY(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iY(t){var e=_Ze(t,"string");return ag(e)==="symbol"?e:String(e)}function _Ze(t,e){if(ag(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ag(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AZe(t){return MZe(t)||PZe(t)||NZe(t)||IZe()}function IZe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NZe(t,e){if(t){if(typeof t=="string")return hT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hT(t,e)}}function PZe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function MZe(t){if(Array.isArray(t))return hT(t)}function hT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var kZe="DF-pre-order";function oY(t,e){for(var r=t.call(e,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=oY.call(this.childs[n],t,e)}return r}var xZe="DF-post-order";function aY(t,e){for(var r=0;r<this.childs.length;r++){var n=aY.call(this.childs[r],t,e);if(n===!1)return!1}return t.call(e,this)}var sY="BF";function $Ze(t,e){var r=[this];function n(){if(r.length!==0){var i=r.shift();r.push.apply(r,AZe(i.childs)),t.call(e,i)!==!1&&n()}}n()}var LZe=sY,J$=new Map([[kZe,oY],[xZe,aY],[sY,$Ze]]),eL=function(){function t(e){CZe(this,t),P0(this,"data",{}),P0(this,"parent",null),P0(this,"childs",[]),this.data=e}return TZe(t,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new t(Z$({},r.data)),i=0;i<r.childs.length;i++)n.addChild(this.cloneTree(r.childs[i]));return n}},{key:"replaceTreeWith",value:function(r){this.data=Z$({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:LZe;if(!J$.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));J$.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,i=function o(a){var s=r.call(n,a);s!==!1&&a.parent!==null&&o(a.parent)};i(this)}}]),t}();function sg(t){"@babel/helpers - typeof";return sg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sg(t)}function tL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function rL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tL(Object(r),!0).forEach(function(n){DZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function DZe(t,e,r){return e=lY(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FZe(t,e){return VZe(t)||BZe(t,e)||UZe(t,e)||HZe()}function HZe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UZe(t,e){if(t){if(typeof t=="string")return nL(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nL(t,e)}}function nL(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function BZe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e!==0)for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function VZe(t){if(Array.isArray(t))return t}function jZe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WZe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lY(n.key),n)}}function GZe(t,e,r){return e&&WZe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function lY(t){var e=zZe(t,"string");return sg(e)==="symbol"?e:String(e)}function zZe(t,e){if(sg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(sg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WR(t,e,r){YZe(t,e),e.set(t,r)}function YZe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rn(t,e){var r=uY(t,e,"get");return KZe(t,r)}function KZe(t,e){return e.get?e.get.call(t):e.value}function XZe(t,e,r){var n=uY(t,e,"set");return qZe(t,n,r),r}function uY(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function qZe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var Ec=new WeakMap,El=new WeakMap,Cc=new WeakMap,QZe=function(){function t(e){jZe(this,t),WR(this,Ec,{writable:!0,value:new Map}),WR(this,El,{writable:!0,value:new Map}),WR(this,Cc,{writable:!0,value:null}),XZe(this,Cc,e)}return GZe(t,[{key:"getRoots",value:function(){return Array.from(Rn(this,Ec).values())}},{key:"getRootByColumn",value:function(r){var n;return Rn(this,El).has(r)&&(n=Rn(this,Ec).get(Rn(this,El).get(r))),n}},{key:"getNode",value:function(r,n){var i=this.getRootByColumn(n);if(i){var o=n-Rn(this,El).get(n),a=0,s;return i.walkDown(function(l){var u=l.data,c=u.origColspan,f=u.headerLevel;if(r===f){if(o>=a&&o<=a+c-1)return s=l,s.data.isRoot=n===s.data.columnIndex,!1;a+=c}}),s}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;Rn(this,El).clear(),D(Rn(this,Ec),function(i){for(var o=FZe(i,2),a=o[1].data.colspan,s=n;s<n+a;s++)Rn(r,El).set(s,n);n+=a})}},{key:"buildTree",value:function(){this.clear();for(var r=Rn(this,Cc).getColumnsCount(),n=0;n<r;){var i=Rn(this,Cc).getHeaderSettings(0,n),o=new eL;Rn(this,Ec).set(n,o),this.buildLeaves(o,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,i){var o=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,s=Rn(this,Cc).getHeadersSettings(i,n,a);i+=1,D(s,function(l){var u=rL(rL({},l),{},{headerLevel:i-1,columnIndex:n}),c;i===1?(r.data=u,c=r):(c=new eL(u),r.addChild(c)),i<Rn(o,Cc).getLayersCount()&&o.buildLeaves(c,n,i,l.origColspan),n+=l.origColspan})}},{key:"clear",value:function(){Rn(this,Ec).clear(),Rn(this,El).clear()}}]),t}();function cY(t,e){t.walkDown(function(r){var n=r.data,i=r.childs;if(!n.isHidden&&(e(n.columnIndex),i.length===0))for(var o=1;o<n.colspan;o++)e(n.columnIndex+o)})}function v2(t,e){var r=t.childs;if(r.length!==0)return r[0].data[e]}function g2(t){return v2(t,"origColspan")===t.data.origColspan}function ZI(t){var e=t.data,r=t.childs;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=g2(t);if(n)return ZI(r[0]);e.isCollapsed=!1;var i=r.slice(1),o=new Set,a=0;if(i.length>0)D(i,function(f){f.replaceTreeWith(f.data.clonedTree),f.data.clonedTree=null;var h=f.data;a+=h.colspan,cY(f,function(d){o.add(d)})});else{var s=e.colspan,l=e.origColspan,u=e.columnIndex;a=l-s;for(var c=1;c<l;c++)o.add(u+c)}return t.walkUp(function(f){var h=f.data;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):g2(f)&&(h.isCollapsed=v2(f,"isCollapsed"))}),{rollbackModification:function(){return JI(t)},affectedColumns:Array.from(o),colspanCompensation:a}}function JI(t){var e,r=t.data,n=t.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var i=g2(t);if(i)return JI(n[0]);r.isCollapsed=!0;var o=n.slice(1),a=new Set;if(o.length>0)D(o,function(h){cY(h,function(d){a.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(d){var p=d.data;p.isHidden=!0})});else for(var s=r.origColspan,l=r.columnIndex,u=1;u<s;u++){var c=l+u;a.add(c)}var f=r.colspan-((e=v2(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(function(h){var d=h.data;d.colspan-=f,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):g2(h)&&(d.isCollapsed=v2(h,"isCollapsed"))}),{rollbackModification:function(){return ZI(t)},affectedColumns:Array.from(a),colspanCompensation:f}}var iL;function ZZe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function JZe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(kt(iL||(iL=ZZe([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=t.data.crossHiddenColumns;if(!r.includes(e)){var n=!1;t.walkUp(function(i){var o=i.data.collapsible;if(o)return n=!0,!1}),!n&&t.walkUp(function(i){var o=i.data;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}}var oL;function eJe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function tJe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(kt(oL||(oL=eJe([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=t.data.crossHiddenColumns;if(r.includes(e)){var n=!1;t.walkUp(function(i){var o=i.data.collapsible;if(o)return n=!0,!1}),!n&&t.walkUp(function(i){var o=i.data;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}}var aL=new Map([["collapse",JI],["expand",ZI],["hide-column",JZe],["show-column",tJe]]);function rJe(t,e,r){if(!aL.has(t))throw new Error('The node modifier action ("'.concat(t,'") does not exist.'));return aL.get(t)(e,r)}var nJe=["crossHiddenColumns"];function iJe(t,e){if(t==null)return{};var r=oJe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function oJe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function P1(t){var e=[];return D(t,function(r){r.walkDown(function(n){for(var i=n.data,o=i.origColspan,a=i.columnIndex,s=i.headerLevel,l=i.crossHiddenColumns,u=sJe(e,s),c=!1,f=a;f<a+o;f++){var h=l.includes(f);if(h||c)u.push(tY());else{var d=aJe(i);d.isRoot=!0,u.push(d),c=!0}}})}),e}function aJe(t){var e=cT(t);e.crossHiddenColumns;var r=iJe(e,nJe);return r}function sJe(t,e){var r;return Array.isArray(t[e])?r=t[e]:(r=[],t[e]=r),r}function lg(t){"@babel/helpers - typeof";return lg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lg(t)}var lJe=["row"];function sL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function lL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sL(Object(r),!0).forEach(function(n){uJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function uJe(t,e,r){return e=fY(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cJe(t,e){if(t==null)return{};var r=fJe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function fJe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function hJe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dJe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fY(n.key),n)}}function pJe(t,e,r){return e&&dJe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function fY(t){var e=mJe(t,"string");return lg(e)==="symbol"?e:String(e)}function mJe(t,e){if(lg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(lg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function GR(t,e,r){vJe(t,e),e.set(t,r)}function vJe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cp(t,e,r){var n=hY(t,e,"set");return gJe(t,n,r),r}function gJe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function vr(t,e){var r=hY(t,e,"get");return yJe(t,r)}function hY(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function yJe(t,e){return e.get?e.get.call(t):e.value}var yo=new WeakMap,ti=new WeakMap,Cl=new WeakMap,bJe=function(){function t(){hJe(this,t),GR(this,yo,{writable:!0,value:new EZe}),GR(this,ti,{writable:!0,value:new QZe(vr(this,yo))}),GR(this,Cl,{writable:!0,value:[[]]})}return pJe(t,[{key:"setState",value:function(r){vr(this,yo).setData(r);var n=!1;try{vr(this,ti).buildTree()}catch{vr(this,ti).clear(),vr(this,yo).clear(),n=!0}return cp(this,Cl,P1(vr(this,ti).getRoots())),n}},{key:"setColumnsLimit",value:function(r){vr(this,yo).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,i=st(r,function(o){var a=o.row,s=cJe(o,lJe);return lL({row:a<0?n.rowCoordsToLevel(a):a},s)});vr(this,yo).mergeWith(i),vr(this,ti).buildTree(),cp(this,Cl,P1(vr(this,ti).getRoots()))}},{key:"mapState",value:function(r){vr(this,yo).map(r),vr(this,ti).buildTree(),cp(this,Cl,P1(vr(this,ti).getRoots()))}},{key:"mapNodes",value:function(r){return gn(vr(this,ti).getRoots(),function(n,i){return i.walkDown(function(o){var a=r(o.data);a!==void 0&&n.push(a)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,i){n<0&&(n=this.rowCoordsToLevel(n));var o=vr(this,ti).getNode(n,i),a;return o&&(a=rJe(r,o,i),cp(this,Cl,P1(vr(this,ti).getRoots()))),a}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var i,o;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(i=(o=vr(this,Cl)[r])===null||o===void 0?void 0:o[n])!==null&&i!==void 0?i:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var i=vr(this,ti).getNode(r,n);return i?lL({},i.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var i,o=(i=this.getHeaderSettings(r,n))!==null&&i!==void 0?i:{isRoot:!0},a=o.isRoot;if(a)return n;for(var s=n-1;s>=0;){var l,u=(l=this.getHeaderSettings(r,s))!==null&&l!==void 0?l:{isRoot:!0},c=u.isRoot;if(c)break;s-=1}return s}},{key:"getLayersCount",value:function(){return vr(this,yo).getLayersCount()}},{key:"getColumnsCount",value:function(){return vr(this,yo).getColumnsCount()}},{key:"clear",value:function(){cp(this,Cl,[]),vr(this,yo).clear(),vr(this,ti).clear()}}]),t}();function ug(t){"@babel/helpers - typeof";return ug=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ug(t)}function wJe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function SJe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dY(n.key),n)}}function RJe(t,e,r){return e&&SJe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function fp(t,e,r){return e=dY(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dY(t){var e=EJe(t,"string");return ug(e)==="symbol"?e:String(e)}function EJe(t,e){if(ug(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ug(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var CJe=function(){function t(e,r){wJe(this,t),fp(this,"hot",void 0),fp(this,"nestedHeaderSettingsGetter",void 0),fp(this,"layersCount",0),fp(this,"container",void 0),fp(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return RJe(t,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var i=0;i<n;i++){var o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),a=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(a,r[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,i=n.rootDocument,o=n.columnIndexMapper,a=i.createDocumentFragment(),s=i.createElement("table"),l=!!this.hot.getSettings().dropdownMenu,u=o.getRenderableIndexesLength(),c=0;c<this.layersCount;c++){for(var f=i.createElement("tr"),h=0;h<u;h++){var d=o.getVisualFromRenderableIndex(h);d===null&&(d=h);var p=i.createElement("th"),m=this.nestedHeaderSettingsGetter(c,d);if(m&&(!m.isPlaceholder||m.isHidden)){var y=m.label;l&&(y+='<button class="changeType"></button>'),Ed(p,y),p.colSpan=m.colspan,f.appendChild(p)}}s.appendChild(f)}a.appendChild(s),r.appendChild(a)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),t}();const OJe=CJe;function rd(t){"@babel/helpers - typeof";return rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rd(t)}var uL,cL;function fL(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function TJe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,pY(n.key),n)}}function _Je(t,e,r){return e&&hL(t.prototype,e),r&&hL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zl(){return typeof Reflect<"u"&&Reflect.get?Zl=Reflect.get.bind():Zl=function(e,r,n){var i=AJe(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Zl.apply(this,arguments)}function AJe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ma(t),t!==null););return t}function IJe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dT(t,e)}function dT(t,e){return dT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},dT(t,e)}function NJe(t){var e=MJe();return function(){var n=Ma(t),i;if(e){var o=Ma(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return PJe(this,i)}}function PJe(t,e){if(e&&(rd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ep(t)}function Ep(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function MJe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ma(t){return Ma=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ma(t)}function dL(t,e,r){return e=pY(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pY(t){var e=kJe(t,"string");return rd(e)==="symbol"?e:String(e)}function kJe(t,e){if(rd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pL(t,e,r){xJe(t,e),e.set(t,r)}function xJe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function M1(t,e,r){var n=mY(t,e,"set");return $Je(t,n,r),r}function $Je(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function or(t,e){var r=mY(t,e,"get");return LJe(t,r)}function mY(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function LJe(t,e){return e.get?e.get.call(t):e.value}var mL="nestedHeaders",DJe=280,Cr=new WeakMap,cs=new WeakMap,FJe=function(t){IJe(r,t);var e=NJe(r);function r(){var n;TJe(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),pL(Ep(n),Cr,{writable:!0,value:new bJe}),pL(Ep(n),cs,{writable:!0,value:null}),dL(Ep(n),"ghostTable",new OJe(n.hot,function(s,l){return n.getHeaderSettings(s,l)})),dL(Ep(n),"detectedOverlappedHeaders",!1),n}return _Je(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[mL]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings(),a=o.nestedHeaders;(!Array.isArray(a)||!Array.isArray(a[0]))&&Dt(kt(uL||(uL=fL([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(){return i.onAfterOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(s){return i.onAfterGetColumnHeaderRenderers(s)}),this.addHook("modifyColWidth",function(){return i.onModifyColWidth.apply(i,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return i.onModifyColumnHeaderValue.apply(i,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return i.onBeforeHighlightingColumnHeader.apply(i,arguments)}),this.addHook("beforeCopy",function(){return i.onBeforeCopy.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),Zl(Ma(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var i=this;if(this.hot.view){var o=this.hot.getSettings(),a=o.nestedHeaders;or(this,Cr).setColumnsLimit(this.hot.countCols()),Array.isArray(a)&&(this.detectedOverlappedHeaders=or(this,Cr).setState(a)),this.detectedOverlappedHeaders&&Dt(kt(cL||(cL=fL([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(s,l){var u=s===!0?"hide-column":"show-column";or(i,Cr).triggerColumnModification(u,l)}),!or(this,cs)&&this.enabled&&M1(this,cs,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(s){s.forEach(function(l){var u=l.op,c=l.index,f=l.newValue;if(u==="replace"){var h=f===!0?"hide-column":"show-column";or(i,Cr).triggerColumnModification(h,c)}}),i.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),Zl(Ma(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),or(this,Cr).clear(),or(this,cs).unsubscribe(),M1(this,cs,null),this.ghostTable.clear(),Zl(Ma(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return or(this,Cr)}},{key:"getLayersCount",value:function(){return or(this,Cr).getLayersCount()}},{key:"getHeaderSettings",value:function(i,o){return or(this,Cr).getHeaderSettings(i,o)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var i=this.hot.view._wt,o=i.getSetting("columnHeaders").length,a=i.wtTable.THEAD,s=i.wtOverlays.topOverlay.clone.wtTable.THEAD,l=i.wtOverlays.topInlineStartCornerOverlay?i.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,u=0;u<o;u++){var c=a.childNodes[u];if(!c)break;for(var f=s.childNodes[u],h=l?l.childNodes[u]:null,d=0,p=c.childNodes.length;d<p;d++)c.childNodes[d].removeAttribute("colspan"),qe(c.childNodes[d],"hiddenHeader"),f&&f.childNodes[d]&&(f.childNodes[d].removeAttribute("colspan"),qe(f.childNodes[d],"hiddenHeader")),l&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),qe(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(i){var o=this,a=this.hot.view._wt.getSetting("fixedColumnsStart");return function(s,l){var u,c=o.hot,f=c.columnIndexMapper,h=c.view,d=f.getVisualFromRenderableIndex(s);d===null&&(d=s),l.removeAttribute("colspan"),qe(l,"hiddenHeader");var p=(u=or(o,Cr).getHeaderSettings(i,d))!==null&&u!==void 0?u:{label:""},m=p.colspan,y=p.isHidden,S=p.isPlaceholder;if(S||y)le(l,"hiddenHeader");else if(m>1){var R,E,O=h._wt.wtOverlays,A=(R=O.topInlineStartCornerOverlay)===null||R===void 0?void 0:R.clone.wtTable.THEAD.contains(l),B=(E=O.inlineStartOverlay)===null||E===void 0?void 0:E.clone.wtTable.THEAD.contains(l),j=A||B?Math.min(m,a-s):m;j>1&&l.setAttribute("colspan",j)}o.hot.view.appendColHeader(d,l,function(){return o.getColumnHeaderValue.apply(o,arguments)},i)}}},{key:"getColumnHeaderValue",value:function(i,o){var a,s=(a=or(this,Cr).getHeaderSettings(o,i))!==null&&a!==void 0?a:{},l=s.isHidden,u=s.isPlaceholder;return u||l?"":this.hot.getColHeader(i,o)}},{key:"onBeforeHighlightingColumnHeader",value:function(i,o,a){var s=or(this,Cr).getHeaderTreeNodeData(o,i);if(!s)return i;var l=a.classNames,u=a.columnCursor,c=a.selectionType,f=a.selectionWidth,h=or(this,Cr).getHeaderSettings(o,i),d=h.isRoot,p=h.colspan;if(c===Wg){if(!d)return s.columnIndex}else c===cw&&(p>f-u||!d)&&(l.length=0);return i}},{key:"onBeforeCopy",value:function(i,o,a){var s=a.columnHeadersCount;if(s!==0)for(var l=0;l<o.length;l++){var u=o[l],c=u.startRow,f=u.startCol,h=u.endRow,d=u.endCol,p=h-c+1,m=f-d+1;if(c>=0||m===1)break;for(var y=f;y<=d;y++)for(var S=c;S<=h;S++){var R,E=p+S,O=y-f;if(O!==0){var A=(R=or(this,Cr).getHeaderTreeNodeData(S,y))===null||R===void 0?void 0:R.isRoot;A===!1&&(i[E][O]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a,s){var l=this._getHeaderTreeNodeDataByCoords(o);l&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,o){var a=this._getHeaderTreeNodeDataByCoords(o);if(a){var s=this.hot.selection,l=s.isSelected()?s.getSelectedRange().current():null,u=[],c=a.columnIndex,f=a.origColspan,h=!s.inInSelection(o);i.shiftKey&&l?o.col<l.from.col?u.push(l.getTopEndCorner().col,c,o.row):o.col>l.from.col?u.push(l.getTopStartCorner().col,c+f-1,o.row):u.push(c,c+f-1,o.row):(Q_(i)||pu(i)&&h)&&u.push(c,c+f-1,o.row),s.selectColumns.apply(s,u)}}},{key:"onBeforeOnCellMouseOver",value:function(i,o,a,s){var l;if(this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(o);if(u){var c=u.columnIndex,f=u.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopStartCorner(),p=h.getBottomEndCorner(),m=h.from;s.column=!0,s.cell=!0;var y=[];o.col<m.col?y.push(p.col,c):o.col>m.col?y.push(d.col,c+f-1):y.push(c,c+f-1),(l=this.hot).selectColumns.apply(l,y)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(i){i.length=0;for(var o=0;o<or(this,Cr).getLayersCount();o++)i.push(this.headerRendererFactory(o))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){for(var o=or(this,Cr).getLayersCount(),a=i.startColumn,s=!!o,l=0;l<o;l++){var u=or(this,Cr).findLeftMostColumnIndex(l,i.startColumn),c=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(s=!1),Ln(c)&&c<i.startColumn){a=c;break}}i.startColumn=s?or(this,Cr).getHeaderTreeNodeData(0,a).columnIndex:a}},{key:"onModifyColWidth",value:function(i,o){var a=this.ghostTable.getWidth(o);return i>a?i:a}},{key:"onModifyColumnHeaderValue",value:function(i,o,a){var s,l=(s=or(this,Cr).getHeaderTreeNodeData(a,o))!==null&&s!==void 0?s:{label:""},u=l.label;return u}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,o){o||this.updatePlugin()}},{key:"destroy",value:function(){M1(this,Cr,null),or(this,cs)!==null&&(or(this,cs).unsubscribe(),M1(this,cs,null)),Zl(Ma(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(i){if(!(i.row>=0||i.col<0))return or(this,Cr).getHeaderTreeNodeData(i.row,i.col)}}],[{key:"PLUGIN_KEY",get:function(){return mL}},{key:"PLUGIN_PRIORITY",get:function(){return DJe}}]),r}(xt);function vL(t){return VJe(t)||BJe(t)||UJe(t)||HJe()}function HJe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UJe(t,e){if(t){if(typeof t=="string")return pT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pT(t,e)}}function BJe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function VJe(t){if(Array.isArray(t))return pT(t)}function pT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function nd(t){"@babel/helpers - typeof";return nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nd(t)}function jJe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WJe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,zJe(n.key),n)}}function GJe(t,e,r){return e&&WJe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function zJe(t){var e=YJe(t,"string");return nd(e)==="symbol"?e:String(e)}function YJe(t,e){if(nd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var KJe=function(){function t(e,r){jJe(this,t),this.hot=r,this.data=null,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return GJe(t,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},De(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,i){var o=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&D(r.__children,function(a){o.cacheNode(a,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,i,o){var a=this,s=!1,l=n;if(isNaN(l)&&l.end)return l;var u=r;return u||(u={__children:this.data},s=!0,l-=1),i!=null&&l===i?{result:u,end:!0}:o!=null&&u===o?{result:l,end:!0}:(l+=1,u.__children&&D(u.__children,function(c){if(a.parentReference.set(c,s?null:u),l=a.readTreeNodes(c,l,i,o),isNaN(l)&&l.end)return!1}),l)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return ut(this.data[0],function(n,i){r[i]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var i=this.getRowParent(r);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,i=0,o=r;return isNaN(o)||(o=this.getDataObject(o)),!o||!o.__children?0:(D(o.__children,function(a){i+=1,a.__children&&(i+=n.countChildren(a))}),i)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||nd(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var i;return((i=r.__children)===null||i===void 0?void 0:i[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,i=r;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var i=n;this.hot.runHooks("beforeAddChild",r,i);var o=null;r&&(o=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",o+this.countChildren(r)+1,1);var a=r;r||(a=this.mockParent()),a.__children||(a.__children=[]),i||(i=this.mockNode()),a.__children.push(i),this.rewriteCache();var s=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",r,i)}},{key:"addChildAtIndex",value:function(r,n,i){var o=i,a;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",r,o,n),r){var s=this.getRowIndex(r),l=s+n+1;this.hot.runHooks("beforeCreateRow",l,1),r.__children.splice(n,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(l,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",l,1),a=l}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),a=this.getRowIndex(this.data[n]);o=this.getDataObject(a),this.hot.runHooks("afterAddChild",r,o,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",i=this.translateTrimmedRow(r),o=this.getRowParent(i),a=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(o,a+1,null);break;case"above":this.addChildAtIndex(o,a,null);break}}},{key:"detachFromParent",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=null,a=[];Array.isArray(r)?(De(r[0],r[2],function(S){var R=n.translateTrimmedRow(S);a.push(n.getDataObject(R))}),De(0,a.length-2,function(S){n.detachFromParent(a[S],!1)}),o=a[a.length-1]):o=r;var s=this.getRowIndex(o),l=this.countChildren(o),u=this.getRowIndexWithinParent(o),c=this.getRowParent(o),f=this.getRowParent(c),h=this.getRowIndex(f),d=null;if(this.hot.runHooks("beforeDetachChild",c,o),u!=null){var p=Array.from(new Array(s+l+1).keys()).splice(-1*(l+1));if(this.hot.runHooks("beforeRemoveRow",s,l+1,p,this.plugin.pluginName),c.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,l+1,p,this.plugin.pluginName),f){d=h+this.countChildren(f);var m=this.getChild(f,this.countChildren(f)-1),y=this.getRowIndex(m);this.hot.runHooks("beforeCreateRow",y+1,l+1,this.plugin.pluginName),f.__children.push(o)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,l+1,this.plugin.pluginName),this.data.push(o)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,l+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",c,o,this.getRowIndex(o)),i&&this.hot.render()}},{key:"filterData",value:function(r,n,i){var o=this,a=[];D(i,function(s){a.push(o.getDataObject(s))}),D(a,function(s){var l=o.getRowIndexWithinParent(s),u=o.getRowParent(s);u===null?o.data.splice(l,1):u.__children.splice(l,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,i){var o=this.getDataObject(r-1),a=null,s=r;if(o&&o.__children&&o.__children.length===0?(a=o,s=0):r<this.countAllRows()&&(a=this.getRowParent(r),s=this.getRowIndexWithinParent(r)),a)if(i){var l;(l=a.__children).splice.apply(l,[s,n].concat(vL(i)))}else a.__children.splice(s,n);else if(i){var u;(u=this.data).splice.apply(u,[s,n].concat(vL(i)))}else this.data.splice(s,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,i=null;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,i,o){var a=n===this.hot.countRows(),s=this.getRowParent(r),l=this.getRowIndexWithinParent(r),u=s.__children.slice(l,l+1),c=r>n,f=a?this.getRowParent(n-1):this.getRowParent(n);f==null&&(f=this.getRowParent(n-1)),f==null&&(f=this.getDataObject(n-1)),f?f.__children||(f.__children=[]):(f=this.getDataObject(n),f.__children=[]);var h=a||i||o?f.__children.length:this.getRowIndexWithinParent(n),d=s===f;f.__children.splice(h,0,u[0]),s.__children.splice(l+(c&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(f)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),t}();const XJe=KJe;function qJe(t,e,r){return Object.defineProperty(t,"prototype",{writable:!1}),t}function QJe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var ZJe=qJe(function t(e,r){QJe(this,t),this.hot=r,this.plugin=e});const e4=ZJe;function id(t){"@babel/helpers - typeof";return id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},id(t)}function JJe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tet(n.key),n)}}function eet(t,e,r){return e&&gL(t.prototype,e),r&&gL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function tet(t){var e=ret(t,"string");return id(e)==="symbol"?e:String(e)}function ret(t,e){if(id(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function net(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mT(t,e)}function mT(t,e){return mT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mT(t,e)}function iet(t){var e=set();return function(){var n=y2(t),i;if(e){var o=y2(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return oet(this,i)}}function oet(t,e){if(e&&(id(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aet(t)}function aet(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function set(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function y2(t){return y2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},y2(t)}var uet=function(t){net(r,t);var e=iet(r);function r(n,i){var o;return JJe(this,r),o=e.call(this,n,i),o.dataManager=o.plugin.dataManager,o.collapsingUI=o.plugin.collapsingUI,o.rowHeaderWidthCache=null,o}return eet(r,[{key:"appendLevelIndicators",value:function(i,o){var a=this.hot.toPhysicalRow(i),s=this.dataManager.getRowLevel(a),l=this.dataManager.getDataObject(a),u=o.getElementsByTagName("DIV")[0],c=u.querySelector("span.rowHeader"),f=u.querySelectorAll('[class^="ht_nesting"]');if(D(f,function(m){m&&u.removeChild(m)}),le(o,r.CSS_CLASSES.indicatorContainer),s){var h=this.hot.rootDocument,d=c.cloneNode(!0);u.innerHTML="",De(0,s-1,function(){var m=h.createElement("SPAN");le(m,r.CSS_CLASSES.emptyIndicator),u.appendChild(m)}),u.appendChild(d)}if(this.dataManager.hasChildren(l)){var p=this.hot.rootDocument.createElement("DIV");le(o,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(a)?le(p,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):le(p,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(p)}}},{key:"updateRowHeaderWidth",value:function(i){var o=i;o||(o=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*o+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(e4);const vY=uet;function od(t){"@babel/helpers - typeof";return od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},od(t)}function yL(t){return det(t)||het(t)||fet(t)||cet()}function cet(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fet(t,e){if(t){if(typeof t=="string")return vT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vT(t,e)}}function het(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function det(t){if(Array.isArray(t))return vT(t)}function vT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function pet(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function met(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,get(n.key),n)}}function vet(t,e,r){return e&&met(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function get(t){var e=yet(t,"string");return od(e)==="symbol"?e:String(e)}function yet(t,e){if(od(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function bet(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gT(t,e)}function gT(t,e){return gT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},gT(t,e)}function wet(t){var e=Cet();return function(){var n=b2(t),i;if(e){var o=b2(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ret(this,i)}}function Ret(t,e){if(e&&(od(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Eet(t)}function Eet(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Cet(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b2(t){return b2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},b2(t)}var Oet=function(t){bet(r,t);var e=wet(r);function r(n,i){var o;return pet(this,r),o=e.call(this,n,i),o.dataManager=o.plugin.dataManager,o.collapsedRows=[],o.collapsedRowsStash={stash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,s)},shiftStash:function(s,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;l==null&&(l=1/0),D(o.lastCollapsedRows,function(c,f){c>=s&&c<l&&(o.lastCollapsedRows[f]=c+u)})},applyStash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;o.collapseMultipleChildren(o.lastCollapsedRows,s),o.lastCollapsedRows=void 0},trimStash:function(s,l){De(s,s+l-1,function(u){var c=o.lastCollapsedRows.indexOf(u);c>-1&&o.lastCollapsedRows.splice(c,1)})}},o}return vet(r,[{key:"collapseChildren",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],u=null,c=null,f=null;return isNaN(i)?(u=i,c=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(i),c=i),this.dataManager.hasChildren(u)&&D(u.__children,function(h){l.push(o.dataManager.getRowIndex(h))}),f=this.collapseRows(l,!0,!1),s&&this.trimRows(f),a&&this.renderAndAdjust(),this.collapsedRows.indexOf(c)===-1&&this.collapsedRows.push(c),f}},{key:"collapseMultipleChildren",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];D(i,function(u){l.push.apply(l,yL(o.collapseChildren(u,!1,!1)))}),s&&this.trimRows(l),a&&this.renderAndAdjust()}},{key:"collapseRow",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([i],o)}},{key:"collapseRows",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return D(i,function(u){l.push(u),a&&o.collapseChildRows(u,l)}),s&&this.trimRows(l),l}},{key:"collapseChildRows",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var l=this.dataManager.getDataObject(i);D(l.__children,function(u){var c=o.dataManager.getRowIndex(u);a.push(c),o.collapseChildRows(c,a)})}s&&this.trimRows(a)}},{key:"expandRow",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([i],o)}},{key:"expandRows",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return D(i,function(u){l.push(u),a&&o.expandChildRows(u,l)}),s&&this.untrimRows(l),l}},{key:"expandChildRows",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var l=this.dataManager.getDataObject(i);D(l.__children,function(u){if(!o.isAnyParentCollapsed(u)){var c=o.dataManager.getRowIndex(u);a.push(c),o.expandChildRows(c,a)}})}s&&this.untrimRows(a)}},{key:"expandChildren",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],u=null,c=null,f=null;return isNaN(i)?(u=i,c=this.dataManager.getRowIndex(i)):(u=this.dataManager.getDataObject(i),c=i),this.collapsedRows.splice(this.collapsedRows.indexOf(c),1),this.dataManager.hasChildren(u)&&D(u.__children,function(h){var d=o.dataManager.getRowIndex(h);l.push(d)}),f=this.expandRows(l,!0,!1),s&&this.untrimRows(f),a&&this.renderAndAdjust(),f}},{key:"expandMultipleChildren",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];D(i,function(u){l.push.apply(l,yL(o.expandChildren(u,!1,!1)))}),s&&this.untrimRows(l),a&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var i=this,o=this.dataManager.getData(),a=[];D(o,function(s){i.dataManager.hasChildren(s)&&a.push(s)}),this.collapseMultipleChildren(a),this.renderAndAdjust()}},{key:"expandAll",value:function(){var i=this,o=this.dataManager.getData(),a=[];D(o,function(s){i.dataManager.hasChildren(s)&&a.push(s)}),this.expandMultipleChildren(a),this.renderAndAdjust()}},{key:"trimRows",value:function(i){var o=this;this.hot.batchExecution(function(){D(i,function(a){o.plugin.collapsedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"untrimRows",value:function(i){var o=this;this.hot.batchExecution(function(){D(i,function(a){o.plugin.collapsedRowsMap.setValueAtIndex(a,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(i){var o=this,a=isNaN(i)?i:this.dataManager.getDataObject(i),s=!0;return a===null&&(a={__children:this.dataManager.data}),this.dataManager.hasChildren(a)&&D(a.__children,function(l){var u=o.dataManager.getRowIndex(l);if(!o.plugin.collapsedRowsMap.getValueAtIndex(u))return s=!1,!1}),s}},{key:"isAnyParentCollapsed",value:function(i){for(var o=i;o!==null;){o=this.dataManager.getRowParent(o);var a=this.dataManager.getRowIndex(o);if(this.collapsedRows.indexOf(a)>-1)return!0}return!1}},{key:"toggleState",value:function(i,o){if(!(o.col>=0)){var a=this.translateTrimmedRow(o.row);Xe(i.target,vY.CSS_CLASSES.button)&&(this.areChildrenCollapsed(a)?this.expandChildren(a):this.collapseChildren(a),Lo(i))}}},{key:"translateTrimmedRow",value:function(i){return this.hot.toPhysicalRow(i)}},{key:"untranslateTrimmedRow",value:function(i){return this.hot.toVisualRow(i)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(e4);const Tet=Oet;function ad(t){"@babel/helpers - typeof";return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ad(t)}function _et(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Aet(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Net(n.key),n)}}function Iet(t,e,r){return e&&Aet(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Net(t){var e=Pet(t,"string");return ad(e)==="symbol"?e:String(e)}function Pet(t,e){if(ad(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Met(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yT(t,e)}function yT(t,e){return yT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yT(t,e)}function ket(t){var e=$et();return function(){var n=w2(t),i;if(e){var o=w2(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return xet(this,i)}}function xet(t,e){if(e&&(ad(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gY(t)}function gY(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $et(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function w2(t){return w2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},w2(t)}var bL=new WeakMap,Let=function(t){Met(r,t);var e=ket(r);function r(n,i){var o;return _et(this,r),o=e.call(this,n,i),bL.set(gY(o),{row_above:function(s,l){var u=l[l.length-1];o.dataManager.addSibling(u.start.row,"above")},row_below:function(s,l){var u=l[l.length-1];o.dataManager.addSibling(u.start.row,"below")}}),o.dataManager=o.plugin.dataManager,o}return Iet(r,[{key:"appendOptions",value:function(i){var o=this,a=[{key:"add_child",name:function(){return this.getTranslatedPhrase(n7)},callback:function(){var l=o.dataManager.translateTrimmedRow(o.hot.getSelectedLast()[0]),u=o.dataManager.getDataObject(l);o.dataManager.addChild(u)},disabled:function(){var l=o.hot.getSelectedLast();return!l||l[0]<0||o.hot.selection.isSelectedByColumnHeader()||o.hot.countRows()>=o.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(i7)},callback:function(){o.dataManager.detachFromParent(o.hot.getSelectedLast())},disabled:function(){var l=o.hot.getSelectedLast(),u=o.dataManager.translateTrimmedRow(l[0]),c=o.dataManager.getRowParent(u);return!c||!l||l[0]<0||o.hot.selection.isSelectedByColumnHeader()||o.hot.countRows()>=o.hot.getSettings().maxRows}},{name:"---------"}];return De(0,i.items.length-1,function(s){if(s===0)return D(a,function(l,u){i.items.splice(s+u,0,l)}),!1}),this.modifyRowInsertingOptions(i)}},{key:"modifyRowInsertingOptions",value:function(i){var o=bL.get(this);return De(0,i.items.length-1,function(a){var s=o[i.items[a].key];s!=null&&(i.items[a].callback=s)}),i}}]),r}(e4);const Det=Let;function cg(t){"@babel/helpers - typeof";return cg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cg(t)}var wL;function SL(t){return Bet(t)||Uet(t)||Het(t)||Fet()}function Fet(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Het(t,e){if(t){if(typeof t=="string")return bT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bT(t,e)}}function Uet(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Bet(t){if(Array.isArray(t))return bT(t)}function bT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Vet(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function jet(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wet(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,zet(n.key),n)}}function Get(t,e,r){return e&&Wet(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function zet(t){var e=Yet(t,"string");return cg(e)==="symbol"?e:String(e)}function Yet(t,e){if(cg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(cg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Ket=function(){function t(e){jet(this,t),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}return Get(t,[{key:"onBeforeRowMove",value:function(r,n,i,o){var a=this,s=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:i,movePossible:o});if(s)return!1;this.movedToCollapsed=!1;var l=i===this.hot.countRows(),u=l?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i),c=!0,f=r.map(function(y){if(!c)return!1;var S=a.dataManager.translateTrimmedRow(y);return c=a.shouldAllowMoving(S,u),S}),h=f.indexOf(u)===-1;if(!c||!h)return!1;var d=this.getBaseParent(f),p=this.getTargetParent(l,u),m=d===p;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(p),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(f,u,m),this.moveRows(f,u,p),this.dataManager.rewriteCache(),this.moveCellsMeta(f,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,i,o,o&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,i),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,i=r.finalIndex,o=r.dropIndex,a=r.movePossible,s=!1;return zt(o)&&(Dt(kt(wL||(wL=Vet([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,i,o,a,!1),s=!0),s}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var i=this.dataManager.getRowParent(r?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,i){i||(Math.max.apply(Math,SL(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,i){var o=this,a=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(function(){r.forEach(function(s){o.dataManager.moveRow(s,n,o.movedToCollapsed,a)})})}},{key:"moveCellsMeta",value:function(r,n){var i=this,o,a=[],s=Math.max.apply(Math,SL(r))<n;r.forEach(function(l){a.push(i.hot.getCellMetaAtRow(l))}),this.hot.spliceCellsMeta(r[0],r.length),(o=this.hot).spliceCellsMeta.apply(o,[n-(s?a.length:0),0].concat(a))}},{key:"selectCells",value:function(r,n){var i=r.length,o=0,a=0,s=null,l=null;if(this.movedToCollapsed){var u=null;r[i-1]<n?u=this.dataManager.translateTrimmedRow(n-i):u=this.dataManager.translateTrimmedRow(n);var c=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),f=this.dataManager.getRowIndex(c);o=this.dataManager.untranslateTrimmedRow(f),a=o}else r[i-1]<n?(a=n-1,o=a-i+1):(o=n,a=o+i-1);s=this.hot.selection,l=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(o,0)),s.setRangeEnd(this.hot._createCellCoords(a,l),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(i,o){return i-o!==n})}}]),t}();function sd(t){"@babel/helpers - typeof";return sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sd(t)}function Xet(t){return Jet(t)||Zet(t)||Qet(t)||qet()}function qet(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qet(t,e){if(t){if(typeof t=="string")return wT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wT(t,e)}}function Zet(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Jet(t){if(Array.isArray(t))return wT(t)}function wT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ett(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function RL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rtt(n.key),n)}}function ttt(t,e,r){return e&&RL(t.prototype,e),r&&RL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function rtt(t){var e=ntt(t,"string");return sd(e)==="symbol"?e:String(e)}function ntt(t,e){if(sd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Jl(){return typeof Reflect<"u"&&Reflect.get?Jl=Reflect.get.bind():Jl=function(e,r,n){var i=itt(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Jl.apply(this,arguments)}function itt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ka(t),t!==null););return t}function ott(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ST(t,e)}function ST(t,e){return ST=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ST(t,e)}function att(t){var e=ltt();return function(){var n=ka(t),i;if(e){var o=ka(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return stt(this,i)}}function stt(t,e){if(e&&(sd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yY(t)}function yY(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ltt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ka(t){return ka=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ka(t)}var zR="nestedRows",utt=300,ra=new WeakMap,ctt="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",ftt=function(t){ott(r,t);var e=att(r);function r(n){var i;return ett(this,r),i=e.call(this,n),i.dataManager=null,i.headersUI=null,i.collapsedRowsMap=null,ra.set(yY(i),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),i}return ttt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[zR]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new jg),this.dataManager=new XJe(this,this.hot),this.collapsingUI=new Tet(this,this.hot),this.headersUI=new vY(this,this.hot),this.contextMenuUI=new Det(this,this.hot),this.rowMoveController=new Ket(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("beforeViewRender",function(){return i.onBeforeViewRender.apply(i,arguments)}),this.addHook("modifyRowData",function(){return i.onModifyRowData.apply(i,arguments)}),this.addHook("modifySourceLength",function(){return i.onModifySourceLength.apply(i,arguments)}),this.addHook("beforeDataSplice",function(){return i.onBeforeDataSplice.apply(i,arguments)}),this.addHook("filterData",function(){return i.onFilterData.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("beforeAddChild",function(){return i.onBeforeAddChild.apply(i,arguments)}),this.addHook("afterAddChild",function(){return i.onAfterAddChild.apply(i,arguments)}),this.addHook("beforeDetachChild",function(){return i.onBeforeDetachChild.apply(i,arguments)}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return i.onModifyRowHeaderWidth.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("beforeRowMove",function(){return i.onBeforeRowMove.apply(i,arguments)}),this.addHook("beforeLoadData",function(o){return i.onBeforeLoadData(o)}),this.addHook("beforeUpdateData",function(o){return i.onBeforeLoadData(o)}),Jl(ka(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),Jl(ka(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var i=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(i),Jl(ka(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(i,o,a,s){return this.rowMoveController.onBeforeRowMove(i,o,a,s)}},{key:"disableCoreAPIModifiers",value:function(){var i=ra.get(this);i.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var i=ra.get(this);i.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a){this.collapsingUI.toggleState(i,o,a)}},{key:"onModifyRowData",value:function(i){var o=ra.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.getDataObject(i)}},{key:"onModifySourceLength",value:function(){var i=ra.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(i,o,a){var s=ra.get(this);return s.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(i)?!0:(this.dataManager.spliceData(i,o,a),!1)}},{key:"onFilterData",value:function(i,o,a){var s=ra.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(a[0],o),this.collapsingUI.collapsedRowsStash.shiftStash(a[0],null,-1*o),this.dataManager.filterData(i,o,a),s.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(i){return this.contextMenuUI.appendOptions(i)}},{key:"onAfterGetRowHeader",value:function(i,o){this.headersUI.appendLevelIndicators(i,o)}},{key:"onModifyRowHeaderWidth",value:function(i){return this.headersUI.rowHeaderWidthCache||i}},{key:"onAfterRemoveRow",value:function(i,o,a,s){var l=this;if(s!==this.pluginName){var u=ra.get(this);setTimeout(function(){u.skipRender=null,l.headersUI.updateRowHeaderWidth(),l.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(i,o,a){var s=this,l=Array.from(a.reduce(function(u,c){if(s.dataManager.isParent(c)){var f=s.dataManager.getDataObject(c).__children;return u.add(c),Array.isArray(f)&&f.forEach(function(h){return u.add(s.dataManager.getRowIndex(h))}),u}return u.add(c)},new Set));a.length=0,a.push.apply(a,l)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(i,o){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(o)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(i,o,a){this.collapsingUI.collapsedRowsStash.shiftStash(a,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var i=Math.max.apply(Math,Xet(this.dataManager.cache.levels));i>0&&this.headersUI.updateRowHeaderWidth(i)}},{key:"onBeforeViewRender",value:function(i,o){var a=ra.get(this);a.skipRender&&(o.skipRender=!0)}},{key:"destroy",value:function(){Jl(ka(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(i){if(!VSe(i)){q_(ctt),this.hot.getSettings()[zR]=!1,this.disablePlugin();return}this.dataManager.setData(i),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return zR}},{key:"PLUGIN_PRIORITY",get:function(){return utt}}]),r}(xt);function fg(t){"@babel/helpers - typeof";return fg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fg(t)}function htt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dtt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mtt(n.key),n)}}function ptt(t,e,r){return e&&dtt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function mtt(t){var e=vtt(t,"string");return fg(e)==="symbol"?e:String(e)}function vtt(t,e){if(fg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(fg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var gtt=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;htt(this,t),this.rootWindow=r,this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}return ptt(t,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var i=typeof r>"u"?n:r,o=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(i));return o===null?void 0:JSON.parse(o)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;D(this.savedKeys,function(n,i){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[i]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),t}();const ytt=gtt;function ld(t){"@babel/helpers - typeof";return ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ld(t)}function btt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function EL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Stt(n.key),n)}}function wtt(t,e,r){return e&&EL(t.prototype,e),r&&EL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Stt(t){var e=Rtt(t,"string");return ld(e)==="symbol"?e:String(e)}function Rtt(t,e){if(ld(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function eu(){return typeof Reflect<"u"&&Reflect.get?eu=Reflect.get.bind():eu=function(e,r,n){var i=Ett(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},eu.apply(this,arguments)}function Ett(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=xa(t),t!==null););return t}function Ctt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&RT(t,e)}function RT(t,e){return RT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},RT(t,e)}function Ott(t){var e=Att();return function(){var n=xa(t),i;if(e){var o=xa(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ttt(this,i)}}function Ttt(t,e){if(e&&(ld(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _tt(t)}function _tt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Att(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xa(t){return xa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xa(t)}Ne.getSingleton().register("persistentStateSave");Ne.getSingleton().register("persistentStateLoad");Ne.getSingleton().register("persistentStateReset");var CL="persistentState",Itt=0,Ntt=function(t){Ctt(r,t);var e=Ott(r);function r(n){var i;return btt(this,r),i=e.call(this,n),i.storage=void 0,i}return wtt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[CL]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.storage||(this.storage=new ytt(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(o,a){return i.saveValue(o,a)}),this.addHook("persistentStateLoad",function(o,a){return i.loadValue(o,a)}),this.addHook("persistentStateReset",function(){return i.resetValue()}),eu(xa(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,eu(xa(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),eu(xa(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(i,o){o.value=this.storage.loadValue(i)}},{key:"saveValue",value:function(i,o){this.storage.saveValue(i,o)}},{key:"resetValue",value:function(i){typeof i>"u"?this.storage.resetAll():this.storage.reset(i)}},{key:"destroy",value:function(){eu(xa(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return CL}},{key:"PLUGIN_PRIORITY",get:function(){return Itt}}]),r}(xt);function ud(t){"@babel/helpers - typeof";return ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ud(t)}function Ptt(t){return $tt(t)||xtt(t)||ktt(t)||Mtt()}function Mtt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ktt(t,e){if(t){if(typeof t=="string")return ET(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ET(t,e)}}function xtt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function $tt(t){if(Array.isArray(t))return ET(t)}function ET(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ltt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function OL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ftt(n.key),n)}}function Dtt(t,e,r){return e&&OL(t.prototype,e),r&&OL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ftt(t){var e=Htt(t,"string");return ud(e)==="symbol"?e:String(e)}function Htt(t,e){if(ud(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function tu(){return typeof Reflect<"u"&&Reflect.get?tu=Reflect.get.bind():tu=function(e,r,n){var i=Utt(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},tu.apply(this,arguments)}function Utt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=$a(t),t!==null););return t}function Btt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&CT(t,e)}function CT(t,e){return CT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},CT(t,e)}function Vtt(t){var e=Gtt();return function(){var n=$a(t),i;if(e){var o=$a(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return jtt(this,i)}}function jtt(t,e){if(e&&(ud(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wtt(t)}function Wtt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gtt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $a(t){return $a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$a(t)}var YR="search",ztt=190,Ytt="htSearchResult",Ktt=function(e,r,n,i,o){e.getCellMeta(r,n).isSearchResult=o},Xtt=function(e,r,n){return zt(e)||e===null||!e.toLocaleLowerCase||e.length===0||zt(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(e.toLocaleLowerCase(n.locale))!==-1},qtt=function(t){Btt(r,t);var e=Vtt(r);function r(n){var i;return Ltt(this,r),i=e.call(this,n),i.callback=Ktt,i.queryMethod=Xtt,i.searchResultClass=Ytt,i}return Dtt(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[YR]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[YR];this.updatePluginSettings(o),this.addHook("beforeRenderer",function(){return i.onBeforeRenderer.apply(i,arguments)}),tu($a(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this,o=function(){return i.onBeforeRenderer.apply(i,arguments)};this.hot.addHook("beforeRenderer",o),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("beforeRenderer",o)}),tu($a(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),tu($a(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),l=this.hot.countRows(),u=this.hot.countCols(),c=[],f=this.hot;return De(0,l-1,function(h){De(0,u-1,function(d){var p=o.hot.getDataAtCell(h,d),m=o.hot.getCellMeta(h,d),y=m.search.callback||a,S=m.search.queryMethod||s,R=S(i,p,m);if(R){var E={row:h,col:d,data:p};c.push(E)}y&&y(f,h,d,p,R)})}),c}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(i){this.callback=i}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(i){this.queryMethod=i}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(i){this.searchResultClass=i}},{key:"updatePluginSettings",value:function(i){lt(i)&&(i.searchResultClass&&this.setSearchResultClass(i.searchResultClass),i.queryMethod&&this.setQueryMethod(i.queryMethod),i.callback&&this.setCallback(i.callback))}},{key:"onBeforeRenderer",value:function(i,o,a,s,l,u){var c=u.className||[],f=[];if(typeof c=="string")f=c.split(" ");else{var h;(h=f).push.apply(h,Ptt(c))}this.isEnabled()&&u.isSearchResult?f.includes(this.searchResultClass)||f.push("".concat(this.searchResultClass)):f.includes(this.searchResultClass)&&f.splice(f.indexOf(this.searchResultClass),1),u.className=f.join(" ")}},{key:"destroy",value:function(){tu($a(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return YR}},{key:"PLUGIN_PRIORITY",get:function(){return ztt}}]),r}(xt);function cd(t){"@babel/helpers - typeof";return cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cd(t)}function Qtt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function TL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Jtt(n.key),n)}}function Ztt(t,e,r){return e&&TL(t.prototype,e),r&&TL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Jtt(t){var e=ert(t,"string");return cd(e)==="symbol"?e:String(e)}function ert(t,e){if(cd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function sf(){return typeof Reflect<"u"&&Reflect.get?sf=Reflect.get.bind():sf=function(e,r,n){var i=trt(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},sf.apply(this,arguments)}function trt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=js(t),t!==null););return t}function rrt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&OT(t,e)}function OT(t,e){return OT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},OT(t,e)}function nrt(t){var e=art();return function(){var n=js(t),i;if(e){var o=js(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return irt(this,i)}}function irt(t,e){if(e&&(cd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ort(t)}function ort(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function art(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function js(t){return js=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},js(t)}var srt="touchScroll",lrt=200,urt=function(t){rrt(r,t);var e=nrt(r);function r(n){var i;return Qtt(this,r),i=e.call(this,n),i.scrollbars=[],i.clones=[],i.lockedCollection=!1,i.freezeOverlays=!1,i}return Ztt(r,[{key:"isEnabled",value:function(){return LF()}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterViewRender",function(){return i.onAfterViewRender()}),this.registerEvents(),sf(js(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,sf(js(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){sf(js(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.addHook("beforeTouchScroll",function(){return i.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return i.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var i=this.hot.view._wt.wtOverlays,o=i.topOverlay,a=i.bottomOverlay,s=i.inlineStartOverlay,l=i.topInlineStartCornerOverlay,u=i.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(o),a.clone&&this.scrollbars.push(a),this.scrollbars.push(s),l&&this.scrollbars.push(l),u&&u.clone&&this.scrollbars.push(u),this.clones=[],o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),s.needFullRender&&this.clones.push(s.clone.wtTable.holder.parentNode),l&&this.clones.push(l.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,D(this.clones,function(i){le(i,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var i=this;this.freezeOverlays=!1,D(this.clones,function(o){qe(o,"hide-tween"),le(o,"show-tween")}),this.hot._registerTimeout(function(){D(i.clones,function(o){qe(o,"show-tween")})},400),D(this.scrollbars,function(o){o.refresh(),o.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return srt}},{key:"PLUGIN_PRIORITY",get:function(){return lrt}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(xt);function fd(t){"@babel/helpers - typeof";return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fd(t)}function crt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _L(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hrt(n.key),n)}}function frt(t,e,r){return e&&_L(t.prototype,e),r&&_L(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function hrt(t){var e=drt(t,"string");return fd(e)==="symbol"?e:String(e)}function drt(t,e){if(fd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function ru(){return typeof Reflect<"u"&&Reflect.get?ru=Reflect.get.bind():ru=function(e,r,n){var i=prt(e,r);if(i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},ru.apply(this,arguments)}function prt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=La(t),t!==null););return t}function mrt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&TT(t,e)}function TT(t,e){return TT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TT(t,e)}function vrt(t){var e=brt();return function(){var n=La(t),i;if(e){var o=La(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return grt(this,i)}}function grt(t,e){if(e&&(fd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yrt(t)}function yrt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function brt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function La(t){return La=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},La(t)}var k1="trimRows",wrt=330,Srt=function(t){mrt(r,t);var e=vrt(r);function r(n){var i;return crt(this,r),i=e.call(this,n),i.trimmedRowsMap=null,i}return frt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[k1]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new jg),this.trimmedRowsMap.addLocalHook("init",function(){return i.onMapInit()}),ru(La(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var i=this,o=this.hot.getSettings()[k1];Array.isArray(o)&&this.hot.batchExecution(function(){i.trimmedRowsMap.clear(),D(o,function(a){i.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),ru(La(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),ru(La(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(i){var o=this,a=this.getTrimmedRows(),s=this.isValidConfig(i),l=a;s&&(l=Array.from(new Set(a.concat(i))));var u=this.hot.runHooks("beforeTrimRow",a,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){D(i,function(c){o.trimmedRowsMap.setValueAtIndex(c,!0)})},!0),this.hot.runHooks("afterTrimRow",a,l,s,s&&l.length>a.length))}},{key:"trimRow",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.trimRows(o)}},{key:"untrimRows",value:function(i){var o=this.getTrimmedRows(),a=this.isValidConfig(i),s=o,l=this.trimmedRowsMap.getValues().slice(),u=i.length>0;a&&u&&(D(i,function(f){l[f]=!1}),s=gn(l,function(f,h,d){return h&&f.push(d),f},[]));var c=this.hot.runHooks("beforeUntrimRow",o,s,a&&u);c!==!1&&(a&&u&&this.trimmedRowsMap.setValues(l),this.hot.runHooks("afterUntrimRow",o,s,a&&u,a&&s.length<o.length))}},{key:"untrimRow",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.untrimRows(o)}},{key:"isTrimmed",value:function(i){return this.trimmedRowsMap.getValueAtIndex(i)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(i){var o=this.hot.countSourceRows();return i.every(function(a){return Number.isInteger(a)&&a>=0&&a<o})}},{key:"onMapInit",value:function(){var i=this,o=this.hot.getSettings()[k1];Array.isArray(o)&&this.hot.batchExecution(function(){D(o,function(a){i.trimmedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"destroy",value:function(){ru(La(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return k1}},{key:"PLUGIN_PRIORITY",get:function(){return wrt}}]),r}(xt);function hd(t){"@babel/helpers - typeof";return hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hd(t)}function bY(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rrt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ert(n.key),n)}}function wY(t,e,r){return e&&Rrt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ert(t){var e=Crt(t,"string");return hd(e)==="symbol"?e:String(e)}function Crt(t,e){if(hd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function SY(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_T(t,e)}function _T(t,e){return _T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_T(t,e)}function RY(t){var e=_rt();return function(){var n=S2(t),i;if(e){var o=S2(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ort(this,i)}}function Ort(t,e){if(e&&(hd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Trt(t)}function Trt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _rt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function S2(t){return S2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},S2(t)}function Art(t){return Prt(t)||Nrt(t)||CY(t)||Irt()}function Irt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nrt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Prt(t){if(Array.isArray(t))return AT(t)}function EY(t,e){return xrt(t)||krt(t,e)||CY(t,e)||Mrt()}function Mrt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CY(t,e){if(t){if(typeof t=="string")return AT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AT(t,e)}}function AT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function krt(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function xrt(t){if(Array.isArray(t))return t}var OY="undoRedo",$rt="undoRedo";function Oe(t){var e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(r,n){var i=this,o=r&&r.length;if(o){var a=r.find(function(l){var u=EY(l,4),c=u[2],f=u[3];return c!==f});if(a){var s=function(){var u=r.reduce(function(f,h){return f.push(Art(h)),f},[]);D(u,function(f){f[1]=t.propToCol(f[1])});var c=o>1?i.getSelected():[[u[0][0],u[0][1]]];return new Oe.ChangeAction(u,c)};e.done(s,n)}}}),t.addHook("afterCreateRow",function(r,n,i){e.done(function(){return new Oe.CreateRowAction(r,n)},i)}),t.addHook("beforeRemoveRow",function(r,n,i,o){var a=function(){var l=t.toPhysicalRow(r),u=An(e.instance.getSourceData(l,0,l+n-1,e.instance.countSourceCols()-1));return new Oe.RemoveRowAction(l,u,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(a,o)}),t.addHook("afterCreateCol",function(r,n,i){e.done(function(){return new Oe.CreateColumnAction(r,n)},i)}),t.addHook("beforeRemoveCol",function(r,n,i,o){var a=function(){var l=e.instance.getSourceDataArray(),u=(e.instance.countCols()+r)%e.instance.countCols(),c=[],f=[],h=[];De(l.length-1,function(m){var y=[],S=l[m];De(u,u+(n-1),function(R){y.push(S[t.toPhysicalColumn(R)])}),c.push(y)}),De(n-1,function(m){h.push(t.toPhysicalColumn(u+m))}),Array.isArray(t.getSettings().colHeaders)&&De(n-1,function(m){f.push(t.getSettings().colHeaders[t.toPhysicalColumn(u+m)]||null)});var d=t.columnIndexMapper.getIndexesSequence(),p=t.rowIndexMapper.getIndexesSequence();return new Oe.RemoveColumnAction(u,h,c,f,d,p,t.getSettings().fixedColumnsStart)};e.done(a,o)}),t.addHook("beforeCellAlignment",function(r,n,i,o){e.done(function(){return new Oe.CellAlignmentAction(r,n,i,o)})}),t.addHook("beforeFilter",function(r){e.done(function(){return new Oe.FiltersAction(r)})}),t.addHook("beforeRowMove",function(r,n){r!==!1&&e.done(function(){return new Oe.RowMoveAction(r,n)})}),t.addHook("beforeMergeCells",function(r,n){n||e.done(function(){return new Oe.MergeCellsAction(t,r)})}),t.addHook("afterUnmergeCells",function(r,n){n||e.done(function(){return new Oe.UnmergeCellsAction(t,r)})}),t.addHook("afterInit",function(){e.init()})}Oe.prototype.done=function(t,e){if(!this.ignoreNewActions){var r=e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto";if(!r){var n=this.doneActions.slice(),i=this.instance.runHooks("beforeUndoStackChange",n,e);if(i!==!1){var o=t(),a=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}};Oe.prototype.undo=function(){if(this.isUndoAvailable()){var t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);var e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());var r=An(e),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,function(){i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};Oe.prototype.redo=function(){if(this.isRedoAvailable()){var t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);var e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());var r=An(e),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,function(){i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};Oe.prototype.isUndoAvailable=function(){return this.doneActions.length>0};Oe.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};Oe.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};Oe.prototype.isEnabled=function(){return this.enabled};Oe.prototype.enable=function(){if(!this.isEnabled()){var t=this.instance;this.enabled=!0,Frt(t),this.registerShortcuts(),t.addHook("afterChange",TY)}};Oe.prototype.disable=function(){if(this.isEnabled()){var t=this.instance;this.enabled=!1,Hrt(t),this.unregisterShortcuts(),t.removeHook("afterChange",TY)}};Oe.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};Oe.Action=function(){};Oe.Action.prototype.undo=function(){};Oe.Action.prototype.redo=function(){};Oe.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};Xs(Oe.ChangeAction,Oe.Action);Oe.ChangeAction.prototype.undo=function(t,e){for(var r=An(this.changes),n=t.countEmptyRows(!0),i=t.countEmptyCols(!0),o=0,a=r.length;o<a;o++)r[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.undo");for(var s=0,l=r.length;s<l;s++){var u=EY(r[s],2),c=u[0],f=u[1];t.getSettings().minSpareRows&&c+1+t.getSettings().minSpareRows===t.countRows()&&n===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(c+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&f+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(f+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)};Oe.ChangeAction.prototype.redo=function(t,e){for(var r=An(this.changes),n=0,i=r.length;n<i;n++)r[n].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};Oe.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};Xs(Oe.CreateRowAction,Oe.Action);Oe.CreateRowAction.prototype.undo=function(t,e){var r=t.countRows(),n=t.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};Oe.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};Oe.RemoveRowAction=function(t,e,r,n,i){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=i};Xs(Oe.RemoveRowAction,Oe.Action);Oe.RemoveRowAction.prototype.undo=function(t,e){var r=this,n=t.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(o,a){Object.keys(o).forEach(function(s){var l=parseInt(s,10);i.push([r.index+a,isNaN(l)?s:l,o[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};Oe.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};Oe.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};Xs(Oe.CreateColumnAction,Oe.Action);Oe.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};Oe.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};Oe.RemoveColumnAction=function(t,e,r,n,i,o,a){this.index=t,this.indexes=e,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a};Xs(Oe.RemoveColumnAction,Oe.Action);Oe.RemoveColumnAction.prototype.undo=function(t,e){var r=this,n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var i=this.indexes.slice(0).sort(),o=function(h,d,p){return p[r.indexes.indexOf(i[d])]},a=this.data.length,s=[],l=0;l<a;l++)s.push(st(this.data[l],o));var u=st(this.headers,o),c=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),D(t.getSourceDataArray(),function(f,h){D(i,function(d,p){f[d]=s[h][p],c.push([h,d,f[d]])})}),t.setSourceDataAtCell(c,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&D(u,function(f,h){t.getSettings().colHeaders[i[h]]=f}),t.batchExecution(function(){t.rowIndexMapper.setIndexesSequence(r.rowPositions),t.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};Oe.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};Oe.CellAlignmentAction=function(t,e,r,n){this.stateBefore=t,this.range=e,this.type=r,this.alignment=n};Oe.CellAlignmentAction.prototype.undo=function(t,e){var r=this;D(this.range,function(n){n.forAll(function(i,o){i>=0&&o>=0&&t.setCellMeta(i,o,"className",r.stateBefore[i][o]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};Oe.CellAlignmentAction.prototype.redo=function(t,e){hs(this.range,this.type,this.alignment,function(r,n){return t.getCellMeta(r,n)},function(r,n,i,o){return t.setCellMeta(r,n,i,o)}),t.addHookOnce("afterViewRender",e),t.render()};Oe.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};Xs(Oe.FiltersAction,Oe.Action);Oe.FiltersAction.prototype.undo=function(t,e){var r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};Oe.FiltersAction.prototype.redo=function(t,e){var r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var Lrt=function(t){SY(r,t);var e=RY(r);function r(n,i){var o;bY(this,r),o=e.call(this),o.cellRange=i;var a=o.cellRange.getTopStartCorner(),s=o.cellRange.getBottomEndCorner();return o.rangeData=n.getData(a.row,a.col,s.row,s.col),o}return wY(r,[{key:"undo",value:function(i,o){var a=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),a.unmergeRange(this.cellRange,!0);var s=this.cellRange.getTopStartCorner();i.populateFromArray(s.row,s.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(i,o){var a=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),a.mergeRange(this.cellRange)}}]),r}(Oe.Action);Oe.MergeCellsAction=Lrt;var Drt=function(t){SY(r,t);var e=RY(r);function r(n,i){var o;return bY(this,r),o=e.call(this),o.cellRange=i,o}return wY(r,[{key:"undo",value:function(i,o){var a=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),a.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(i,o){var a=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),a.unmergeRange(this.cellRange,!0),i.render()}}]),r}(Oe.Action);Oe.UnmergeCellsAction=Drt;Oe.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};Xs(Oe.RowMoveAction,Oe.Action);Oe.RowMoveAction.prototype.undo=function(t,e){var r=this,n=t.getPlugin("manualRowMove"),i=[].concat(this.rows),o=i.filter(function(c){return c>r.finalIndex}),a=i.filter(function(c){return c<=r.finalIndex}),s=o.sort(function(c,f){return f-c}).concat(a.sort(function(c,f){return c-f}));t.addHookOnce("afterViewRender",e);for(var l=0;l<s.length;l+=1){var u=t.toVisualRow(s[l]);n.moveRow(u,s[l])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};Oe.RowMoveAction.prototype.redo=function(t,e){var r=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),r.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};Oe.prototype.init=function(){var t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};Oe.prototype.registerShortcuts=function(){var t=this,e=this.instance.getShortcutManager(),r=e.getContext("grid"),n=function(a){return!a.altKey},i={runOnlyIf:n,group:OY};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){t.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){t.redo()}}],i)};Oe.prototype.unregisterShortcuts=function(){var t=this.instance.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(OY)};function TY(t,e){var r=this;if(e==="loadData")return r.undoRedo.clear()}function Frt(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function Hrt(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}var iy=Ne.getSingleton();iy.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});iy.register("beforeUndo");iy.register("afterUndo");iy.register("beforeRedo");iy.register("afterRedo");Oe.PLUGIN_KEY=$rt;Oe.SETTING_KEYS=!0;function Urt(){Ct(G9e),Ct(vke),Ct(xke),Ct(Ixe),Ct(Kxe),Ct(LG),Ct(RLe),Ct(rDe),Ct(qG),Ct(lHe),Ct($He),Ct(zHe),Ct(lz),Ct(QUe),Ct(eze),Ct(rYe),Ct(_Ye),Ct(ZYe),Ct(SKe),Ct(hXe),Ct(EXe),Ct(pqe),Ct(Oqe),Ct(OQe),Ct(zQe),Ct(oZe),Ct(FJe),Ct(ftt),Ct(Ntt),Ct(qtt),Ct(urt),Ct(Srt),Ct(Oe)}function Brt(){nMe(),yMe(),xMe(),QMe(),Urt()}Brt();const zrt=kr.memo(function(e){let{name:r,id:n,SVs:i,actions:o,callAction:a}=IY(e),s=l=>{a({action:o.recordVisibilityChange,args:{isVisible:l}})};return NY.useEffect(()=>()=>{a({action:o.recordVisibilityChange,args:{isVisible:!1}})},[]),i.hidden?null:ay.jsx(PY,{partialVisibility:!0,onChange:s,children:ay.jsxs("div",{id:n,style:{margin:"12px 0"},children:[ay.jsx("a",{name:n}),ay.jsx(iV,{licenseKey:"non-commercial-and-evaluation",data:i.cells.map(l=>[...l]),colHeaders:i.columnHeaders,rowHeaders:i.rowHeaders,width:l4(i.width),height:l4(i.height),afterChange:(l,u)=>a({action:o.onChange,args:{changes:l,source:u}}),formulas:{engine:Zr},fixedRowsTop:i.fixedRowsTop,fixedColumnsLeft:i.fixedColumnsLeft,hiddenColumns:{columns:i.hiddenColumns.map(l=>l-1),indicators:!1},hiddenRows:{rows:i.hiddenRows.map(l=>l-1),indicators:!1},readOnly:i.disabled,disableVisualSelection:i.disabled,stretchH:"all"})]})})});export{zrt as default};
