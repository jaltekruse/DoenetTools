import{R as W,u as q,r as v,C as f}from"./index-DVZ7nus4.js";import{BoardContext as H,BASE_LAYER_OFFSET as j}from"./graph-1a05b976-BUHOs_UM.js";import"./css-5483d03f-CnY6i4xu.js";const ne=W.memo(function U(D){var O;let{name:I,id:K,SVs:u,actions:Q,sourceOfUpdate:Z,callAction:$}=q(D);U.ignoreActionsWithoutCore=()=>!0;const l=v.useContext(H);let s=v.useRef(null),N=v.useRef(null),x=v.useRef(null),h=v.useRef(null),p=v.useRef(null),y=v.useRef(null);x.current=u.dx,h.current=u.dy,p.current=u.xoffset,y.current=u.yoffset;let F=v.useRef({visible:!u.hidden,fixed:!0,withlabel:!1,layer:10*u.layer+j,fillColor:"darkgray",strokeColor:"darkgray",size:.1,face:"circle",highlight:!1,showinfobox:!1});F.current.visible=!u.hidden,F.current.layer=10*u.layer+j,v.useEffect(()=>()=>{X()},[]);function P(){let[o,b,g,R]=l.getBoundingBox(),M=(o-p.current)/x.current,C=(g-p.current)/x.current,w=(R-y.current)/h.current,B=(b-y.current)/h.current,d=f.math.round(Math.min(M,C)+1),m=f.math.round(Math.max(M,C)-1),i=f.math.round(Math.min(w,B)+1),a=f.math.round(Math.max(w,B)-1);if(N.current=[d,m,i,a],Number.isFinite(d)&&Number.isFinite(m)&&Number.isFinite(i)&&Number.isFinite(a)){let t=[];for(let r=i;r<=a;r++){let c=r*u.dy+u.yoffset,e=[];for(let n=d;n<=m;n++)e.push(l.create("point",[n*u.dx+u.xoffset,c],F.current));t.push(e)}s.current=t}l.on("boundingbox",()=>{let[t,r,c,e]=l.getBoundingBox(),n=(t-p.current)/x.current,A=(c-p.current)/x.current,E=(e-y.current)/h.current,Y=(r-y.current)/h.current,S=f.math.round(Math.min(n,A)+1),G=f.math.round(Math.max(n,A)-1),J=f.math.round(Math.min(E,Y)+1),k=f.math.round(Math.max(E,Y)-1),[z,L,T,V]=N.current;(S!==z||G!==L||J!==T||k!==V)&&_(S,G,J,k)})}function X(){if(s.current!==null)for(let o of s.current)for(let b of o)l.removeObject(b);s.current=null}function _(o,b,g,R){if(s.current===null)return P();if(!Number.isFinite(o)||!Number.isFinite(b)||!Number.isFinite(g)||!Number.isFinite(R))return X();let[M,C,w,B]=N.current,d=R-g+1,m=B-w+1,i=b-o+1,a=C-M+1;for(let t=0;t<Math.min(d,m);t++){let r=s.current[t],c=(t+g)*h.current+y.current;for(let e=0;e<Math.min(i,a);e++){let n=(e+o)*x.current+p.current;r[e].coords.setCoordinates(JXG.COORDS_BY_USER,[n,c]),r[e].needsUpdate=!0,r[e].update()}if(a>i)for(let e=i;e<a;e++){let n=r.pop();l.removeObject(n)}else if(a<i)for(let e=a;e<i;e++){let n=(e+o)*x.current+p.current;r.push(l.create("point",[n,c],F.current))}}if(m>d)for(let t=d;t<m;t++){let r=s.current.pop();for(let c=0;c<a;c++){let e=r.pop();l.removeObject(e)}}else if(m<d)for(let t=m;t<d;t++){let r=[],c=(t+g)*h.current+y.current;for(let e=0;e<i;e++){let n=(e+o)*x.current+p.current;r.push(l.create("point",[n,c],F.current))}s.current.push(r)}N.current=[o,b,g,R],l.updateRenderer()}if(l)if(s.current===null)P();else{let[o,b,g,R]=l.getBoundingBox(),M=(o-p.current)/x.current,C=(g-p.current)/x.current,w=(R-y.current)/h.current,B=(b-y.current)/h.current,d=f.math.round(Math.min(M,C)+1),m=f.math.round(Math.max(M,C)-1),i=f.math.round(Math.min(w,B)+1),a=f.math.round(Math.max(w,B)-1);_(d,m,i,a);let t=(O=s.current[0])==null?void 0:O[0];if(t){let r=10*u.layer+j;if(t.visProp.layer!==r)for(let e of s.current)for(let n of e)n.setAttribute({layer:r})}}return null});export{ne as default};
