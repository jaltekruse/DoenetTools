import{q as ue,R as Q,u as de,r as i,e as fe,g as pe,C as Z,a as r,F as N,f as me,b as he,c as xe,d as be,T as ge,M as ve}from"./index-DVZ7nus4.js";import{BoardContext as Ce}from"./graph-1a05b976-BUHOs_UM.js";import{g as ee}from"./graph-462f764a-C0kM6xFY.js";import"./css-5483d03f-CnY6i4xu.js";const A=ue.button`
    position: relative;
    width: 24px;
    height: 24px;
    color: #ffffff;
    background-color: var(--mainBlue);
    display: inline-block;
    /* text-align: center; */
    padding: 2px;
    /* z-index: 0; */
    /* border: var(--mainBorder); */
    border: none;
    border-radius: var(--mainBorderRadius);
    margin: 0px 4px 4px 0px;

    &:hover {
        background-color: var(--lightBlue);
        color: black;
    }
`,_e=Q.memo(function T(Y){let{name:ye,id:f,SVs:e,actions:g,ignoreUpdate:te,rendererName:re,callAction:v}=de(Y);T.baseStateVariable="value",T.ignoreActionsWithoutCore=n=>n==="moveInput";const[C,H]=i.useState(e.value);let W=i.useRef(null);W.current=C;const ne=fe(pe(re));let _=i.useRef(null),t=i.useRef(null),S=i.useRef(null),P=i.useRef(null);const l=i.useContext(Ce);let k=i.useRef(!1),V=i.useRef(!1),p=i.useRef(!1),m=i.useRef(null),h=i.useRef(null),z=i.useRef(null),X=i.useRef(null),I=i.useRef(!1),R=i.useRef(!1);I.current=e.fixed,R.current=!e.draggable||e.fixLocation||e.fixed,i.useEffect(()=>()=>{t.current!==null&&ae()},[]),!te&&_.current!==e.value?(H(e.value),_.current=e.value):_.current=null;function w(n){let o=!W.current;H(o),_.current=e.value,ne(d=>{let x={...d};return x.ignoreUpdate=!0,x}),v({action:g.updateBoolean,args:{boolean:o},baseVariableValue:o})}function oe(){let n={visible:!e.hidden,fixed:I.current,disabled:e.disabled,checked:C,useMathJax:e.labelHasLatex,strokeColor:"var(--canvastext)",highlightStrokeColor:"var(--canvastext)",highlight:!R.current,parse:!1},o;try{let a=Z.fromAst(e.anchor),b=[a.get_component(0).evaluate_to_constant(),a.get_component(1).evaluate_to_constant()];Number.isFinite(b[0])||(b[0]=0,n.visible=!1),Number.isFinite(b[1])||(b[1]=0,n.visible=!1),o=l.create("point",b,{visible:!1})}catch{n.visible=!1,o=l.create("point",[0,0],{visible:!1});return}n.anchor=o;let{anchorx:d,anchory:x}=ee(e.positionFromAnchor);n.anchorx=d,n.anchory=x,P.current=[d,x];let s=l.create("checkbox",[0,0,e.label],n);s.rendNodeCheckbox.addEventListener("change",w),s.isDraggable=!R.current,s.on("down",function(a){k.current=[a.x,a.y],V.current=[...o.coords.scrCoords],p.current=!1}),s.on("hit",function(a){p.current=!1}),s.on("up",function(a){p.current&&(v({action:g.moveInput,args:{x:m.current,y:h.current}}),p.current=!1)}),s.on("keyfocusout",function(a){p.current&&(v({action:g.moveInput,args:{x:m.current,y:h.current}}),p.current=!1)}),s.on("drag",function(a){let b=a.type==="pointermove";(!b||Math.abs(a.x-k.current[0])>.1||Math.abs(a.y-k.current[1])>.1)&&(p.current=!0);let[G,J,U,D]=l.getBoundingBox(),M=s.size[0]/l.unitX,O=s.size[1]/l.unitY,$=P.current[0],q=P.current[1],F=0;$==="middle"?F=-M/2:$==="right"&&(F=-M);let E=0;q==="middle"?E=-O/2:q==="top"&&(E=-O);let ie=G+.04*(U-G)-F-M,le=U-.04*(U-G)-F,se=D+.04*(J-D)-E-O,ce=J-.04*(J-D)-E;if(b){var K=l.origin.scrCoords;m.current=(V.current[1]+a.x-k.current[0]-K[1])/l.unitX,h.current=(K[2]-(V.current[2]+a.y-k.current[1]))/l.unitY}else m.current=o.X()+s.relativeCoords.usrCoords[1],h.current=o.Y()+s.relativeCoords.usrCoords[2];m.current=Math.min(le,Math.max(ie,m.current)),h.current=Math.min(ce,Math.max(se,h.current)),v({action:g.moveInput,args:{x:m.current,y:h.current,transient:!0,skippable:!0}}),s.relativeCoords.setCoordinates(JXG.COORDS_BY_USER,[0,0]),o.coords.setCoordinates(JXG.COORDS_BY_USER,z.current)}),s.on("keydown",function(a){a.key==="Enter"&&p.current&&(v({action:g.moveInput,args:{x:m.current,y:h.current}}),p.current=!1)}),t.current=s,S.current=o,X.current=e.positionFromAnchor,e.labelHasLatex&&setTimeout(()=>{t.current&&(t.current.needsUpdate=!0,t.current.setText(e.label),t.current.update(),l==null||l.updateRenderer())},1e3)}function ae(){t.current.rendNodeCheckbox.removeEventListener("change",w),t.current.off("drag"),t.current.off("down"),t.current.off("hit"),t.current.off("up"),t.current.off("keyfocusout"),t.current.off("keydown"),l.removeObject(t.current),t.current=null}if(l){let n;try{let o=Z.fromAst(e.anchor);n=[o.get_component(0).evaluate_to_constant(),o.get_component(1).evaluate_to_constant()]}catch{n=[NaN,NaN]}if(z.current=n,t.current===null)oe();else{t.current.Value()!==C&&t.current.setAttribute({checked:C}),t.current.relativeCoords.setCoordinates(JXG.COORDS_BY_USER,[0,0]),S.current.coords.setCoordinates(JXG.COORDS_BY_USER,n),t.current.setText(e.label);let o=!e.hidden;if(Number.isFinite(n[0])&&Number.isFinite(n[1])){let d=t.current.visProp.visible!==o;t.current.visProp.visible=o,t.current.visPropCalc.visible=o,d&&t.current.setAttribute({visible:o})}else t.current.visProp.visible=!1,t.current.visPropCalc.visible=!1;if(t.current.visProp.disabled!==e.disabled&&(t.current.visProp.disabled=e.disabled,t.current.setAttribute({disabled:e.disabled})),t.current.visProp.highlight=!R.current,t.current.visProp.fixed=I.current,t.current.isDraggable=!R.current,t.current.needsUpdate=!0,e.positionFromAnchor!==X.current){let{anchorx:d,anchory:x}=ee(e.positionFromAnchor);t.current.visProp.anchorx=d,t.current.visProp.anchory=x,P.current=[d,x],X.current=e.positionFromAnchor,t.current.fullUpdate()}else t.current.update();S.current.needsUpdate=!0,S.current.update(),l.updateRenderer()}return r.jsx("a",{name:f})}if(e.hidden)return null;let j=e.disabled;const B=f+"_input";let c={cursor:"pointer",padding:"1px 6px 1px 6px"},u=null;if(Y.icon,e.includeCheckWork&&!e.suppressCheckwork){let n="unvalidated";if(e.valueHasBeenValidated&&(e.creditAchieved===1?n="correct":e.creditAchieved===0?n="incorrect":n="partialcorrect"),n==="unvalidated")j&&(c.backgroundColor=getComputedStyle(document.documentElement).getPropertyValue("--mainGray"),c.cursor="not-allowed"),u=r.jsx(A,{id:f+"_submit",tabIndex:"0",disabled:j,style:c,onClick:()=>v({action:g.submitAnswer}),onKeyPress:o=>{o.key==="Enter"&&v({action:g.submitAnswer})},children:r.jsx(N,{style:{},icon:me,transform:{rotate:90}})});else if(e.showCorrectness)if(n==="correct")c.backgroundColor=getComputedStyle(document.documentElement).getPropertyValue("--mainGreen"),u=r.jsx(A,{id:f+"_correct",style:c,children:r.jsx(N,{icon:he})});else if(n==="partialcorrect"){let d=`${Math.round(e.creditAchieved*100)} %`;c.width="44px",c.backgroundColor="#efab34",u=r.jsx(A,{id:f+"_partial",style:c,children:d})}else c.backgroundColor=getComputedStyle(document.documentElement).getPropertyValue("--mainRed"),u=r.jsx(A,{id:f+"_incorrect",style:c,children:r.jsx(N,{icon:xe})});else c.backgroundColor="rgb(74, 3, 217)",c.padding="1px 8px 1px 4px",u=r.jsx(A,{id:f+"_saved",style:c,children:r.jsx(N,{icon:be})});e.numAttemptsLeft<0?u=r.jsxs(r.Fragment,{children:[u,r.jsx("span",{children:"(no attempts remaining)"})]}):e.numAttemptsLeft==1?u=r.jsxs(r.Fragment,{children:[u,r.jsx("span",{children:"(1 attempt remaining)"})]}):Number.isFinite(e.numAttemptsLeft)&&(u=r.jsxs(r.Fragment,{children:[u,r.jsxs("span",{children:["(",e.numAttemptsLeft," attempts remaining)"]})]}))}let L,y=e.label;if(e.labelHasLatex&&(y=r.jsx(ve,{hideUntilTypeset:"first",inline:!0,dynamic:!0,children:y})),e.asToggleButton)L=r.jsx(ge,{id:B,isSelected:C,onClick:w,value:y,disabled:j},B);else{let n="doenetml-boolean-container",o="doenetml-checkmark";j&&(n+=" doenetml-boolean-container-disabled",o+=" doenetml-checkmark-disabled"),L=r.jsxs("label",{className:n,children:[r.jsx("input",{type:"checkbox",id:B,checked:C,onChange:w,disabled:j},B),r.jsx("span",{className:o}),y!=""?r.jsx("span",{style:{marginLeft:"2px"},children:y}):r.jsx("span",{children:y})]})}return r.jsxs(Q.Fragment,{children:[r.jsxs("span",{id:f,children:[r.jsx("a",{name:f}),L]}),u]})});export{_e as default};
